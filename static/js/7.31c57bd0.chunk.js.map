{"version":3,"sources":["comps/lc/background/DesignerBackground.tsx","framework/core/ComponentContainer.tsx","designer/LoadDesigner.ts","designer/operate-provider/core/EventManager.ts","designer/operate-provider/keyboard-mouse/KeyboardMouse.ts","designer/operate-provider/drag/AbstractDrag.ts","designer/operate-provider/drag/CanvasDragger.ts","designer/operate-provider/keyboard-mouse/HotKey.tsx","designer/operate-provider/scale/Scaler.ts","designer/operate-provider/DragScaleProvider.tsx","lib/lc-ruler/DesignerRuler.tsx","designer/operate-provider/DesignerContainer.tsx","lib/lc-movable/GroupMovable.tsx","lib/lc-movable/GroupSelectable.tsx","designer/operate-provider/right-click-menu/ContextMenuStore.ts","utils/RenderUtil.ts","designer/left/classify-list/ClassifyType.ts","designer/operate-provider/keyboard-mouse/HotKeyConfig.ts","designer/operate-provider/right-click-menu/ContextMenu.tsx","designer/canvas/DesignerCanvas.tsx","designer/header/DesignerHeader.tsx","designer/structure/LcHeader.tsx","designer/structure/LcBody.tsx","designer/structure/LcLeft.tsx","designer/structure/LcContent.tsx","designer/structure/LcRight.tsx","designer/structure/LcStructure.tsx","designer/structure/LcFoot.tsx","icon/icon-all.svg","icon/icon-bar.svg","icon/icon-column.svg","icon/icon-area.svg","icon/icon-pie.svg","icon/icon-scatter.svg","icon/icon-histogram.svg","icon/icon-line.svg","icon/icon-loading.svg","icon/icon-flowers.svg","icon/icon-radar.svg","icon/icon-ring.svg","icon/icon-wordcloud.svg","icon/icon-sun.svg","icon/icon-rectangle.svg","icon/icon-optimize.svg","icon/icon-points.svg","designer/left/classify-list/ClassifyListStore.ts","designer/float-configs/comp-list/CompListStore.ts","designer/left/classify-list/ClassifyList.tsx","designer/left/index.tsx","designer/right/MenuList.tsx","designer/right/ConfigContent.tsx","designer/right/index.tsx","designer/footer/HotKeyDes.tsx","designer/footer/keyboard-icon.svg","designer/footer/layers-icon.svg","designer/footer/DesignerFooter.tsx","designer/operate-provider/drag/CommonDragger.ts","designer/float-configs/common/FloatPanel.tsx","designer/float-configs/comp-list/CompList.tsx","designer/float-configs/layer-list/icon/lock.svg","designer/float-configs/layer-list/icon/preview-close.svg","designer/float-configs/layer-list/icon/preview-open.svg","designer/float-configs/layer-list/icon/unlock.svg","designer/float-configs/layer-list/LayerItem.tsx","designer/float-configs/layer-list/LayerComponent.ts","designer/float-configs/layer-list/LayerContainer.tsx","designer/float-configs/layer-list/LayerList.tsx","designer/float-configs/FloatConfigs.tsx","designer/Designer.tsx","designer/RegisterEvent.ts"],"names":["DesignerBackground","props","onClick","e","getBgConfigProps","bgConfig","state","config","width","height","bgMode","bgColor","bgImg","bgImgSize","length","bgImgPosition","bgImgPos","bgConfigProps","BackgroundMode","NONE","PICTURE","bgImgUrl","bgImgRepeat","single","radialGradient","linearGradient","bgColorMode","BackgroundColorMode","SINGLE","color","LINEAR_GRADIENT","compInstances","designerStore","elemConfigs","customComponentInfoMap","designerStarter","componentDefine","getInitConfig","AbstractBackgroundImpl","background","className","id","onDoubleClick","this","style","children","Component","ComponentContainer","ref","mode","parseUrlParams","action","layout","type","AbsCompImpl","getComponent","initConfig","info","create","then","instance","fallback","locked","hide","transform","position","display","pointerEvents","React","PureComponent","doScan","loadDesigner","loadProjectData","includes","initExistProject","Error","initNewProject","urlParams","name","doInit","setLoaded","canvasConfig","parseInt","projectConfig","abstractOperatorMap","saveType","SaveType","LOCAL","getProject","store","layoutConfigs","statisticInfo","themeConfig","theme","extendParams","setMinLevel","eventOperateStore","setMaxLevel","minLevel","maxLevel","EventManager","events","handler","push","index","indexOf","splice","args","forEach","eventManager","KMMap","leftClick","rightClick","middleClick","AbstractDrag","target","dragTarget","x","y","onDragStart","onDragEnd","CanvasDragger","initPosition","register","button","releasePointerCapture","pointerId","console","log","unregister","onDragMove","movementX","movementY","scale","scaleCore","setPointerCapture","error","clientX","clientY","destroy","registerDragger","TriggerType","scaleConfig","content","offsetX","offsetY","doScale","setScale","scaleCanvas","emit","deltaY","compute","origin","ratio","DragScaleProvider","dragger","overflow","window","innerHeight","innerWidth","backgroundColor","observer","DesignerRuler","wheelTimerId","pointerMoveTimerId","render","unit","baseOffset","_scrollPosX","_scrollPosY","rulerX","mousePosX","scrollPosX","startPosX","rulerY","mousePosY","scrollPosY","startPosY","ofX","ofY","Math","floor","clearTimeout","setTimeout","setState","scroll","textAlign","fontSize","top","left","scrollPos","zoom","lineColor","textColor","segment","negativeRuler","textOffset","DesignerContainer","designerContainerRef","handleClick","event","handleContextMenu","handlePointerDown","handlePointerMove","handlePointerUp","document","addEventListener","removeEventListener","dom","outline","GroupMovable","movableRef","updateLayout","lastEvent","beforeTranslate","offsetWidth","offsetHeight","dataset","onDragGroupEnd","data","ev","onResizeEnd","translate","drag","onResizeGroupEnd","targets","setMovableRef","readonly","selectorRef","rasterize","dragStep","resizeStep","draggable","resizable","keepRatio","throttleDrag","throttleResize","onClickGroup","current","clickTarget","inputEvent","inputTarget","onDrag","onDragGroup","onResize","onResizeGroup","GroupSelectable","createRef","setSelectorRef","dragContainer","selectableTargets","hitRate","selectByClick","selectFromInside","toggleContinueSelect","movable","isMoveableElement","some","t","contains","stop","onSelectEnd","setTargets","setTargetIds","isDragStart","preventDefault","dragStart","selected","filter","item","targetIds","contextMenuStore","visible","mouseDownTime","mouseUpTime","updateVisible","setPosition","setMouseDownTime","time","setMouseUpTime","makeObservable","observable","shieldKeyList","HotKey","handlerMapping","currHotKey","existHandlerKey","doHandler","hotKey","triggerType","COILED","pointerTarget","enforcementCap","querySelector","classList","keyDown","key","toLowerCase","join","keyUp","wheel","onBlur","onblur","RenderUtil","fn","delay","callback","now","Date","prev","ClassifyEnum","selectAll","comps","getElementsByClassName","compIds","compArr","Array","from","comp","doCopy","newIds","copyItem","newId","getElementById","doLock","toBeUpdate","toTop","order","toBottom","doDelete","setContentVisible","rightStore","delItem","doSave","throttle","doCreateOrUpdate","cloneDeep","getData","SERVER","alert","message","warn","doUnLock","unLockedId","doHide","ContextMenu","menuList","icon","LockOutlined","EyeInvisibleOutlined","CopyOutlined","VerticalAlignTopOutlined","VerticalAlignBottomOutlined","DeleteOutlined","menuListDom","i","menuItem","Icon","DesignerCanvas","backgroundRef","designerRef","updateActive","activeConfig","activeElem","isEqual","generateElement","Object","values","sort","a","b","map","loaded","Loading","ProjectHdItemImpl","lazy","ThemeHdItemImpl","Header","buildHeaderList","headerItemInstances","items","canvasVisible","headerStore","projectVisible","themeVisible","CanvasHdConfigImpl","LcHeader","LcBody","LcLeft","LcContent","LcRight","LcStructure","LcFoot","classifyListStore","classifies","classifyKey","icon_all","classify","ALL","icon_points","BASE","icon_optimize","icon_bar","BAR","icon_column","COLUMN","icon_line","LINE","icon_area","AREA","icon_pie","icon_loading","icon_scatter","icon_flowers","icon_radar","icon_word_cloud","icon_ring","icon_histogram","icon_sun","icon_rectangle","doClear","setClassifyKey","makeAutoObservable","compListStore","compInfoArr","compKey","keys","baseInfo","getBaseInfo","setVisible","setCompKey","ClassifyList","changeClassifyKey","currentTarget","buildClassifyList","classifyArr","src","alt","classifyListDom","overflowY","DesignerLeft","MenuList","menuChange","setActiveMenu","buildMenuList","menus","ConfigContent","buildConfigContent","activeMenu","ConfigComp","getMenuToConfigContentMap","onClose","activeMenuName","LineOutlined","Right","HotKeyDes","DesignerFooter","showHotKeyDes","toggleHotKeyDes","toggleLayerList","layerListStore","stateStr","keyboardIcon","layerIcon","toFixed","Dialog","title","CommonDragger","initPos","FloatPanel","panelRef","dragTargetRef","CompList","addItem","movableItem","idGenerate","generateId","getChartDom","chartDom","typeKey","compName","compInfo","chartImg","getChartImg","backgroundImage","searchChart","value","placeholder","onPressEnter","LayerItem","lock","compId","toggleLock","lockChange","toggleHide","hideChange","onSelected","selectedChange","previewClose","previewOpen","lockImg","unlockImg","LayerComponent","container","ComponentUtil","createAndRender","upOp","merge","reRender","operateType","OperateType","OPTIONS","AbstractComponent","LayerContainer","layerContainerRef","layerInstanceMap","r","LayerList","cancelSelected","layerListDom","searchLayer","setContent","buildLayerList","searchContent","_props","FloatConfigs","compListVisible","layerListVisible","Designer","setUnLockedId","setPointerTarget","registerEventOnDesignerLoaded"],"mappings":"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","file":"static/js/7.31c57bd0.chunk.js","sourcesContent":["import React, {Component, MouseEvent} from 'react';\r\nimport {BackgroundColorMode, BackgroundMode} from \"../../../designer/DesignerType\";\r\nimport AbstractBackgroundImpl, {AbstractBackgroundImplProps, BackgroundConfigType} from \"./AbstractBackgroundImpl\";\r\nimport designerStore from \"../../../designer/store/DesignerStore\";\r\nimport designerStarter from \"../../../designer/DesignerStarter\";\r\n\r\ninterface LcDesignerBackgroundProps {\r\n    onClick?: (e: MouseEvent<HTMLDivElement>) => void;\r\n    config?: BackgroundConfigType;\r\n}\r\n\r\n/**\r\n * 设计器画布背景\r\n */\r\nclass DesignerBackground extends Component<LcDesignerBackgroundProps> {\r\n\r\n    constructor(props: LcDesignerBackgroundProps) {\r\n        super(props);\r\n        const {compInstances, elemConfigs} = designerStore;\r\n        const {customComponentInfoMap} = designerStarter;\r\n        let config: AbstractBackgroundImplProps | null = null;\r\n        if ('80cc666f' in elemConfigs!)\r\n            config = elemConfigs['80cc666f'];\r\n        else {\r\n            const componentDefine = customComponentInfoMap['LcBg'];\r\n            if (componentDefine)\r\n                config = componentDefine.getInitConfig();\r\n        }\r\n        compInstances['80cc666f'] = new AbstractBackgroundImpl(this, config!);\r\n        this.state = {config: config?.background}\r\n        delete elemConfigs!['80cc666f'];\r\n    }\r\n\r\n    onClick = (e: MouseEvent<HTMLDivElement>) => {\r\n        const {onClick} = this.props;\r\n        onClick && onClick(e);\r\n    }\r\n\r\n    getBgConfigProps = () => {\r\n        // const bgConfig: BackgroundConfigType = this.props.config!!;\r\n        const {config: bgConfig} = this.state as any;\r\n        const {width, height, bgMode, bgColor, bgImg} = bgConfig;\r\n        let bgImgSize = '100% 100%';\r\n        if (bgImg.bgImgSize && bgImg.bgImgSize.length === 2)\r\n            bgImgSize = `${bgConfig.bgImg.bgImgSize[0]}px ${bgImg.bgImgSize[1]}px`;\r\n        let bgImgPosition = '0 0';\r\n        if (bgImg.bgImgPos && bgImg.bgImgPos.length === 2)\r\n            bgImgPosition = `${bgImg.bgImgPos[0]}px ${bgImg.bgImgPos[1]}px`;\r\n        if (bgConfig) {\r\n            let bgConfigProps: any = {height: height, width: width}\r\n            if (bgMode + '' === BackgroundMode.NONE)\r\n                bgConfigProps['backgroundColor'] = '#000000';\r\n            else if (bgMode + '' === BackgroundMode.PICTURE) {\r\n                if (bgImg.bgImgUrl && bgImg.bgImgUrl !== '') {\r\n                    bgConfigProps['backgroundImage'] = `url(${bgImg.bgImgUrl})`;\r\n                    bgConfigProps['backgroundSize'] = bgImgSize;\r\n                    bgConfigProps['backgroundPosition'] = bgImgPosition;\r\n                    bgConfigProps['backgroundRepeat'] = bgImg?.bgImgRepeat;\r\n                } else\r\n                    bgConfigProps['backgroundColor'] = '#000000';\r\n            } else {\r\n                const {single, radialGradient, linearGradient, bgColorMode} = bgColor;\r\n                if (bgConfig?.bgColor.bgColorMode + '' === BackgroundColorMode.SINGLE)\r\n                    bgConfigProps['backgroundColor'] = single.color;\r\n                else if (bgColorMode === BackgroundColorMode.LINEAR_GRADIENT)\r\n                    bgConfigProps['background'] = linearGradient.color;\r\n                else\r\n                    bgConfigProps['background'] = radialGradient.color;\r\n            }\r\n            return bgConfigProps;\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className={'lc-background'}\r\n                 id={'80cc666f'}\r\n                 data-type={'LcBg'}\r\n                 onDoubleClick={this.onClick}\r\n                 style={this.getBgConfigProps()}>\r\n                {this.props.children}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default DesignerBackground;","import React, {Suspense} from \"react\";\r\nimport designerStarter from \"../../designer/DesignerStarter\";\r\nimport {MovableItemType} from \"../../lib/lc-movable/types\";\r\nimport Loading from \"../../lib/loading/Loading\";\r\nimport designerStore from \"../../designer/store/DesignerStore\";\r\nimport {AbstractCustomComponentDefinition} from \"./AbstractCustomComponentDefinition\";\r\nimport {parseUrlParams} from \"../../utils/URLUtil\";\r\n\r\nexport interface ComponentContainerProps {\r\n    layout: MovableItemType;\r\n}\r\n\r\nclass ComponentContainer extends React.PureComponent<ComponentContainerProps> {\r\n\r\n    private ref: HTMLDivElement | null = null;\r\n\r\n    private mode: string = parseUrlParams()?.action || 'edit';\r\n\r\n    componentDidMount(): void {\r\n        //通过ref创建组件，并将组件实例方法Map中。后续通过Map匹配到具体实例，\r\n        //调用实例的对象方法进行组件的更新操作\r\n        const {layout} = this.props;\r\n        const {customComponentInfoMap} = designerStarter;\r\n        const {elemConfigs} = designerStore;\r\n        let componentDefine: AbstractCustomComponentDefinition = customComponentInfoMap[layout!.type + ''];\r\n        if (componentDefine) {\r\n            const AbsCompImpl = componentDefine.getComponent();\r\n            if (AbsCompImpl) {\r\n                const config = layout.id! in elemConfigs! ? elemConfigs![layout.id!] : (function () {\r\n                    let initConfig = componentDefine.getInitConfig();\r\n                    initConfig.info.id = layout.id!;\r\n                    return initConfig;\r\n                })() as any;\r\n                new AbsCompImpl()!.create(this.ref!, config).then((instance: any) => {\r\n                    const {compInstances} = designerStore;\r\n                    compInstances[layout.id + ''] = instance;\r\n                });\r\n                delete elemConfigs![layout.id!];\r\n            }\r\n        }\r\n    }\r\n\r\n    render() {\r\n        const {layout} = this.props;\r\n        return (\r\n            <Suspense fallback={<Loading/>}>\r\n                <div\r\n                    id={layout.id}\r\n                    data-type={layout.type}\r\n                    data-locked={layout.locked}\r\n                    data-hide={layout.hide}\r\n                    key={layout.id + ''}\r\n                    style={{\r\n                        width: layout.width,\r\n                        height: layout.height,\r\n                        transform: `translate(${layout.position![0]}px, ${layout.position![1]}px)`,\r\n                        position: 'absolute',\r\n                        display: layout.hide ? 'none' : 'block',\r\n                    }} className={'lc-comp-item'}>\r\n                    <div ref={(ref) => this.ref = ref} style={{\r\n                        width: '100%',\r\n                        height: '100%',\r\n                        //todo 要优化\r\n                        pointerEvents: `${this.mode === 'view' ? 'auto' : 'none'}`,\r\n                        position: 'relative'\r\n                    }}/>\r\n                </div>\r\n            </Suspense>\r\n        )\r\n    }\r\n}\r\n\r\n\r\nexport default ComponentContainer;","import designerStore from \"./store/DesignerStore\";\r\nimport eventOperateStore from \"./operate-provider/EventOperateStore\";\r\nimport designerStarter from \"./DesignerStarter\";\r\nimport {parseUrlParams} from \"../utils/URLUtil\";\r\nimport {SaveType} from \"./DesignerType\";\r\n\r\nconst {doScan} = designerStarter;\r\n\r\nexport const loadDesigner = () => {\r\n    //扫描组件\r\n    doScan();\r\n    //初始化项目数据\r\n    loadProjectData();\r\n}\r\n\r\n/**\r\n * 初始化项目操作类型。新增 / 更新\r\n */\r\nconst loadProjectData = () => {\r\n    let urlParams = parseUrlParams();\r\n    const {action} = urlParams;\r\n    if (['edit', 'view'].includes(action))\r\n        initExistProject();\r\n    else if (action === 'create')\r\n        initNewProject();\r\n    else\r\n        throw new Error('action is error')\r\n}\r\n\r\n/**\r\n * 初始化以创建方式打开时项目信息\r\n */\r\nconst initNewProject = () => {\r\n    let urlParams = parseUrlParams();\r\n    const {width, height, name} = urlParams;\r\n    const {doInit, setLoaded} = designerStore;\r\n    doInit({\r\n        canvasConfig: {\r\n            width: parseInt(width),\r\n            height: parseInt(height),\r\n        },\r\n        projectConfig: {\r\n            name: name\r\n        },\r\n    })\r\n    setLoaded(true);\r\n}\r\n\r\n/**\r\n * 初始化以更新方式打开时项目信息\r\n */\r\nconst initExistProject = () => {\r\n    let urlParams = parseUrlParams();\r\n    const {doInit, setLoaded} = designerStore;\r\n    const {abstractOperatorMap} = designerStarter;\r\n    const {projectConfig: {saveType = SaveType.LOCAL}} = designerStore;\r\n    abstractOperatorMap[saveType].getProject(urlParams.id).then((store: any) => {\r\n        if (store) {\r\n            doInit({\r\n                id: store.id,\r\n                canvasConfig: store.canvasConfig,\r\n                projectConfig: store.projectConfig,\r\n                elemConfigs: store.elemConfigs,\r\n                layoutConfigs: store.layoutConfigs,\r\n                statisticInfo: store.statisticInfo,\r\n                themeConfig: store.theme,\r\n                extendParams: store.extendParams,\r\n            })\r\n            //设置事件操作器的最大最小层级\r\n            const {setMinLevel, setMaxLevel} = eventOperateStore;\r\n            setMinLevel(store.layoutConfigs.minLevel || 0);\r\n            setMaxLevel(store.layoutConfigs.maxLevel || 0);\r\n        }\r\n        setLoaded(true);\r\n    })\r\n}","class EventManager {\r\n    events: any = {};\r\n\r\n    register(type: string, handler: Function) {\r\n        if (!this.events[type])\r\n            this.events[type] = [];\r\n        this.events[type].push(handler);\r\n    }\r\n\r\n    unregister(type: string, handler?: Function) {\r\n        if (!this.events[type])\r\n            return;\r\n\r\n        const index = this.events[type].indexOf(handler);\r\n        if (index > -1)\r\n            this.events[type].splice(index, 1);\r\n\r\n    }\r\n\r\n    emit(type: string, ...args: any[]) {\r\n        if (!this.events[type])\r\n            return;\r\n        this.events[type].forEach((handler: Function) => {\r\n            handler(...args);\r\n        });\r\n    }\r\n}\r\n\r\nconst eventManager = new EventManager();\r\nexport default eventManager;","export const KMMap = {\r\n    leftClick: false,\r\n    rightClick: false,\r\n    middleClick: false,\r\n}","abstract class AbstractDrag {\r\n    //被拖拽的目标\r\n    protected target: any = null;\r\n    //触发拖拽的目标元素\r\n    protected dragTarget: any = null;\r\n    //拖拽的起始位置\r\n    protected position: { x: number, y: number } = {x: 0, y: 0};\r\n\r\n    public registerDragger(): void {\r\n        this.onDragStart(this.target);\r\n        this.onDragEnd(this.target);\r\n    }\r\n\r\n    protected abstract onDragStart(e: any): void;\r\n\r\n    protected abstract onDragMove(e: any): void;\r\n\r\n    protected abstract onDragEnd(e: any): void;\r\n}\r\n\r\nexport default AbstractDrag;","import AbstractDrag from \"./AbstractDrag\";\r\nimport eventManager from \"../core/EventManager\";\r\nimport {KMMap} from \"../keyboard-mouse/KeyboardMouse\";\r\nimport scaleCore from \"../scale/ScaleCore\";\r\n\r\nclass CanvasDragger extends AbstractDrag {\r\n\r\n    //设置为静态属性，以供画布的拖拽和缩放信息共用\r\n    public static position: { x: number, y: number } = {x: 0, y: 0};\r\n\r\n    constructor(target: any, initPosition?: { x: number, y: number }) {\r\n        super();\r\n        if (!target)\r\n            throw new Error(\"target is null, cannot drag\");\r\n        this.target = target;\r\n        CanvasDragger.position = initPosition || CanvasDragger.position;\r\n        this.registerDragger();\r\n    }\r\n\r\n    protected onDragEnd = (): void => {\r\n        eventManager.register('pointerup', (e: any) => {\r\n            if (e.button === 2) {\r\n                try {\r\n                    this.target.releasePointerCapture(e.pointerId);\r\n                } catch (e) {\r\n                    console.log(e);\r\n                }\r\n                eventManager.unregister('pointermove', this.onDragMove);\r\n            }\r\n        });\r\n    }\r\n\r\n    protected onDragMove = (e: any): void => {\r\n        if (KMMap.rightClick) {\r\n            CanvasDragger.position.x += e.movementX;\r\n            CanvasDragger.position.y += e.movementY;\r\n            const {scale} = scaleCore;\r\n            this.target.style.transform = 'translate3d(' + CanvasDragger.position.x + 'px, ' + CanvasDragger.position.y + 'px, 0) scale(' + scale + ')';\r\n        }\r\n    }\r\n\r\n    protected onDragStart = (): void => {\r\n        eventManager.register('pointerdown', (e: any) => {\r\n            if (e.button === 2) {\r\n                try {\r\n                    this.target.setPointerCapture(e.pointerId);\r\n                } catch (error) {\r\n                    this.target.releasePointerCapture(e.pointerId);\r\n                }\r\n                this.position = {x: e.clientX, y: e.clientY};\r\n                eventManager.register('pointermove', this.onDragMove);\r\n            }\r\n        });\r\n    }\r\n\r\n    destroy = () => {\r\n        eventManager.unregister('pointerdown');\r\n        eventManager.unregister('pointermove');\r\n        eventManager.unregister('pointerup');\r\n    }\r\n\r\n}\r\n\r\nexport default CanvasDragger;","import {Component} from 'react';\r\nimport eventOperateStore from \"../EventOperateStore\";\r\n\r\nexport enum TriggerType {\r\n    SINGLE,\r\n    COILED\r\n}\r\n\r\nexport interface HandlerMapping {\r\n    [key: string]: {\r\n        handler: Function,\r\n        target?: any,\r\n        triggerType?: TriggerType\r\n    }\r\n}\r\n\r\ninterface HotKeyProps {\r\n    handlerMapping: HandlerMapping;\r\n}\r\n\r\n//需要屏蔽浏览器默认快捷键效果的快捷键列表\r\nconst shieldKeyList = ['control + s', 'alt', 'control + l']\r\n\r\nclass HotKey extends Component<HotKeyProps> {\r\n\r\n    handlerMapping: HandlerMapping = {}\r\n    currHotKey: string[] = [];\r\n    existHandlerKey: string = \"\";\r\n\r\n    constructor(props: HotKeyProps) {\r\n        super(props);\r\n        this.handlerMapping = props.handlerMapping;\r\n    }\r\n\r\n    /**\r\n     * 从快捷键配置管理映射表中匹配对应的快捷键处理函数并执行。\r\n     * @param e 鼠标事件对象\r\n     * @param hotKey 当前按下的快捷键\r\n     */\r\n    doHandler = (e: any, hotKey: string) => {\r\n        const {handler, triggerType = TriggerType.SINGLE} = this.handlerMapping[hotKey] || {};\r\n        if (handler) {\r\n            if ((triggerType === TriggerType.SINGLE && this.existHandlerKey !== hotKey) || triggerType === TriggerType.COILED) {\r\n                const {pointerTarget} = eventOperateStore;\r\n                //todo 需要优化快捷键的执行范围\r\n                const enforcementCap = document.querySelector('.lc-ruler-content');\r\n                if (enforcementCap && (enforcementCap.contains(pointerTarget) || (pointerTarget && pointerTarget.classList.contains('layer-item')))) {\r\n                    handler(e);\r\n                    this.existHandlerKey = hotKey;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    keyDown = (e: any) => {\r\n        const key = e.key.toLowerCase();\r\n        if (!this.currHotKey.some(item => item === key))\r\n            this.currHotKey.push(key);\r\n        let hotKey = this.currHotKey.join(' + ');\r\n        if (shieldKeyList.some(item => item === hotKey))\r\n            e.preventDefault();\r\n        this.doHandler(e, hotKey);\r\n    };\r\n\r\n    keyUp = (e: any) => {\r\n        const key = e.key.toLowerCase();\r\n        if (this.currHotKey.some(item => item === key)) {\r\n            this.currHotKey = this.currHotKey.filter(item => item !== key);\r\n            this.existHandlerKey = '';\r\n        }\r\n    }\r\n\r\n    wheel = (e: any) => {\r\n        let hotKey = this.currHotKey.join(' + ') + ' + wheel';\r\n        const {handler, target} = this.handlerMapping[hotKey] || {};\r\n        if (handler) {\r\n            if (target && !target.contains(e.target))\r\n                return;\r\n            handler(e);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 失去焦点时清空当前热键（一般是切换屏幕）\r\n     */\r\n    onBlur = () => {\r\n        this.currHotKey = [];\r\n        this.existHandlerKey = '';\r\n    }\r\n\r\n    componentDidMount() {\r\n        document.addEventListener('keydown', this.keyDown);\r\n        document.addEventListener('keyup', this.keyUp);\r\n        document.addEventListener('wheel', this.wheel);\r\n        window.onblur = this.onBlur;\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.removeEventListener('keydown', this.keyDown);\r\n        document.removeEventListener('keyup', this.keyUp);\r\n        document.removeEventListener('wheel', this.wheel);\r\n        window.onblur = null;\r\n    }\r\n\r\n    render() {\r\n        return null;\r\n    }\r\n}\r\n\r\nexport default HotKey;","import designerStore from \"../../store/DesignerStore\";\r\nimport scaleCore from \"./ScaleCore\";\r\nimport eventOperateStore from \"../EventOperateStore\";\r\nimport eventManager from \"../core/EventManager\";\r\nimport {KMMap} from \"../keyboard-mouse/KeyboardMouse\";\r\nimport CanvasDragger from \"../drag/CanvasDragger\";\r\n\r\nexport const scaleConfig = {\r\n    content: null,\r\n    offsetX: 0,\r\n    offsetY: 0,\r\n}\r\n\r\nexport const doScale = (e: any) => {\r\n    //缩放拖拽不能同时进行\r\n    if (KMMap.rightClick) return;\r\n    const {setScale} = eventOperateStore;\r\n    //缩放画布\r\n    scaleCanvas(e);\r\n    //缩放标尺\r\n    eventManager.emit('wheel', e);\r\n    setScale(scaleCore.scale);\r\n}\r\n\r\nexport const scaleCanvas = (e: any) => {\r\n    let {canvasConfig: {width = 1920, height = 1080}} = designerStore;\r\n    let type = 1;\r\n    if (e.deltaY > 0)\r\n        type = 0;\r\n    scaleCore.compute(type);\r\n    const origin = {\r\n        x: (scaleCore.ratio - 1) * width * 0.5,\r\n        y: (scaleCore.ratio - 1) * height * 0.5\r\n    };\r\n    // 计算偏移量\r\n    CanvasDragger.position.x -= (scaleCore.ratio - 1) * (e.clientX - scaleConfig.offsetX - CanvasDragger.position.x) - origin.x;\r\n    CanvasDragger.position.y -= (scaleCore.ratio - 1) * (e.clientY - scaleConfig.offsetY - CanvasDragger.position.y) - origin.y;\r\n    (scaleConfig.content as any).style.transform = 'translate3d(' + CanvasDragger.position.x + 'px, ' + CanvasDragger.position.y + 'px, 0) scale(' + scaleCore.scale + ')';\r\n}","import React, {Component} from 'react';\r\nimport {scaleConfig} from \"./scale/Scaler\";\r\nimport designerStore from \"../store/DesignerStore\";\r\nimport {observer} from \"mobx-react\";\r\nimport CanvasDragger from \"./drag/CanvasDragger\";\r\n\r\nclass DragScaleProvider extends Component {\r\n\r\n    content: any = null;\r\n    dragger: CanvasDragger | null = null;\r\n\r\n    componentDidMount() {\r\n        //配置缩放\r\n        this.content!.style.transform = 'translate3d(' + CanvasDragger.position.x + 'px, ' + CanvasDragger.position.y + 'px, 0) scale(1)';\r\n        scaleConfig.content = this.content;\r\n        scaleConfig.offsetX = 80;\r\n        scaleConfig.offsetY = 70;\r\n        this.dragger = new CanvasDragger(this.content);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        if (this.dragger)\r\n            this.dragger.destroy();\r\n    }\r\n\r\n    render() {\r\n        const {canvasConfig} = designerStore!;\r\n        return (\r\n            <div style={{\r\n                overflow: \"hidden\",\r\n                height: window.innerHeight - 90,\r\n                width: window.innerWidth - 95,\r\n                backgroundColor: '#434343'\r\n            }}>\r\n                <div ref={ref => this.content = ref} className={'lc-content-scale'}\r\n                     style={{width: canvasConfig?.width, height: canvasConfig?.height}}>\r\n                    {this.props.children}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(DragScaleProvider);\r\n","import React, {Component} from 'react';\r\nimport Ruler, {RulerProps} from \"@scena/react-ruler\";\r\nimport {KMMap} from \"../../designer/operate-provider/keyboard-mouse/KeyboardMouse\";\r\nimport eventManager from \"../../designer/operate-provider/core/EventManager\";\r\nimport scaleCore from \"../../designer/operate-provider/scale/ScaleCore\";\r\n\r\ninterface DesignerRulerProps {\r\n    offsetX?: number;\r\n    offsetY?: number;\r\n}\r\n\r\n/**\r\n * 缩放计算公式：\r\n * 设现有条件：\r\n * 1) 当前鼠标位置：P\r\n * 2) 当前缩放倍数：S1\r\n * 3) 最新缩放倍数：S2\r\n * 4) 标尺起始位置：St\r\n * 5) 标尺渲染起始位置：scrollPos\r\n * 则：scrollPos = P-[(P-St)/(S2/S1)]\r\n *\r\n * 鼠标移动计算公式：\r\n * 设现有条件：\r\n * 1) 鼠标按下时在当前屏幕分辨路下的真实鼠标位置：mosP\r\n * 2) 标尺当前的起始位置：startP\r\n * 3) 鼠标本次移动的距离：mouOffset\r\n * 4) 标尺当前的缩放系数：scale\r\n * 5) 在当前缩放系数下，鼠标对应的标尺位置：rulerP\r\n *\r\n * 则鼠标指针在当前缩放系数下的位置为：rulerP = startP + (mouOffset / scale)\r\n * 鼠标移动后的标尺起始位置为：scrollPos = startP + (mouOffset / scale)\r\n */\r\nclass DesignerRuler extends Component<RulerProps & DesignerRulerProps> {\r\n\r\n    wheelTimerId: any = null;\r\n    pointerMoveTimerId: any = null;\r\n\r\n    state = {\r\n        render: 0\r\n    }\r\n\r\n    unit = 50;\r\n\r\n    baseOffset = 20;\r\n    _scrollPosX = 0;\r\n    _scrollPosY = 0;\r\n\r\n    rulerX: any = null;\r\n    offsetX = 0;\r\n    mousePosX = 0;\r\n    scrollPosX = 0;\r\n    startPosX = 0;\r\n\r\n    rulerY: any = null;\r\n    offsetY = 0;\r\n    mousePosY = 0;\r\n    scrollPosY = 0;\r\n    startPosY = 0;\r\n\r\n    componentDidMount() {\r\n        const {offsetX: ofX = 0, offsetY: ofY = 0} = this.props;\r\n        eventManager.register('wheel', () => {\r\n            this.startPosX = this.mousePosX - ((this.mousePosX - this.startPosX) / scaleCore.ratio);\r\n            this.scrollPosX = this.startPosX;\r\n            this.startPosY = this.mousePosY - ((this.mousePosY - this.startPosY) / scaleCore.ratio);\r\n            this.scrollPosY = this.startPosY;\r\n            this.unit = Math.floor(50 / scaleCore.scale);\r\n            clearTimeout(this.wheelTimerId);\r\n            this.wheelTimerId = setTimeout(() => {\r\n                this.setState({render: this.state.render + 1})\r\n            }, 300);\r\n        });\r\n\r\n        eventManager.register('pointermove', (e: any) => {\r\n            const {scale} = scaleCore;\r\n            this.mousePosX = this.startPosX + ((e.clientX - this.baseOffset - ofX) / scale);\r\n            this.mousePosY = this.startPosY + ((e.clientY - this.baseOffset - ofY) / scale);\r\n            if (KMMap.rightClick) {\r\n                this.offsetX = this.offsetX - e.movementX;\r\n                this._scrollPosX = this.startPosX + (this.offsetX / scale)\r\n                this.offsetY = this.offsetY - e.movementY;\r\n                this._scrollPosY = this.startPosY + (this.offsetY / scale)\r\n\r\n                clearTimeout(this.pointerMoveTimerId);\r\n                this.pointerMoveTimerId = setTimeout(() => {\r\n                    this.rulerX && this.rulerX.scroll(this._scrollPosX);\r\n                    this.rulerY && this.rulerY.scroll(this._scrollPosY);\r\n                }, 300);\r\n            }\r\n        });\r\n\r\n        eventManager.register('pointerdown', (e: PointerEvent) => {\r\n            if (e.button === 2) {\r\n                this.offsetX = 0;\r\n                this.offsetY = 0;\r\n            }\r\n        });\r\n\r\n        eventManager.register('pointerup', (e: PointerEvent) => {\r\n            if (e.button === 2) {\r\n                this.offsetX = 0;\r\n                this.offsetY = 0;\r\n                this.scrollPosX = this._scrollPosX;\r\n                this.startPosX = this._scrollPosX;\r\n                this.scrollPosY = this._scrollPosY;\r\n                this.startPosY = this._scrollPosY;\r\n            }\r\n        });\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        eventManager.unregister('wheel');\r\n        eventManager.unregister('pointermove');\r\n        eventManager.unregister('pointerdown');\r\n        eventManager.unregister('pointerup');\r\n        clearTimeout(this.wheelTimerId);\r\n        clearTimeout(this.pointerMoveTimerId);\r\n    }\r\n\r\n\r\n    render() {\r\n        const {scale} = scaleCore;\r\n        return (\r\n            <div className={'lc-ruler'} style={{position: 'relative'}}>\r\n                <div style={{\r\n                    position: 'absolute',\r\n                    width: 20,\r\n                    height: 20,\r\n                    color: '#838383',\r\n                    textAlign: 'center',\r\n                    fontSize: 12,\r\n                    top: -1\r\n                }}>px\r\n                </div>\r\n                <div className={'lc-ruler-horizontal'}\r\n                     style={{\r\n                         height: this.baseOffset,\r\n                         width: `calc(100% - ${this.baseOffset}px)`,\r\n                         position: 'relative',\r\n                         left: this.baseOffset\r\n                     }}>\r\n                    <Ruler ref={ref => this.rulerX = ref}\r\n                           scrollPos={this.scrollPosX}\r\n                           zoom={scale}\r\n                           lineColor={'#444b4d'}\r\n                           textColor={'#a6a6a6'}\r\n                           segment={2}\r\n                           negativeRuler={true}\r\n                           textOffset={[0, 10]}\r\n                           backgroundColor={'#090f1d'}\r\n                           unit={this.unit}/>\r\n                </div>\r\n                <div className={'lc-ruler-vertical'}\r\n                     style={{\r\n                         width: this.baseOffset,\r\n                         height: window.innerHeight - this.baseOffset - 90,\r\n                         position: 'relative',\r\n                         overflow: 'hidden'\r\n                     }}>\r\n                    <Ruler ref={ref => this.rulerY = ref}\r\n                           type={'vertical'}\r\n                           scrollPos={this.scrollPosY}\r\n                           lineColor={'#444b4d'}\r\n                           textColor={'#a6a6a6'}\r\n                           zoom={scale}\r\n                           segment={2}\r\n                           negativeRuler={true}\r\n                           textOffset={[10, 0]}\r\n                           backgroundColor={'#090f1d'}\r\n                           unit={this.unit}/>\r\n                </div>\r\n                <div className={'lc-ruler-content'} style={{\r\n                    position: 'absolute',\r\n                    top: this.baseOffset,\r\n                    left: this.baseOffset,\r\n                }}>\r\n                    {this.props.children}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default DesignerRuler;","import React, {Component} from 'react';\r\nimport eventManager from \"./core/EventManager\";\r\n\r\nclass DesignerContainer extends Component {\r\n\r\n    designerContainerRef: any;\r\n\r\n    componentDidMount() {\r\n        document.addEventListener(\"click\", this.handleClick);\r\n        this.designerContainerRef.addEventListener(\"contextmenu\", this.handleContextMenu);\r\n        document.addEventListener(\"pointerdown\", this.handlePointerDown);\r\n        document.addEventListener(\"pointermove\", this.handlePointerMove);\r\n        document.addEventListener(\"pointerup\", this.handlePointerUp);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.removeEventListener(\"click\", this.handleClick);\r\n        this.designerContainerRef.removeEventListener(\"contextmenu\", this.handleContextMenu);\r\n        document.removeEventListener(\"pointerdown\", this.handlePointerDown);\r\n        document.removeEventListener(\"pointermove\", this.handlePointerMove);\r\n        document.removeEventListener(\"pointerup\", this.handlePointerUp);\r\n    }\r\n\r\n    /**\r\n     * 监听点击事件\r\n     */\r\n    handleClick = (event: any) => eventManager.emit('click', event);\r\n    /**\r\n     * 监听右键菜单事件\r\n     */\r\n    handleContextMenu = (event: any) => eventManager.emit('contextmenu', event);\r\n    /**\r\n     * 监听触摸屏按下事件\r\n     */\r\n    handlePointerDown = (event: any) => eventManager.emit('pointerdown', event);\r\n    /**\r\n     * 监听指针移动事件\r\n     */\r\n    handlePointerMove = (event: any) => eventManager.emit('pointermove', event);\r\n    /**\r\n     * 监听指针抬起事件\r\n     */\r\n    handlePointerUp = (event: any) => eventManager.emit('pointerup', event);\r\n\r\n    render() {\r\n        return (\r\n            <div ref={dom => this.designerContainerRef = dom} style={{outline: 'none'}}\r\n                 className={'lc-event-container'}>\r\n                {this.props.children}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default DesignerContainer;","import * as React from \"react\";\r\nimport Moveable from \"react-moveable\";\r\nimport {observer} from \"mobx-react\";\r\nimport eventOperateStore from \"../../designer/operate-provider/EventOperateStore\";\r\nimport designerStore from \"../../designer/store/DesignerStore\";\r\nimport {MovableItemType} from \"./types\";\r\n\r\ninterface GroupMovableProps {\r\n    readonly?: boolean;\r\n}\r\n\r\nclass GroupMovable extends React.Component<GroupMovableProps> {\r\n    movableRef = React.createRef<Moveable>();\r\n\r\n    constructor(props: any) {\r\n        super(props);\r\n        this.state = {\r\n            targets: [],\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        const {setMovableRef} = eventOperateStore;\r\n        setMovableRef(this.movableRef);\r\n    }\r\n\r\n    onDragEnd = (e: any) => {\r\n        const {updateLayout} = designerStore;\r\n        const {lastEvent, target} = e;\r\n        if (lastEvent) {\r\n            const {beforeTranslate} = lastEvent;\r\n            updateLayout([\r\n                {\r\n                    id: target.id,\r\n                    width: target.offsetWidth,\r\n                    height: target.offsetHeight,\r\n                    type: target.dataset.type,\r\n                    position: [beforeTranslate[0], beforeTranslate[1]]\r\n                }\r\n            ], false);\r\n        }\r\n    }\r\n\r\n    onDragGroupEnd = (e: any) => {\r\n        const {updateLayout} = designerStore;\r\n        let data: MovableItemType[] = [];\r\n        e.events.forEach((ev: any) => {\r\n            const {target, lastEvent} = ev;\r\n            if (lastEvent) {\r\n                const {beforeTranslate} = lastEvent;\r\n                data.push({\r\n                    id: target.id,\r\n                    width: target.offsetWidth,\r\n                    height: target.offsetHeight,\r\n                    type: target.dataset.type,\r\n                    position: [beforeTranslate[0], beforeTranslate[1]]\r\n                })\r\n            }\r\n        })\r\n        if (data.length > 0)\r\n            updateLayout(data);\r\n    }\r\n\r\n    onResizeEnd = (e: any) => {\r\n        const {updateLayout} = designerStore;\r\n        const {target, lastEvent} = e;\r\n        if (lastEvent) {\r\n            const {width, height, drag: {translate}} = lastEvent;\r\n            updateLayout([\r\n                {\r\n                    id: target.id,\r\n                    width: width,\r\n                    height: height,\r\n                    type: target.dataset.type,\r\n                    position: [translate[0], translate[1]]\r\n                }\r\n            ], false)\r\n        }\r\n    }\r\n\r\n    onResizeGroupEnd = (e: any) => {\r\n        const {updateLayout} = designerStore;\r\n        let data: MovableItemType[] = [];\r\n        e.events.forEach((ev: any) => {\r\n            const {target, lastEvent} = ev;\r\n            if (lastEvent) {\r\n                const {drag: {translate}} = lastEvent;\r\n                data.push({\r\n                    id: target.id,\r\n                    width: target.offsetWidth,\r\n                    height: target.offsetHeight,\r\n                    type: target.dataset.type,\r\n                    position: [translate[0], translate[1]]\r\n                })\r\n            }\r\n        })\r\n        if (data.length > 0)\r\n            updateLayout(data, false);\r\n    }\r\n\r\n\r\n    render() {\r\n        const {readonly = false} = this.props;\r\n        const {selectorRef, targets} = eventOperateStore;\r\n        const {canvasConfig: {rasterize, dragStep, resizeStep}} = designerStore;\r\n        return (\r\n            <>\r\n                {this.props.children}\r\n                <Moveable ref={this.movableRef}\r\n                          target={targets}\r\n                          draggable={!readonly}\r\n                          resizable={!readonly}\r\n                          keepRatio={false}\r\n                          throttleDrag={rasterize ? dragStep : 0}\r\n                          throttleResize={rasterize ? resizeStep : 1}\r\n                          onClickGroup={e => {\r\n                              (selectorRef.current as any)?.clickTarget(e.inputEvent, e.inputTarget);\r\n                          }}\r\n                          onDrag={({target, beforeTranslate}) => {\r\n                              target.style.transform = `translate(${beforeTranslate[0]}px, ${beforeTranslate[1]}px)`;\r\n                          }}\r\n                          onDragEnd={this.onDragEnd}\r\n                          onDragGroup={e => {\r\n                              e.events.forEach(ev => {\r\n                                  ev.target.style.transform = ev.transform;\r\n                              });\r\n                          }}\r\n                          onDragGroupEnd={this.onDragGroupEnd}\r\n                          onResize={({target, width, height, drag}) => {\r\n                              target.style.width = `${width}px`;\r\n                              target.style.height = `${height}px`;\r\n                              target.style.transform = `translate(${drag.beforeTranslate[0]}px, ${drag.beforeTranslate[1]}px)`;\r\n                          }}\r\n                          onResizeEnd={this.onResizeEnd}\r\n                          onResizeGroupEnd={this.onResizeGroupEnd}\r\n                          onResizeGroup={({events}) => {\r\n                              events.forEach(ev => {\r\n                                  ev.target.style.width = `${ev.width}px`;\r\n                                  ev.target.style.height = `${ev.height}px`;\r\n                                  ev.target.style.transform = ev.drag.transform;\r\n                              })\r\n                          }}\r\n                />\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(GroupMovable);","import React, {Component} from 'react';\r\nimport Selecto from \"react-selecto\";\r\nimport eventOperateStore from \"../../designer/operate-provider/EventOperateStore\";\r\nimport {observer} from \"mobx-react\";\r\nimport Moveable from 'react-moveable';\r\n\r\nclass GroupSelectable extends Component {\r\n    selectorRef = React.createRef<Selecto>();\r\n\r\n    componentDidMount() {\r\n        const {setSelectorRef} = eventOperateStore;\r\n        setSelectorRef(this.selectorRef);\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <>\r\n                {this.props.children}\r\n                <Selecto ref={this.selectorRef}\r\n                         dragContainer={\".lc-event-container\"}\r\n                         selectableTargets={[\".lc-comp-item\"]}\r\n                         hitRate={0}\r\n                         selectByClick={true}\r\n                         selectFromInside={false}\r\n                         toggleContinueSelect={[\"ctrl\"]}\r\n                         ratio={0}\r\n                         onDragStart={e => {\r\n                             const {movableRef, targets} = eventOperateStore;\r\n                             const movable: Moveable = movableRef.current;\r\n                             const target = e.inputEvent.target;\r\n                             if ((movable.isMoveableElement(target))\r\n                                 || targets.some((t: any) => t === target || t.contains(target))\r\n                             ) {\r\n                                 e.stop();\r\n                             }\r\n                         }}\r\n                         onSelectEnd={e => {\r\n                             const {movableRef, setTargets, setTargetIds} = eventOperateStore;\r\n                             if (!movableRef) return;\r\n                             const movable: Moveable = movableRef.current;\r\n                             if (e.isDragStart) {\r\n                                 e.inputEvent.preventDefault();\r\n                                 setTimeout(() => {\r\n                                     movable.dragStart(e.inputEvent);\r\n                                 });\r\n                             }\r\n                             let selected = e.selected.filter((item: any) => {\r\n                                 return item.dataset.locked !== 'true';\r\n                             });\r\n                             if (e.inputEvent.target.className.indexOf('menu-item') === -1) {\r\n                                 let targetIds: string[] = [];\r\n                                 selected.forEach((item: any) => targetIds.push(item.id));\r\n                                 setTargetIds(targetIds);\r\n                             }\r\n                             setTargets(selected);\r\n                         }}\r\n                />\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(GroupSelectable);","import {action, makeObservable, observable} from \"mobx\";\r\n\r\n/**\r\n * 右键操作菜单的状态管理类。\r\n */\r\nclass ContextMenuStore {\r\n    constructor() {\r\n        makeObservable(this, {\r\n            visible: observable,\r\n            position: observable,\r\n            updateVisible: action,\r\n            setPosition: action,\r\n        })\r\n    }\r\n\r\n    /**\r\n     * 右键菜单显示状态\r\n     */\r\n    visible = false;\r\n    /**\r\n     * 右键菜单位置\r\n     */\r\n    position = [0, 0];\r\n    /**\r\n     * 鼠标按下时间，用于优化。 右键菜单的操作体验。由于长按右键是拖拽整个画布的操作。 在长时间按住右键后。\r\n     * 右键菜单也会显示。为了避免这种情况。 需要在鼠标抬起时。 判断鼠标按下到抬起的时间。如果时间小于200ms则不显示右键菜单。\r\n     */\r\n    mouseDownTime = 0;\r\n    /**\r\n     * 鼠标抬起时间\r\n     */\r\n    mouseUpTime = 0;\r\n\r\n    updateVisible = (visible: boolean) => this.visible = visible;\r\n\r\n    setPosition = (position: number[]) => this.position = position;\r\n\r\n    setMouseDownTime = (time: any) => this.mouseDownTime = time;\r\n\r\n    setMouseUpTime = (time: any) => this.mouseUpTime = time;\r\n\r\n}\r\n\r\nconst contextMenuStore = new ContextMenuStore();\r\nexport default contextMenuStore;","export default class RenderUtil {\r\n    private static prev: number = 0;\r\n\r\n    public static throttle(fn: Function, delay: number, callback?: Function) {\r\n\r\n        return function (...args: any) {\r\n            const now = Date.now();\r\n            if (now - RenderUtil.prev > delay) {\r\n                fn(...args);\r\n                RenderUtil.prev = now;\r\n            } else {\r\n                callback && callback(...args);\r\n            }\r\n        };\r\n    }\r\n}\r\n","export enum ClassifyEnum {\r\n    ALL = 'all',\r\n    BAR = 'bar',\r\n    COLUMN = 'column',\r\n    BASE = 'base',\r\n    LINE = 'line',\r\n    AREA = 'area',\r\n}\r\n","import {TriggerType} from \"./HotKey\";\r\nimport {doScale} from \"../scale/Scaler\";\r\nimport eventOperateStore from \"../EventOperateStore\";\r\nimport designerStore from \"../../store/DesignerStore\";\r\nimport {MovableItemType} from \"../../../lib/lc-movable/types\";\r\nimport rightStore from \"../../right/RightStore\";\r\nimport {SaveType} from \"../../DesignerType\";\r\nimport designerStarter from \"../../DesignerStarter\";\r\nimport RenderUtil from \"../../../utils/RenderUtil\";\r\nimport {message} from \"antd\";\r\nimport {cloneDeep} from \"lodash\";\r\n\r\n\r\nexport const selectAll = () => {\r\n    let comps = document.getElementsByClassName('lc-comp-item');\r\n    let compIds: string[] = [];\r\n    let compArr: any[] = [];\r\n    comps && Array.from(comps).forEach((comp: any) => {\r\n        if (comp.dataset.locked !== 'true') {\r\n            compArr.push(comp);\r\n            compIds.push(comp.id);\r\n        }\r\n    });\r\n    const {setTargets, setTargetIds} = eventOperateStore;\r\n    setTargets(compArr);\r\n    setTargetIds(compIds);\r\n}\r\n\r\nexport const doCopy = () => {\r\n    const {targetIds, setTargetIds, setTargets} = eventOperateStore;\r\n    if (!targetIds || targetIds.length === 0) return;\r\n    const {copyItem} = designerStore;\r\n    let newIds = copyItem(targetIds);\r\n    let targets: any = [];\r\n    //延迟10毫秒，等待dom元素渲染完毕后再获取。\r\n    setTimeout(() => {\r\n        for (const newId of newIds) {\r\n            targets.push(document.getElementById(newId));\r\n        }\r\n        targets.filter((item: any) => item !== null);\r\n        setTargets(targets);\r\n        setTargetIds(newIds);\r\n    }, 10);\r\n}\r\n\r\nexport const doLock = () => {\r\n    const {targetIds, setTargets} = eventOperateStore;\r\n    if (!targetIds || targetIds.length === 0) return;\r\n    const {updateLayout, layoutConfigs} = designerStore;\r\n    let toBeUpdate = [];\r\n    for (const targetId of targetIds) {\r\n        let item = layoutConfigs[targetId];\r\n        toBeUpdate.push({...item, locked: true})\r\n    }\r\n    updateLayout(toBeUpdate);\r\n    //操作完毕之后，清空已被选择的元素。\r\n    setTargets([]);\r\n}\r\n\r\nexport const toTop = () => {\r\n    let {maxLevel, setMaxLevel, targetIds, setTargetIds} = eventOperateStore;\r\n    if (!targetIds || targetIds.length === 0) return;\r\n    const {updateLayout, layoutConfigs} = designerStore;\r\n    let toBeUpdate: MovableItemType[] = [];\r\n    targetIds.forEach((id: string) => {\r\n        let item = layoutConfigs[id];\r\n        toBeUpdate.push({...item, order: ++maxLevel});\r\n    });\r\n    setMaxLevel(maxLevel)\r\n    setTargetIds([]);\r\n    updateLayout(toBeUpdate);\r\n}\r\n\r\nexport const toBottom = () => {\r\n    let {minLevel, setMinLevel, targetIds, setTargetIds} = eventOperateStore;\r\n    if (!targetIds || targetIds.length === 0) return;\r\n    const {updateLayout, layoutConfigs} = designerStore;\r\n    let toBeUpdate: MovableItemType[] = [];\r\n    targetIds.forEach((id: string) => {\r\n        let item = layoutConfigs[id];\r\n        toBeUpdate.push({...item, order: --minLevel});\r\n    });\r\n    setMinLevel(minLevel)\r\n    setTargetIds([]);\r\n    updateLayout(toBeUpdate);\r\n}\r\n\r\nexport const doDelete = () => {\r\n    const {targetIds, setTargetIds, setTargets} = eventOperateStore;\r\n    if (!targetIds || targetIds.length === 0) return;\r\n    // const {updateActive} = designerStore;\r\n    const {setContentVisible} = rightStore;\r\n    setContentVisible(false);\r\n    // updateActive && updateActive({\r\n    //     id: -1,\r\n    //     type: 'LcBg'\r\n    // });\r\n    targetIds.length > 0 && designerStore.delItem(targetIds);\r\n    setTargetIds([]);\r\n    setTargets([])\r\n}\r\n\r\nexport const doSave = () => {\r\n    RenderUtil.throttle(() => {\r\n        let {projectConfig: {saveType}} = designerStore;\r\n        if (saveType === SaveType.LOCAL) {\r\n            const {abstractOperatorMap} = designerStarter;\r\n            const {projectConfig: {saveType = SaveType.LOCAL}} = designerStore;\r\n            abstractOperatorMap[saveType].doCreateOrUpdate(cloneDeep(designerStore.getData()));\r\n        } else if (saveType === SaveType.SERVER) {\r\n            alert(\"server save\");\r\n        }\r\n    }, 5000, () => {\r\n        message.warn('保存过于频繁，请稍后再试！')\r\n    })();\r\n\r\n}\r\n\r\nexport const doUnLock = () => {\r\n    const {unLockedId} = eventOperateStore;\r\n    if (!unLockedId || unLockedId === '') return;\r\n    const {updateLayout, layoutConfigs} = designerStore;\r\n    let item = layoutConfigs[unLockedId];\r\n    updateLayout([{...item, locked: false}])\r\n}\r\n\r\nexport const doHide = () => {\r\n    const {targetIds} = eventOperateStore;\r\n    if (!targetIds || targetIds.length === 0) return;\r\n    const {updateLayout, layoutConfigs} = designerStore;\r\n    let toBeUpdate: MovableItemType[] = [];\r\n    targetIds.forEach((id: string) => {\r\n        let item = layoutConfigs[id];\r\n        toBeUpdate.push({...item, hide: true});\r\n    });\r\n    updateLayout(toBeUpdate)\r\n}\r\n\r\nexport const getOperateEventMapping: any = () => {\r\n    return {\r\n        'alt + wheel': {\r\n            handler: doScale,\r\n            triggerType: TriggerType.COILED,\r\n        },\r\n        'control + a': {\r\n            handler: selectAll,\r\n        },\r\n        'control + v': {\r\n            handler: doCopy,\r\n        },\r\n        'control + l': {\r\n            handler: doLock,\r\n        },\r\n        'control + arrowup': {\r\n            handler: toTop,\r\n        },\r\n        'control + arrowdown': {\r\n            handler: toBottom,\r\n        },\r\n        'control + s': {\r\n            handler: doSave,\r\n        },\r\n        'delete': {\r\n            handler: doDelete,\r\n        }\r\n    }\r\n}","import React, {Component} from 'react';\r\nimport {observer} from \"mobx-react\";\r\nimport contextMenuStore from \"./ContextMenuStore\";\r\nimport './OperateMenu.less';\r\nimport {\r\n    CopyOutlined,\r\n    DeleteOutlined,\r\n    EyeInvisibleOutlined,\r\n    LockOutlined,\r\n    VerticalAlignBottomOutlined,\r\n    VerticalAlignTopOutlined\r\n} from \"@ant-design/icons\";\r\nimport {doCopy, doDelete, doHide, doLock, doUnLock, toBottom, toTop} from \"../keyboard-mouse/HotKeyConfig\";\r\n\r\nclass ContextMenu extends Component {\r\n\r\n    menuList = [\r\n        {\r\n            name: '锁定',\r\n            icon: LockOutlined,\r\n            onClick: doLock,\r\n        },\r\n        {\r\n            name: '解锁',\r\n            icon: LockOutlined,\r\n            onClick: doUnLock,\r\n        },\r\n        {\r\n            name: '隐藏',\r\n            icon: EyeInvisibleOutlined,\r\n            onClick: doHide,\r\n        },\r\n        {\r\n            name: '复制',\r\n            icon: CopyOutlined,\r\n            onClick: doCopy,\r\n        },\r\n        {\r\n            name: '置顶',\r\n            icon: VerticalAlignTopOutlined,\r\n            onClick: toTop,\r\n        },\r\n        {\r\n            name: '置底',\r\n            icon: VerticalAlignBottomOutlined,\r\n            onClick: toBottom,\r\n        },\r\n        {\r\n            name: '删除',\r\n            icon: DeleteOutlined,\r\n            onClick: doDelete,\r\n        },\r\n    ]\r\n\r\n    render() {\r\n        const {visible, position = [0, 0]} = contextMenuStore;\r\n        let menuListDom = [];\r\n        for (let i = 0; i < this.menuList.length; i++) {\r\n            let menuItem = this.menuList[i];\r\n            let Icon = menuItem.icon;\r\n            menuListDom.push(\r\n                <div key={i + ''} className={'menu-item'} onClick={menuItem.onClick}>\r\n                    <label><Icon/></label>\r\n                    <span>{menuItem.name}</span>\r\n                </div>\r\n            )\r\n        }\r\n        return (\r\n            <>\r\n                {visible &&\r\n                <div className={'lc-right-menu'} style={{\r\n                    position: 'fixed',\r\n                    top: position[1],\r\n                    left: position[0]\r\n                }}>\r\n                    {menuListDom}\r\n                </div>}\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(ContextMenu);","import React, {MouseEvent, PureComponent} from 'react';\r\nimport DragScaleProvider from \"../operate-provider/DragScaleProvider\";\r\nimport {observer} from \"mobx-react\";\r\nimport designerStore, {DesignerStore} from \"../store/DesignerStore\";\r\nimport DesignerBackground from \"../../comps/lc/background/DesignerBackground\";\r\nimport rightStore from \"../right/RightStore\";\r\nimport DesignerRuler from \"../../lib/lc-ruler/DesignerRuler\";\r\nimport DesignerContainer from \"../operate-provider/DesignerContainer\";\r\nimport GroupMovable from \"../../lib/lc-movable/GroupMovable\";\r\nimport GroupSelectable from \"../../lib/lc-movable/GroupSelectable\";\r\nimport LcRightMenu from \"../operate-provider/right-click-menu/ContextMenu\";\r\nimport {MovableItemType} from \"../../lib/lc-movable/types\";\r\nimport HotKey from \"../operate-provider/keyboard-mouse/HotKey\";\r\nimport {getOperateEventMapping} from \"../operate-provider/keyboard-mouse/HotKeyConfig\";\r\nimport ComponentContainer from \"../../framework/core/ComponentContainer\";\r\nimport Loading from \"../../lib/loading/Loading\";\r\nimport {isEqual} from \"lodash\";\r\n\r\n/**\r\n * 设计器画布\r\n */\r\nclass DesignerCanvas extends PureComponent<DesignerStore | any> {\r\n\r\n    backgroundRef: DesignerBackground | null = null;\r\n\r\n    state = {\r\n        designerRef: null\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.setState({designerRef: document.querySelector('.lc-ruler-content')});\r\n    }\r\n\r\n    updateActive = (e: MouseEvent<HTMLDivElement>) => {\r\n        let {id, dataset: {type}} = e.target as HTMLDivElement;\r\n        const {activeConfig, activeElem} = rightStore;\r\n        if (isEqual(activeElem, {id, type})) return;\r\n        activeConfig(id, type!);\r\n    }\r\n\r\n    /**\r\n     * 元素生成\r\n     */\r\n    generateElement = () => {\r\n        let {layoutConfigs} = designerStore!;\r\n        const sortLayout = Object.values(layoutConfigs).sort((a: MovableItemType, b: MovableItemType) => a.order! - b.order!);\r\n        return sortLayout.map((item: MovableItemType) => {\r\n            return <ComponentContainer layout={item} key={item.id}/>\r\n        });\r\n    }\r\n\r\n    render() {\r\n        console.log('render')\r\n        const {loaded} = designerStore;\r\n        if (!loaded)\r\n            return <Loading/>;\r\n        return (\r\n            <>\r\n                <DesignerContainer>\r\n                    <GroupSelectable>\r\n                        <DesignerRuler offsetX={60} offsetY={50}>\r\n                            <DragScaleProvider>\r\n                                <GroupMovable>\r\n                                    <DesignerBackground onClick={this.updateActive}\r\n                                                        ref={ref => this.backgroundRef = ref}>\r\n                                        {this.generateElement()}\r\n                                    </DesignerBackground>\r\n                                </GroupMovable>\r\n                            </DragScaleProvider>\r\n                            <LcRightMenu/>\r\n                        </DesignerRuler>\r\n                    </GroupSelectable>\r\n                </DesignerContainer>\r\n                <HotKey handlerMapping={getOperateEventMapping()}/>\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(DesignerCanvas);\r\n\r\n","import React, {Component, ReactElement, Suspense} from 'react';\r\nimport './DesignerHeader.less';\r\nimport headerStore from \"./HeaderStore\";\r\nimport CanvasHdConfigImpl from \"./items/canvas/CanvasHdConfigImpl\";\r\nimport {observer} from \"mobx-react\";\r\nimport designerStarter from \"../DesignerStarter\";\r\nimport Loading from \"../../lib/loading/Loading\";\r\n\r\nconst ProjectHdItemImpl = React.lazy(() => import('./items/project/ProjectHdItemImpl'));\r\nconst ThemeHdItemImpl = React.lazy(() => import('./items/theme/ThemeHdItemImpl'));\r\n\r\nclass Header extends Component<any> {\r\n\r\n    buildHeaderList = (): Array<ReactElement> => {\r\n        const {headerItemInstances} = designerStarter;\r\n        let items: Array<ReactElement> = [];\r\n        for (let i = 0; i < headerItemInstances.length; i++) {\r\n            const {icon: Icon, name, onClick} = headerItemInstances[i];\r\n            items.push(\r\n                <div key={i + ''} className={'right-item'} onClick={onClick}>\r\n                    <span className={'item-span'}><Icon/>&nbsp;{name}</span>\r\n                </div>\r\n            );\r\n        }\r\n        return items;\r\n    }\r\n\r\n    render() {\r\n        const {canvasVisible, projectVisible, themeVisible} = headerStore;\r\n        const items = this.buildHeaderList();\r\n        return (\r\n            <div className={'designer-header'}>\r\n                <div className={'header-left'}>\r\n                    <div className={'header-title'}>L C</div>\r\n                </div>\r\n                <div className={'header-right'}>\r\n                    {items}\r\n                </div>\r\n                {/*todo 想办法让这两个组件不要在这里写死*/}\r\n                {canvasVisible && <Suspense fallback={<Loading/>}><CanvasHdConfigImpl/> </Suspense>}\r\n                {projectVisible && <Suspense fallback={<Loading/>}><ProjectHdItemImpl/></Suspense>}\r\n                {themeVisible && <Suspense fallback={<Loading/>}><ThemeHdItemImpl/></Suspense>}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(Header);\r\n","import React, {Component} from 'react';\r\n\r\nclass LcHeader extends Component {\r\n    render() {\r\n        return (\r\n            <div className={'structure-header'}>{this.props.children}</div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default LcHeader;","import React, {Component} from 'react';\r\n\r\nclass LcBody extends Component {\r\n    render() {\r\n        return (\r\n            <div className={'structure-body'}>{this.props.children}</div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default LcBody;","import React, {Component} from 'react';\r\n\r\nclass LcLeft extends Component {\r\n    render() {\r\n        return (\r\n            <div className={'structure-body-left'}>{this.props.children}</div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default LcLeft;","import React, {Component} from 'react';\r\n\r\nclass LcContent extends Component {\r\n    render() {\r\n        return (\r\n            <div id={'structureContent'} className={'structure-body-content'}>{this.props.children}</div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default LcContent;","import React, {Component} from 'react';\r\n\r\nclass LcRight extends Component {\r\n    render() {\r\n        return (\r\n            <div className={'structure-body-right'}>{this.props.children}</div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default LcRight;","import React, {Component} from 'react';\r\nimport './structure.less';\r\n\r\nclass LcStructure extends Component {\r\n    render() {\r\n        return (\r\n            <div className={'lc-designer-structure'}>{this.props.children}</div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default LcStructure;","import React, {Component} from 'react';\r\n\r\nclass LcFoot extends Component {\r\n    render() {\r\n        return (\r\n            <div className={'structure-foot'}>{this.props.children}</div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default LcFoot;","export default __webpack_public_path__ + \"static/media/icon-all.fe79e4fd.svg\";","export default __webpack_public_path__ + \"static/media/icon-bar.dfbc87b2.svg\";","export default __webpack_public_path__ + \"static/media/icon-column.ae79292f.svg\";","export default __webpack_public_path__ + \"static/media/icon-area.f3992c44.svg\";","export default __webpack_public_path__ + \"static/media/icon-pie.4d05a7b6.svg\";","export default __webpack_public_path__ + \"static/media/icon-scatter.778bce01.svg\";","export default __webpack_public_path__ + \"static/media/icon-histogram.7afbcca1.svg\";","export default __webpack_public_path__ + \"static/media/icon-line.b79af542.svg\";","export default __webpack_public_path__ + \"static/media/icon-loading.9d197f5f.svg\";","export default __webpack_public_path__ + \"static/media/icon-flowers.442a19b5.svg\";","export default __webpack_public_path__ + \"static/media/icon-radar.c8f4b906.svg\";","export default __webpack_public_path__ + \"static/media/icon-ring.9d197f5f.svg\";","export default __webpack_public_path__ + \"static/media/icon-wordcloud.fe36ef61.svg\";","export default __webpack_public_path__ + \"static/media/icon-sun.57eb8ea8.svg\";","export default __webpack_public_path__ + \"static/media/icon-rectangle.996c1059.svg\";","export default __webpack_public_path__ + \"static/media/icon-optimize.9b17ea95.svg\";","export default __webpack_public_path__ + \"static/media/icon-points.7fb541f7.svg\";","import {makeAutoObservable} from \"mobx\";\r\nimport {ClassifyEnum} from \"./ClassifyType\";\r\nimport icon_all from '../../../icon/icon-all.svg';\r\nimport icon_bar from '../../../icon/icon-bar.svg';\r\nimport icon_column from '../../../icon/icon-column.svg';\r\nimport icon_area from '../../../icon/icon-area.svg';\r\nimport icon_pie from '../../../icon/icon-pie.svg';\r\nimport icon_scatter from '../../../icon/icon-scatter.svg';\r\nimport icon_histogram from '../../../icon/icon-histogram.svg';\r\nimport icon_line from '../../../icon/icon-line.svg';\r\nimport icon_loading from '../../../icon/icon-loading.svg';\r\nimport icon_flowers from '../../../icon/icon-flowers.svg';\r\nimport icon_radar from '../../../icon/icon-radar.svg';\r\nimport icon_ring from '../../../icon/icon-ring.svg';\r\nimport icon_word_cloud from '../../../icon/icon-wordcloud.svg';\r\nimport icon_sun from '../../../icon/icon-sun.svg';\r\nimport icon_rectangle from '../../../icon/icon-rectangle.svg';\r\nimport icon_optimize from '../../../icon/icon-optimize.svg';\r\nimport icon_points from '../../../icon/icon-points.svg';\r\n\r\nconst getClassifyItemInfo = () => {\r\n    return [\r\n        {\r\n            icon: icon_all,\r\n            name: \"全部\",\r\n            classify: ClassifyEnum.ALL,\r\n        },\r\n        {\r\n            icon: icon_points,\r\n            name: \"基础\",\r\n            classify: ClassifyEnum.BASE,\r\n        },\r\n        {\r\n            icon: icon_optimize,\r\n            name: \"装饰\",\r\n            classify: ClassifyEnum.ALL,\r\n        },\r\n        {\r\n            icon: icon_bar,\r\n            name: \"条形图\",\r\n            classify: ClassifyEnum.BAR,\r\n        },\r\n        {\r\n            icon: icon_column,\r\n            name: \"柱状图\",\r\n            classify: ClassifyEnum.COLUMN,\r\n        },\r\n        {\r\n            icon: icon_line,\r\n            name: \"折线图\",\r\n            classify: ClassifyEnum.LINE,\r\n        },\r\n        {\r\n            icon: icon_area,\r\n            name: \"面积图\",\r\n            classify: ClassifyEnum.AREA,\r\n        },\r\n        {\r\n            icon: icon_pie,\r\n            name: \"饼图\",\r\n            classify: ClassifyEnum.BAR,\r\n        },\r\n        {\r\n            icon: icon_loading,\r\n            name: \"进度图\",\r\n            classify: ClassifyEnum.BAR,\r\n        },\r\n        {\r\n            icon: icon_scatter,\r\n            name: \"散点图\",\r\n            classify: ClassifyEnum.BAR,\r\n        },\r\n        {\r\n            icon: icon_flowers,\r\n            name: \"玫瑰图\",\r\n            classify: ClassifyEnum.BAR,\r\n        },\r\n        {\r\n            icon: icon_radar,\r\n            name: \"雷达图\",\r\n            classify: ClassifyEnum.BAR,\r\n        },\r\n        {\r\n            icon: icon_word_cloud,\r\n            name: \"词云图\",\r\n            classify: ClassifyEnum.BAR,\r\n        },\r\n        {\r\n            icon: icon_ring,\r\n            name: \"玉珏图\",\r\n            classify: ClassifyEnum.BAR,\r\n        },\r\n        {\r\n            icon: icon_histogram,\r\n            name: \"直方图\",\r\n            classify: ClassifyEnum.BAR,\r\n        },\r\n        {\r\n            icon: icon_sun,\r\n            name: \"旭日图\",\r\n            classify: ClassifyEnum.BAR,\r\n        },\r\n        {\r\n            icon: icon_rectangle,\r\n            name: \"矩形树图\",\r\n            classify: ClassifyEnum.BAR,\r\n        },\r\n    ]\r\n}\r\n\r\n/**\r\n * 左侧分类列表store\r\n */\r\nclass ClassifyListStore {\r\n    constructor() {\r\n        makeAutoObservable(this);\r\n    }\r\n\r\n    /**\r\n     * 分类列表\r\n     */\r\n    classifies: Array<any> = [];\r\n    /**\r\n     * 分类搜索关键字\r\n     */\r\n    classifyKey: string = 'all';\r\n\r\n    /**\r\n     * 初始化\r\n     */\r\n    doInit = () => {\r\n        this.classifies = getClassifyItemInfo();\r\n    }\r\n\r\n    /**\r\n     * 清空store\r\n     */\r\n    doClear = () => {\r\n        this.classifies = [];\r\n    }\r\n\r\n    setClassifyKey = (key: string) => {\r\n        this.classifyKey = key;\r\n    }\r\n}\r\n\r\nconst classifyListStore = new ClassifyListStore();\r\nexport default classifyListStore;","import {action, makeObservable, observable} from \"mobx\";\r\nimport designerStarter from \"../../DesignerStarter\";\r\nimport {BaseInfoType} from \"../../DesignerType\";\r\n\r\n/**\r\n * 设计器左侧列表组件的状态管理类。\r\n */\r\nclass CompListStore {\r\n    constructor() {\r\n        makeObservable(this, {\r\n            compKey: observable,\r\n            visible: observable,\r\n            setVisible: action,\r\n            setCompKey: action,\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 组件基础信息数组。设计器左侧组件列表的展示过滤依赖于此数组。\r\n     * 该数组会在设计器加载时进行初始化，后续不再修改。若其他。 场景或组件需要。 操作该数组的数据。 应该操作他的备份。 而不是直接操作该数组。\r\n     */\r\n    compInfoArr: Array<BaseInfoType> = [];\r\n    /**\r\n     * 组件搜索关键字，左侧组件列表根据关键字过滤与组件，使会用到该属性。\r\n     */\r\n    compKey: string = '';\r\n    /**\r\n     * 组件列表可见性。\r\n     */\r\n    visible: boolean = false;\r\n\r\n    doInit = () => {\r\n        const comps: Array<any> = [];\r\n        const {customComponentInfoMap}: any = designerStarter;\r\n        if (customComponentInfoMap) {\r\n            Object.keys(customComponentInfoMap).forEach(key => {\r\n                let baseInfo = customComponentInfoMap[key].getBaseInfo();\r\n                if (baseInfo.compKey !== 'LcBg') comps.push(baseInfo);\r\n            });\r\n        }\r\n        this.compInfoArr = comps;\r\n    }\r\n\r\n    setVisible = (visible: boolean) => this.visible = visible;\r\n\r\n    setCompKey = (key: string) => this.compKey = key;\r\n}\r\n\r\nconst compListStore = new CompListStore();\r\nexport default compListStore;","import React, {Component, MouseEvent} from 'react';\r\nimport {observer} from \"mobx-react\";\r\nimport '../classify-list/ClassifyList.less';\r\nimport classifyListStore from \"./ClassifyListStore\";\r\nimport compListStore from \"../../float-configs/comp-list/CompListStore\";\r\n\r\nclass ClassifyList extends Component {\r\n\r\n    constructor(props: {}) {\r\n        super(props);\r\n        const {doInit} = classifyListStore;\r\n        doInit && doInit();\r\n    }\r\n\r\n    changeClassifyKey = (e: MouseEvent<HTMLDivElement>) => {\r\n        const {setClassifyKey} = classifyListStore;\r\n        const {setVisible, visible} = compListStore;\r\n        setClassifyKey(e.currentTarget.id);\r\n        if (!visible)\r\n            setVisible && setVisible(true);\r\n    }\r\n\r\n    buildClassifyList = () => {\r\n        const {classifies} = classifyListStore;\r\n        let classifyArr = [];\r\n        for (let i = 0; i < classifies.length; i++) {\r\n            const {icon: Icon, name, classify} = classifies[i];\r\n            classifyArr.push(\r\n                <div key={i + ''} className={'sort-item'} id={classify} onClick={this.changeClassifyKey}>\r\n                    <div className={'sort-item-icon'}><img style={{width: 20}} src={Icon} alt={'all'}/></div>\r\n                    <span className={'sort-item-content'}>{name}</span>\r\n                </div>\r\n            )\r\n        }\r\n        return classifyArr;\r\n    }\r\n\r\n    render() {\r\n        const classifyListDom = this.buildClassifyList();\r\n        return (\r\n            <div className={'lc-charts-sort'} style={{overflowY: 'scroll'}}>\r\n                {classifyListDom}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(ClassifyList);","import React, {Component} from 'react';\r\nimport ClassifyList from \"./classify-list/ClassifyList\";\r\nimport {observer} from \"mobx-react\";\r\n\r\nclass DesignerLeft extends Component {\r\n\r\n    render() {\r\n        return (\r\n            <ClassifyList/>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(DesignerLeft);","import React, {Component} from 'react';\r\nimport './MenuList.less';\r\nimport {MenuInfo} from \"./MenuType\";\r\nimport rightStore from \"./RightStore\";\r\nimport {observer} from \"mobx-react\";\r\n\r\ninterface LcConfigMenusProps {\r\n    onChange?: (menu: string) => void;\r\n}\r\n\r\nclass MenuList extends Component<LcConfigMenusProps | any> {\r\n\r\n    menuChange = (e: any) => {\r\n        const {setActiveMenu, setContentVisible} = rightStore;\r\n        setActiveMenu && setActiveMenu(e.currentTarget.id);\r\n        setContentVisible && setContentVisible(true);\r\n    }\r\n\r\n    buildMenuList = () => {\r\n        const {menus} = rightStore;\r\n        return menus.map((item: MenuInfo) => {\r\n            const Icon: any = item.icon;\r\n            return (\r\n                <div className={'menu-item'} key={item.key} id={item.key} onClick={this.menuChange}>\r\n                    <div className={'item-icon'}><Icon/></div>\r\n                    <div className={'item-content'}>{item.name}</div>\r\n                </div>\r\n            );\r\n        });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className={'lc-config-menu'}>\r\n                <div className={'menu-list'}>\r\n                    {this.buildMenuList()}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(MenuList);","import React, {Component, Suspense} from 'react';\r\nimport {LineOutlined} from \"@ant-design/icons\";\r\nimport rightStore from \"./RightStore\";\r\nimport designerStarter from \"../DesignerStarter\";\r\nimport {observer} from \"mobx-react\";\r\nimport './ConfigContent.less';\r\nimport Loading from \"../../lib/loading/Loading\";\r\nimport designerStore from \"../store/DesignerStore\";\r\nimport {AbstractCustomComponentDefinition} from \"../../framework/core/AbstractCustomComponentDefinition\";\r\nimport {ConfigType} from \"./ConfigType\";\r\n\r\nclass ConfigContent extends Component {\r\n\r\n    buildConfigContent = () => {\r\n        const {compInstances} = designerStore;\r\n        let {activeMenu, activeElem} = rightStore;\r\n        let {customComponentInfoMap} = designerStarter;\r\n        let abstractConfigObj: AbstractCustomComponentDefinition = customComponentInfoMap[activeElem.type + '']\r\n        let configMapping = abstractConfigObj.getMenuToConfigContentMap();\r\n        const ConfigComp: React.ComponentType<ConfigType> = configMapping![activeMenu];\r\n        const instance = compInstances[activeElem.id + ''];\r\n        return (\r\n            <Suspense fallback={<Loading/>}>\r\n                <ConfigComp instance={instance}/>\r\n            </Suspense>\r\n        )\r\n\r\n    }\r\n\r\n    onClose = () => {\r\n        const {setContentVisible} = rightStore;\r\n        setContentVisible && setContentVisible(false);\r\n    }\r\n\r\n    render() {\r\n        const {activeMenu, menus} = rightStore;\r\n        let activeMenuName = '';\r\n        for (let i = 0; i < menus.length; i++) {\r\n            if (menus[i].key === activeMenu) {\r\n                activeMenuName = menus[i].name;\r\n                break;\r\n            }\r\n        }\r\n        return (\r\n            <div className={'lc-config-panel'}>\r\n                <div className={'lc-panel-top'}>\r\n                    <div className={'panel-title'}>\r\n                        <span>{activeMenuName}</span></div>\r\n                    <div className={'panel-operate'} onClick={this.onClose}><LineOutlined/></div>\r\n                </div>\r\n                <div className={'lc-panel-content'}>\r\n                    {this.buildConfigContent()}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(ConfigContent);","import React, {Component} from 'react';\r\nimport MenuList from \"./MenuList\";\r\nimport ConfigContent from \"./ConfigContent\";\r\nimport rightStore from \"./RightStore\";\r\nimport {observer} from \"mobx-react\";\r\n\r\nclass Right extends Component {\r\n\r\n    render() {\r\n        const {visible} = rightStore;\r\n        return (\r\n            <>\r\n                <MenuList/>\r\n                {visible && <ConfigContent/>}\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(Right);","import React, {Component} from 'react';\r\nimport './HotKeyDes.less';\r\n\r\nclass HotKeyDes extends Component {\r\n    render() {\r\n        return (\r\n            <div className={'lc-hotkey-des'} style={{color: 'white'}}>\r\n                <div className={'hotkey-des-item'}>\r\n                    <div className={'hotkey-content'}><code>Ctrl + S</code></div>\r\n                    <div className={'hotkey-des'}>保存项目</div>\r\n                </div>\r\n                <div className={'hotkey-des-item'}>\r\n                    <div className={'hotkey-content'}><code>Ctrl + V</code></div>\r\n                    <div className={'hotkey-des'}>复制元素</div>\r\n                </div>\r\n                <div className={'hotkey-des-item'}>\r\n                    <div className={'hotkey-content'}><code>Ctrl + L</code></div>\r\n                    <div className={'hotkey-des'}>锁定元素</div>\r\n                </div>\r\n                <div className={'hotkey-des-item'}>\r\n                    <div className={'hotkey-content'}><code>Ctrl + up-arrow(方向上键)</code></div>\r\n                    <div className={'hotkey-des'}>元素置顶</div>\r\n                </div>\r\n                <div className={'hotkey-des-item'}>\r\n                    <div className={'hotkey-content'}><code>Ctrl + down-arrow(方向下键)</code></div>\r\n                    <div className={'hotkey-des'}>元素置底</div>\r\n                </div>\r\n                <div className={'hotkey-des-item'}>\r\n                    <div className={'hotkey-content'}><code>Delete</code></div>\r\n                    <div className={'hotkey-des'}>删除元素</div>\r\n                </div>\r\n                <div className={'hotkey-des-item'}>\r\n                    <div className={'hotkey-content'}><code>Alt + wheel(鼠标滑轮)</code></div>\r\n                    <div className={'hotkey-des'}>缩放画布</div>\r\n                </div>\r\n                <div className={'hotkey-des-item'}>\r\n                    <div className={'hotkey-content'}><code>长按鼠标右键</code></div>\r\n                    <div className={'hotkey-des'}>拖拽画布</div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default HotKeyDes;","export default __webpack_public_path__ + \"static/media/keyboard-icon.1ed11794.svg\";","export default __webpack_public_path__ + \"static/media/layers-icon.aabb7495.svg\";","import React, {Component} from 'react';\r\nimport './DesignerFooter.less';\r\nimport eventOperateStore from \"../operate-provider/EventOperateStore\";\r\nimport {observer} from \"mobx-react\";\r\nimport designerStore from \"../store/DesignerStore\";\r\nimport Dialog from \"../../lib/lc-dialog/Dialog\";\r\nimport HotKeyDes from \"./HotKeyDes\";\r\nimport layerListStore from \"../float-configs/layer-list/LayerListStore\";\r\nimport keyboardIcon from './keyboard-icon.svg';\r\nimport layerIcon from './layers-icon.svg';\r\n\r\nclass DesignerFooter extends Component {\r\n\r\n    state = {\r\n        showHotKeyDes: false\r\n    }\r\n\r\n    toggleHotKeyDes = () => {\r\n        const {showHotKeyDes} = this.state;\r\n        this.setState({\r\n            showHotKeyDes: !showHotKeyDes\r\n        })\r\n    }\r\n\r\n    toggleLayerList = () => {\r\n        const {setVisible, visible} = layerListStore;\r\n        setVisible && setVisible(!visible);\r\n    }\r\n\r\n    render() {\r\n        const {scale} = eventOperateStore;\r\n        const {layoutConfigs, projectConfig: {name, state}} = designerStore;\r\n        let stateStr = '';\r\n        switch (state) {\r\n            case '0':\r\n                stateStr = '草稿';\r\n                break;\r\n            case '1':\r\n                stateStr = '发布';\r\n                break;\r\n            case '2':\r\n                stateStr = '封存';\r\n                break;\r\n        }\r\n        return (\r\n            <div className={'lc-designer-footer'}>\r\n                <div className={'footer-left'}>\r\n                    <div className={'footer-item'} onClick={this.toggleHotKeyDes}>\r\n                        <img width={16} alt={'快捷键'}\r\n                             src={keyboardIcon}/>\r\n                        &nbsp;\r\n                        <span style={{position: 'relative', top: 2}}>快捷键</span>\r\n                    </div>\r\n                    <div className={'footer-item'} onClick={this.toggleLayerList}>\r\n                        <img width={16} alt={'图层'} src={layerIcon}/>\r\n                        &nbsp;\r\n                        <span style={{position: 'relative', top: 2}}>图层</span>\r\n                    </div>\r\n                </div>\r\n                <div className={'footer-right'}>\r\n                    <div className={'right-info-item'}>缩放 : {(scale * 100).toFixed(0)}%</div>\r\n                    <div className={'right-info-item'}>当前组件数 : {Object.keys(layoutConfigs).length}</div>\r\n                    <div className={'right-info-item'}>项目 : {name}</div>\r\n                    <div className={'right-info-item'}>状态 : {stateStr}</div>\r\n                </div>\r\n                <Dialog title={'快捷键说明'} visible={this.state.showHotKeyDes} onClose={this.toggleHotKeyDes}>\r\n                    <HotKeyDes/>\r\n                </Dialog>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(DesignerFooter);","import AbstractDrag from \"./AbstractDrag\";\r\n\r\nexport interface DragCoordinate {\r\n    x: number,\r\n    y: number\r\n}\r\n\r\nexport default class CommonDragger extends AbstractDrag {\r\n\r\n    protected position: { x: number, y: number } = {x: 0, y: 0}; // 第一个点坐标\r\n\r\n    constructor(target: any, dragTarget: any, initPos?: DragCoordinate) {\r\n        super();\r\n        this.target = target;\r\n        this.dragTarget = dragTarget;\r\n        this.registerDragger();\r\n        if (initPos) this.position = initPos;\r\n    }\r\n\r\n    protected onDragEnd = (): void => {\r\n        this.dragTarget.addEventListener('pointerup', (e: any) => {\r\n            if (e.button === 0) {\r\n                this.dragTarget.releasePointerCapture(e.pointerId);\r\n                this.dragTarget.removeEventListener('pointermove', this.onDragMove);\r\n            }\r\n        });\r\n    }\r\n\r\n    protected onDragMove = (e: any): void => {\r\n        this.position.x += e.movementX;\r\n        this.position.y += e.movementY;\r\n        this.target.style.transform = 'translate(' + this.position.x + 'px, ' + this.position.y + 'px)';\r\n    }\r\n\r\n    protected onDragStart = (): void => {\r\n        this.dragTarget.addEventListener('pointerdown', (e: any) => {\r\n            if (e.button === 0) {\r\n                this.dragTarget.setPointerCapture(e.pointerId);\r\n                this.dragTarget.addEventListener('pointermove', this.onDragMove);\r\n            }\r\n        });\r\n    }\r\n\r\n}","import React, {Component} from 'react';\r\nimport {LineOutlined} from \"@ant-design/icons\";\r\nimport CommonDragger from \"../../operate-provider/drag/CommonDragger\";\r\nimport './FloatPanel.less';\r\n\r\nexport interface FloatPanelProps {\r\n    title?: string;\r\n    initPosition?: { x: number, y: number };\r\n    width?: number;\r\n    height?: number;\r\n    onClose?: () => void;\r\n    className?: string;\r\n}\r\n\r\n/**\r\n * 浮动面板容器，提供浮动面板的拖拽功能\r\n */\r\nclass FloatPanel extends Component<FloatPanelProps> {\r\n\r\n    panelRef: any = null;\r\n    dragTargetRef: any = null;\r\n\r\n    componentDidMount() {\r\n        const {initPosition = {x: 0, y: 0}} = this.props;\r\n        if (this.dragTargetRef && this.panelRef)\r\n            new CommonDragger(this.panelRef, this.dragTargetRef, initPosition);\r\n    }\r\n\r\n    onClose = () => {\r\n        const {onClose} = this.props;\r\n        onClose && onClose();\r\n    }\r\n\r\n    render() {\r\n        const {initPosition = {x: 0, y: 0}, title, className} = this.props;\r\n        return (\r\n            <div className={`float-panel ${className}`}\r\n                 style={{transform: `translate(${initPosition.x}px, ${initPosition.y}px)`}}\r\n                 ref={ref => this.panelRef = ref}>\r\n                <div className={'panel-title'}>\r\n                    <div className={'title-left'}>{title}</div>\r\n                    <div ref={ref => this.dragTargetRef = ref} className={'title-drag-target'}\r\n                         style={{width: '50%', height: '100%'}}>\r\n                    </div>\r\n                    <div className={'title-right'} onClick={this.onClose}><span><LineOutlined/></span></div>\r\n                </div>\r\n                {this.props.children}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default FloatPanel;","import React, {Component} from 'react';\r\nimport {Input} from \"antd\";\r\nimport compListStore from \"./CompListStore\";\r\nimport classifyListStore from \"../../left/classify-list/ClassifyListStore\";\r\nimport './CompList.less';\r\nimport {observer} from \"mobx-react\";\r\nimport designerStarter from \"../../DesignerStarter\";\r\nimport designerStore from \"../../store/DesignerStore\";\r\nimport {idGenerate} from \"../../../utils/IdGenerate\";\r\nimport {MovableItemType} from \"../../../lib/lc-movable/types\";\r\nimport eventOperateStore from \"../../operate-provider/EventOperateStore\";\r\nimport FloatPanel from \"../common/FloatPanel\";\r\nimport {BaseInfoType} from \"../../DesignerType\";\r\n\r\nclass CompList extends Component {\r\n\r\n    constructor(props: any) {\r\n        super(props);\r\n        const {doInit} = compListStore;\r\n        doInit && doInit();\r\n    }\r\n\r\n    addItem = (compKey: string, name: string) => {\r\n        const {addItem} = designerStore;\r\n        let {maxLevel, setMaxLevel} = eventOperateStore;\r\n        let movableItem: MovableItemType = {\r\n            name: name,\r\n            type: compKey,\r\n            width: 384,\r\n            height: 216,\r\n            position: [0, 0],\r\n            id: idGenerate.generateId() + '',\r\n            locked: false,\r\n            hide: false,\r\n            order: ++maxLevel,\r\n        }\r\n        setMaxLevel && setMaxLevel(maxLevel);\r\n        addItem && addItem(movableItem);\r\n    }\r\n\r\n    getChartDom = () => {\r\n        let chartDom = [];\r\n        let {classifyKey} = classifyListStore\r\n        let {compInfoArr, compKey} = compListStore;\r\n        if (classifyKey !== 'all') {\r\n            compInfoArr = compInfoArr.filter((item: BaseInfoType) => {\r\n                return item.typeKey === classifyKey;\r\n            })\r\n        }\r\n        if (compKey !== '') {\r\n            compInfoArr = compInfoArr.filter((item: BaseInfoType) => {\r\n                return item.compName.indexOf(compKey) >= 0;\r\n            })\r\n        }\r\n        for (let i = 0; i < compInfoArr.length; i++) {\r\n            let compInfo: any = compInfoArr[i];\r\n            const {compName, compKey} = compInfo;\r\n            const {customComponentInfoMap} = designerStarter;\r\n            let lcCompInit: any = customComponentInfoMap[compKey];\r\n            let chartImg = lcCompInit.getChartImg();\r\n            chartDom.push(\r\n                <div key={i + ''} className={'list-item droppable-element'}>\r\n                    <div className={'item-header'} ref={'drag-target'}>\r\n                        <div className={'item-name'}>{compName}</div>\r\n                        <div className={'item-type'}>Antd</div>\r\n                    </div>\r\n                    <div className={'item-content'} onDoubleClick={() => this.addItem(compKey, compName)}>\r\n                        <div className={'item-img'} style={{backgroundImage: `url(${chartImg})`}}/>\r\n                    </div>\r\n                </div>\r\n            )\r\n        }\r\n        return chartDom;\r\n    }\r\n\r\n    onClose = () => {\r\n        const {setVisible} = compListStore;\r\n        setVisible && setVisible(false);\r\n    }\r\n\r\n    searchChart = (e: any) => {\r\n        const {setCompKey} = compListStore;\r\n        setCompKey && setCompKey(e.currentTarget.value);\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <FloatPanel className={'comp-list'} title={'组件列表'} onClose={this.onClose}\r\n                        initPosition={{x: 60, y: -window.innerHeight + 50}}>\r\n                <div className={'list-search'}>\r\n                    <Input placeholder=\"搜索组件\" onPressEnter={this.searchChart}\r\n                           style={{width: '100%'}}/>\r\n                </div>\r\n                <div className={'list-items'}>\r\n                    {this.getChartDom()}\r\n                </div>\r\n            </FloatPanel>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(CompList);","export default __webpack_public_path__ + \"static/media/lock.11cf90eb.svg\";","export default __webpack_public_path__ + \"static/media/preview-close.40634e66.svg\";","export default __webpack_public_path__ + \"static/media/preview-open.fe6af5a2.svg\";","export default __webpack_public_path__ + \"static/media/unlock.a58cef96.svg\";","import React, {MouseEvent} from 'react';\r\nimport './LayerItem.less';\r\nimport lockImg from './icon/lock.svg';\r\nimport previewClose from './icon/preview-close.svg';\r\nimport previewOpen from './icon/preview-open.svg';\r\nimport unlockImg from './icon/unlock.svg';\r\nimport layerListStore from \"./LayerListStore\";\r\n\r\nexport interface LayerItemDataProps {\r\n    compId?: string;\r\n    name?: string;\r\n    lock?: boolean;\r\n    hide?: boolean;\r\n    selected?: boolean;\r\n}\r\n\r\nclass LayerItem extends React.PureComponent<LayerItemDataProps> {\r\n\r\n    state = {\r\n        selected: false,\r\n        lock: false,\r\n        hide: false,\r\n        compId: '',\r\n        name: ''\r\n    }\r\n\r\n    constructor(props: LayerItemDataProps) {\r\n        super(props);\r\n        const {selected, lock, hide, compId, name} = props;\r\n        this.state = {\r\n            selected: selected || false,\r\n            lock: lock || false,\r\n            hide: hide || false,\r\n            compId: compId || '',\r\n            name: name || ''\r\n        }\r\n    }\r\n\r\n    toggleLock = () => {\r\n        const {lockChange} = layerListStore;\r\n        lockChange && lockChange(this.state.compId, !this.state.lock);\r\n    }\r\n\r\n    toggleHide = () => {\r\n        const {hideChange} = layerListStore;\r\n        hideChange && hideChange(this.state.compId, !this.state.hide);\r\n    }\r\n\r\n    onSelected = (event: MouseEvent<HTMLDivElement>) => {\r\n        const {selectedChange} = layerListStore;\r\n        selectedChange && selectedChange({...this.state, ...{selected: true}}, event);\r\n    }\r\n\r\n    render() {\r\n        const {name, lock, hide, selected = false} = this.state || {};\r\n        return (\r\n            <div className={`layer-item ${selected ? \"layer-item-selected\" : \"\"}`}\r\n                 onClick={this.onSelected}>\r\n                <div className={'layer-item-name'}>{name}</div>\r\n                <div className={'layer-item-operators'}>\r\n                    <div className={'layer-item-operator'}>\r\n                        <span onClick={this.toggleHide}>\r\n                            <img src={hide ? previewClose : previewOpen} alt={hide ? '显示' : '隐藏'}\r\n                                 style={{width: 14}}/>\r\n                        </span>\r\n                    </div>\r\n                    <div className={'layer-item-operator'}>\r\n                        <span onClick={this.toggleLock}>\r\n                            <img src={lock ? lockImg : unlockImg} alt={lock ? '锁定' : '解锁'}/>\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default LayerItem;","import AbstractComponent, {OperateType, UpdateOptions,} from \"../../../framework/core/AbstractComponent\";\r\nimport ComponentUtil from \"../../../utils/ComponentUtil\";\r\nimport LayerItem, {LayerItemDataProps} from \"./LayerItem\";\r\nimport {merge} from \"../../../utils/ObjectUtil\";\r\n\r\nexport default class LayerComponent extends AbstractComponent<LayerItem, LayerItemDataProps> {\r\n\r\n    async create(container: HTMLElement, config: LayerItemDataProps): Promise<this> {\r\n        this.config = config;\r\n        if (!this.instance)\r\n            ComponentUtil.createAndRender<LayerItem, LayerItemDataProps>(container, LayerItem, config).then((instance) => {\r\n                this.instance = instance;\r\n            });\r\n        return this;\r\n    }\r\n\r\n    destroy(): void {\r\n    }\r\n\r\n    getConfig(): LayerItemDataProps | null {\r\n        return this.config;\r\n    }\r\n\r\n    update(config: LayerItemDataProps, upOp?: UpdateOptions): void {\r\n        this.config = merge(this.config, config) as LayerItemDataProps;\r\n        upOp = upOp || {reRender: true, operateType: OperateType.OPTIONS};\r\n        if (upOp.reRender)\r\n            this.instance?.setState({...this.config})\r\n    }\r\n\r\n\r\n}\r\n","import React, {Component} from 'react';\r\nimport LayerComponent from \"./LayerComponent\";\r\nimport layerListStore from \"./LayerListStore\";\r\nimport {LayerItemDataProps} from \"./LayerItem\";\r\n\r\nexport interface LayerContainerProps {\r\n    item: LayerItemDataProps;\r\n}\r\n\r\nclass LayerContainer extends Component<LayerContainerProps> {\r\n\r\n    layerContainerRef: HTMLDivElement | null = null;\r\n\r\n    componentDidMount() {\r\n        const {layerInstanceMap} = layerListStore;\r\n        const {item} = this.props as LayerContainerProps;\r\n        new LayerComponent().create(this.layerContainerRef!, item).then(r => {\r\n            layerInstanceMap[item.compId!] = r;\r\n        });\r\n    }\r\n\r\n    render() {\r\n        const {item} = this.props as LayerContainerProps;\r\n        return (\r\n            <div id={item.compId + ''} className={'layer-item-container'}\r\n                 ref={ref => this.layerContainerRef = ref}/>\r\n        );\r\n    }\r\n}\r\n\r\nexport default LayerContainer;","import React, {Component, KeyboardEvent} from 'react';\r\nimport './LayerList.less';\r\nimport {Input} from \"antd\";\r\nimport layerListStore from \"./LayerListStore\";\r\nimport designerStore from \"../../store/DesignerStore\";\r\nimport {LayerItemDataProps} from \"./LayerItem\";\r\nimport {observer} from \"mobx-react\";\r\nimport FloatPanel from \"../common/FloatPanel\";\r\nimport eventOperateStore from \"../../operate-provider/EventOperateStore\";\r\nimport eventManager from \"../../operate-provider/core/EventManager\";\r\nimport LayerContainer from \"./LayerContainer\";\r\nimport {MovableItemType} from \"../../../lib/lc-movable/types\";\r\n\r\n//todo 该组件的重新渲染逻辑要重点优化\r\nclass LayerList extends Component {\r\n\r\n    componentDidMount() {\r\n        eventManager.register(\"click\", this.cancelSelected);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        eventManager.unregister(\"click\", this.cancelSelected);\r\n    }\r\n\r\n    //todo: 想想怎么优化\r\n    cancelSelected = (e: PointerEvent) => {\r\n        const layerListDom = document.querySelector(\".layer-list\");\r\n        if (!layerListDom || !e.target) return;\r\n        if (layerListDom.contains(e.target as Node) && !(e.target as HTMLElement).classList.contains(\"layer-item\")) {\r\n            const {setTargetIds, setTargets} = eventOperateStore;\r\n            setTargetIds([]);\r\n            setTargets([]);\r\n        }\r\n    }\r\n\r\n    onClose = () => {\r\n        const {setVisible} = layerListStore;\r\n        setVisible && setVisible(false);\r\n    }\r\n\r\n    searchLayer = (e: KeyboardEvent<HTMLInputElement>) => {\r\n        const {setContent} = layerListStore;\r\n        const content = (e.target as HTMLInputElement).value;\r\n        // if (content === '') return;\r\n        setContent && setContent(content);\r\n    }\r\n\r\n\r\n    buildLayerList = () => {\r\n        const {layoutConfigs} = designerStore;\r\n        const {targetIds} = eventOperateStore;\r\n        const {searchContent} = layerListStore;\r\n        return Object.values(layoutConfigs)\r\n            .filter((item: MovableItemType) => item.name?.includes(searchContent))\r\n            .sort((a: MovableItemType, b: MovableItemType) => b.order! - a.order!)\r\n            .map((item: MovableItemType, index) => {\r\n                let _props: LayerItemDataProps = {\r\n                    name: item.name,\r\n                    lock: item.locked,\r\n                    hide: item.hide,\r\n                    compId: item.id,\r\n                    selected: targetIds.includes(item.id!)\r\n                }\r\n                return <LayerContainer key={item.id} item={_props}/>\r\n            });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <FloatPanel title={'图层'} onClose={this.onClose} initPosition={{x: 250, y: -window.innerHeight + 50}}\r\n                        className={'layer-list'}>\r\n                <div className={'list-search'}>\r\n                    <Input placeholder=\"搜索图层\" onPressEnter={this.searchLayer}\r\n                           style={{width: '100%'}}/>\r\n                </div>\r\n                <div className={'layer-items'}>\r\n                    {this.buildLayerList()}\r\n                </div>\r\n            </FloatPanel>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(LayerList);","import React, {Component} from 'react';\r\nimport {observer} from \"mobx-react\";\r\nimport CompList from \"./comp-list/CompList\";\r\nimport compListStore from \"./comp-list/CompListStore\";\r\nimport layerListStore from \"./layer-list/LayerListStore\";\r\nimport LayerList from \"./layer-list/LayerList\";\r\n\r\nclass FloatConfigs extends Component {\r\n    render() {\r\n        const {visible: compListVisible} = compListStore;\r\n        const {visible: layerListVisible} = layerListStore;\r\n        return (\r\n            <>\r\n                {compListVisible && <CompList/>}\r\n                {layerListVisible && <LayerList/>}\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(FloatConfigs);","import React, {Component} from 'react';\r\nimport DesignerCanvas from \"./canvas/DesignerCanvas\";\r\nimport DesignerHeader from \"./header/DesignerHeader\";\r\nimport LcHeader from \"./structure/LcHeader\";\r\nimport LcBody from \"./structure/LcBody\";\r\nimport LcLeft from \"./structure/LcLeft\";\r\nimport LcContent from \"./structure/LcContent\";\r\nimport LcRight from \"./structure/LcRight\";\r\nimport LcStructure from \"./structure/LcStructure\";\r\nimport LcFoot from \"./structure/LcFoot\";\r\nimport DesignerLeft from \"./left\";\r\nimport Right from \"./right\";\r\nimport DesignerFooter from \"./footer/DesignerFooter\";\r\nimport {loadDesigner} from \"./LoadDesigner\";\r\nimport {registerEventOnDesignerLoaded} from \"./RegisterEvent\";\r\nimport FloatConfigs from \"./float-configs/FloatConfigs\";\r\n\r\nclass Designer extends Component<any> {\r\n\r\n    constructor(props: any) {\r\n        super(props);\r\n        //加载设计器\r\n        loadDesigner();\r\n    }\r\n\r\n    componentDidMount() {\r\n        //注册设计器加载完成事件\r\n        registerEventOnDesignerLoaded();\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <LcStructure>\r\n                <LcHeader>\r\n                    <DesignerHeader/>\r\n                </LcHeader>\r\n                <LcBody>\r\n                    <LcLeft><DesignerLeft/></LcLeft>\r\n                    <LcContent><DesignerCanvas/></LcContent>\r\n                    <LcRight><Right/></LcRight>\r\n                </LcBody>\r\n                <LcFoot>\r\n                    <DesignerFooter/>\r\n                </LcFoot>\r\n                <FloatConfigs/>\r\n            </LcStructure>\r\n        );\r\n    }\r\n}\r\n\r\nexport default Designer;","import contextMenuStore from \"./operate-provider/right-click-menu/ContextMenuStore\";\r\nimport eventOperateStore from \"./operate-provider/EventOperateStore\";\r\nimport eventManager from \"./operate-provider/core/EventManager\";\r\nimport {KMMap} from \"./operate-provider/keyboard-mouse/KeyboardMouse\";\r\n\r\nexport function registerEventOnDesignerLoaded() {\r\n    const {setPosition, updateVisible} = contextMenuStore;\r\n    const {setUnLockedId} = eventOperateStore;\r\n    eventManager.register('click', (e: any) => {\r\n        const {visible, updateVisible} = contextMenuStore;\r\n        if (visible && e.button === 0) {\r\n            //这里添加异步处理的原因：必须要在操作菜单执行点击事件执行之后才能卸载dom元素，不然操作菜单的点击事件会失效。\r\n            setTimeout(() => {\r\n                updateVisible(false);\r\n            });\r\n        }\r\n    });\r\n    eventManager.register('contextmenu', (event: any) => {\r\n        event.preventDefault();\r\n        const {mouseDownTime, mouseUpTime} = contextMenuStore;\r\n        let targetArr = ['lc-comp-item', 'moveable-area'];\r\n        if (targetArr.some((item: string) => event.target.classList.contains(item)) && mouseUpTime - mouseDownTime < 200) {\r\n            updateVisible && updateVisible(true);\r\n            setPosition([event.clientX, event.clientY]);\r\n            setUnLockedId(event.target.id);\r\n        } else {\r\n            updateVisible && updateVisible(false);\r\n        }\r\n    });\r\n    eventManager.register('pointerdown', (e: PointerEvent) => {\r\n        if (e.button === 0) {\r\n            KMMap.leftClick = true;\r\n        } else if (e.button === 2)\r\n            KMMap.rightClick = true;\r\n        const {setMouseDownTime} = contextMenuStore;\r\n        setMouseDownTime(Date.now());\r\n    });\r\n    eventManager.register('pointerup', (e: PointerEvent) => {\r\n        if (e.button === 0)\r\n            KMMap.leftClick = false;\r\n        else if (e.button === 2)\r\n            KMMap.rightClick = false;\r\n        const {setMouseUpTime} = contextMenuStore;\r\n        setMouseUpTime(Date.now());\r\n        const {setPointerTarget} = eventOperateStore;\r\n        setPointerTarget(e.target);\r\n    });\r\n}"],"sourceRoot":""}