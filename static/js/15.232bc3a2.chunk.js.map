{"version":3,"sources":["comps/lc/background/DesignerBackground.tsx","framework/core/ComponentContainer.tsx","designer/left/classify-list/ClassifyType.ts","designer/structure/LcHeader.tsx","designer/structure/LcBody.tsx","designer/structure/LcLeft.tsx","designer/structure/LcContent.tsx","designer/structure/LcRight.tsx","designer/structure/LcStructure.tsx","designer/structure/LcFoot.tsx","icon/icon-all.svg","icon/icon-bar.svg","icon/icon-column.svg","icon/icon-area.svg","icon/icon-pie.svg","icon/icon-scatter.svg","icon/icon-line.svg","icon/icon-loading.svg","icon/icon-flowers.svg","icon/icon-optimize.svg","icon/icon-points.svg","designer/left/classify-list/ClassifyListStore.ts","designer/float-configs/comp-list/CompListStore.ts","designer/left/classify-list/ClassifyList.tsx","designer/left/index.tsx","designer/right/MenuList.tsx","designer/right/ConfigContent.tsx","designer/right/index.tsx","designer/footer/HotKeyDes.tsx","designer/footer/keyboard-icon.svg","designer/footer/layers-icon.svg","designer/footer/FooterStore.ts","designer/footer/Footer.tsx","designer/operate-provider/drag/AbstractDrag.ts","designer/operate-provider/drag/CommonDragger.ts","designer/float-configs/common/FloatPanel.tsx","designer/float-configs/comp-list/CompList.tsx","designer/operate-provider/core/EventManager.ts","designer/float-configs/layer-list/icon/lock.svg","designer/float-configs/layer-list/icon/preview-close.svg","designer/float-configs/layer-list/icon/preview-open.svg","designer/float-configs/layer-list/icon/unlock.svg","designer/float-configs/layer-list/LayerItem.tsx","designer/float-configs/layer-list/LayerComponent.ts","designer/float-configs/layer-list/LayerContainer.tsx","designer/float-configs/layer-list/LayerList.tsx","designer/float-configs/FloatConfigs.tsx","designer/operate-provider/right-click-menu/ContextMenuStore.ts","designer/operate-provider/hot-key/KeyboardMouse.ts","designer/header/DesignerHeader.tsx","designer/operate-provider/drag/CanvasDragger.ts","designer/operate-provider/DragScaleProvider.tsx","lib/lc-ruler/DesignerRuler.tsx","designer/operate-provider/DesignerContainer.tsx","lib/lc-movable/GroupMovable.tsx","lib/lc-movable/GroupSelectable.tsx","utils/RenderUtil.ts","designer/operate-provider/undo-redo/core/AbstractRollback.ts","designer/operate-provider/undo-redo/core/DragRollbackImpl.ts","designer/operate-provider/undo-redo/core/ResizeRollbackImpl.ts","designer/operate-provider/undo-redo/core/AddRollbackImpl.ts","designer/operate-provider/undo-redo/core/DelRollbackImpl.ts","designer/operate-provider/undo-redo/core/StyleRollbackImpl.ts","designer/operate-provider/undo-redo/core/HideRollbackImpl.ts","designer/operate-provider/undo-redo/core/LockRollbackImpl.ts","designer/operate-provider/undo-redo/core/OrderRollbackImpl.ts","designer/operate-provider/undo-redo/core/index.ts","designer/operate-provider/hot-key/HotKey.tsx","designer/operate-provider/hot-key/HotKeyImpl.ts","designer/operate-provider/right-click-menu/ContextMenu.tsx","designer/operate-provider/scale/Scaler.ts","designer/operate-provider/hot-key/HotKeyConfig.ts","designer/canvas/DesignerCanvas.tsx","designer/Designer.tsx"],"names":["DesignerBackground","props","onClick","e","getBgConfigProps","bgConfig","state","config","width","height","bgMode","bgColor","bgImg","bgImgSize","length","bgImgPosition","bgImgPos","bgConfigProps","BackgroundMode","NONE","PICTURE","bgImgUrl","bgImgRepeat","single","radialGradient","linearGradient","bgColorMode","BackgroundColorMode","SINGLE","color","LINEAR_GRADIENT","compInstances","designerStore","elemConfigs","componentDefine","EditorDesignerLoader","getInstance","customComponentInfoMap","getInitConfig","AbstractBackgroundImpl","background","className","id","onDoubleClick","this","style","children","Component","ComponentContainer","ref","mode","parseUrlParams","action","layout","historyRecordOperateProxy","doAdd","fallback","type","locked","hide","transform","position","display","pointerEvents","React","PureComponent","ClassifyEnum","LcHeader","LcBody","LcLeft","LcContent","LcRight","LcStructure","LcFoot","classifyListStore","classifies","classifyKey","doInit","icon","icon_all","name","classify","ALL","icon_points","BASE","icon_optimize","ORNAMENTAL","icon_bar","BAR","icon_column","COLUMN","icon_line","LINE","icon_area","AREA","icon_pie","PIE","icon_loading","PROGRESS","icon_scatter","SCATTER","icon_flowers","ROSE","doClear","setClassifyKey","key","makeAutoObservable","compListStore","compInfoArr","compKey","visible","comps","Object","keys","forEach","baseInfo","getBaseInfo","push","setVisible","setCompKey","makeObservable","observable","ClassifyList","changeClassifyKey","currentTarget","buildClassifyList","classifyArr","i","Icon","src","alt","classifyListDom","overflowY","observer","DesignerLeft","MenuList","menuChange","setActiveMenu","rightStore","setContentVisible","buildMenuList","menus","map","item","ConfigContent","createProxy","instance","Proxy","get","target","prop","originalMethod","apply","thisArg","argumentsList","newValue","oldValue","ObjectUtil","getOriginValue","doStyleUpd","buildConfigContent","activeMenu","activeElem","ConfigComp","getMenuToConfigContentMap","Loading","onClose","activeMenuName","LineOutlined","Right","HotKeyDes","footerStore","coordinate","size","scale","setCoordinate","setSize","setScale","Footer","showHotKeyDes","toggleHotKeyDes","setState","toggleLayerList","layerListStore","layoutConfigs","projectConfig","stateStr","keyboardIcon","top","layerIcon","parseInt","toFixed","Dialog","title","AbstractDrag","dragTarget","x","y","onDragStart","onDragEnd","CommonDragger","initPos","addEventListener","button","releasePointerCapture","pointerId","removeEventListener","onDragMove","movementX","movementY","setPointerCapture","registerDragger","FloatPanel","panelRef","dragTargetRef","initPosition","CompList","addItem","maxLevel","eventOperateStore","setMaxLevel","setAddRecordCompId","movableItem","idGenerate","generateId","order","getChartDom","chartDom","filter","typeKey","compName","indexOf","compInfo","chartImg","getChartImg","searchChart","value","window","innerHeight","placeholder","onPressEnter","EventManager","events","handler","index","splice","args","eventManager","LayerItem","selected","lock","compId","toggleLock","lockChange","toggleHide","hideChange","onSelected","event","selectedChange","previewClose","previewOpen","lockImg","unlockImg","LayerComponent","container","a","ComponentUtil","createAndRender","then","upOp","merge","reRender","operateType","OperateType","OPTIONS","AbstractComponent","LayerContainer","layerContainerRef","layerInstanceMap","create","r","LayerList","cancelSelected","layerListDom","document","querySelector","contains","classList","setTargetIds","setTargets","searchLayer","setContent","content","buildLayerList","targetIds","searchContent","values","includes","sort","b","_props","register","unregister","FloatConfigs","compListVisible","layerListVisible","contextMenuStore","mouseDownTime","mouseUpTime","updateVisible","setPosition","setMouseDownTime","time","setMouseUpTime","KMMap","leftClick","rightClick","middleClick","ProjectHdItemImpl","lazy","CanvasHdConfigImpl","ThemeHdItemImpl","Header","buildHeaderList","items","headerItemInstances","canvasVisible","headerStore","projectVisible","themeVisible","CanvasDragger","console","log","DragScaleProvider","scaleCore","error","clientX","clientY","destroy","Error","dragger","providerRef","canvasConfig","overflow","innerWidth","backgroundColor","offsetX","offsetY","DesignerRuler","wheelTimerId","pointerMoveTimerId","render","unit","baseOffset","_scrollPosX","_scrollPosY","rulerX","mousePosX","scrollPosX","startPosX","rulerY","mousePosY","scrollPosY","startPosY","ofX","ofY","ratio","Math","floor","clearTimeout","setTimeout","scroll","textAlign","fontSize","left","scrollPos","zoom","lineColor","textColor","segment","negativeRuler","textOffset","DesignerContainer","outline","GroupMovable","movableRef","updateLayout","backoff","setBackoff","lastEvent","beforeTranslate","data","offsetWidth","offsetHeight","dataset","doDrag","onDragGroupEnd","setGroupCoordinate","groupCoordinate","ev","posChange","minX","minY","onResizeEnd","translate","drag","direction","doResize","onResizeGroupEnd","dist","groupWidth","groupHeight","onResizeGroup","onResize","targets","setMovableRef","readonly","selectorRef","rasterize","dragStep","resizeStep","draggable","resizable","keepRatio","throttleDrag","throttleResize","onClickGroup","current","clickTarget","inputEvent","inputTarget","onDrag","onDragGroup","GroupSelectable","createRef","onSelectEnd","movable","isDragStart","preventDefault","dragStart","calculateGroupCoordinate","isMoveableElement","some","t","stop","setSelectorRef","dragContainer","selectableTargets","hitRate","selectByClick","selectFromInside","toggleContinueSelect","RenderUtil","fn","delay","callback","now","Date","prev","AbstractRollback","DragRollbackImpl","record","nextRecordData","next","ids","getElementById","request","prevRecordData","dragRollbackImpl","ResizeRollbackImpl","nextResizeData","prevResizeData","resizeRollbackImpl","AddRollbackImpl","layoutConfig","nextAddData","delItem","delIds","addRollbackImpl","DelRollbackImpl","prevDelData","elemConfig","delRollbackImpl","StyleRollbackImpl","update","styleRollbackImpl","HideRollbackImpl","hideRollbackImpl","LockRollbackImpl","lockRollbackImpl","OrderRollBackImpl","orderRollBackImpl","undoRedoMap","Map","set","HistoryType","DRAG","RESIZE","ADD","DEL","STYLE","HIDE","LOCK","ORDER","TriggerType","doCopy","newIds","copyItem","newId","doLock","toBeUpdate","doLockUpd","doUnLock","unLockedId","toTop","doOrderUpd","toBottom","minLevel","setMinLevel","doDelete","doHide","doHideUpd","ContextMenu","menuList","LockOutlined","EyeInvisibleOutlined","CopyOutlined","VerticalAlignTopOutlined","VerticalAlignBottomOutlined","DeleteOutlined","menuListDom","menuItem","shieldKeyList","HotKey","handlerMapping","currHotKey","existHandlerKey","doHandler","hotKey","triggerType","COILED","pointerTarget","enforcementCap","keyDown","toLowerCase","join","keyUp","wheel","onBlur","onblur","scaleCanvas","origin","getHotKeyConfig","compute","deltaY","emit","getElementsByClassName","compIds","compArr","Array","from","comp","throttle","saveType","SaveType","LOCAL","abstractOperatorMap","doCreateOrUpdate","cloneDeep","getData","SERVER","alert","message","warn","historyOperator","undo","forward","redo","yPos","xPos","DesignerCanvas","backgroundRef","designerRef","updateActive","activeConfig","isEqual","generateElement","Designer","load","clickHandler","contextMenuHandler","pointerDownHandler","pointerUpHandler","clickEmit","contextMenuEmit","pointerDownEmit","pointerMoveEmit","pointerUpEmit","loaded","setUnLockedId","setPointerTarget"],"mappings":"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","file":"static/js/15.232bc3a2.chunk.js","sourcesContent":["import React, {Component, MouseEvent} from 'react';\r\nimport {BackgroundColorMode, BackgroundMode} from \"../../../designer/DesignerType\";\r\nimport AbstractBackgroundImpl, {AbstractBackgroundImplProps, BackgroundConfigType} from \"./AbstractBackgroundImpl\";\r\nimport designerStore from \"../../../designer/store/DesignerStore\";\r\nimport EditorDesignerLoader from \"../../../designer/loader/EditorDesignerLoader\";\r\n\r\ninterface LcDesignerBackgroundProps {\r\n    onClick?: (e: MouseEvent<HTMLDivElement>) => void;\r\n    config?: BackgroundConfigType;\r\n}\r\n\r\n/**\r\n * 设计器画布背景\r\n */\r\nclass DesignerBackground extends Component<LcDesignerBackgroundProps> {\r\n\r\n    constructor(props: LcDesignerBackgroundProps) {\r\n        super(props);\r\n        const {compInstances, elemConfigs} = designerStore;\r\n        // const {customComponentInfoMap} = designerStarter;\r\n        let config: AbstractBackgroundImplProps | null = null;\r\n        if ('80cc666f' in elemConfigs!)\r\n            config = elemConfigs['80cc666f'];\r\n        else {\r\n            const componentDefine = EditorDesignerLoader.getInstance().customComponentInfoMap['LcBg'];\r\n            if (componentDefine)\r\n                config = componentDefine.getInitConfig();\r\n        }\r\n        compInstances['80cc666f'] = new AbstractBackgroundImpl(this, config!);\r\n        this.state = {config: config?.background}\r\n        // delete elemConfigs!['80cc666f'];\r\n    }\r\n\r\n    onClick = (e: MouseEvent<HTMLDivElement>) => {\r\n        const {onClick} = this.props;\r\n        onClick && onClick(e);\r\n    }\r\n\r\n    getBgConfigProps = () => {\r\n        // const bgConfig: BackgroundConfigType = this.props.config!!;\r\n        const {config: bgConfig} = this.state as any;\r\n        const {width, height, bgMode, bgColor, bgImg} = bgConfig;\r\n        let bgImgSize = '100% 100%';\r\n        if (bgImg.bgImgSize && bgImg.bgImgSize.length === 2)\r\n            bgImgSize = `${bgConfig.bgImg.bgImgSize[0]}px ${bgImg.bgImgSize[1]}px`;\r\n        let bgImgPosition = '0 0';\r\n        if (bgImg.bgImgPos && bgImg.bgImgPos.length === 2)\r\n            bgImgPosition = `${bgImg.bgImgPos[0]}px ${bgImg.bgImgPos[1]}px`;\r\n        if (bgConfig) {\r\n            let bgConfigProps: any = {height: height, width: width}\r\n            if (bgMode + '' === BackgroundMode.NONE)\r\n                bgConfigProps['backgroundColor'] = '#000000';\r\n            else if (bgMode + '' === BackgroundMode.PICTURE) {\r\n                if (bgImg.bgImgUrl && bgImg.bgImgUrl !== '') {\r\n                    bgConfigProps['backgroundImage'] = `url(${bgImg.bgImgUrl})`;\r\n                    bgConfigProps['backgroundSize'] = bgImgSize;\r\n                    bgConfigProps['backgroundPosition'] = bgImgPosition;\r\n                    bgConfigProps['backgroundRepeat'] = bgImg?.bgImgRepeat;\r\n                } else\r\n                    bgConfigProps['backgroundColor'] = '#000000';\r\n            } else {\r\n                const {single, radialGradient, linearGradient, bgColorMode} = bgColor;\r\n                if (bgConfig?.bgColor.bgColorMode + '' === BackgroundColorMode.SINGLE)\r\n                    bgConfigProps['backgroundColor'] = single.color;\r\n                else if (bgColorMode === BackgroundColorMode.LINEAR_GRADIENT)\r\n                    bgConfigProps['background'] = linearGradient.color;\r\n                else\r\n                    bgConfigProps['background'] = radialGradient.color;\r\n            }\r\n            return bgConfigProps;\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className={'lc-background'}\r\n                 id={'80cc666f'}\r\n                 data-type={'LcBg'}\r\n                 onDoubleClick={this.onClick}\r\n                 style={this.getBgConfigProps()}>\r\n                {this.props.children}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default DesignerBackground;","import React, {Suspense} from \"react\";\r\nimport {MovableItemType} from \"../../lib/lc-movable/types\";\r\nimport Loading from \"../../lib/loading/Loading\";\r\nimport {parseUrlParams} from \"../../utils/URLUtil\";\r\nimport historyRecordOperateProxy from \"../../designer/operate-provider/undo-redo/HistoryRecordOperateProxy\";\r\n\r\nexport interface ComponentContainerProps {\r\n    layout: MovableItemType;\r\n}\r\n\r\nclass ComponentContainer extends React.PureComponent<ComponentContainerProps> {\r\n\r\n    private ref: HTMLDivElement | null = null;\r\n\r\n    private mode: string = parseUrlParams()?.action || 'edit';\r\n\r\n    componentDidMount(): void {\r\n        //通过ref创建组件，并将组件实例方法Map中。后续通过Map匹配到具体实例，\r\n        //调用实例的对象方法进行组件的更新操作\r\n        const {layout} = this.props;\r\n        historyRecordOperateProxy.doAdd(this.ref, layout);\r\n    }\r\n\r\n    render() {\r\n        const {layout} = this.props;\r\n        return (\r\n            <Suspense fallback={<Loading/>}>\r\n                <div\r\n                    id={layout.id}\r\n                    data-type={layout.type}\r\n                    data-locked={layout.locked}\r\n                    data-hide={layout.hide}\r\n                    key={layout.id + ''}\r\n                    style={{\r\n                        width: layout.width,\r\n                        height: layout.height,\r\n                        transform: `translate(${layout.position![0]}px, ${layout.position![1]}px)`,\r\n                        position: 'absolute',\r\n                        display: layout.hide ? 'none' : 'block',\r\n                    }} className={'lc-comp-item'}>\r\n                    <div ref={(ref) => this.ref = ref} style={{\r\n                        width: '100%',\r\n                        height: '100%',\r\n                        //todo 要优化\r\n                        pointerEvents: `${this.mode === 'view' ? 'auto' : 'none'}`,\r\n                        position: 'relative'\r\n                    }}/>\r\n                </div>\r\n            </Suspense>\r\n        )\r\n    }\r\n}\r\n\r\n\r\nexport default ComponentContainer;","export enum ClassifyEnum {\r\n    //所有\r\n    ALL = 'all',\r\n    //基础\r\n    BASE = 'base',\r\n    //装饰\r\n    ORNAMENTAL = 'ornamental',\r\n    //条形图\r\n    BAR = 'bar',\r\n    //柱状图\r\n    COLUMN = 'column',\r\n    //折线图\r\n    LINE = 'line',\r\n    //面积图\r\n    AREA = 'area',\r\n    //饼图\r\n    PIE = 'pie',\r\n    //进度图\r\n    PROGRESS = 'progress',\r\n    //散点图\r\n    SCATTER = 'scatter',\r\n    //雷达图\r\n    RADAR = 'radar',\r\n    //玫瑰图\r\n    ROSE = 'rose',\r\n    //词云图\r\n    WORD_CLOUD = 'word_cloud',\r\n    //直方图\r\n    HISTOGRAM = 'histogram',\r\n    //旭日图\r\n    SUNBURST = 'sunburst',\r\n    //矩阵图\r\n    TREEMAP = 'treemap',\r\n\r\n}\r\n","import React, {Component} from 'react';\r\n\r\nclass LcHeader extends Component {\r\n    render() {\r\n        return (\r\n            <div className={'structure-header'}>{this.props.children}</div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default LcHeader;","import React, {Component} from 'react';\r\n\r\nclass LcBody extends Component {\r\n    render() {\r\n        return (\r\n            <div className={'structure-body'}>{this.props.children}</div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default LcBody;","import React, {Component} from 'react';\r\n\r\nclass LcLeft extends Component {\r\n    render() {\r\n        return (\r\n            <div className={'structure-body-left'}>{this.props.children}</div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default LcLeft;","import React, {Component} from 'react';\r\n\r\nclass LcContent extends Component {\r\n    render() {\r\n        return (\r\n            <div id={'structureContent'} className={'structure-body-content'}>{this.props.children}</div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default LcContent;","import React, {Component} from 'react';\r\n\r\nclass LcRight extends Component {\r\n    render() {\r\n        return (\r\n            <div className={'structure-body-right'}>{this.props.children}</div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default LcRight;","import React, {Component} from 'react';\r\nimport './structure.less';\r\n\r\nclass LcStructure extends Component {\r\n    render() {\r\n        return (\r\n            <div className={'lc-designer-structure'}>{this.props.children}</div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default LcStructure;","import React, {Component} from 'react';\r\n\r\nclass LcFoot extends Component {\r\n    render() {\r\n        return (\r\n            <div className={'structure-foot'}>{this.props.children}</div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default LcFoot;","export default __webpack_public_path__ + \"static/media/icon-all.fe79e4fd.svg\";","export default __webpack_public_path__ + \"static/media/icon-bar.dfbc87b2.svg\";","export default __webpack_public_path__ + \"static/media/icon-column.ae79292f.svg\";","export default __webpack_public_path__ + \"static/media/icon-area.f3992c44.svg\";","export default __webpack_public_path__ + \"static/media/icon-pie.4d05a7b6.svg\";","export default __webpack_public_path__ + \"static/media/icon-scatter.778bce01.svg\";","export default __webpack_public_path__ + \"static/media/icon-line.b79af542.svg\";","export default __webpack_public_path__ + \"static/media/icon-loading.9d197f5f.svg\";","export default __webpack_public_path__ + \"static/media/icon-flowers.442a19b5.svg\";","export default __webpack_public_path__ + \"static/media/icon-optimize.9b17ea95.svg\";","export default __webpack_public_path__ + \"static/media/icon-points.7fb541f7.svg\";","import {makeAutoObservable} from \"mobx\";\r\nimport {ClassifyEnum} from \"./ClassifyType\";\r\nimport icon_all from '../../../icon/icon-all.svg';\r\nimport icon_bar from '../../../icon/icon-bar.svg';\r\nimport icon_column from '../../../icon/icon-column.svg';\r\nimport icon_area from '../../../icon/icon-area.svg';\r\nimport icon_pie from '../../../icon/icon-pie.svg';\r\nimport icon_scatter from '../../../icon/icon-scatter.svg';\r\nimport icon_line from '../../../icon/icon-line.svg';\r\nimport icon_loading from '../../../icon/icon-loading.svg';\r\nimport icon_flowers from '../../../icon/icon-flowers.svg';\r\nimport icon_optimize from '../../../icon/icon-optimize.svg';\r\nimport icon_points from '../../../icon/icon-points.svg';\r\n\r\nconst getClassifyItemInfo = () => {\r\n    return [\r\n        {\r\n            icon: icon_all,\r\n            name: \"全部\",\r\n            classify: ClassifyEnum.ALL,\r\n        },\r\n        {\r\n            icon: icon_points,\r\n            name: \"基础\",\r\n            classify: ClassifyEnum.BASE,\r\n        },\r\n        {\r\n            icon: icon_optimize,\r\n            name: \"装饰\",\r\n            classify: ClassifyEnum.ORNAMENTAL,\r\n        },\r\n        {\r\n            icon: icon_bar,\r\n            name: \"条形图\",\r\n            classify: ClassifyEnum.BAR,\r\n        },\r\n        {\r\n            icon: icon_column,\r\n            name: \"柱状图\",\r\n            classify: ClassifyEnum.COLUMN,\r\n        },\r\n        {\r\n            icon: icon_line,\r\n            name: \"折线图\",\r\n            classify: ClassifyEnum.LINE,\r\n        },\r\n        {\r\n            icon: icon_area,\r\n            name: \"面积图\",\r\n            classify: ClassifyEnum.AREA,\r\n        },\r\n        {\r\n            icon: icon_pie,\r\n            name: \"饼图\",\r\n            classify: ClassifyEnum.PIE,\r\n        },\r\n        {\r\n            icon: icon_loading,\r\n            name: \"进度图\",\r\n            classify: ClassifyEnum.PROGRESS,\r\n        },\r\n        {\r\n            icon: icon_scatter,\r\n            name: \"散点图\",\r\n            classify: ClassifyEnum.SCATTER,\r\n        },\r\n        {\r\n            icon: icon_flowers,\r\n            name: \"玫瑰图\",\r\n            classify: ClassifyEnum.ROSE,\r\n        },\r\n        // {\r\n        //     icon: icon_radar,\r\n        //     name: \"雷达图\",\r\n        //     classify: ClassifyEnum.RADAR,\r\n        // },\r\n        // {\r\n        //     icon: icon_word_cloud,\r\n        //     name: \"词云图\",\r\n        //     classify: ClassifyEnum.WORD_CLOUD,\r\n        // },\r\n        // {\r\n        //     icon: icon_histogram,\r\n        //     name: \"直方图\",\r\n        //     classify: ClassifyEnum.HISTOGRAM,\r\n        // },\r\n        // {\r\n        //     icon: icon_sun,\r\n        //     name: \"旭日图\",\r\n        //     classify: ClassifyEnum.SUNBURST,\r\n        // },\r\n        // {\r\n        //     icon: icon_rectangle,\r\n        //     name: \"矩形树图\",\r\n        //     classify: ClassifyEnum.TREEMAP,\r\n        // },\r\n    ]\r\n}\r\n\r\n/**\r\n * 左侧分类列表store\r\n */\r\nclass ClassifyListStore {\r\n    constructor() {\r\n        makeAutoObservable(this);\r\n    }\r\n\r\n    /**\r\n     * 分类列表\r\n     */\r\n    classifies: Array<any> = [];\r\n    /**\r\n     * 分类搜索关键字\r\n     */\r\n    classifyKey: string = 'all';\r\n\r\n    /**\r\n     * 初始化\r\n     */\r\n    doInit = () => {\r\n        this.classifies = getClassifyItemInfo();\r\n    }\r\n\r\n    /**\r\n     * 清空store\r\n     */\r\n    doClear = () => {\r\n        this.classifies = [];\r\n    }\r\n\r\n    setClassifyKey = (key: string) => {\r\n        this.classifyKey = key;\r\n    }\r\n}\r\n\r\nconst classifyListStore = new ClassifyListStore();\r\nexport default classifyListStore;","import {action, makeObservable, observable} from \"mobx\";\r\nimport {BaseInfoType} from \"../../DesignerType\";\r\nimport EditorDesignerLoader from \"../../loader/EditorDesignerLoader\";\r\n\r\n/**\r\n * 设计器左侧列表组件的状态管理类。\r\n */\r\nclass CompListStore {\r\n    constructor() {\r\n        makeObservable(this, {\r\n            compKey: observable,\r\n            visible: observable,\r\n            setVisible: action,\r\n            setCompKey: action,\r\n        });\r\n    }\r\n\r\n    /**\r\n     * 组件基础信息数组。设计器左侧组件列表的展示过滤依赖于此数组。\r\n     * 该数组会在设计器加载时进行初始化，后续不再修改。若其他。 场景或组件需要。 操作该数组的数据。 应该操作他的备份。 而不是直接操作该数组。\r\n     */\r\n    compInfoArr: Array<BaseInfoType> = [];\r\n    /**\r\n     * 组件搜索关键字，左侧组件列表根据关键字过滤与组件，使会用到该属性。\r\n     */\r\n    compKey: string = '';\r\n    /**\r\n     * 组件列表可见性。\r\n     */\r\n    visible: boolean = false;\r\n\r\n    doInit = () => {\r\n        const comps: Array<any> = [];\r\n        const {customComponentInfoMap} = EditorDesignerLoader.getInstance();\r\n        if (customComponentInfoMap) {\r\n            Object.keys(customComponentInfoMap).forEach(key => {\r\n                let baseInfo = customComponentInfoMap[key].getBaseInfo();\r\n                if (baseInfo.compKey !== 'LcBg') comps.push(baseInfo);\r\n            });\r\n        }\r\n        this.compInfoArr = comps;\r\n    }\r\n\r\n    setVisible = (visible: boolean) => this.visible = visible;\r\n\r\n    setCompKey = (key: string) => this.compKey = key;\r\n}\r\n\r\nconst compListStore = new CompListStore();\r\nexport default compListStore;","import React, {Component, MouseEvent} from 'react';\r\nimport {observer} from \"mobx-react\";\r\nimport '../classify-list/ClassifyList.less';\r\nimport classifyListStore from \"./ClassifyListStore\";\r\nimport compListStore from \"../../float-configs/comp-list/CompListStore\";\r\n\r\nclass ClassifyList extends Component {\r\n\r\n    constructor(props: {}) {\r\n        super(props);\r\n        const {doInit} = classifyListStore;\r\n        doInit && doInit();\r\n    }\r\n\r\n    changeClassifyKey = (e: MouseEvent<HTMLDivElement>) => {\r\n        const {setClassifyKey} = classifyListStore;\r\n        const {setVisible, visible} = compListStore;\r\n        setClassifyKey(e.currentTarget.id);\r\n        if (!visible)\r\n            setVisible && setVisible(true);\r\n    }\r\n\r\n    buildClassifyList = () => {\r\n        const {classifies} = classifyListStore;\r\n        let classifyArr = [];\r\n        for (let i = 0; i < classifies.length; i++) {\r\n            const {icon: Icon, name, classify} = classifies[i];\r\n            classifyArr.push(\r\n                <div key={i + ''} className={'sort-item'} id={classify} onClick={this.changeClassifyKey}>\r\n                    <div className={'sort-item-icon'}><img style={{width: 20}} src={Icon} alt={'all'}/></div>\r\n                    <span className={'sort-item-content'}>{name}</span>\r\n                </div>\r\n            )\r\n        }\r\n        return classifyArr;\r\n    }\r\n\r\n    render() {\r\n        const classifyListDom = this.buildClassifyList();\r\n        return (\r\n            <div className={'lc-charts-sort'} style={{overflowY: 'scroll'}}>\r\n                {classifyListDom}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(ClassifyList);","import React, {Component} from 'react';\r\nimport ClassifyList from \"./classify-list/ClassifyList\";\r\nimport {observer} from \"mobx-react\";\r\n\r\nclass DesignerLeft extends Component {\r\n\r\n    render() {\r\n        return (\r\n            <ClassifyList/>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(DesignerLeft);","import React, {Component} from 'react';\r\nimport './MenuList.less';\r\nimport {MenuInfo} from \"./MenuType\";\r\nimport rightStore from \"./RightStore\";\r\nimport {observer} from \"mobx-react\";\r\n\r\ninterface LcConfigMenusProps {\r\n    onChange?: (menu: string) => void;\r\n}\r\n\r\nclass MenuList extends Component<LcConfigMenusProps | any> {\r\n\r\n    menuChange = (e: any) => {\r\n        const {setActiveMenu, setContentVisible} = rightStore;\r\n        setActiveMenu && setActiveMenu(e.currentTarget.id);\r\n        setContentVisible && setContentVisible(true);\r\n    }\r\n\r\n    buildMenuList = () => {\r\n        const {menus} = rightStore;\r\n        return menus.map((item: MenuInfo) => {\r\n            const Icon: any = item.icon;\r\n            return (\r\n                <div className={'menu-item'} key={item.key} id={item.key} onClick={this.menuChange}>\r\n                    <div className={'item-icon'}><Icon/></div>\r\n                    <div className={'item-content'}>{item.name}</div>\r\n                </div>\r\n            );\r\n        });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <div className={'lc-config-menu'}>\r\n                <div className={'menu-list'}>\r\n                    {this.buildMenuList()}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(MenuList);","import React, {Component, Suspense} from 'react';\r\nimport {LineOutlined} from \"@ant-design/icons\";\r\nimport rightStore from \"./RightStore\";\r\nimport {observer} from \"mobx-react\";\r\nimport './ConfigContent.less';\r\nimport Loading from \"../../lib/loading/Loading\";\r\nimport designerStore from \"../store/DesignerStore\";\r\nimport {AbstractCustomComponentDefinition} from \"../../framework/core/AbstractCustomComponentDefinition\";\r\nimport {ConfigType} from \"./ConfigType\";\r\nimport EditorDesignerLoader from \"../loader/EditorDesignerLoader\";\r\nimport AbstractDesignerComponent from \"../../framework/core/AbstractDesignerComponent\";\r\nimport ObjectUtil from \"../../utils/ObjectUtil\";\r\nimport historyRecordOperateProxy from \"../operate-provider/undo-redo/HistoryRecordOperateProxy\";\r\n\r\nclass ConfigContent extends Component {\r\n\r\n    createProxy = (instance: AbstractDesignerComponent) => {\r\n        return new Proxy(instance, {\r\n            get(target, prop) {\r\n                const originalMethod = target[prop as keyof AbstractDesignerComponent];\r\n                if (typeof originalMethod === 'function' && originalMethod.name === \"update\") {\r\n                    return new Proxy(originalMethod, {\r\n                        apply(target, thisArg, argumentsList) {\r\n                            const newValue = argumentsList[0];\r\n                            const oldValue = ObjectUtil.getOriginValue(thisArg.config, argumentsList[0]);\r\n                            historyRecordOperateProxy.doStyleUpd(newValue, oldValue);\r\n                            return target.apply(thisArg, argumentsList);\r\n                        }\r\n                    });\r\n                }\r\n                return originalMethod;\r\n            }\r\n        });\r\n    }\r\n\r\n    buildConfigContent = () => {\r\n        const {compInstances} = designerStore;\r\n        let {activeMenu, activeElem} = rightStore;\r\n        let abstractConfigObj: AbstractCustomComponentDefinition = EditorDesignerLoader.getInstance().customComponentInfoMap[activeElem.type + '']\r\n        let configMapping = abstractConfigObj.getMenuToConfigContentMap();\r\n        const ConfigComp: React.ComponentType<ConfigType> = configMapping![activeMenu];\r\n        //使用动态代理对象，监听属性变化\r\n        const instance = this.createProxy(compInstances[activeElem.id + '']);\r\n        return (\r\n            <Suspense fallback={<Loading/>}>\r\n                <ConfigComp instance={instance}/>\r\n            </Suspense>\r\n        )\r\n\r\n    }\r\n\r\n    onClose = () => {\r\n        const {setContentVisible} = rightStore;\r\n        setContentVisible && setContentVisible(false);\r\n    }\r\n\r\n    render() {\r\n        const {activeMenu, menus} = rightStore;\r\n        let activeMenuName = '';\r\n        for (let i = 0; i < menus.length; i++) {\r\n            if (menus[i].key === activeMenu) {\r\n                activeMenuName = menus[i].name;\r\n                break;\r\n            }\r\n        }\r\n        return (\r\n            <div className={'lc-config-panel'}>\r\n                <div className={'lc-panel-top'}>\r\n                    <div className={'panel-title'}>\r\n                        <span>{activeMenuName}</span></div>\r\n                    <div className={'panel-operate'} onClick={this.onClose}><LineOutlined/></div>\r\n                </div>\r\n                <div className={'lc-panel-content'}>\r\n                    {this.buildConfigContent()}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(ConfigContent);","import React, {Component} from 'react';\r\nimport MenuList from \"./MenuList\";\r\nimport ConfigContent from \"./ConfigContent\";\r\nimport rightStore from \"./RightStore\";\r\nimport {observer} from \"mobx-react\";\r\n\r\nclass Right extends Component {\r\n\r\n    render() {\r\n        const {visible} = rightStore;\r\n        return (\r\n            <>\r\n                <MenuList/>\r\n                {visible && <ConfigContent/>}\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(Right);","import React, {Component} from 'react';\r\nimport './HotKeyDes.less';\r\n\r\nclass HotKeyDes extends Component {\r\n    render() {\r\n        return (\r\n            <div className={'lc-hotkey-des'} style={{color: 'white'}}>\r\n                <div className={'hotkey-des-item'}>\r\n                    <div className={'hotkey-content'}><code>Ctrl + S</code></div>\r\n                    <div className={'hotkey-des'}>保存项目</div>\r\n                </div>\r\n                <div className={'hotkey-des-item'}>\r\n                    <div className={'hotkey-content'}><code>Ctrl + V</code></div>\r\n                    <div className={'hotkey-des'}>复制元素</div>\r\n                </div>\r\n                <div className={'hotkey-des-item'}>\r\n                    <div className={'hotkey-content'}><code>Ctrl + L</code></div>\r\n                    <div className={'hotkey-des'}>锁定元素</div>\r\n                </div>\r\n                <div className={'hotkey-des-item'}>\r\n                    <div className={'hotkey-content'}><code>Ctrl + up-arrow(方向上键)</code></div>\r\n                    <div className={'hotkey-des'}>元素置顶</div>\r\n                </div>\r\n                <div className={'hotkey-des-item'}>\r\n                    <div className={'hotkey-content'}><code>Ctrl + down-arrow(方向下键)</code></div>\r\n                    <div className={'hotkey-des'}>元素置底</div>\r\n                </div>\r\n                <div className={'hotkey-des-item'}>\r\n                    <div className={'hotkey-content'}><code>Delete</code></div>\r\n                    <div className={'hotkey-des'}>删除元素</div>\r\n                </div>\r\n                <div className={'hotkey-des-item'}>\r\n                    <div className={'hotkey-content'}><code>Alt + wheel(鼠标滑轮)</code></div>\r\n                    <div className={'hotkey-des'}>缩放画布</div>\r\n                </div>\r\n                <div className={'hotkey-des-item'}>\r\n                    <div className={'hotkey-content'}><code>长按鼠标右键</code></div>\r\n                    <div className={'hotkey-des'}>拖拽画布</div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default HotKeyDes;","export default __webpack_public_path__ + \"static/media/keyboard-icon.1ed11794.svg\";","export default __webpack_public_path__ + \"static/media/layers-icon.aabb7495.svg\";","import {action, makeObservable, observable} from \"mobx\";\r\n\r\nclass FooterStore {\r\n\r\n    constructor() {\r\n        makeObservable(this, {\r\n            coordinate: observable,\r\n            scale: observable,\r\n            size: observable,\r\n            setCoordinate: action,\r\n            setSize: action,\r\n            setScale: action\r\n        })\r\n    }\r\n\r\n    coordinate: number[] = [0, 0];\r\n\r\n    size: number[] = [0, 0];\r\n\r\n    scale: number = 1;\r\n\r\n    setCoordinate = (coordinate: number[]) => this.coordinate = coordinate;\r\n\r\n    setSize = (size: number[]) => this.size = size;\r\n\r\n    setScale = (scale: number) => this.scale = scale;\r\n}\r\n\r\nconst footerStore = new FooterStore();\r\nexport default footerStore;","import React, {Component} from 'react';\r\nimport './Footer.less';\r\nimport {observer} from \"mobx-react\";\r\nimport designerStore from \"../store/DesignerStore\";\r\nimport Dialog from \"../../lib/lc-dialog/Dialog\";\r\nimport HotKeyDes from \"./HotKeyDes\";\r\nimport layerListStore from \"../float-configs/layer-list/LayerListStore\";\r\nimport keyboardIcon from './keyboard-icon.svg';\r\nimport layerIcon from './layers-icon.svg';\r\nimport footerStore from \"./FooterStore\";\r\n\r\nclass Footer extends Component {\r\n\r\n    state = {\r\n        showHotKeyDes: false\r\n    }\r\n\r\n    toggleHotKeyDes = () => {\r\n        const {showHotKeyDes} = this.state;\r\n        this.setState({\r\n            showHotKeyDes: !showHotKeyDes\r\n        })\r\n    }\r\n\r\n    toggleLayerList = () => {\r\n        const {setVisible, visible} = layerListStore;\r\n        setVisible && setVisible(!visible);\r\n    }\r\n\r\n    render() {\r\n        const {layoutConfigs, projectConfig: {name, state}} = designerStore;\r\n        const {size, coordinate, scale} = footerStore;\r\n        let stateStr = '';\r\n        switch (state) {\r\n            case '0':\r\n                stateStr = '草稿';\r\n                break;\r\n            case '1':\r\n                stateStr = '发布';\r\n                break;\r\n            case '2':\r\n                stateStr = '封存';\r\n                break;\r\n        }\r\n        return (\r\n            <div className={'lc-designer-footer'}>\r\n                <div className={'footer-left'}>\r\n                    <div className={'footer-item'} onClick={this.toggleHotKeyDes}>\r\n                        <img width={16} alt={'快捷键'}\r\n                             src={keyboardIcon}/>\r\n                        &nbsp;\r\n                        <span style={{position: 'relative', top: 2}}>快捷键</span>\r\n                    </div>\r\n                    <div className={'footer-item'} onClick={this.toggleLayerList}>\r\n                        <img width={16} alt={'图层'} src={layerIcon}/>\r\n                        &nbsp;\r\n                        <span style={{position: 'relative', top: 2}}>图层</span>\r\n                    </div>\r\n                </div>\r\n                <div className={'footer-right'}>\r\n                    <div className={'right-info-item'}>\r\n                        {`尺寸 (${parseInt(size[0] + '')} , ${parseInt(size[1] + '')})`}\r\n                    </div>\r\n                    <div className={'right-info-item'}>\r\n                        {`坐标 (${parseInt(coordinate[0] + '')} , ${parseInt(coordinate[1] + '')})`}\r\n                    </div>\r\n                    <div className={'right-info-item'}>缩放 : {(scale * 100).toFixed(0)}%</div>\r\n                    <div className={'right-info-item'}>当前组件数 : {Object.keys(layoutConfigs).length}</div>\r\n                    <div className={'right-info-item'}>项目 : {name}</div>\r\n                    <div className={'right-info-item'}>状态 : {stateStr}</div>\r\n                </div>\r\n                <Dialog title={'快捷键说明'} visible={this.state.showHotKeyDes} onClose={this.toggleHotKeyDes}>\r\n                    <HotKeyDes/>\r\n                </Dialog>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(Footer);","abstract class AbstractDrag {\r\n    //被拖拽的目标\r\n    protected target: any = null;\r\n    //触发拖拽的目标元素\r\n    protected dragTarget: any = null;\r\n    //拖拽的起始位置\r\n    protected position: { x: number, y: number } = {x: 0, y: 0};\r\n\r\n    public registerDragger(): void {\r\n        this.onDragStart(this.target);\r\n        this.onDragEnd(this.target);\r\n    }\r\n\r\n    protected abstract onDragStart(e: any): void;\r\n\r\n    protected abstract onDragMove(e: any): void;\r\n\r\n    protected abstract onDragEnd(e: any): void;\r\n}\r\n\r\nexport default AbstractDrag;","import AbstractDrag from \"./AbstractDrag\";\r\n\r\nexport interface DragCoordinate {\r\n    x: number,\r\n    y: number\r\n}\r\n\r\nexport default class CommonDragger extends AbstractDrag {\r\n\r\n    protected position: { x: number, y: number } = {x: 0, y: 0}; // 第一个点坐标\r\n\r\n    constructor(target: any, dragTarget: any, initPos?: DragCoordinate) {\r\n        super();\r\n        this.target = target;\r\n        this.dragTarget = dragTarget;\r\n        this.registerDragger();\r\n        if (initPos) this.position = initPos;\r\n    }\r\n\r\n    protected onDragEnd = (): void => {\r\n        this.dragTarget.addEventListener('pointerup', (e: any) => {\r\n            if (e.button === 0) {\r\n                this.dragTarget.releasePointerCapture(e.pointerId);\r\n                this.dragTarget.removeEventListener('pointermove', this.onDragMove);\r\n            }\r\n        });\r\n    }\r\n\r\n    protected onDragMove = (e: any): void => {\r\n        this.position.x += e.movementX;\r\n        this.position.y += e.movementY;\r\n        this.target.style.transform = 'translate(' + this.position.x + 'px, ' + this.position.y + 'px)';\r\n    }\r\n\r\n    protected onDragStart = (): void => {\r\n        this.dragTarget.addEventListener('pointerdown', (e: any) => {\r\n            if (e.button === 0) {\r\n                this.dragTarget.setPointerCapture(e.pointerId);\r\n                this.dragTarget.addEventListener('pointermove', this.onDragMove);\r\n            }\r\n        });\r\n    }\r\n\r\n}","import React, {Component} from 'react';\r\nimport {LineOutlined} from \"@ant-design/icons\";\r\nimport CommonDragger from \"../../operate-provider/drag/CommonDragger\";\r\nimport './FloatPanel.less';\r\n\r\nexport interface FloatPanelProps {\r\n    title?: string;\r\n    initPosition?: { x: number, y: number };\r\n    width?: number;\r\n    height?: number;\r\n    onClose?: () => void;\r\n    className?: string;\r\n}\r\n\r\n/**\r\n * 浮动面板容器，提供浮动面板的拖拽功能\r\n */\r\nclass FloatPanel extends Component<FloatPanelProps> {\r\n\r\n    panelRef: any = null;\r\n    dragTargetRef: any = null;\r\n\r\n    componentDidMount() {\r\n        const {initPosition = {x: 0, y: 0}} = this.props;\r\n        if (this.dragTargetRef && this.panelRef)\r\n            new CommonDragger(this.panelRef, this.dragTargetRef, initPosition);\r\n    }\r\n\r\n    onClose = () => {\r\n        const {onClose} = this.props;\r\n        onClose && onClose();\r\n    }\r\n\r\n    render() {\r\n        const {initPosition = {x: 0, y: 0}, title, className} = this.props;\r\n        return (\r\n            <div className={`float-panel ${className}`}\r\n                 style={{transform: `translate(${initPosition.x}px, ${initPosition.y}px)`}}\r\n                 ref={ref => this.panelRef = ref}>\r\n                <div className={'panel-title'}>\r\n                    <div className={'title-left'}>{title}</div>\r\n                    <div ref={ref => this.dragTargetRef = ref} className={'title-drag-target'}\r\n                         style={{width: '50%', height: '100%'}}>\r\n                    </div>\r\n                    <div className={'title-right'} onClick={this.onClose}><span><LineOutlined/></span></div>\r\n                </div>\r\n                {this.props.children}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default FloatPanel;","import React, {Component} from 'react';\r\nimport {Input} from \"antd\";\r\nimport compListStore from \"./CompListStore\";\r\nimport classifyListStore from \"../../left/classify-list/ClassifyListStore\";\r\nimport './CompList.less';\r\nimport {observer} from \"mobx-react\";\r\nimport designerStore from \"../../store/DesignerStore\";\r\nimport {idGenerate} from \"../../../utils/IdGenerate\";\r\nimport {MovableItemType} from \"../../../lib/lc-movable/types\";\r\nimport eventOperateStore from \"../../operate-provider/EventOperateStore\";\r\nimport FloatPanel from \"../common/FloatPanel\";\r\nimport {BaseInfoType} from \"../../DesignerType\";\r\nimport EditorDesignerLoader from \"../../loader/EditorDesignerLoader\";\r\n\r\nclass CompList extends Component {\r\n\r\n    constructor(props: any) {\r\n        super(props);\r\n        const {doInit} = compListStore;\r\n        doInit && doInit();\r\n    }\r\n\r\n    addItem = (compKey: string, name: string) => {\r\n        const {addItem} = designerStore;\r\n        let {maxLevel, setMaxLevel, setAddRecordCompId} = eventOperateStore;\r\n        let movableItem: MovableItemType = {\r\n            name: name,\r\n            type: compKey,\r\n            width: 320,\r\n            height: 200,\r\n            position: [0, 0],\r\n            id: idGenerate.generateId(),\r\n            locked: false,\r\n            hide: false,\r\n            order: ++maxLevel,\r\n        }\r\n        setAddRecordCompId(movableItem.id!)\r\n        setMaxLevel && setMaxLevel(maxLevel);\r\n        addItem && addItem(movableItem);\r\n    }\r\n\r\n    getChartDom = () => {\r\n        let chartDom = [];\r\n        let {classifyKey} = classifyListStore\r\n        let {compInfoArr, compKey} = compListStore;\r\n        if (classifyKey !== 'all') {\r\n            compInfoArr = compInfoArr.filter((item: BaseInfoType) => {\r\n                return item.typeKey === classifyKey;\r\n            })\r\n        }\r\n        if (compKey !== '') {\r\n            compInfoArr = compInfoArr.filter((item: BaseInfoType) => {\r\n                return item.compName.indexOf(compKey) >= 0;\r\n            })\r\n        }\r\n        for (let i = 0; i < compInfoArr.length; i++) {\r\n            let compInfo: any = compInfoArr[i];\r\n            const {compName, compKey} = compInfo;\r\n            let lcCompInit: any = EditorDesignerLoader.getInstance().customComponentInfoMap[compKey];\r\n            let chartImg = lcCompInit.getChartImg();\r\n            chartDom.push(\r\n                <div key={i + ''} className={'list-item droppable-element'}>\r\n                    <div className={'item-header'} ref={'drag-target'}>\r\n                        <div className={'item-name'}>{compName}</div>\r\n                        <div className={'item-type'}>Antd</div>\r\n                    </div>\r\n                    <div className={'item-content'} onDoubleClick={() => this.addItem(compKey, compName)}>\r\n                        <img src={chartImg} alt={'组件预览图'}/>\r\n                    </div>\r\n                </div>\r\n            )\r\n        }\r\n        return chartDom;\r\n    }\r\n\r\n    onClose = () => {\r\n        const {setVisible} = compListStore;\r\n        setVisible && setVisible(false);\r\n    }\r\n\r\n    searchChart = (e: any) => {\r\n        const {setCompKey} = compListStore;\r\n        setCompKey && setCompKey(e.currentTarget.value);\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <FloatPanel className={'comp-list'} title={'组件列表'} onClose={this.onClose}\r\n                        initPosition={{x: 60, y: -window.innerHeight + 50}}>\r\n                <div className={'list-search'}>\r\n                    <Input placeholder=\"搜索组件\" onPressEnter={this.searchChart}\r\n                           style={{width: '100%'}}/>\r\n                </div>\r\n                <div className={'list-items'}>\r\n                    {this.getChartDom()}\r\n                </div>\r\n            </FloatPanel>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(CompList);","class EventManager {\r\n    events: any = {};\r\n\r\n    register(type: string, handler: Function) {\r\n        if (!this.events[type])\r\n            this.events[type] = [];\r\n        this.events[type].push(handler);\r\n    }\r\n\r\n    unregister(type: string, handler?: Function) {\r\n        if (!this.events[type])\r\n            return;\r\n\r\n        const index = this.events[type].indexOf(handler);\r\n        if (index > -1)\r\n            this.events[type].splice(index, 1);\r\n\r\n    }\r\n\r\n    emit(type: string, ...args: any[]) {\r\n        if (!this.events[type])\r\n            return;\r\n        this.events[type].forEach((handler: Function) => {\r\n            handler(...args);\r\n        });\r\n    }\r\n}\r\n\r\nconst eventManager = new EventManager();\r\nexport default eventManager;","export default __webpack_public_path__ + \"static/media/lock.11cf90eb.svg\";","export default __webpack_public_path__ + \"static/media/preview-close.40634e66.svg\";","export default __webpack_public_path__ + \"static/media/preview-open.fe6af5a2.svg\";","export default __webpack_public_path__ + \"static/media/unlock.a58cef96.svg\";","import React, {MouseEvent} from 'react';\r\nimport './LayerItem.less';\r\nimport lockImg from './icon/lock.svg';\r\nimport previewClose from './icon/preview-close.svg';\r\nimport previewOpen from './icon/preview-open.svg';\r\nimport unlockImg from './icon/unlock.svg';\r\nimport layerListStore from \"./LayerListStore\";\r\n\r\nexport interface LayerItemDataProps {\r\n    compId?: string;\r\n    name?: string;\r\n    lock?: boolean;\r\n    hide?: boolean;\r\n    selected?: boolean;\r\n}\r\n\r\nclass LayerItem extends React.PureComponent<LayerItemDataProps> {\r\n\r\n    state = {\r\n        selected: false,\r\n        lock: false,\r\n        hide: false,\r\n        compId: '',\r\n        name: ''\r\n    }\r\n\r\n    constructor(props: LayerItemDataProps) {\r\n        super(props);\r\n        const {selected, lock, hide, compId, name} = props;\r\n        this.state = {\r\n            selected: selected || false,\r\n            lock: lock || false,\r\n            hide: hide || false,\r\n            compId: compId || '',\r\n            name: name || ''\r\n        }\r\n    }\r\n\r\n    toggleLock = () => {\r\n        const {lockChange} = layerListStore;\r\n        lockChange && lockChange(this.state.compId, !this.state.lock);\r\n    }\r\n\r\n    toggleHide = () => {\r\n        const {hideChange} = layerListStore;\r\n        hideChange && hideChange(this.state.compId, !this.state.hide);\r\n    }\r\n\r\n    onSelected = (event: MouseEvent<HTMLDivElement>) => {\r\n        const {selectedChange} = layerListStore;\r\n        selectedChange && selectedChange({...this.state, ...{selected: true}}, event);\r\n    }\r\n\r\n    render() {\r\n        const {name, lock, hide, selected = false} = this.state || {};\r\n        return (\r\n            <div className={`layer-item ${selected ? \"layer-item-selected\" : \"\"}`}\r\n                 onClick={this.onSelected}>\r\n                <div className={'layer-item-name'}>{name}</div>\r\n                <div className={'layer-item-operators'}>\r\n                    <div className={'layer-item-operator'}>\r\n                        <span onClick={this.toggleHide}>\r\n                            <img src={hide ? previewClose : previewOpen} alt={hide ? '显示' : '隐藏'}\r\n                                 style={{width: 14}}/>\r\n                        </span>\r\n                    </div>\r\n                    <div className={'layer-item-operator'}>\r\n                        <span onClick={this.toggleLock}>\r\n                            <img src={lock ? lockImg : unlockImg} alt={lock ? '锁定' : '解锁'}/>\r\n                        </span>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default LayerItem;","import AbstractComponent, {OperateType, UpdateOptions,} from \"../../../framework/core/AbstractComponent\";\r\nimport ComponentUtil from \"../../../utils/ComponentUtil\";\r\nimport LayerItem, {LayerItemDataProps} from \"./LayerItem\";\r\nimport ObjectUtil from \"../../../utils/ObjectUtil\";\r\n\r\nexport default class LayerComponent extends AbstractComponent<LayerItem, LayerItemDataProps> {\r\n\r\n    async create(container: HTMLElement, config: LayerItemDataProps): Promise<this> {\r\n        this.config = config;\r\n        if (!this.instance)\r\n            ComponentUtil.createAndRender<LayerItem, LayerItemDataProps>(container, LayerItem, config).then((instance) => {\r\n                this.instance = instance;\r\n            });\r\n        return this;\r\n    }\r\n\r\n    destroy(): void {\r\n    }\r\n\r\n    getConfig(): LayerItemDataProps | null {\r\n        return this.config;\r\n    }\r\n\r\n    update(config: LayerItemDataProps, upOp?: UpdateOptions): void {\r\n        this.config = ObjectUtil.merge(this.config, config) as LayerItemDataProps;\r\n        upOp = upOp || {reRender: true, operateType: OperateType.OPTIONS};\r\n        if (upOp.reRender)\r\n            this.instance?.setState({...this.config})\r\n    }\r\n\r\n\r\n}\r\n","import React, {Component} from 'react';\r\nimport LayerComponent from \"./LayerComponent\";\r\nimport layerListStore from \"./LayerListStore\";\r\nimport {LayerItemDataProps} from \"./LayerItem\";\r\n\r\nexport interface LayerContainerProps {\r\n    item: LayerItemDataProps;\r\n}\r\n\r\nclass LayerContainer extends Component<LayerContainerProps> {\r\n\r\n    layerContainerRef: HTMLDivElement | null = null;\r\n\r\n    componentDidMount() {\r\n        const {layerInstanceMap} = layerListStore;\r\n        const {item} = this.props as LayerContainerProps;\r\n        new LayerComponent().create(this.layerContainerRef!, item).then(r => {\r\n            layerInstanceMap[item.compId!] = r;\r\n        });\r\n    }\r\n\r\n    render() {\r\n        const {item} = this.props as LayerContainerProps;\r\n        return (\r\n            <div id={item.compId + ''} className={'layer-item-container'}\r\n                 ref={ref => this.layerContainerRef = ref}/>\r\n        );\r\n    }\r\n}\r\n\r\nexport default LayerContainer;","import React, {Component, KeyboardEvent} from 'react';\r\nimport './LayerList.less';\r\nimport {Input} from \"antd\";\r\nimport layerListStore from \"./LayerListStore\";\r\nimport designerStore from \"../../store/DesignerStore\";\r\nimport {LayerItemDataProps} from \"./LayerItem\";\r\nimport {observer} from \"mobx-react\";\r\nimport FloatPanel from \"../common/FloatPanel\";\r\nimport eventOperateStore from \"../../operate-provider/EventOperateStore\";\r\nimport eventManager from \"../../operate-provider/core/EventManager\";\r\nimport LayerContainer from \"./LayerContainer\";\r\nimport {MovableItemType} from \"../../../lib/lc-movable/types\";\r\n\r\n//todo 该组件的重新渲染逻辑要重点优化\r\nclass LayerList extends Component {\r\n\r\n    componentDidMount() {\r\n        eventManager.register(\"click\", this.cancelSelected);\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        eventManager.unregister(\"click\", this.cancelSelected);\r\n    }\r\n\r\n    //todo: 想想怎么优化\r\n    cancelSelected = (e: PointerEvent) => {\r\n        const layerListDom = document.querySelector(\".layer-list\");\r\n        if (!layerListDom || !e.target) return;\r\n        if (layerListDom.contains(e.target as Node) && !(e.target as HTMLElement).classList.contains(\"layer-item\")) {\r\n            const {setTargetIds, setTargets} = eventOperateStore;\r\n            setTargetIds([]);\r\n            setTargets([]);\r\n        }\r\n    }\r\n\r\n    onClose = () => {\r\n        const {setVisible} = layerListStore;\r\n        setVisible && setVisible(false);\r\n    }\r\n\r\n    searchLayer = (e: KeyboardEvent<HTMLInputElement>) => {\r\n        const {setContent} = layerListStore;\r\n        const content = (e.target as HTMLInputElement).value;\r\n        // if (content === '') return;\r\n        setContent && setContent(content);\r\n    }\r\n\r\n\r\n    buildLayerList = () => {\r\n        const {layoutConfigs} = designerStore;\r\n        const {targetIds} = eventOperateStore;\r\n        const {searchContent} = layerListStore;\r\n        return Object.values(layoutConfigs)\r\n            .filter((item: MovableItemType) => item.name?.includes(searchContent))\r\n            .sort((a: MovableItemType, b: MovableItemType) => b.order! - a.order!)\r\n            .map((item: MovableItemType, index) => {\r\n                let _props: LayerItemDataProps = {\r\n                    name: item.name,\r\n                    lock: item.locked,\r\n                    hide: item.hide,\r\n                    compId: item.id,\r\n                    selected: targetIds.includes(item.id!)\r\n                }\r\n                return <LayerContainer key={item.id} item={_props}/>\r\n            });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <FloatPanel title={'图层'} onClose={this.onClose} initPosition={{x: 250, y: -window.innerHeight + 50}}\r\n                        className={'layer-list'}>\r\n                <div className={'list-search'}>\r\n                    <Input placeholder=\"搜索图层\" onPressEnter={this.searchLayer}\r\n                           style={{width: '100%'}}/>\r\n                </div>\r\n                <div className={'layer-items'}>\r\n                    {this.buildLayerList()}\r\n                </div>\r\n            </FloatPanel>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(LayerList);","import React, {Component} from 'react';\r\nimport {observer} from \"mobx-react\";\r\nimport CompList from \"./comp-list/CompList\";\r\nimport compListStore from \"./comp-list/CompListStore\";\r\nimport layerListStore from \"./layer-list/LayerListStore\";\r\nimport LayerList from \"./layer-list/LayerList\";\r\n\r\nclass FloatConfigs extends Component {\r\n    render() {\r\n        const {visible: compListVisible} = compListStore;\r\n        const {visible: layerListVisible} = layerListStore;\r\n        return (\r\n            <>\r\n                {compListVisible && <CompList/>}\r\n                {layerListVisible && <LayerList/>}\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(FloatConfigs);","import {action, makeObservable, observable} from \"mobx\";\r\n\r\n/**\r\n * 右键操作菜单的状态管理类。\r\n */\r\nclass ContextMenuStore {\r\n    constructor() {\r\n        makeObservable(this, {\r\n            visible: observable,\r\n            position: observable,\r\n            updateVisible: action,\r\n            setPosition: action,\r\n        })\r\n    }\r\n\r\n    /**\r\n     * 右键菜单显示状态\r\n     */\r\n    visible = false;\r\n    /**\r\n     * 右键菜单位置\r\n     */\r\n    position = [0, 0];\r\n    /**\r\n     * 鼠标按下时间，用于优化。 右键菜单的操作体验。由于长按右键是拖拽整个画布的操作。 在长时间按住右键后。\r\n     * 右键菜单也会显示。为了避免这种情况。 需要在鼠标抬起时。 判断鼠标按下到抬起的时间。如果时间小于200ms则不显示右键菜单。\r\n     */\r\n    mouseDownTime = 0;\r\n    /**\r\n     * 鼠标抬起时间\r\n     */\r\n    mouseUpTime = 0;\r\n\r\n    updateVisible = (visible: boolean) => this.visible = visible;\r\n\r\n    setPosition = (position: number[]) => this.position = position;\r\n\r\n    setMouseDownTime = (time: any) => this.mouseDownTime = time;\r\n\r\n    setMouseUpTime = (time: any) => this.mouseUpTime = time;\r\n\r\n}\r\n\r\nconst contextMenuStore = new ContextMenuStore();\r\nexport default contextMenuStore;","export const KMMap = {\r\n    leftClick: false,\r\n    rightClick: false,\r\n    middleClick: false,\r\n}","import React, {Component, ReactElement, Suspense} from 'react';\r\nimport './DesignerHeader.less';\r\nimport headerStore from \"./HeaderStore\";\r\nimport {observer} from \"mobx-react\";\r\nimport Loading from \"../../lib/loading/Loading\";\r\nimport EditorDesignerLoader from \"../loader/EditorDesignerLoader\";\r\n\r\nconst ProjectHdItemImpl = React.lazy(() => import('./items/project/ProjectHdItemImpl'));\r\nconst CanvasHdConfigImpl = React.lazy(() => import('./items/canvas/CanvasHdConfigImpl'));\r\nconst ThemeHdItemImpl = React.lazy(() => import('./items/theme/ThemeHdItemImpl'));\r\n\r\nclass Header extends Component<any> {\r\n\r\n    buildHeaderList = (): Array<ReactElement> => {\r\n        let items: Array<ReactElement> = [];\r\n        const {headerItemInstances} = EditorDesignerLoader.getInstance();\r\n        for (let i = 0; i < headerItemInstances.length; i++) {\r\n            const {icon: Icon, name, onClick} = headerItemInstances[i];\r\n            items.push(\r\n                <div key={i + ''} className={'right-item'} onClick={onClick}>\r\n                    <span className={'item-span'}><Icon/>&nbsp;{name}</span>\r\n                </div>\r\n            );\r\n        }\r\n        return items;\r\n    }\r\n\r\n    render() {\r\n        const {canvasVisible, projectVisible, themeVisible} = headerStore;\r\n        const items = this.buildHeaderList();\r\n        return (\r\n            <div className={'designer-header'}>\r\n                <div className={'header-left'}>\r\n                    <div className={'header-title'}>L C</div>\r\n                </div>\r\n                <div className={'header-right'}>\r\n                    {items}\r\n                </div>\r\n                {/*todo 想办法让这两个组件不要在这里写死*/}\r\n                {canvasVisible && <Suspense fallback={<Loading/>}><CanvasHdConfigImpl/></Suspense>}\r\n                {projectVisible && <Suspense fallback={<Loading/>}><ProjectHdItemImpl/></Suspense>}\r\n                {themeVisible && <Suspense fallback={<Loading/>}><ThemeHdItemImpl/></Suspense>}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(Header);\r\n","import AbstractDrag from \"./AbstractDrag\";\r\nimport eventManager from \"../core/EventManager\";\r\nimport {KMMap} from \"../hot-key/KeyboardMouse\";\r\nimport scaleCore from \"../scale/ScaleCore\";\r\nimport DragScaleProvider from \"../DragScaleProvider\";\r\n\r\nclass CanvasDragger extends AbstractDrag {\r\n\r\n    constructor(target: any, initPosition?: { x: number, y: number }) {\r\n        super();\r\n        if (!target)\r\n            throw new Error(\"target is null, cannot drag\");\r\n        this.target = target;\r\n        DragScaleProvider.x = initPosition ? initPosition.x : 0;\r\n        DragScaleProvider.y = initPosition ? initPosition.y : 0;\r\n        this.registerDragger();\r\n    }\r\n\r\n    protected onDragEnd = (): void => {\r\n        eventManager.register('pointerup', (e: any) => {\r\n            if (e.button === 2) {\r\n                try {\r\n                    this.target.releasePointerCapture(e.pointerId);\r\n                } catch (e) {\r\n                    console.log(e);\r\n                }\r\n                eventManager.unregister('pointermove', this.onDragMove);\r\n            }\r\n        });\r\n    }\r\n\r\n    protected onDragMove = (e: any): void => {\r\n        if (KMMap.rightClick) {\r\n            DragScaleProvider.x += e.movementX;\r\n            DragScaleProvider.y += e.movementY;\r\n            const {scale} = scaleCore;\r\n            //更新画布位置\r\n            this.target.style.transform = 'translate3d(' + DragScaleProvider.x + 'px, ' + DragScaleProvider.y + 'px, 0) scale(' + scale + ')';\r\n        }\r\n    }\r\n\r\n    protected onDragStart = (): void => {\r\n        eventManager.register('pointerdown', (e: any) => {\r\n            if (e.button === 2) {\r\n                try {\r\n                    this.target.setPointerCapture(e.pointerId);\r\n                } catch (error) {\r\n                    this.target.releasePointerCapture(e.pointerId);\r\n                }\r\n                this.position = {x: e.clientX, y: e.clientY};\r\n                eventManager.register('pointermove', this.onDragMove);\r\n            }\r\n        });\r\n    }\r\n\r\n    destroy = () => {\r\n        eventManager.unregister('pointerdown');\r\n        eventManager.unregister('pointermove');\r\n        eventManager.unregister('pointerup');\r\n    }\r\n\r\n}\r\n\r\nexport default CanvasDragger;","import React, {Component} from 'react';\r\nimport designerStore from \"../store/DesignerStore\";\r\nimport {observer} from \"mobx-react\";\r\nimport CanvasDragger from \"./drag/CanvasDragger\";\r\n\r\n\r\nclass DragScaleProvider extends Component {\r\n\r\n    //画布x坐标（画布拖拽缩放共用）\r\n    public static x: number = 0;\r\n    //画布y坐标（画布拖拽缩放共用）\r\n    public static y: number = 0;\r\n    //画布x偏移量（相对于屏幕）\r\n    public static offsetX: number = 80;\r\n    //画布y偏移量（相对于屏幕）\r\n    public static offsetY: number = 70;\r\n    //画布拖拽缩放容器dom元素引用（画布拖拽缩放共用）\r\n    public static providerRef: HTMLDivElement | null = null;\r\n\r\n    dragger: CanvasDragger | null = null;\r\n\r\n    componentDidMount() {\r\n        //初始化画布位置\r\n        DragScaleProvider.providerRef!.style.transform = 'translate3d(' + DragScaleProvider.x + 'px, ' + DragScaleProvider.y + 'px, 0) scale(1)';\r\n        //初始化画布拖拽器\r\n        this.dragger = new CanvasDragger(DragScaleProvider.providerRef);\r\n        //缩放由快捷键触发（不在此处注册）\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        if (this.dragger)\r\n            this.dragger.destroy();\r\n    }\r\n\r\n    render() {\r\n        const {canvasConfig} = designerStore!;\r\n        return (\r\n            <div style={{\r\n                overflow: \"hidden\",\r\n                height: window.innerHeight - 90,\r\n                width: window.innerWidth - 95,\r\n                backgroundColor: '#434343'\r\n            }}>\r\n                <div ref={ref => DragScaleProvider.providerRef = ref}\r\n                     className={'lc-drag-scale-provider'}\r\n                     style={{width: canvasConfig?.width, height: canvasConfig?.height}}>\r\n                    {this.props.children}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(DragScaleProvider);\r\n","import React, {Component} from 'react';\r\nimport Ruler, {RulerProps} from \"@scena/react-ruler\";\r\nimport {KMMap} from \"../../designer/operate-provider/hot-key/KeyboardMouse\";\r\nimport eventManager from \"../../designer/operate-provider/core/EventManager\";\r\nimport scaleCore from \"../../designer/operate-provider/scale/ScaleCore\";\r\n\r\ninterface DesignerRulerProps {\r\n    offsetX?: number;\r\n    offsetY?: number;\r\n}\r\n\r\n/**\r\n * 缩放计算公式：\r\n * 设现有条件：\r\n * 1) 当前鼠标位置：P\r\n * 2) 当前缩放倍数：S1\r\n * 3) 最新缩放倍数：S2\r\n * 4) 标尺起始位置：St\r\n * 5) 标尺渲染起始位置：scrollPos\r\n * 则：scrollPos = P-[(P-St)/(S2/S1)]\r\n *\r\n * 鼠标移动计算公式：\r\n * 设现有条件：\r\n * 1) 鼠标按下时在当前屏幕分辨路下的真实鼠标位置：mosP\r\n * 2) 标尺当前的起始位置：startP\r\n * 3) 鼠标本次移动的距离：mouOffset\r\n * 4) 标尺当前的缩放系数：scale\r\n * 5) 在当前缩放系数下，鼠标对应的标尺位置：rulerP\r\n *\r\n * 则鼠标指针在当前缩放系数下的位置为：rulerP = startP + (mouOffset / scale)\r\n * 鼠标移动后的标尺起始位置为：scrollPos = startP + (mouOffset / scale)\r\n */\r\nclass DesignerRuler extends Component<RulerProps & DesignerRulerProps> {\r\n\r\n    wheelTimerId: any = null;\r\n    pointerMoveTimerId: any = null;\r\n\r\n    state = {\r\n        render: 0\r\n    }\r\n\r\n    unit = 50;\r\n\r\n    baseOffset = 20;\r\n    _scrollPosX = 0;\r\n    _scrollPosY = 0;\r\n\r\n    rulerX: any = null;\r\n    offsetX = 0;\r\n    mousePosX = 0;\r\n    scrollPosX = 0;\r\n    startPosX = 0;\r\n\r\n    rulerY: any = null;\r\n    offsetY = 0;\r\n    mousePosY = 0;\r\n    scrollPosY = 0;\r\n    startPosY = 0;\r\n\r\n    componentDidMount() {\r\n        const {offsetX: ofX = 0, offsetY: ofY = 0} = this.props;\r\n        eventManager.register('wheel', () => {\r\n            this.startPosX = this.mousePosX - ((this.mousePosX - this.startPosX) / scaleCore.ratio);\r\n            this.scrollPosX = this.startPosX;\r\n            this.startPosY = this.mousePosY - ((this.mousePosY - this.startPosY) / scaleCore.ratio);\r\n            this.scrollPosY = this.startPosY;\r\n            this.unit = Math.floor(50 / scaleCore.scale);\r\n            clearTimeout(this.wheelTimerId);\r\n            this.wheelTimerId = setTimeout(() => {\r\n                this.setState({render: this.state.render + 1})\r\n            }, 400);\r\n        });\r\n\r\n        eventManager.register('pointermove', (e: any) => {\r\n            const {scale} = scaleCore;\r\n            this.mousePosX = this.startPosX + ((e.clientX - this.baseOffset - ofX) / scale);\r\n            this.mousePosY = this.startPosY + ((e.clientY - this.baseOffset - ofY) / scale);\r\n            if (KMMap.rightClick) {\r\n                this.offsetX = this.offsetX - e.movementX;\r\n                this._scrollPosX = this.startPosX + (this.offsetX / scale)\r\n                this.offsetY = this.offsetY - e.movementY;\r\n                this._scrollPosY = this.startPosY + (this.offsetY / scale)\r\n\r\n                clearTimeout(this.pointerMoveTimerId);\r\n                this.pointerMoveTimerId = setTimeout(() => {\r\n                    this.rulerX && this.rulerX.scroll(this._scrollPosX);\r\n                    this.rulerY && this.rulerY.scroll(this._scrollPosY);\r\n                }, 400);\r\n            }\r\n        });\r\n\r\n        eventManager.register('pointerdown', (e: PointerEvent) => {\r\n            if (e.button === 2) {\r\n                this.offsetX = 0;\r\n                this.offsetY = 0;\r\n            }\r\n        });\r\n\r\n        eventManager.register('pointerup', (e: PointerEvent) => {\r\n            if (e.button === 2) {\r\n                this.offsetX = 0;\r\n                this.offsetY = 0;\r\n                this.scrollPosX = this._scrollPosX;\r\n                this.startPosX = this._scrollPosX;\r\n                this.scrollPosY = this._scrollPosY;\r\n                this.startPosY = this._scrollPosY;\r\n            }\r\n        });\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        eventManager.unregister('wheel');\r\n        eventManager.unregister('pointermove');\r\n        eventManager.unregister('pointerdown');\r\n        eventManager.unregister('pointerup');\r\n        clearTimeout(this.wheelTimerId);\r\n        clearTimeout(this.pointerMoveTimerId);\r\n    }\r\n\r\n\r\n    render() {\r\n        const {scale} = scaleCore;\r\n        return (\r\n            <div className={'lc-ruler'} style={{position: 'relative'}}>\r\n                <div style={{\r\n                    position: 'absolute',\r\n                    width: 20,\r\n                    height: 20,\r\n                    color: '#838383',\r\n                    textAlign: 'center',\r\n                    fontSize: 12,\r\n                    top: -1\r\n                }}>px\r\n                </div>\r\n                <div className={'lc-ruler-horizontal'}\r\n                     style={{\r\n                         height: this.baseOffset,\r\n                         width: `calc(100% - ${this.baseOffset}px)`,\r\n                         position: 'relative',\r\n                         left: this.baseOffset\r\n                     }}>\r\n                    <Ruler ref={ref => this.rulerX = ref}\r\n                           scrollPos={this.scrollPosX}\r\n                           zoom={scale}\r\n                           lineColor={'#444b4d'}\r\n                           textColor={'#a6a6a6'}\r\n                           segment={2}\r\n                           negativeRuler={true}\r\n                           textOffset={[0, 10]}\r\n                           backgroundColor={'#090f1d'}\r\n                           unit={this.unit}/>\r\n                </div>\r\n                <div className={'lc-ruler-vertical'}\r\n                     style={{\r\n                         width: this.baseOffset,\r\n                         height: window.innerHeight - this.baseOffset - 90,\r\n                         position: 'relative',\r\n                         overflow: 'hidden'\r\n                     }}>\r\n                    <Ruler ref={ref => this.rulerY = ref}\r\n                           type={'vertical'}\r\n                           scrollPos={this.scrollPosY}\r\n                           lineColor={'#444b4d'}\r\n                           textColor={'#a6a6a6'}\r\n                           zoom={scale}\r\n                           segment={2}\r\n                           negativeRuler={true}\r\n                           textOffset={[10, 0]}\r\n                           backgroundColor={'#090f1d'}\r\n                           unit={this.unit}/>\r\n                </div>\r\n                <div className={'lc-ruler-content'} style={{\r\n                    position: 'absolute',\r\n                    top: this.baseOffset,\r\n                    left: this.baseOffset,\r\n                }}>\r\n                    {this.props.children}\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default DesignerRuler;","import React, {Component} from 'react';\r\n\r\nclass DesignerContainer extends Component {\r\n\r\n    render() {\r\n        return (\r\n            <div style={{outline: 'none'}} className={'lc-event-container'}>\r\n                {this.props.children}\r\n            </div>\r\n        );\r\n    }\r\n}\r\n\r\nexport default DesignerContainer;","import * as React from \"react\";\r\nimport Moveable, {OnResize, OnResizeGroup} from \"react-moveable\";\r\nimport {observer} from \"mobx-react\";\r\nimport eventOperateStore from \"../../designer/operate-provider/EventOperateStore\";\r\nimport designerStore from \"../../designer/store/DesignerStore\";\r\nimport {MovableItemType} from \"./types\";\r\nimport footerStore from \"../../designer/footer/FooterStore\";\r\nimport historyRecordOperateProxy from \"../../designer/operate-provider/undo-redo/HistoryRecordOperateProxy\";\r\n\r\ninterface GroupMovableProps {\r\n    readonly?: boolean;\r\n}\r\n\r\nclass GroupMovable extends React.Component<GroupMovableProps> {\r\n    movableRef = React.createRef<Moveable>();\r\n\r\n    constructor(props: any) {\r\n        super(props);\r\n        this.state = {\r\n            targets: [],\r\n        };\r\n    }\r\n\r\n    componentDidMount() {\r\n        const {setMovableRef} = eventOperateStore;\r\n        setMovableRef(this.movableRef);\r\n    }\r\n\r\n    onDragEnd = (e: any) => {\r\n        const {updateLayout} = designerStore;\r\n        const {setCoordinate} = footerStore;\r\n        let {backoff, setBackoff} = eventOperateStore;\r\n        const {lastEvent, target} = e;\r\n        if (lastEvent) {\r\n            const {beforeTranslate} = lastEvent;\r\n            const data: MovableItemType[] = [\r\n                {\r\n                    id: target.id,\r\n                    width: target.offsetWidth,\r\n                    height: target.offsetHeight,\r\n                    type: target.dataset.type,\r\n                    position: [beforeTranslate[0], beforeTranslate[1]]\r\n                }\r\n            ];\r\n            //更新组件位置信息\r\n            if (backoff) {\r\n                updateLayout(data, false);\r\n                setBackoff(false);\r\n            } else\r\n                historyRecordOperateProxy.doDrag(data)\r\n            //更新footer组件中的坐标信息\r\n            setCoordinate([beforeTranslate[0], beforeTranslate[1]])\r\n        }\r\n    }\r\n\r\n    onDragGroupEnd = (e: any) => {\r\n        const {updateLayout} = designerStore;\r\n        let {backoff, setBackoff, setGroupCoordinate, groupCoordinate} = eventOperateStore;\r\n        let data: MovableItemType[] = [];\r\n        e.events.forEach((ev: any) => {\r\n            const {target, lastEvent} = ev;\r\n            if (lastEvent) {\r\n                const {beforeTranslate} = lastEvent;\r\n                data.push({\r\n                    id: target.id,\r\n                    width: target.offsetWidth,\r\n                    height: target.offsetHeight,\r\n                    type: target.dataset.type,\r\n                    position: [beforeTranslate[0], beforeTranslate[1]]\r\n                })\r\n            }\r\n        })\r\n        //计算多选组件时的坐标信息\r\n        const posChange = e?.lastEvent?.beforeTranslate || [0, 0]\r\n        const minX = groupCoordinate.minX + posChange[0];\r\n        const minY = groupCoordinate.minY + posChange[1];\r\n        setGroupCoordinate({minX, minY})\r\n        //更新组件位置信息并记录操作\r\n        if (data.length > 0) {\r\n            if (backoff) {\r\n                updateLayout(data, false);\r\n                setBackoff(false);\r\n            } else\r\n                historyRecordOperateProxy.doDrag(data)\r\n        }\r\n        //更新footer组件中的最表信息\r\n        const {setCoordinate} = footerStore;\r\n        setCoordinate([minX, minY])\r\n    }\r\n\r\n    onResizeEnd = (e: any) => {\r\n        const {updateLayout} = designerStore;\r\n        let {backoff, setBackoff} = eventOperateStore;\r\n        const {target, lastEvent} = e;\r\n        if (lastEvent) {\r\n            const {width, height, drag: {translate}, direction} = lastEvent;\r\n            const data: MovableItemType[] = [\r\n                {\r\n                    id: target.id,\r\n                    width: width,\r\n                    height: height,\r\n                    type: target.dataset.type,\r\n                    position: [translate[0], translate[1]]\r\n                }\r\n            ];\r\n            //更新组件尺寸信息\r\n            if (backoff) {\r\n                updateLayout(data, false);\r\n                setBackoff(false);\r\n            } else\r\n                historyRecordOperateProxy.doResize(data, direction)\r\n            //更新footer组件中的尺寸和坐标信息\r\n            const {setCoordinate, setSize} = footerStore;\r\n            setCoordinate([translate[0], translate[1]])\r\n            setSize([width, height])\r\n        }\r\n    }\r\n\r\n    onResizeGroupEnd = (e: any) => {\r\n        const {updateLayout} = designerStore;\r\n        let {backoff, setBackoff} = eventOperateStore;\r\n        let data: MovableItemType[] = [];\r\n        e.events.forEach((ev: any) => {\r\n            const {target, lastEvent} = ev;\r\n            if (lastEvent) {\r\n                const {drag: {translate}} = lastEvent;\r\n                data.push({\r\n                    id: target.id,\r\n                    width: target.offsetWidth,\r\n                    height: target.offsetHeight,\r\n                    type: target.dataset.type,\r\n                    position: [translate[0], translate[1]]\r\n                })\r\n            }\r\n        })\r\n        if (!e.lastEvent) return;\r\n        const {dist, direction} = e.lastEvent;\r\n        //更新组件尺寸和坐标信息\r\n        if (data.length > 0) {\r\n            if (backoff) {\r\n                updateLayout(data, false);\r\n                setBackoff(false);\r\n            } else\r\n                historyRecordOperateProxy.doResize(data, direction)\r\n\r\n            //组件多选情况下，重新计算多选组件的尺寸和坐标信息\r\n            const {setGroupCoordinate, groupCoordinate} = eventOperateStore;\r\n            const {setCoordinate, setSize} = footerStore;\r\n            if (direction[0] === -1 || direction[1] === -1) {\r\n                //缩放元素左侧或上侧，此时需要同时改变坐标\r\n                setGroupCoordinate({\r\n                    minX: groupCoordinate.minX! - dist[0],\r\n                    minY: groupCoordinate.minY! - dist[1],\r\n                    groupWidth: groupCoordinate.groupWidth + dist[0],\r\n                    groupHeight: groupCoordinate.groupHeight + dist[1],\r\n                })\r\n                setCoordinate([groupCoordinate.minX!, groupCoordinate.minY!])\r\n            } else {\r\n                setGroupCoordinate({\r\n                    groupWidth: groupCoordinate.groupWidth + dist[0],\r\n                    groupHeight: groupCoordinate.groupHeight + dist[1],\r\n                })\r\n            }\r\n            setSize([groupCoordinate.groupWidth!, groupCoordinate.groupHeight!])\r\n        }\r\n    }\r\n\r\n    onResizeGroup = (e: OnResizeGroup) => {\r\n        e.events.forEach((ev: OnResize) => {\r\n            ev.target.style.width = `${ev.width}px`;\r\n            ev.target.style.height = `${ev.height}px`;\r\n            ev.target.style.transform = ev.drag.transform;\r\n        })\r\n    }\r\n\r\n    onResize = (e: OnResize) => {\r\n        const {target, width, height, drag} = e;\r\n        target.style.width = `${width}px`;\r\n        target.style.height = `${height}px`;\r\n        target.style.transform = `translate(${drag.beforeTranslate[0]}px, ${drag.beforeTranslate[1]}px)`;\r\n    }\r\n\r\n    render() {\r\n        const {readonly = false} = this.props;\r\n        const {selectorRef, targets} = eventOperateStore;\r\n        const {canvasConfig: {rasterize, dragStep, resizeStep}} = designerStore;\r\n        return (\r\n            <>\r\n                {this.props.children}\r\n                <Moveable ref={this.movableRef}\r\n                          target={targets}\r\n                          draggable={!readonly}\r\n                          resizable={!readonly}\r\n                          keepRatio={false}\r\n                          throttleDrag={rasterize ? dragStep : 1}\r\n                          throttleResize={rasterize ? resizeStep : 1}\r\n                          onClickGroup={e => {\r\n                              (selectorRef.current as any)?.clickTarget(e.inputEvent, e.inputTarget);\r\n                          }}\r\n                          onDrag={({target, beforeTranslate}) => {\r\n                              target.style.transform = `translate(${beforeTranslate[0]}px, ${beforeTranslate[1]}px)`;\r\n                          }}\r\n                          onDragEnd={this.onDragEnd}\r\n                          onDragGroup={e => e.events.forEach(ev => ev.target.style.transform = ev.transform)}\r\n                          onDragGroupEnd={this.onDragGroupEnd}\r\n                          onResize={this.onResize}\r\n                          onResizeEnd={this.onResizeEnd}\r\n                          onResizeGroup={this.onResizeGroup}\r\n                          onResizeGroupEnd={this.onResizeGroupEnd}\r\n                />\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(GroupMovable);","import React, {Component} from 'react';\r\nimport Selecto from \"react-selecto\";\r\nimport eventOperateStore from \"../../designer/operate-provider/EventOperateStore\";\r\nimport {observer} from \"mobx-react\";\r\nimport Moveable from 'react-moveable';\r\nimport footerStore from \"../../designer/footer/FooterStore\";\r\nimport designerStore from \"../../designer/store/DesignerStore\";\r\n\r\nclass GroupSelectable extends Component {\r\n    selectorRef = React.createRef<Selecto>();\r\n\r\n    componentDidMount() {\r\n        const {setSelectorRef} = eventOperateStore;\r\n        setSelectorRef(this.selectorRef);\r\n    }\r\n\r\n    onSelectEnd = (e: any) => {\r\n        const {movableRef, setTargets, setTargetIds} = eventOperateStore;\r\n        if (!movableRef) return;\r\n        const movable: Moveable = movableRef!.current!;\r\n        if (e.isDragStart) {\r\n            e.inputEvent.preventDefault();\r\n            setTimeout(() => {\r\n                movable.dragStart(e.inputEvent);\r\n            });\r\n        }\r\n        //排除被锁定的元素\r\n        let selected = e.selected.filter((item: any) => {\r\n            return item.dataset.locked !== 'true';\r\n        });\r\n        //图层若处于显示状态，则同步勾选图层列表中的元素\r\n        if (e.inputEvent.target.className.indexOf('menu-item') === -1) {\r\n            let targetIds: string[] = [];\r\n            selected.forEach((item: any) => targetIds.push(item.id));\r\n            setTargetIds(targetIds);\r\n        }\r\n        //更新选中的组件\r\n        setTargets(selected);\r\n        //若选中多个组件，计算更新组件多选时的左上角坐标\r\n        if (selected.length > 1) {\r\n            let {calculateGroupCoordinate} = eventOperateStore;\r\n            calculateGroupCoordinate(selected);\r\n        }\r\n        //更新底部坐标信息\r\n        let {setCoordinate, setSize} = footerStore;\r\n        const {layoutConfigs} = designerStore;\r\n        if (selected.length === 1) {\r\n            const {position, width, height} = layoutConfigs[selected[0].id];\r\n            setCoordinate([position![0], position![1]]);\r\n            setSize([width!, height!])\r\n        } else if (selected.length > 1) {\r\n            let {groupCoordinate} = eventOperateStore;\r\n            setCoordinate([groupCoordinate.minX!, groupCoordinate.minY!]);\r\n            setSize([groupCoordinate.groupWidth!, groupCoordinate.groupHeight!])\r\n        }\r\n    }\r\n\r\n    onDragStart = (e: any) => {\r\n        const {movableRef, targets} = eventOperateStore;\r\n        const movable: Moveable = movableRef!.current!;\r\n        const target = e.inputEvent.target;\r\n        if ((movable.isMoveableElement(target))\r\n            || targets.some((t: any) => t === target || t.contains(target))\r\n        ) {\r\n            e.stop();\r\n        }\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <>\r\n                {this.props.children}\r\n                <Selecto ref={this.selectorRef}\r\n                         dragContainer={\".lc-event-container\"}\r\n                         selectableTargets={[\".lc-comp-item\"]}\r\n                         hitRate={0}\r\n                         selectByClick={true}\r\n                         selectFromInside={false}\r\n                         toggleContinueSelect={[\"ctrl\"]}\r\n                         ratio={0}\r\n                         onDragStart={this.onDragStart}\r\n                         onSelectEnd={this.onSelectEnd}\r\n                />\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(GroupSelectable);","export default class RenderUtil {\r\n    private static prev: number = 0;\r\n\r\n    public static throttle(fn: Function, delay: number, callback?: Function) {\r\n\r\n        return function (...args: any) {\r\n            const now = Date.now();\r\n            if (now - RenderUtil.prev > delay) {\r\n                fn(...args);\r\n                RenderUtil.prev = now;\r\n            } else {\r\n                callback && callback(...args);\r\n            }\r\n        };\r\n    }\r\n}\r\n","import {HistoryRecordType} from \"../HistoryType\";\r\n\r\n/**\r\n * 撤销回滚抽象接口定义\r\n */\r\nexport default abstract class AbstractRollback {\r\n    /**\r\n     * 撤销\r\n     */\r\n    public abstract undo(record: HistoryRecordType): void;\r\n\r\n    /**\r\n     * 重做\r\n     */\r\n    public abstract redo(record: HistoryRecordType): void;\r\n}","import AbstractRollback from \"./AbstractRollback\";\r\nimport eventOperateStore from \"../../EventOperateStore\";\r\nimport {DragDataType, HistoryRecordType} from \"../HistoryType\";\r\n\r\nexport class DragRollbackImpl extends AbstractRollback {\r\n    redo(record: HistoryRecordType): void {\r\n        if (!record) return;\r\n        const {movableRef, setBackoff, setTargets} = eventOperateStore;\r\n        const {next} = record!;\r\n        let nextRecordData = next! as DragDataType;\r\n        //选中目标元素\r\n        const targets: HTMLElement[] = [];\r\n        nextRecordData.ids.forEach((id) => targets.push(document.getElementById(id)!));\r\n        setTargets(targets);\r\n        setBackoff(true);\r\n        //执行反向操作\r\n        movableRef?.current?.request(\"draggable\", {\r\n            x: nextRecordData!.x,\r\n            y: nextRecordData!.y,\r\n        }, true);\r\n\r\n    }\r\n\r\n    undo(record: HistoryRecordType): void {\r\n        if (!record) return;\r\n        const {movableRef, setBackoff, setTargets} = eventOperateStore;\r\n        const {prev} = record!;\r\n        let prevRecordData = prev! as DragDataType;\r\n        //选中目标元素\r\n        const targets: HTMLElement[] = [];\r\n        prevRecordData.ids.forEach((id) => targets.push(document.getElementById(id)!));\r\n        setTargets(targets);\r\n        setBackoff(true);\r\n        //执行反向操作\r\n        movableRef?.current?.request(\"draggable\", {\r\n            x: prevRecordData!.x,\r\n            y: prevRecordData!.y,\r\n        }, true);\r\n    }\r\n\r\n}\r\n\r\nconst dragRollbackImpl = new DragRollbackImpl();\r\nexport default dragRollbackImpl;","import AbstractRollback from \"./AbstractRollback\";\r\nimport eventOperateStore from \"../../EventOperateStore\";\r\nimport {HistoryRecordType, ResizeDataType} from \"../HistoryType\";\r\n\r\nexport class ResizeRollbackImpl extends AbstractRollback {\r\n    redo(record: HistoryRecordType): void {\r\n        if (!record) return;\r\n        const {movableRef, setBackoff, setTargets} = eventOperateStore;\r\n        const {next} = record!;\r\n        let nextResizeData = next! as ResizeDataType;\r\n        //选中目标元素\r\n        const targets: HTMLElement[] = [];\r\n        nextResizeData.ids.forEach((id) => targets.push(document.getElementById(id)!));\r\n        setTargets(targets);\r\n        setBackoff(true);\r\n        //执行反向操作\r\n        movableRef?.current?.request(\"resizable\", {\r\n            offsetWidth: nextResizeData!.width,\r\n            offsetHeight: nextResizeData!.height,\r\n            direction: nextResizeData!.direction,\r\n        }, true);\r\n    }\r\n\r\n    undo(record: HistoryRecordType): void {\r\n        if (!record) return;\r\n        const {movableRef, setBackoff, setTargets} = eventOperateStore;\r\n        const {prev} = record!;\r\n        let prevResizeData = prev! as ResizeDataType;\r\n        //选中目标元素\r\n        const targets: HTMLElement[] = [];\r\n        prevResizeData.ids.forEach((id) => targets.push(document.getElementById(id)!));\r\n        setTargets(targets);\r\n        setBackoff(true);\r\n        //执行反向操作\r\n        movableRef?.current?.request(\"resizable\", {\r\n            offsetWidth: prevResizeData!.width,\r\n            offsetHeight: prevResizeData!.height,\r\n            direction: prevResizeData!.direction,\r\n        }, true);\r\n    }\r\n\r\n}\r\n\r\nconst resizeRollbackImpl = new ResizeRollbackImpl();\r\nexport default resizeRollbackImpl;","import AbstractRollback from \"./AbstractRollback\";\r\nimport eventOperateStore from \"../../EventOperateStore\";\r\nimport {AddDataType, HistoryRecordType} from \"../HistoryType\";\r\nimport designerStore from \"../../../store/DesignerStore\";\r\n\r\nexport class AddRollbackImpl extends AbstractRollback {\r\n    redo(record: HistoryRecordType): void {\r\n        if (!record) return;\r\n        const {next} = record!;\r\n        //执行正向操作添加元素\r\n        const {addItem} = designerStore;\r\n        (next as AddDataType[]).forEach((item) => addItem(item.data.layoutConfig));\r\n    }\r\n\r\n    undo(record: HistoryRecordType): void {\r\n        if (!record) return;\r\n        const {setTargets} = eventOperateStore;\r\n        const {next} = record!;\r\n        let nextAddData = next! as AddDataType[];\r\n        //执行反向操作删除元素\r\n        const {delItem} = designerStore;\r\n        const delIds: string[] = [];\r\n        nextAddData.forEach((item) => delIds.push(item.id));\r\n        delItem(delIds);\r\n        //清空框选状态,避免空框选\r\n        setTargets([]);\r\n    }\r\n\r\n}\r\n\r\nconst addRollbackImpl = new AddRollbackImpl();\r\nexport default addRollbackImpl;","import AbstractRollback from \"./AbstractRollback\";\r\nimport eventOperateStore from \"../../EventOperateStore\";\r\nimport {DelDataType, HistoryRecordType} from \"../HistoryType\";\r\nimport designerStore from \"../../../store/DesignerStore\";\r\n\r\nexport class DelRollbackImpl extends AbstractRollback {\r\n    redo(record: HistoryRecordType): void {\r\n        if (!record) return;\r\n        const {prev} = record!;\r\n        //执行正向操作删除元素\r\n        const {delItem} = designerStore;\r\n        const delIds: string[] = [];\r\n        (prev as DelDataType[]).forEach((item) => delIds.push(item.id));\r\n        delItem(delIds);\r\n        const {setTargets} = eventOperateStore;\r\n        //清空框选状态,避免空框选\r\n        setTargets([]);\r\n    }\r\n\r\n    undo(record: HistoryRecordType): void {\r\n        if (!record) return;\r\n        const {setTargets} = eventOperateStore;\r\n        const {prev} = record!;\r\n        let prevDelData = prev! as DelDataType[];\r\n        //执行反向操作添加元素\r\n        const {addItem, elemConfigs} = designerStore;\r\n        const targets: HTMLElement[] = [];\r\n        prevDelData.forEach((item) => {\r\n            addItem(item.data.layoutConfig)\r\n            elemConfigs![item.id] = item.data.elemConfig;\r\n            targets.push(document.getElementById(item.id)!);\r\n        });\r\n        //选中目标元素\r\n        setTargets(targets);\r\n    }\r\n\r\n}\r\n\r\nconst delRollbackImpl = new DelRollbackImpl();\r\nexport default delRollbackImpl;","import AbstractRollback from \"./AbstractRollback\";\r\nimport {HistoryRecordType, StyleDataType} from \"../HistoryType\";\r\nimport designerStore from \"../../../store/DesignerStore\";\r\nimport rightStore from \"../../../right/RightStore\";\r\n\r\nexport class StyleRollbackImpl extends AbstractRollback {\r\n    redo(record: HistoryRecordType): void {\r\n        const {next} = record;\r\n        if (next) {\r\n            const {id, data} = next as StyleDataType;\r\n            const {compInstances} = designerStore;\r\n            const instance = compInstances[id];\r\n            if (instance)\r\n                instance.update(data)\r\n            const {visible, setContentVisible} = rightStore;\r\n            //回滚时，若配置项开启，则关闭\r\n            if (visible) {\r\n                setContentVisible(false)\r\n                setTimeout(() => {\r\n                    setContentVisible(true)\r\n                }, 1)\r\n            }\r\n        }\r\n    }\r\n\r\n    undo(record: HistoryRecordType): void {\r\n        const {prev} = record;\r\n        if (prev) {\r\n            const {id, data} = prev as StyleDataType;\r\n            const {compInstances} = designerStore;\r\n            const instance = compInstances[id];\r\n            if (instance)\r\n                instance.update(data)\r\n            const {visible, setContentVisible} = rightStore;\r\n            //回滚时，若配置项开启，则关闭\r\n            if (visible) {\r\n                setContentVisible(false)\r\n                setTimeout(() => {\r\n                    setContentVisible(true)\r\n                }, 1)\r\n            }\r\n        }\r\n    }\r\n\r\n}\r\n\r\nconst styleRollbackImpl = new StyleRollbackImpl();\r\nexport default styleRollbackImpl;","import AbstractRollback from \"./AbstractRollback\";\r\nimport {HideDataType, HistoryRecordType} from \"../HistoryType\";\r\nimport designerStore from \"../../../store/DesignerStore\";\r\nimport layerListStore from \"../../../float-configs/layer-list/LayerListStore\";\r\n\r\n/**\r\n * hide, lock, order的撤销与回滚操作实现\r\n */\r\nexport class HideRollbackImpl extends AbstractRollback {\r\n    redo(record: HistoryRecordType): void {\r\n        if (!record) return;\r\n        const {next} = record;\r\n        const {updateLayout} = designerStore;\r\n        if (next)\r\n            updateLayout(next as HideDataType[]);\r\n        const {visible, layerInstanceMap} = layerListStore;\r\n        if (visible) {\r\n            //图层列表若显示，则需要更新图层列表的组件状态\r\n            (next as HideDataType[])?.forEach((item) => {\r\n                const {id, hide} = item;\r\n                layerInstanceMap[id].update({hide});\r\n            })\r\n        }\r\n    }\r\n\r\n    undo(record: HistoryRecordType): void {\r\n        if (!record) return;\r\n        const {prev} = record;\r\n        const {updateLayout} = designerStore;\r\n        if (prev)\r\n            updateLayout(prev as HideDataType[]);\r\n        const {visible, layerInstanceMap} = layerListStore;\r\n        if (visible) {\r\n            //图层列表若显示，则需要更新图层列表的组件状态\r\n            (prev as HideDataType[])?.forEach((item) => {\r\n                const {id, hide} = item;\r\n                layerInstanceMap[id].update({hide});\r\n            })\r\n        }\r\n    }\r\n\r\n}\r\n\r\nconst hideRollbackImpl = new HideRollbackImpl();\r\nexport default hideRollbackImpl;","import AbstractRollback from \"./AbstractRollback\";\r\nimport {HistoryRecordType, LockDataType} from \"../HistoryType\";\r\nimport designerStore from \"../../../store/DesignerStore\";\r\nimport layerListStore from \"../../../float-configs/layer-list/LayerListStore\";\r\n\r\n/**\r\n * hide, lock, order的撤销与回滚操作实现\r\n */\r\nexport class LockRollbackImpl extends AbstractRollback {\r\n    redo(record: HistoryRecordType): void {\r\n        const {next} = record;\r\n        const {updateLayout} = designerStore;\r\n        if (next)\r\n            updateLayout(next as LockDataType[]);\r\n        const {visible, layerInstanceMap} = layerListStore;\r\n        if (visible) {\r\n            //图层列表若显示，则需要更新图层列表的组件状态\r\n            (next as LockDataType[])?.forEach((item) => {\r\n                const {id, lock} = item;\r\n                layerInstanceMap[id].update({lock});\r\n            })\r\n        }\r\n    }\r\n\r\n    undo(record: HistoryRecordType): void {\r\n        const {prev} = record;\r\n        const {updateLayout} = designerStore;\r\n        if (prev)\r\n            updateLayout(prev as LockDataType[]);\r\n        const {visible, layerInstanceMap} = layerListStore;\r\n        if (visible) {\r\n            //图层列表若显示，则需要更新图层列表的组件状态\r\n            (prev as LockDataType[])?.forEach((item) => {\r\n                const {id, lock} = item;\r\n                layerInstanceMap[id].update({lock});\r\n            })\r\n        }\r\n    }\r\n\r\n}\r\n\r\nconst lockRollbackImpl = new LockRollbackImpl();\r\nexport default lockRollbackImpl;","import AbstractRollback from \"./AbstractRollback\";\r\nimport {HistoryRecordType, OrderDataType} from \"../HistoryType\";\r\nimport designerStore from \"../../../store/DesignerStore\";\r\n\r\n/**\r\n * hide, lock, order的撤销与回滚操作实现\r\n */\r\nexport class OrderRollBackImpl extends AbstractRollback {\r\n    redo(record: HistoryRecordType): void {\r\n        const {next} = record;\r\n        const {updateLayout} = designerStore;\r\n        if (next) updateLayout(next as OrderDataType[]);\r\n    }\r\n\r\n    undo(record: HistoryRecordType): void {\r\n        const {prev} = record;\r\n        const {updateLayout} = designerStore;\r\n        if (prev) updateLayout(prev as OrderDataType[]);\r\n    }\r\n\r\n}\r\n\r\nconst orderRollBackImpl = new OrderRollBackImpl();\r\nexport default orderRollBackImpl;","import {HistoryType} from \"../HistoryType\";\r\nimport AbstractRollback from \"./AbstractRollback\";\r\nimport dragRollbackImpl from \"./DragRollbackImpl\";\r\nimport resizeRollbackImpl from \"./ResizeRollbackImpl\";\r\nimport addRollbackImpl from \"./AddRollbackImpl\";\r\nimport delRollbackImpl from \"./DelRollbackImpl\";\r\nimport styleRollbackImpl from \"./StyleRollbackImpl\";\r\nimport hideRollbackImpl from \"./HideRollbackImpl\";\r\nimport lockRollbackImpl from \"./LockRollbackImpl\";\r\nimport orderRollBackImpl from \"./OrderRollbackImpl\";\r\n\r\nconst undoRedoMap = new Map<HistoryType, AbstractRollback>();\r\nundoRedoMap.set(HistoryType.DRAG, dragRollbackImpl);\r\nundoRedoMap.set(HistoryType.RESIZE, resizeRollbackImpl);\r\nundoRedoMap.set(HistoryType.ADD, addRollbackImpl);\r\nundoRedoMap.set(HistoryType.DEL, delRollbackImpl);\r\nundoRedoMap.set(HistoryType.STYLE, styleRollbackImpl);\r\nundoRedoMap.set(HistoryType.HIDE, hideRollbackImpl);\r\nundoRedoMap.set(HistoryType.LOCK, lockRollbackImpl);\r\nundoRedoMap.set(HistoryType.ORDER, orderRollBackImpl);\r\n\r\nexport default undoRedoMap;","import {Component} from 'react';\r\nimport eventOperateStore from \"../EventOperateStore\";\r\n\r\nexport enum TriggerType {\r\n    SINGLE,\r\n    COILED\r\n}\r\n\r\nexport interface HotKeyConfigType {\r\n    [key: string]: {\r\n        handler: Function,\r\n        target?: any,\r\n        triggerType?: TriggerType\r\n    }\r\n}\r\n\r\ninterface HotKeyProps {\r\n    handlerMapping: HotKeyConfigType;\r\n}\r\n\r\n//需要屏蔽浏览器默认快捷键效果的快捷键列表\r\nconst shieldKeyList = ['control + s', 'alt', 'control + l']\r\n\r\nclass HotKey extends Component<HotKeyProps> {\r\n\r\n    handlerMapping: HotKeyConfigType = {}\r\n    currHotKey: string[] = [];\r\n    existHandlerKey: string = \"\";\r\n\r\n    constructor(props: HotKeyProps) {\r\n        super(props);\r\n        this.handlerMapping = props.handlerMapping;\r\n    }\r\n\r\n    /**\r\n     * 从快捷键配置管理映射表中匹配对应的快捷键处理函数并执行。\r\n     * @param e 鼠标事件对象\r\n     * @param hotKey 当前按下的快捷键\r\n     */\r\n    doHandler = (e: any, hotKey: string) => {\r\n        const {handler, triggerType = TriggerType.SINGLE} = this.handlerMapping[hotKey] || {};\r\n        if (handler) {\r\n            if ((triggerType === TriggerType.SINGLE && this.existHandlerKey !== hotKey) || triggerType === TriggerType.COILED) {\r\n                const {pointerTarget} = eventOperateStore;\r\n                //todo 需要优化快捷键的执行范围\r\n                const enforcementCap = document.querySelector('.lc-ruler-content');\r\n                if (enforcementCap && (enforcementCap.contains(pointerTarget) || (pointerTarget && pointerTarget.classList.contains('layer-item')))) {\r\n                    handler(e);\r\n                    this.existHandlerKey = hotKey;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    keyDown = (e: any) => {\r\n        const key = e.key.toLowerCase();\r\n        if (!this.currHotKey.some(item => item === key))\r\n            this.currHotKey.push(key);\r\n        let hotKey = this.currHotKey.join(' + ');\r\n        if (shieldKeyList.some(item => item === hotKey))\r\n            e.preventDefault();\r\n        this.doHandler(e, hotKey);\r\n    };\r\n\r\n    keyUp = (e: any) => {\r\n        const key = e.key.toLowerCase();\r\n        if (this.currHotKey.some(item => item === key)) {\r\n            this.currHotKey = this.currHotKey.filter(item => item !== key);\r\n            this.existHandlerKey = '';\r\n        }\r\n    }\r\n\r\n    wheel = (e: any) => {\r\n        let hotKey = this.currHotKey.join(' + ') + ' + wheel';\r\n        const {handler, target} = this.handlerMapping[hotKey] || {};\r\n        if (handler) {\r\n            if (target && !target.contains(e.target))\r\n                return;\r\n            handler(e);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 失去焦点时清空当前热键（一般是切换屏幕）\r\n     */\r\n    onBlur = () => {\r\n        this.currHotKey = [];\r\n        this.existHandlerKey = '';\r\n    }\r\n\r\n    componentDidMount() {\r\n        document.addEventListener('keydown', this.keyDown);\r\n        document.addEventListener('keyup', this.keyUp);\r\n        document.addEventListener('wheel', this.wheel);\r\n        window.onblur = this.onBlur;\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        document.removeEventListener('keydown', this.keyDown);\r\n        document.removeEventListener('keyup', this.keyUp);\r\n        document.removeEventListener('wheel', this.wheel);\r\n        window.onblur = null;\r\n    }\r\n\r\n    render() {\r\n        return null;\r\n    }\r\n}\r\n\r\nexport default HotKey;","import eventOperateStore from \"../EventOperateStore\";\r\nimport designerStore from \"../../store/DesignerStore\";\r\nimport {MovableItemType} from \"../../../lib/lc-movable/types\";\r\nimport RenderUtil from \"../../../utils/RenderUtil\";\r\nimport {SaveType} from \"../../DesignerType\";\r\nimport {cloneDeep} from \"lodash\";\r\nimport {message} from \"antd\";\r\nimport EditorDesignerLoader from \"../../loader/EditorDesignerLoader\";\r\nimport {historyOperator} from \"../undo-redo/HistoryOperator\";\r\nimport historyRecordOperateProxy from \"../undo-redo/HistoryRecordOperateProxy\";\r\nimport undoRedoMap from \"../undo-redo/core\";\r\n\r\nexport const selectAll = () => {\r\n    let comps = document.getElementsByClassName('lc-comp-item');\r\n    let compIds: string[] = [];\r\n    let compArr: any[] = [];\r\n    comps && Array.from(comps).forEach((comp: any) => {\r\n        if (comp.dataset.locked !== 'true') {\r\n            compArr.push(comp);\r\n            compIds.push(comp.id);\r\n        }\r\n    });\r\n    const {setTargets, setTargetIds, calculateGroupCoordinate} = eventOperateStore;\r\n    setTargets(compArr);\r\n    setTargetIds(compIds);\r\n\r\n    //计算组件多选时的左上角坐标\r\n    if (compArr.length > 1)\r\n        calculateGroupCoordinate(compArr);\r\n}\r\n\r\nexport const doCopy = () => {\r\n    const {targetIds, setTargetIds, setTargets} = eventOperateStore;\r\n    if (!targetIds || targetIds.length === 0) return;\r\n    const {copyItem} = designerStore;\r\n    let newIds = copyItem(targetIds);\r\n    let targets: any = [];\r\n    //延迟10毫秒，等待dom元素渲染完毕后再获取。\r\n    setTimeout(() => {\r\n        for (const newId of newIds) {\r\n            targets.push(document.getElementById(newId));\r\n        }\r\n        targets.filter((item: any) => item !== null);\r\n        setTargets(targets);\r\n        setTargetIds(newIds);\r\n    }, 10);\r\n}\r\n\r\nexport const doLock = () => {\r\n    const {targetIds, setTargets} = eventOperateStore;\r\n    if (!targetIds || targetIds.length === 0) return;\r\n    const {layoutConfigs} = designerStore;\r\n    let toBeUpdate = [];\r\n    for (const targetId of targetIds) {\r\n        let item = layoutConfigs[targetId];\r\n        toBeUpdate.push({...item, locked: true})\r\n    }\r\n    historyRecordOperateProxy.doLockUpd(toBeUpdate);\r\n    //操作完毕之后，清空已被选择的元素。\r\n    setTargets([]);\r\n}\r\n\r\nexport const doUnLock = () => {\r\n    const {unLockedId} = eventOperateStore;\r\n    if (!unLockedId || unLockedId === '') return;\r\n    const {updateLayout, layoutConfigs} = designerStore;\r\n    let item = layoutConfigs[unLockedId];\r\n    updateLayout([{...item, locked: false}])\r\n    historyRecordOperateProxy.doLockUpd([{...item, locked: false}]);\r\n}\r\n\r\nexport const toTop = () => {\r\n    let {maxLevel, setMaxLevel, targetIds, setTargetIds} = eventOperateStore;\r\n    if (!targetIds || targetIds.length === 0) return;\r\n    const {layoutConfigs} = designerStore;\r\n    let toBeUpdate: MovableItemType[] = [];\r\n    targetIds.forEach((id: string) => {\r\n        let item = layoutConfigs[id];\r\n        toBeUpdate.push({...item, order: ++maxLevel});\r\n    });\r\n    setMaxLevel(maxLevel)\r\n    setTargetIds([]);\r\n    historyRecordOperateProxy.doOrderUpd(toBeUpdate);\r\n}\r\n\r\nexport const toBottom = () => {\r\n    let {minLevel, setMinLevel, targetIds, setTargetIds} = eventOperateStore;\r\n    if (!targetIds || targetIds.length === 0) return;\r\n    const {layoutConfigs} = designerStore;\r\n    let toBeUpdate: MovableItemType[] = [];\r\n    targetIds.forEach((id: string) => {\r\n        let item = layoutConfigs[id];\r\n        toBeUpdate.push({...item, order: --minLevel});\r\n    });\r\n    setMinLevel(minLevel)\r\n    setTargetIds([]);\r\n    historyRecordOperateProxy.doOrderUpd(toBeUpdate);\r\n}\r\n\r\nexport const doDelete = () => {\r\n    historyRecordOperateProxy.doDelete();\r\n}\r\n\r\nexport const doSave = () => {\r\n    RenderUtil.throttle(() => {\r\n        let {projectConfig: {saveType}} = designerStore;\r\n        if (saveType === SaveType.LOCAL) {\r\n            const {projectConfig: {saveType = SaveType.LOCAL}} = designerStore;\r\n            EditorDesignerLoader.getInstance().abstractOperatorMap[saveType].doCreateOrUpdate(cloneDeep(designerStore.getData()));\r\n        } else if (saveType === SaveType.SERVER) {\r\n            alert(\"server save\");\r\n        }\r\n    }, 5000, () => {\r\n        message.warn('保存过于频繁，请稍后再试！')\r\n    })();\r\n\r\n}\r\n\r\nexport const doHide = () => {\r\n    const {targetIds} = eventOperateStore;\r\n    if (!targetIds || targetIds.length === 0) return;\r\n    const {layoutConfigs} = designerStore;\r\n    let toBeUpdate: MovableItemType[] = [];\r\n    targetIds.forEach((id: string) => {\r\n        let item = layoutConfigs[id];\r\n        toBeUpdate.push({...item, hide: true});\r\n    });\r\n    historyRecordOperateProxy.doHideUpd(toBeUpdate);\r\n}\r\n\r\n/*************************快捷键控制移动组件的位置*************************/\r\n\r\nexport const doMoveUp = () => {\r\n    const {targets, movableRef, groupCoordinate} = eventOperateStore;\r\n    const {layoutConfigs, canvasConfig: {dragStep = 1}} = designerStore;\r\n    if (!targets || targets.length === 0) return;\r\n    if (targets.length === 1) {\r\n        let id = targets[0].id;\r\n        let yPos = layoutConfigs[id].position![1] - dragStep;\r\n        movableRef?.current?.request(\"draggable\", {y: yPos}, true);\r\n    } else {\r\n        const yPos = groupCoordinate?.minY! - dragStep;\r\n        movableRef?.current?.request(\"draggable\", {y: yPos}, true);\r\n    }\r\n}\r\n\r\nexport const doMoveDown = () => {\r\n    const {targets, movableRef, groupCoordinate} = eventOperateStore;\r\n    const {layoutConfigs, canvasConfig: {dragStep = 1}} = designerStore;\r\n    if (!targets || targets.length === 0) return;\r\n    if (targets.length === 1) {\r\n        let id = targets[0].id;\r\n        let yPos = layoutConfigs[id].position![1] + dragStep;\r\n        movableRef?.current?.request(\"draggable\", {y: yPos}, true);\r\n    } else {\r\n        const yPos = groupCoordinate?.minY! + dragStep;\r\n        movableRef?.current?.request(\"draggable\", {y: yPos}, true);\r\n    }\r\n}\r\n\r\nexport const doMoveLeft = () => {\r\n    const {targets, movableRef, groupCoordinate} = eventOperateStore;\r\n    const {layoutConfigs, canvasConfig: {dragStep = 1}} = designerStore;\r\n    if (!targets || targets.length === 0) return;\r\n    if (targets.length === 1) {\r\n        let id = targets[0].id;\r\n        let xPos = layoutConfigs[id].position![0];\r\n        movableRef?.current?.request(\"draggable\", {x: xPos - dragStep}, true);\r\n    } else {\r\n        const xPos = groupCoordinate?.minX! - dragStep;\r\n        movableRef?.current?.request(\"draggable\", {x: xPos}, true);\r\n    }\r\n}\r\n\r\nexport const doMoveRight = () => {\r\n    const {targets, movableRef, groupCoordinate} = eventOperateStore;\r\n    const {layoutConfigs, canvasConfig: {dragStep = 1}} = designerStore;\r\n    if (!targets || targets.length === 0) return;\r\n    if (targets.length === 1) {\r\n        let id = targets[0].id;\r\n        let xPos = layoutConfigs[id].position![0];\r\n        movableRef?.current?.request(\"draggable\", {x: xPos + dragStep}, true);\r\n    } else {\r\n        const xPos = groupCoordinate?.minX! + dragStep;\r\n        movableRef?.current?.request(\"draggable\", {x: xPos}, true);\r\n    }\r\n}\r\n\r\n/*************************快捷键控制缩放组件尺寸*************************/\r\n\r\n/**\r\n * 以底部为基准向上扩大\r\n */\r\nexport const doBaseBottomEnlargeUp = () => {\r\n    const {targets, movableRef, groupCoordinate} = eventOperateStore;\r\n    const {layoutConfigs, canvasConfig: {resizeStep = 1}} = designerStore;\r\n    if (!targets || targets.length === 0) return;\r\n    let height;\r\n    if (targets.length === 1) {\r\n        let id = targets[0].id;\r\n        height = layoutConfigs[id].height! + resizeStep;\r\n    } else {\r\n        height = groupCoordinate.groupHeight! + resizeStep;\r\n    }\r\n    movableRef?.current?.request(\"resizable\", {offsetHeight: height, direction: [1, -1]}, true);\r\n}\r\n\r\n/**\r\n * 以顶部为基准向下扩大\r\n */\r\nexport const doBaseUpEnlargeDown = () => {\r\n    const {targets, movableRef, groupCoordinate} = eventOperateStore;\r\n    const {layoutConfigs, canvasConfig: {resizeStep = 1}} = designerStore;\r\n    if (!targets || targets.length === 0) return;\r\n    let height;\r\n    if (targets.length === 1) {\r\n        let id = targets[0].id;\r\n        height = layoutConfigs[id].height! + resizeStep;\r\n    } else {\r\n        height = groupCoordinate.groupHeight! + resizeStep;\r\n    }\r\n    movableRef?.current?.request(\"resizable\", {offsetHeight: height, direction: [1, 1]}, true);\r\n}\r\n\r\n/**\r\n * 以右边为基准向左扩大\r\n */\r\nexport const doBaseRightEnlargeLeft = () => {\r\n    const {targets, movableRef, groupCoordinate} = eventOperateStore;\r\n    const {layoutConfigs, canvasConfig: {resizeStep = 1}} = designerStore;\r\n    if (!targets || targets.length === 0) return;\r\n    let width;\r\n    if (targets.length === 1) {\r\n        let id = targets[0].id;\r\n        width = layoutConfigs[id].width! + resizeStep;\r\n    } else {\r\n        width = groupCoordinate.groupWidth! + resizeStep;\r\n    }\r\n    movableRef?.current?.request(\"resizable\", {offsetWidth: width, direction: [-1, 1]}, true);\r\n}\r\n\r\n/**\r\n * 以左边为基准向右扩大\r\n */\r\nexport const doBaseLeftEnlargeRight = () => {\r\n    const {targets, movableRef, groupCoordinate} = eventOperateStore;\r\n    const {layoutConfigs, canvasConfig: {resizeStep = 1}} = designerStore;\r\n    if (!targets || targets.length === 0) return;\r\n    let width;\r\n    if (targets.length === 1) {\r\n        let id = targets[0].id;\r\n        width = layoutConfigs[id].width! + resizeStep;\r\n    } else {\r\n        width = groupCoordinate.groupWidth! + resizeStep;\r\n    }\r\n    movableRef?.current?.request(\"resizable\", {offsetWidth: width, direction: [1, 1]}, true);\r\n}\r\n\r\n\r\n/**\r\n * 以底部为基准向上缩小\r\n */\r\nexport const doBaseBottomDecreaseUp = () => {\r\n    const {targets, movableRef, groupCoordinate} = eventOperateStore;\r\n    const {layoutConfigs, canvasConfig: {resizeStep = 1}} = designerStore;\r\n    if (!targets || targets.length === 0) return;\r\n    let height;\r\n    if (targets.length === 1) {\r\n        height = layoutConfigs[targets[0].id].height! - resizeStep;\r\n    } else {\r\n        height = groupCoordinate.groupHeight! - resizeStep;\r\n    }\r\n    movableRef?.current?.request(\"resizable\", {offsetHeight: height, direction: [1, -1]}, true);\r\n}\r\n\r\n/**\r\n * 以顶部为基准向下缩小\r\n */\r\nexport const doBaseUpDecreaseDown = () => {\r\n    const {targets, movableRef, groupCoordinate} = eventOperateStore;\r\n    const {layoutConfigs, canvasConfig: {resizeStep = 1}} = designerStore;\r\n    if (!targets || targets.length === 0) return;\r\n    let height;\r\n    if (targets.length === 1) {\r\n        let id = targets[0].id;\r\n        height = layoutConfigs[id].height! - resizeStep;\r\n    } else {\r\n        height = groupCoordinate.groupHeight! - resizeStep;\r\n    }\r\n    movableRef?.current?.request(\"resizable\", {offsetHeight: height, direction: [1, 1]}, true);\r\n}\r\n\r\n/**\r\n * 以右边为基准向左缩小\r\n */\r\nexport const doBaseRightDecreaseLeft = () => {\r\n    const {targets, movableRef, groupCoordinate} = eventOperateStore;\r\n    const {layoutConfigs, canvasConfig: {resizeStep = 1}} = designerStore;\r\n    if (!targets || targets.length === 0) return;\r\n    let width;\r\n    if (targets.length === 1) {\r\n        let id = targets[0].id;\r\n        width = layoutConfigs[id].width! - resizeStep;\r\n    } else {\r\n        width = groupCoordinate.groupWidth! - resizeStep;\r\n    }\r\n    movableRef?.current?.request(\"resizable\", {offsetWidth: width, direction: [-1, 1]}, true);\r\n}\r\n\r\n/**\r\n * 以左边为基准向右缩小\r\n */\r\nexport const doBaseLeftDecreaseRight = () => {\r\n    const {targets, movableRef, groupCoordinate} = eventOperateStore;\r\n    const {layoutConfigs, canvasConfig: {resizeStep = 1}} = designerStore;\r\n    if (!targets || targets.length === 0) return;\r\n    let width;\r\n    if (targets.length === 1) {\r\n        let id = targets[0].id;\r\n        width = layoutConfigs[id].width! - resizeStep;\r\n    } else {\r\n        width = groupCoordinate.groupWidth! - resizeStep;\r\n    }\r\n    movableRef?.current?.request(\"resizable\", {offsetWidth: width, direction: [1, 1]}, true);\r\n}\r\n\r\n\r\n/**\r\n * 撤销\r\n */\r\nexport const undo = () => {\r\n    let record = historyOperator.backoff();\r\n    if (!record) return;\r\n    const {type} = record!;\r\n    undoRedoMap.get(type)?.undo(record!);\r\n}\r\n\r\n/**\r\n * 重做\r\n */\r\nexport const redo = () => {\r\n    let record = historyOperator.forward();\r\n    if (!record) return;\r\n    const {type} = record!;\r\n    undoRedoMap.get(type)?.redo(record!);\r\n}","import React, {Component} from 'react';\r\nimport {observer} from \"mobx-react\";\r\nimport contextMenuStore from \"./ContextMenuStore\";\r\nimport './OperateMenu.less';\r\nimport {\r\n    CopyOutlined,\r\n    DeleteOutlined,\r\n    EyeInvisibleOutlined,\r\n    LockOutlined,\r\n    VerticalAlignBottomOutlined,\r\n    VerticalAlignTopOutlined\r\n} from \"@ant-design/icons\";\r\nimport {doCopy, doDelete, doHide, doLock, doUnLock, toBottom, toTop} from \"../hot-key/HotKeyImpl\";\r\n\r\nclass ContextMenu extends Component {\r\n\r\n    menuList = [\r\n        {\r\n            name: '锁定',\r\n            icon: LockOutlined,\r\n            onClick: doLock,\r\n        },\r\n        {\r\n            name: '解锁',\r\n            icon: LockOutlined,\r\n            onClick: doUnLock,\r\n        },\r\n        {\r\n            name: '隐藏',\r\n            icon: EyeInvisibleOutlined,\r\n            onClick: doHide,\r\n        },\r\n        {\r\n            name: '复制',\r\n            icon: CopyOutlined,\r\n            onClick: doCopy,\r\n        },\r\n        {\r\n            name: '置顶',\r\n            icon: VerticalAlignTopOutlined,\r\n            onClick: toTop,\r\n        },\r\n        {\r\n            name: '置底',\r\n            icon: VerticalAlignBottomOutlined,\r\n            onClick: toBottom,\r\n        },\r\n        {\r\n            name: '删除',\r\n            icon: DeleteOutlined,\r\n            onClick: doDelete,\r\n        },\r\n    ]\r\n\r\n    render() {\r\n        const {visible, position = [0, 0]} = contextMenuStore;\r\n        let menuListDom = [];\r\n        for (let i = 0; i < this.menuList.length; i++) {\r\n            let menuItem = this.menuList[i];\r\n            let Icon = menuItem.icon;\r\n            menuListDom.push(\r\n                <div key={i + ''} className={'menu-item'} onClick={menuItem.onClick}>\r\n                    <label><Icon/></label>\r\n                    <span>{menuItem.name}</span>\r\n                </div>\r\n            )\r\n        }\r\n        return (\r\n            <>\r\n                {visible &&\r\n                <div className={'lc-right-menu'} style={{\r\n                    position: 'fixed',\r\n                    top: position[1],\r\n                    left: position[0]\r\n                }}>\r\n                    {menuListDom}\r\n                </div>}\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(ContextMenu);","import designerStore from \"../../store/DesignerStore\";\r\nimport scaleCore from \"./ScaleCore\";\r\nimport eventManager from \"../core/EventManager\";\r\nimport {KMMap} from \"../hot-key/KeyboardMouse\";\r\nimport footerStore from \"../../footer/FooterStore\";\r\nimport DragScaleProvider from \"../DragScaleProvider\";\r\n\r\nexport const doScale = (e: any) => {\r\n    //如果仍处于拖拽过程中，则不进行缩放\r\n    if (KMMap.rightClick) return;\r\n    //计算缩放比例\r\n    scaleCore.compute(e.deltaY > 0 ? 0 : 1);\r\n    //缩放画布\r\n    scaleCanvas(e);\r\n    //缩放标尺\r\n    eventManager.emit('wheel', e);\r\n    //更新缩放比例显示信息\r\n    const {setScale} = footerStore;\r\n    setScale(scaleCore.scale);\r\n}\r\n\r\nexport const scaleCanvas = (e: any) => {\r\n    let {canvasConfig: {width = 1920, height = 1080}} = designerStore;\r\n    const origin = {\r\n        x: (scaleCore.ratio - 1) * width * 0.5,\r\n        y: (scaleCore.ratio - 1) * height * 0.5\r\n    };\r\n    // 计算偏移量\r\n    DragScaleProvider.x -= (scaleCore.ratio - 1) * (e.clientX - DragScaleProvider.offsetX - DragScaleProvider.x) - origin.x;\r\n    DragScaleProvider.y -= (scaleCore.ratio - 1) * (e.clientY - DragScaleProvider.offsetY - DragScaleProvider.y) - origin.y;\r\n    DragScaleProvider.providerRef!.style.transform = 'translate3d(' + DragScaleProvider.x + 'px, ' + DragScaleProvider.y + 'px, 0) scale(' + scaleCore.scale + ')';\r\n}","import {HotKeyConfigType, TriggerType} from \"./HotKey\";\r\nimport {doScale} from \"../scale/Scaler\";\r\nimport {\r\n    doCopy,\r\n    doDelete,\r\n    doLock,\r\n    doMoveDown,\r\n    doMoveLeft,\r\n    doMoveRight,\r\n    doMoveUp,\r\n    doBaseUpEnlargeDown,\r\n    doBaseRightEnlargeLeft,\r\n    doBaseLeftEnlargeRight,\r\n    doBaseBottomEnlargeUp,\r\n    doSave,\r\n    selectAll,\r\n    toBottom,\r\n    toTop,\r\n    doBaseBottomDecreaseUp, doBaseUpDecreaseDown, doBaseRightDecreaseLeft, doBaseLeftDecreaseRight, undo, redo\r\n} from \"./HotKeyImpl\";\r\n\r\nexport const getHotKeyConfig: HotKeyConfigType = {\r\n    'alt + wheel': {\r\n        handler: doScale,\r\n        triggerType: TriggerType.COILED,\r\n    },\r\n    'control + a': {\r\n        handler: selectAll,\r\n    },\r\n    'control + v': {\r\n        handler: doCopy,\r\n    },\r\n    'control + l': {\r\n        handler: doLock,\r\n    },\r\n    'control + arrowup': {\r\n        handler: toTop,\r\n    },\r\n    'control + arrowdown': {\r\n        handler: toBottom,\r\n    },\r\n    'control + s': {\r\n        handler: doSave,\r\n    },\r\n    'delete': {\r\n        handler: doDelete,\r\n    },\r\n    'control + z': {\r\n        handler: undo,\r\n    },\r\n    'control + shift + z': {\r\n        handler: redo,\r\n    },\r\n    'arrowup': {\r\n        handler: doMoveUp,\r\n        triggerType: TriggerType.COILED,\r\n    },\r\n    'arrowdown': {\r\n        handler: doMoveDown,\r\n        triggerType: TriggerType.COILED,\r\n    },\r\n    'arrowleft': {\r\n        handler: doMoveLeft,\r\n        triggerType: TriggerType.COILED,\r\n    },\r\n    'arrowright': {\r\n        handler: doMoveRight,\r\n        triggerType: TriggerType.COILED,\r\n    },\r\n    'control + shift + arrowup': {\r\n        handler: doBaseBottomEnlargeUp,\r\n        triggerType: TriggerType.COILED,\r\n    },\r\n    'control + shift + arrowdown': {\r\n        handler: doBaseUpEnlargeDown,\r\n        triggerType: TriggerType.COILED,\r\n    },\r\n    'control + shift + arrowleft': {\r\n        handler: doBaseRightEnlargeLeft,\r\n        triggerType: TriggerType.COILED,\r\n    },\r\n    'control + shift + arrowright': {\r\n        handler: doBaseLeftEnlargeRight,\r\n        triggerType: TriggerType.COILED,\r\n    },\r\n    'control + alt + arrowup': {\r\n        handler: doBaseBottomDecreaseUp,\r\n        triggerType: TriggerType.COILED,\r\n    },\r\n    'control + alt + arrowdown': {\r\n        handler: doBaseUpDecreaseDown,\r\n        triggerType: TriggerType.COILED,\r\n    },\r\n    'control + alt + arrowleft': {\r\n        handler: doBaseRightDecreaseLeft,\r\n        triggerType: TriggerType.COILED,\r\n    },\r\n    'control + alt + arrowright': {\r\n        handler: doBaseLeftDecreaseRight,\r\n        triggerType: TriggerType.COILED,\r\n    },\r\n}","import React, {MouseEvent, PureComponent} from 'react';\r\nimport DragScaleProvider from \"../operate-provider/DragScaleProvider\";\r\nimport {observer} from \"mobx-react\";\r\nimport designerStore, {DesignerStore} from \"../store/DesignerStore\";\r\nimport DesignerBackground from \"../../comps/lc/background/DesignerBackground\";\r\nimport rightStore from \"../right/RightStore\";\r\nimport DesignerRuler from \"../../lib/lc-ruler/DesignerRuler\";\r\nimport DesignerContainer from \"../operate-provider/DesignerContainer\";\r\nimport GroupMovable from \"../../lib/lc-movable/GroupMovable\";\r\nimport GroupSelectable from \"../../lib/lc-movable/GroupSelectable\";\r\nimport LcRightMenu from \"../operate-provider/right-click-menu/ContextMenu\";\r\nimport {MovableItemType} from \"../../lib/lc-movable/types\";\r\nimport HotKey from \"../operate-provider/hot-key/HotKey\";\r\nimport {getHotKeyConfig} from \"../operate-provider/hot-key/HotKeyConfig\";\r\nimport ComponentContainer from \"../../framework/core/ComponentContainer\";\r\nimport {isEqual} from \"lodash\";\r\n\r\n/**\r\n * 设计器画布\r\n */\r\nclass DesignerCanvas extends PureComponent<DesignerStore | any> {\r\n\r\n    backgroundRef: DesignerBackground | null = null;\r\n\r\n    state = {\r\n        designerRef: null\r\n    }\r\n\r\n    componentDidMount() {\r\n        this.setState({designerRef: document.querySelector('.lc-ruler-content')});\r\n    }\r\n\r\n    updateActive = (e: MouseEvent<HTMLDivElement>) => {\r\n        let {id, dataset: {type}} = e.target as HTMLDivElement;\r\n        const {activeConfig, activeElem} = rightStore;\r\n        if (isEqual(activeElem, {id, type})) return;\r\n        activeConfig(id, type!);\r\n    }\r\n\r\n    /**\r\n     * 元素生成\r\n     */\r\n    generateElement = () => {\r\n        let {layoutConfigs} = designerStore!;\r\n        const sortLayout = Object.values(layoutConfigs).sort((a: MovableItemType, b: MovableItemType) => a.order! - b.order!);\r\n        return sortLayout.map((item: MovableItemType) => {\r\n            return <ComponentContainer layout={item} key={item.id}/>\r\n        });\r\n    }\r\n\r\n    render() {\r\n        return (\r\n            <>\r\n                <DesignerContainer>\r\n                    <GroupSelectable>\r\n                        <DesignerRuler offsetX={60} offsetY={50}>\r\n                            <DragScaleProvider>\r\n                                <GroupMovable>\r\n                                    <DesignerBackground onClick={this.updateActive}\r\n                                                        ref={ref => this.backgroundRef = ref}>\r\n                                        {this.generateElement()}\r\n                                    </DesignerBackground>\r\n                                </GroupMovable>\r\n                            </DragScaleProvider>\r\n                            <LcRightMenu/>\r\n                        </DesignerRuler>\r\n                    </GroupSelectable>\r\n                </DesignerContainer>\r\n                <HotKey handlerMapping={getHotKeyConfig}/>\r\n            </>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(DesignerCanvas);\r\n\r\n","import React, {Component} from 'react';\r\nimport LcHeader from \"./structure/LcHeader\";\r\nimport LcBody from \"./structure/LcBody\";\r\nimport LcLeft from \"./structure/LcLeft\";\r\nimport LcContent from \"./structure/LcContent\";\r\nimport LcRight from \"./structure/LcRight\";\r\nimport LcStructure from \"./structure/LcStructure\";\r\nimport LcFoot from \"./structure/LcFoot\";\r\nimport DesignerLeft from \"./left\";\r\nimport Right from \"./right\";\r\nimport Footer from \"./footer/Footer\";\r\nimport FloatConfigs from \"./float-configs/FloatConfigs\";\r\nimport contextMenuStore from \"./operate-provider/right-click-menu/ContextMenuStore\";\r\nimport eventOperateStore from \"./operate-provider/EventOperateStore\";\r\nimport eventManager from \"./operate-provider/core/EventManager\";\r\nimport {KMMap} from \"./operate-provider/hot-key/KeyboardMouse\";\r\nimport EditorDesignerLoader from \"./loader/EditorDesignerLoader\";\r\nimport designerStore from \"./store/DesignerStore\";\r\nimport Loading from \"../lib/loading/Loading\";\r\nimport DesignerHeader from \"./header/DesignerHeader\";\r\nimport DesignerCanvas from \"./canvas/DesignerCanvas\";\r\nimport {observer} from \"mobx-react\";\r\n\r\nclass Designer extends Component {\r\n\r\n    constructor(props: any) {\r\n        super(props);\r\n        //加载设计器\r\n        EditorDesignerLoader.getInstance().load();\r\n    }\r\n\r\n    componentDidMount() {\r\n        //加载事件到事件管理器\r\n        registerEventToManager();\r\n        //绑定事件到dom元素\r\n        bindEventToDom();\r\n    }\r\n\r\n    componentWillUnmount() {\r\n        //卸载事件管理器中的事件\r\n        unRegisterEventToManager();\r\n        //卸载dom元素上的事件\r\n        unbindEventToDom();\r\n    }\r\n\r\n    render() {\r\n        const {loaded} = designerStore;\r\n        if (!loaded)\r\n            return <Loading/>;\r\n        return (\r\n            <LcStructure>\r\n                <LcHeader>\r\n                    <DesignerHeader/>\r\n                </LcHeader>\r\n                <LcBody>\r\n                    <LcLeft><DesignerLeft/></LcLeft>\r\n                    <LcContent><DesignerCanvas/></LcContent>\r\n                    <LcRight><Right/></LcRight>\r\n                </LcBody>\r\n                <LcFoot>\r\n                    <Footer/>\r\n                </LcFoot>\r\n                <FloatConfigs/>\r\n            </LcStructure>\r\n        );\r\n    }\r\n}\r\n\r\nexport default observer(Designer);\r\n\r\n/**\r\n * 注册事件到事件管理器\r\n */\r\nfunction registerEventToManager() {\r\n    eventManager.register('click', clickHandler);\r\n    eventManager.register('contextmenu', contextMenuHandler);\r\n    eventManager.register('pointerdown', pointerDownHandler);\r\n    eventManager.register('pointerup', pointerUpHandler);\r\n}\r\n\r\n/**\r\n * 卸载事件管理器中的事件\r\n */\r\nfunction unRegisterEventToManager() {\r\n    eventManager.unregister('click', clickHandler);\r\n    eventManager.unregister('contextmenu', contextMenuHandler);\r\n    eventManager.unregister('pointerdown', pointerDownHandler);\r\n    eventManager.unregister('pointerup', pointerUpHandler);\r\n}\r\n\r\n/**\r\n * 绑定事件到dom元素\r\n */\r\nfunction bindEventToDom() {\r\n    document.addEventListener(\"click\", clickEmit);\r\n    document.addEventListener(\"contextmenu\", contextMenuEmit);\r\n    document.addEventListener(\"pointerdown\", pointerDownEmit);\r\n    document.addEventListener(\"pointermove\", pointerMoveEmit);\r\n    document.addEventListener(\"pointerup\", pointerUpEmit);\r\n}\r\n\r\n/**\r\n * 卸载dom元素上的事件\r\n */\r\nfunction unbindEventToDom() {\r\n    document.removeEventListener(\"click\", clickEmit);\r\n    document.removeEventListener(\"contextmenu\", contextMenuEmit);\r\n    document.removeEventListener(\"pointerdown\", pointerDownEmit);\r\n    document.removeEventListener(\"pointermove\", pointerMoveEmit);\r\n    document.removeEventListener(\"pointerup\", pointerUpEmit);\r\n}\r\n\r\n/*****************事件分发*****************/\r\nconst clickEmit = (event: any) => eventManager.emit('click', event);\r\nconst contextMenuEmit = (event: any) => eventManager.emit('contextmenu', event);\r\nconst pointerDownEmit = (event: any) => eventManager.emit('pointerdown', event);\r\nconst pointerMoveEmit = (event: any) => eventManager.emit('pointermove', event);\r\nconst pointerUpEmit = (event: any) => eventManager.emit('pointerup', event);\r\n\r\n\r\n/*****************事件处理*****************/\r\nconst clickHandler = (event: any) => {\r\n    const {visible, updateVisible} = contextMenuStore;\r\n    if (visible && event.button === 0) {\r\n        //这里添加异步处理的原因：必须要在操作菜单执行点击事件执行之后才能卸载dom元素，不然操作菜单的点击事件会失效。\r\n        setTimeout(() => {\r\n            updateVisible(false);\r\n        });\r\n    }\r\n}\r\n\r\nconst contextMenuHandler = (event: any) => {\r\n    event.preventDefault();\r\n    const {mouseDownTime, mouseUpTime, setPosition, updateVisible} = contextMenuStore;\r\n    const {setUnLockedId} = eventOperateStore;\r\n    let targetArr = ['lc-comp-item', 'moveable-area'];\r\n    if (targetArr.some((item: string) => event.target.classList.contains(item)) && mouseUpTime - mouseDownTime < 200) {\r\n        updateVisible && updateVisible(true);\r\n        setPosition([event.clientX, event.clientY]);\r\n        setUnLockedId(event.target.id);\r\n    } else {\r\n        updateVisible && updateVisible(false);\r\n    }\r\n}\r\n\r\nconst pointerDownHandler = (event: any) => {\r\n    if (event.button === 0) {\r\n        KMMap.leftClick = true;\r\n    } else if (event.button === 2)\r\n        KMMap.rightClick = true;\r\n    const {setMouseDownTime} = contextMenuStore;\r\n    setMouseDownTime(Date.now());\r\n}\r\n\r\nconst pointerUpHandler = (event: any) => {\r\n    if (event.button === 0)\r\n        KMMap.leftClick = false;\r\n    else if (event.button === 2)\r\n        KMMap.rightClick = false;\r\n    const {setMouseUpTime} = contextMenuStore;\r\n    setMouseUpTime(Date.now());\r\n    const {setPointerTarget} = eventOperateStore;\r\n    setPointerTarget(event.target);\r\n}"],"sourceRoot":""}