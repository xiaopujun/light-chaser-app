import{A as z}from"./FontGlobal-I0xzNbJH.js";import{C as T}from"./LayerManager-yWnDoBOm.js";import{r,j as s}from"./index-OsS9UfkW.js";import{l as B,O as H}from"./ObjectUtil-nMvTrJhh.js";import"./mobxreact.esm-rNVktGB7.js";import"./PreviewOpen-nQ2Iv4_U.js";import"./index-K2O65-hP.js";import"./LocalOperator-BbYzoZ36.js";import"./GlobalMessage-FQtvcjbG.js";import"./MainRouter-Z3gK7D7G.js";import"./useZIndex-g2cfol2D.js";import"./FetchUtil-Ivd_z0Im.js";import"./index-APrWN4Qi.js";const $=r.forwardRef((j,t)=>{const[n,o]=r.useState({...j}),i=r.useRef(null),u=r.useRef(null),d=r.useRef(null),f=r.useRef(null),h=r.useRef(null),b=r.useRef({}),g=r.useRef(0);r.useImperativeHandle(t,()=>({updateConfig:e=>o({...e}),setEventHandler:e=>b.current=e,destroy:S}));const v=()=>{"click"in b.current&&b.current.click()},S=()=>{var e;i&&(i.current=null),u&&(u.current=null),d&&(d.current=null),f&&(f.current=null),h&&((e=h.current)==null||e.disconnect()),h.current=null},x=()=>{var l;const{pageSize:e=0}=n.style.body;if(e){const c=((l=i.current)==null?void 0:l.getElementsByClassName("base-table-tr"))||[],m=g.current/e;for(let R=0;R<c.length;R++)c[R].style.height=`${m}px`}};r.useEffect(()=>{i.current&&(g.current=i.current.clientHeight-u.current.clientHeight,h.current=new ResizeObserver(B.debounce(e=>{for(const l of e){const{height:c}=l.contentRect;g.current=c-u.current.clientHeight,d.current&&(d.current.style.height=`${g.current}px`),f.current&&(f.current.style.height=`${g.current}px`)}x()},100)),h.current.observe(i.current),x())},[]);const{columns:a,data:p,header:y,body:E}=n.style,{enableCarousel:N,carouselSpeed:k=3,pageSize:w,...C}=E,A=N?`scroll ${k}s linear infinite`:"none";return w&&x(),s.jsx("div",{className:"base-table",ref:i,onClick:v,children:s.jsxs("table",{children:[s.jsx("thead",{style:{...y},ref:u,children:s.jsx("tr",{children:a&&a.map((e,l)=>s.jsx("th",{style:{width:e.width,fontWeight:y==null?void 0:y.fontWeight,textAlign:e.textAlign},children:e.label},l))})}),s.jsx("tbody",{style:{...C,animation:A},className:"scroll-body",ref:d,children:p&&p.map((e,l)=>s.jsx("tr",{className:"base-table-tr",children:a&&a.map((c,m)=>s.jsx("td",{style:{textAlign:c.textAlign},children:e[c.key]},m))},l))}),s.jsx("tbody",{style:{...C,animation:A},className:"scroll-body",ref:f,children:p&&p.map((e,l)=>s.jsx("tr",{className:"base-table-tr",children:a&&a.map((c,m)=>s.jsx("td",{style:{textAlign:c.textAlign},children:e[c.key]},m))},l))})]})})});class Q extends z{async create(t,n){this.config=n,this.container=t,this.instance=await T.createAndRender(t,$,n)}destroy(){var t;(t=this.instance)==null||t.destroy(),this.instance=null,this.config=null}getConfig(){return this.config}changeData(t){var o,i;const n=H.merge((o=this.config)==null?void 0:o.style,{data:t});(i=this.instance)==null||i.updateConfig(n)}update(t,n){var o;this.config=H.merge(this.config,t),n=n||{reRender:!0},n.reRender&&((o=this.instance)==null||o.updateConfig(this.config))}}export{Q as BaseTableController};
