import{j as e,r as m,R as f}from"./index-CIZzpp4t.js";import{o as h,D as v}from"./index-Ky8VuNT2.js";import{D as P}from"./Dialog-ghulqU4P.js";import d from"./Button-DQqSxazJ.js";import{Grid as G}from"./Grid-Ng_M152z.js";import I from"./NumberInput-M7WGrGB5.js";import k from"./Input-y8ttkQ4v.js";import{g as u}from"./GlobalMessage-b_IUatJJ.js";import{P as J}from"./ProjectItem-zdbForvr.js";import{P as K}from"./Pagination-0FUqSArA.js";const q="/light-chaser-app/assets/default-snapshot-CKE6I4qV.jpg",B=c=>{const s={name:"未命名项目",des:"",width:1920,height:1080},a=t=>{t.preventDefault();const{onOk:j}=c;j&&j(s)},l=()=>{const{onCancel:t}=c;t&&t()},{visible:p=!1}=c;return e.jsx(P,{title:"新建大屏",visible:p,className:"add-new-screen-dialog",onClose:l,children:e.jsxs("form",{onSubmit:a,children:[e.jsx("div",{className:"lc-add-new-screen",children:e.jsxs(G,{gridGap:"15px",columns:2,children:[e.jsx(k,{label:"名称",maxLength:20,defaultValue:s.name,onChange:t=>s.name=t}),e.jsx(k,{label:"描述",maxLength:20,onChange:t=>s.des=t}),e.jsx(I,{label:"宽度",min:300,defaultValue:s.width,onChange:t=>s.width=Number(t)}),e.jsx(I,{label:"高度",min:300,defaultValue:s.height,onChange:t=>s.height=Number(t)})]})}),e.jsxs("div",{className:"add-new-screen-explain",children:[e.jsx("p",{children:"说明："}),e.jsx("p",{children:"1、名称不超过20字，描述不超过60字"}),e.jsx("p",{children:"2、宽度必须≥500，高度必须≥300"})]}),e.jsxs("div",{className:"add-new-screen-footer",children:[e.jsx(d,{type:"submit",children:"创建"}),e.jsx(d,{onClick:l,children:"取消"})]})]})})},H=m.memo(c=>{const{onOk:s,onCancel:a,visible:l}=c;return e.jsxs(P,{title:"删除确认",visible:l,onClose:a,children:[e.jsx("div",{style:{color:"#aeaeae",padding:10},children:"确定要删除该项目吗？"}),e.jsxs("div",{className:"del-pro-confirm",style:{display:"flex",justifyContent:"flex-end",borderTop:"2px solid #272b34",paddingTop:5},children:[e.jsx(d,{onClick:s,children:"确认"}),"  ",e.jsx(d,{onClick:a,children:"取消"})]})]})}),W=c=>{const{onOk:s,onCancel:a,visible:l}=c,p=t=>{t.preventDefault(),s()};return e.jsxs(P,{title:"克隆项目",visible:l,onClose:a,children:[e.jsx("div",{style:{color:"#a7a7a7",padding:10},children:"确认复制吗？"}),e.jsxs("div",{className:"del-pro-confirm",style:{display:"flex",justifyContent:"flex-end",borderTop:"2px solid #272b34",paddingTop:10},children:[e.jsx(d,{onClick:p,children:"确认"}),"   ",e.jsx(d,{onClick:a,children:"取消"})]})]})},te=m.memo(c=>{const{saveType:s}=c,[a,l]=f.useState(!1),[p,t]=f.useState(!1),[j,x]=f.useState(!1),w=m.useRef(""),N=m.useRef(""),[o,C]=f.useState({records:[],total:0,current:1,size:24}),g=(n,r,i)=>{h[s].getProjectInfoPageList({current:n,size:r,searchValue:i}).then(b=>C(b))},O=()=>l(!a),T=n=>{const{name:r,des:i,width:b,height:M}=n,_={name:r,des:i,saveType:s,dataJson:JSON.stringify({canvasManager:{width:b,height:M}})};h[s].createProject(_).then(D=>{var y;D===""?(y=u.messageApi)==null||y.error("创建失败"):(l(!1),window.open(`/light-chaser-app/#/designer?id=${D}&saveType=${s}&mode=${v.EDIT}`,"_blank"),g(o.current,o.size))})},z=()=>l(!1),S=(n,r)=>{switch(r){case"edit":window.open(`/light-chaser-app/#/designer?id=${n}&saveType=${s}&mode=${v.EDIT}`,"_blank");break;case"show":window.open(`/light-chaser-app/#/view?id=${n}&saveType=${s}&mode=${v.VIEW}`,"_blank");break;case"del":w.current=n,t(!0);break;case"clone":N.current=n,x(!0);break}},$=()=>t(!1),E=()=>{h[s].copyProject(N.current).then(n=>{var r,i;n!==""?(x(!1),g(o.current,o.size),(r=u.messageApi)==null||r.success("克隆成功")):(i=u.messageApi)==null||i.error("克隆失败")})},L=()=>x(!1),R=()=>{h[s].deleteProject(w.current).then(n=>{var r;n?(t(!1),g(o.current,o.size)):(r=u.messageApi)==null||r.error("删除失败")})},V=(n,r)=>{h[s].getProjectInfoPageList({current:n,size:r}).then(i=>C(i))},A=n=>{n.key==="Enter"&&h[s].getProjectInfoPageList({current:o.current,size:o.size,searchValue:n.target.value}).then(r=>C(r))};return m.useEffect(()=>{g(o.current,o.size)},[]),e.jsxs("div",{className:"project-list-container",children:[e.jsxs("div",{className:"project-list-header",children:[e.jsx("div",{className:"project-list-header-left",children:e.jsx(k,{className:"list-search",placeholder:"搜索项目",onKeyDown:A})}),e.jsx("div",{className:"project-list-header-right",children:e.jsx(d,{onClick:O,children:"+ 创建"})})]}),e.jsx("div",{className:"project-list",children:o&&o.records.map((n,r)=>e.jsx(J,{id:n.id,name:n.name,cover:n.cover||q,saveType:s,doOperate:S},n.id))}),e.jsx(K,{rootClassName:"project-list-page",defaultCurrent:o==null?void 0:o.current,pageSize:o==null?void 0:o.size,total:o==null?void 0:o.total,onChange:V}),e.jsx(B,{onOk:T,onCancel:z,visible:a}),e.jsx(H,{visible:p,onOk:R,onCancel:$}),e.jsx(W,{onOk:()=>E(),onCancel:L,visible:j})]})});export{te as P};
