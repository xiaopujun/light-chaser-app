var ae=Object.defineProperty;var se=(l,t,e)=>t in l?ae(l,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):l[t]=e;var u=(l,t,e)=>(se(l,typeof t!="symbol"?t+"":t,e),e);import{r as te,j as o}from"./index-Vy1Yw5o7.js";import{v as le,w as ce,O as p}from"./Dialog-Zv92ba_c.js";import{aS as re,aR as pe}from"./LayerManager-GjyFNgYQ.js";import"./MainRouter-JVC0j7bk.js";import"./AntdIcon-H26mUnTY.js";import"./useZIndex-j0u8NYY7.js";import"./Overflow-kXLebS6p.js";import"./GlobalMessage-xEmdGiIb.js";import"./Accordion-3459iFJP.js";import"./Switch-JT6W9IDW.js";import"./UIContainer-Yl49M_pF.js";import"./QuestionCircleOutlined-QjJiUeOP.js";import"./Radio-WoN3Ah2C.js";import"./ColorPicker-EgERoCQ7.js";import"./CardPanel-WUJ30tpk.js";import"./Input-cgMnXtOp.js";import"./Grid-0zq_maPI.js";import"./Button-TSqYfOPg.js";class Ie extends te.Component{constructor(){super(...arguments);u(this,"pieGraphicsChange",e=>{this.props.controller.update({style:e})});u(this,"legendChange",e=>{this.props.controller.update({style:{legend:e}})})}render(){const e=this.props.controller,i=e.getConfig().style;return o.jsxs(o.Fragment,{children:[o.jsx(re,{controller:e}),o.jsx(ye,{onChange:this.pieGraphicsChange,config:i})]})}}const ye=({config:l,onChange:t})=>{var r,f,m,d,b,g,h,k,v,x,S,w,A,F,C,R,j,P,z,I,W,M,G,T,U,O,X,Y,L,E,D,K,_,q,B,H,J,N,Q,V,Z,$;const[e,i]=te.useState(l),y=ie=>{let{id:a,data:n,dataKeyPath:ne,dataFragment:ee,reRender:oe}=ie;if(a==="startAngle"||a==="endAngle")n=Math.PI*n,t&&t(ce.createObjectFromArray(ne,n));else if(a==="titleSwitch")if(n){const s={statistic:{title:{style:{fontSize:12,color:"#fff"},content:"text"}}};t(s),i({...p.merge(e,s)})}else t({statistic:{content:!1}}),i({...p.merge(e,{statistic:{title:!1}})});else if(a==="contentSwitch")if(n){const s={statistic:{content:{style:{fontSize:12,color:"#fff"},content:"content"}}};t(s),i({...p.merge(e,s)})}else t({statistic:{title:!1}}),i({...p.merge(e,{statistic:{content:!1}})});else a==="labelRotate"?t({label:{rotate:n*Math.PI}}):t&&t(ee);oe&&i({...e,...ee})},c={children:[{type:"accordion",label:"图形",children:[{type:"grid",config:{columns:2},children:[{key:"radius",type:"number-input",label:"外径",value:l.radius,config:{min:0,max:1,step:.01}},{id:"startAngle",key:"startAngle",type:"number-input",label:"起始角",value:(l.startAngle||0)/Math.PI,config:{suffix:"Π",min:0,max:2,step:.01}},{key:"innerRadius",type:"number-input",label:"内径",value:l.innerRadius,config:{min:0,max:1,step:.01}},{id:"endAngle",key:"endAngle",type:"number-input",label:"结束角",value:(l.endAngle||2*Math.PI)/Math.PI,config:{suffix:"Π",min:0,max:2,step:.01}},{key:"pieStyle",children:[{key:"stroke",type:"color-picker",label:"描边色",value:"#1c1c1c",config:{showText:!0}},{key:"lineWidth",type:"number-input",label:"描边宽",value:0,config:{min:0,max:30}}]},{key:"color",type:"color-mode",label:"颜色",value:"#1c1c1c",config:{containerStyle:{gridColumn:"1 / 3"}}}]}]},{key:"statistic",type:"accordion",label:"标题",children:[{key:"title",type:"grid",config:{columns:2},children:[{id:"titleSwitch",key:"titleSwitch",type:"switch",label:"开启",value:!!((r=e.statistic)!=null&&r.title)},{rules:"{titleSwitch} === 'true'",children:[{key:"content",type:"input",label:"内容",value:(m=(f=e.statistic)==null?void 0:f.title)==null?void 0:m.content},{key:"style",children:[{key:"fontSize",type:"number-input",label:"字号",value:((g=(b=(d=e.statistic)==null?void 0:d.title)==null?void 0:b.style)==null?void 0:g.fontSize)||12,config:{min:0,max:100}},{key:"fontWeight",type:"number-input",label:"加粗",value:((v=(k=(h=e.statistic)==null?void 0:h.title)==null?void 0:k.style)==null?void 0:v.fontWeight)||500,config:{min:100,max:900,step:100}},{key:"color",type:"color-picker",label:"颜色",value:(w=(S=(x=e.statistic)==null?void 0:x.title)==null?void 0:S.style)==null?void 0:w.color,config:{showText:!0}}]},{key:"offsetX",type:"number-input",label:"x偏移",value:((F=(A=e.statistic)==null?void 0:A.title)==null?void 0:F.offsetX)||0},{key:"offsetY",type:"number-input",label:"y偏移",value:((R=(C=e.statistic)==null?void 0:C.title)==null?void 0:R.offsetY)||0}]}]}]},{key:"statistic",type:"accordion",label:"内容",children:[{key:"content",type:"grid",config:{columns:2},children:[{id:"contentSwitch",key:"contentSwitch",type:"switch",label:"开启",value:!!((j=e.statistic)!=null&&j.content)},{rules:"{contentSwitch} === 'true'",children:[{key:"content",type:"input",label:"内容",value:(z=(P=e.statistic)==null?void 0:P.content)==null?void 0:z.content},{key:"style",children:[{key:"fontSize",type:"number-input",label:"字号",value:((M=(W=(I=e.statistic)==null?void 0:I.content)==null?void 0:W.style)==null?void 0:M.fontSize)||12,config:{min:0,max:100}},{key:"fontWeight",type:"number-input",label:"加粗",value:((U=(T=(G=e.statistic)==null?void 0:G.content)==null?void 0:T.style)==null?void 0:U.fontWeight)||500,config:{min:100,max:900,step:100}},{key:"color",type:"color-picker",label:"颜色",value:(Y=(X=(O=e.statistic)==null?void 0:O.content)==null?void 0:X.style)==null?void 0:Y.color,config:{showText:!0}}]},{key:"offsetX",type:"number-input",label:"x偏移",value:((E=(L=e.statistic)==null?void 0:L.content)==null?void 0:E.offsetX)||0},{key:"offsetY",type:"number-input",label:"y偏移",value:((K=(D=e.statistic)==null?void 0:D.content)==null?void 0:K.offsetY)||0}]}]}]},{type:"accordion",label:"标签",children:[{key:"label",type:"grid",config:{columns:2},children:[{key:"type",type:"select",label:"位置",value:((_=e.label)==null?void 0:_.type)||"inner",config:{options:[{value:"inner",label:"内测"},{value:"outer",label:"外侧"}]}},{key:"offset",type:"number-input",label:"偏移",value:((q=e.label)==null?void 0:q.offset)||0,config:{min:0,max:100}},{key:"style",children:[{key:"fontSize",type:"number-input",label:"字号",value:((H=(B=e.label)==null?void 0:B.style)==null?void 0:H.fontSize)||12,config:{min:0,max:100}},{key:"fontWeight",type:"number-input",label:"加粗",value:((N=(J=e.label)==null?void 0:J.style)==null?void 0:N.fontWeight)||500,config:{min:100,max:900,step:100}},{key:"fill",type:"color-picker",label:"颜色",value:(V=(Q=e.label)==null?void 0:Q.style)==null?void 0:V.fill,config:{showText:!0}}]},{key:"autoRotate",type:"switch",label:"自动旋转",reRender:!0,value:(Z=e.label)==null?void 0:Z.autoRotate},{id:"labelRotate",key:"rotate",type:"number-input",label:"旋转角度",rules:"{autoRotate} === 'false'",value:(($=e.label)==null?void 0:$.rotate)||0,config:{min:0,max:2,step:.01}}]}]}]};return o.jsx(le,{schema:c,onFieldChange:y})},We=({controller:l})=>{var c;const t=(c=l.config)==null?void 0:c.style,e=pe.getDataFieldOptions(l),i={type:"grid",key:"style",config:{columns:2},children:[{type:"select",key:"angleField",label:"角度字段",value:t==null?void 0:t.angleField,config:{options:e}},{type:"select",key:"colorField",label:"颜色字段",value:t==null?void 0:t.colorField,config:{options:e}}]},y=r=>{l.update(r.dataFragment)};return o.jsx(le,{schema:i,onFieldChange:y})};export{We as AntdPieFieldMapping,ye as AntdPieGraphicsConfig,Ie as default};
