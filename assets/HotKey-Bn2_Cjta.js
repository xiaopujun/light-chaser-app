var a=Object.defineProperty;var h=(n,i,t)=>i in n?a(n,i,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[i]=t;var r=(n,i,t)=>h(n,typeof i!="symbol"?i+"":i,t);import{r as u}from"./index-BGb4Vr6r.js";import{e as y}from"./ViewDesignerLoader-DXeK7jRJ.js";import{H as c}from"./DesignerPage-OfuQDMAc.js";import"./mobxreact.esm-DyjwGLY0.js";import"./MainRouter-B1R3Zt_D.js";import"./zoom-BTqsuETn.js";import"./asyncToGenerator-DBB230pG.js";import"./Compact-DzzDZMuf.js";import"./useZIndex-D0JyUzw0.js";import"./pickAttrs-CSoaMUvc.js";import"./index-K8tTczQM.js";import"./button-gJeP7DM-.js";import"./render-B6yvyxXw.js";import"./Input-D61RPOug.js";import"./GlobalMessage-w_89I4zt.js";import"./index-BB2N-NZK.js";import"./index-DOwexXEl.js";import"./FetchUtil-BqQLSZ8D.js";import"./Overflow-BbLqOhED.js";import"./index-DoQ1r5wX.js";import"./Data-Bn-QghVN.js";import"./collapse-BbEVqHco.js";import"./CheckBox-DCpT0jJf.js";import"./NumberInput-DcrVVkIB.js";import"./FontGlobal-iqvzwRTQ.js";import"./PreviewOpen-C5YtI9Jz.js";import"./System-BCu1OiEq.js";import"./ThemeEditor-CmU8Vhay.js";import"./Info-DVVj4iJw.js";const d=["control + s","alt","control + l","control + shift + l","control + h","control + f","control + k","control + 1","control + 2","control + 3","control + 4","control + 5","control + g","control + shift + g"];class Q extends u.Component{constructor(t){super(t);r(this,"handlerMapping",{});r(this,"currHotKey",[]);r(this,"existHandlerKey","");r(this,"specialDomCache",{});r(this,"getSpecialDomCache",t=>{const e=this.specialDomCache[t];if(e)return e;{const o=document.querySelector(t);return o?(this.specialDomCache[t]=o,o):null}});r(this,"doHandler",(t,e)=>{const{handler:o,triggerType:p=c.SINGLE,range:s}=this.handlerMapping[e]||{};if(o&&(p===c.SINGLE&&this.existHandlerKey!==e||p===c.COILED)){const{pointerTarget:l}=y;if(s){const m=this.getSpecialDomCache(s);if(!m||!m.contains(l))return}Array.isArray(o)?o.forEach(m=>m(t)):o(t),this.existHandlerKey=e}});r(this,"keyDown",t=>{var p;const e=(p=t.key)==null?void 0:p.toLowerCase();if(!e)return;this.currHotKey.some(s=>s===e)||this.currHotKey.push(e);const o=this.currHotKey.join(" + ");d.some(s=>s===o)&&t.preventDefault(),this.doHandler(t,o)});r(this,"keyUp",t=>{const e=t.key.toLowerCase();this.currHotKey.some(o=>o===e)&&(this.currHotKey=this.currHotKey.filter(o=>o!==e),this.existHandlerKey="")});r(this,"onBlur",()=>{this.currHotKey=[],this.existHandlerKey=""});this.handlerMapping=t.handlerMapping}componentDidMount(){document.addEventListener("keydown",this.keyDown),document.addEventListener("keyup",this.keyUp),window.onblur=this.onBlur}componentWillUnmount(){document.removeEventListener("keydown",this.keyDown),document.removeEventListener("keyup",this.keyUp),window.onblur=null}render(){return null}}export{Q as default};
