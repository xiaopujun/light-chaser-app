import{A as z}from"./FontGlobal-OJzIEJBO.js";import{C as T}from"./LayerManager-9_OZ_v7l.js";import{r,j as s}from"./index-CIZzpp4t.js";import{l as B,O as H}from"./FetchUtil-FMEOVjjY.js";import"./mobxreact.esm-QmaNsbsC.js";import"./PreviewOpen-ZH2J-uf_.js";import"./index-PQsxm07c.js";import"./index-Ky8VuNT2.js";import"./GlobalMessage-b_IUatJJ.js";import"./MainRouter-LJqlNU58.js";import"./useZIndex-C48Dwtsu.js";const $=r.forwardRef((j,t)=>{const[n,o]=r.useState({...j}),i=r.useRef(null),u=r.useRef(null),d=r.useRef(null),f=r.useRef(null),h=r.useRef(null),p=r.useRef({}),g=r.useRef(0);r.useImperativeHandle(t,()=>({updateConfig:e=>o({...e}),setEventHandler:e=>p.current=e,destroy:S}));const v=()=>{"click"in p.current&&p.current.click()},S=()=>{var e;i&&(i.current=null),u&&(u.current=null),d&&(d.current=null),f&&(f.current=null),h&&((e=h.current)==null||e.disconnect()),h.current=null},x=()=>{var l;const{pageSize:e=0}=n.style.body;if(e){const c=((l=i.current)==null?void 0:l.getElementsByClassName("base-table-tr"))||[],y=g.current/e;for(let R=0;R<c.length;R++)c[R].style.height=`${y}px`}};r.useEffect(()=>{i.current&&(g.current=i.current.clientHeight-u.current.clientHeight,h.current=new ResizeObserver(B.debounce(e=>{for(const l of e){const{height:c}=l.contentRect;g.current=c-u.current.clientHeight,d.current&&(d.current.style.height=`${g.current}px`),f.current&&(f.current.style.height=`${g.current}px`)}x()},100)),h.current.observe(i.current),x())},[]);const{columns:a,data:m,header:b,body:E}=n.style,{enableCarousel:N,carouselSpeed:k=3,pageSize:w,...C}=E,A=N?`scroll ${k}s linear infinite`:"none";return w&&x(),s.jsx("div",{className:"base-table",ref:i,onClick:v,children:s.jsxs("table",{children:[s.jsx("thead",{style:{...b},ref:u,children:s.jsx("tr",{children:a&&a.map((e,l)=>s.jsx("th",{style:{width:e.width,fontWeight:b==null?void 0:b.fontWeight,textAlign:e.textAlign},children:e.label},l))})}),s.jsx("tbody",{style:{...C,animation:A},className:"scroll-body",ref:d,children:m&&m.map((e,l)=>s.jsx("tr",{className:"base-table-tr",children:a&&a.map((c,y)=>s.jsx("td",{style:{textAlign:c.textAlign},children:e[c.key]},y))},l))}),s.jsx("tbody",{style:{...C,animation:A},className:"scroll-body",ref:f,children:m&&m.map((e,l)=>s.jsx("tr",{className:"base-table-tr",children:a&&a.map((c,y)=>s.jsx("td",{style:{textAlign:c.textAlign},children:e[c.key]},y))},l))})]})})});class L extends z{async create(t,n){this.config=n,this.container=t,this.instance=await T.createAndRender(t,$,n)}destroy(){var t;(t=this.instance)==null||t.destroy(),this.instance=null,this.config=null}getConfig(){return this.config}changeData(t){var o,i;const n=H.merge((o=this.config)==null?void 0:o.style,{data:t});(i=this.instance)==null||i.updateConfig(n)}update(t,n){var o;this.config=H.merge(this.config,t),n=n||{reRender:!0},n.reRender&&((o=this.instance)==null||o.updateConfig(this.config))}}export{L as BaseTableController};
