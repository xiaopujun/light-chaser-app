var Et=Object.defineProperty;var zt=(i,l,e)=>l in i?Et(i,l,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[l]=e;var a=(i,l,e)=>(zt(i,typeof l!="symbol"?l+"":l,e),e);import{r as h,A as oe,_ as w,j as s,c as It,e as Fe,f as ie,o as fe,g as me,h as y,i as Ot,k as _,O as Nt,l as ne,L as W,n as Xe,d as v,D as Mt,p as Ke,q as se,s as m,t as Tt,I as Ye,u as De,v as Pt,R as re,w as Se,x as Ht,y as Bt,z as At,C as we,F as _t,M as Vt,H as qe,J as Qe,K as Je,N as Ze,Q as et,T as tt,V as Gt,W as nt,X as $t,Y as Kt,Z as Ut,$ as Wt,a0 as Ft,a1 as Xt,a2 as Yt,a3 as qt,a4 as Qt,a5 as Jt,a6 as Zt,a7 as en,a8 as tn,a9 as nn,aa as sn,ab as rn,ac as on,ad as an,ae as ln,af as cn,ag as dn,ah as hn,ai as un,aj as pn,ak as gn,al as fn,am as mn,an as vn,ao as yn,ap as xn}from"./index-ed455431.js";var Cn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M859.9 168H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zM518.3 355a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V848c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V509.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 355z"}}]},name:"vertical-align-top",theme:"outlined"};const bn=Cn;var st=function(l,e){return h.createElement(oe,w(w({},l),{},{ref:e,icon:bn}))};st.displayName="VerticalAlignTopOutlined";const Ln=h.forwardRef(st);var kn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2Q889.47 375.11 816.7 305l-50.88 50.88C807.31 395.53 843.45 447.4 874.7 512 791.5 684.2 673.4 766 512 766q-72.67 0-133.87-22.38L323 798.75Q408 838 512 838q288.3 0 430.2-300.3a60.29 60.29 0 000-51.5zm-63.57-320.64L836 122.88a8 8 0 00-11.32 0L715.31 232.2Q624.86 186 512 186q-288.3 0-430.2 300.3a60.3 60.3 0 000 51.5q56.69 119.4 136.5 191.41L112.48 835a8 8 0 000 11.31L155.17 889a8 8 0 0011.31 0l712.15-712.12a8 8 0 000-11.32zM149.3 512C232.6 339.8 350.7 258 512 258c54.54 0 104.13 9.36 149.12 28.39l-70.3 70.3a176 176 0 00-238.13 238.13l-83.42 83.42C223.1 637.49 183.3 582.28 149.3 512zm246.7 0a112.11 112.11 0 01146.2-106.69L401.31 546.2A112 112 0 01396 512z"}},{tag:"path",attrs:{d:"M508 624c-3.46 0-6.87-.16-10.25-.47l-52.82 52.82a176.09 176.09 0 00227.42-227.42l-52.82 52.82c.31 3.38.47 6.79.47 10.25a111.94 111.94 0 01-112 112z"}}]},name:"eye-invisible",theme:"outlined"};const jn=kn;var rt=function(l,e){return h.createElement(oe,w(w({},l),{},{ref:e,icon:jn}))};rt.displayName="EyeInvisibleOutlined";const wn=h.forwardRef(rt);var Dn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"}}]},name:"copy",theme:"outlined"};const Rn=Dn;var ot=function(l,e){return h.createElement(oe,w(w({},l),{},{ref:e,icon:Rn}))};ot.displayName="CopyOutlined";const Sn=h.forwardRef(ot);var En={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"};const zn=En;var it=function(l,e){return h.createElement(oe,w(w({},l),{},{ref:e,icon:zn}))};it.displayName="LockOutlined";const Ue=h.forwardRef(it);var In={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M859.9 780H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zM505.7 669a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V176c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8z"}}]},name:"vertical-align-bottom",theme:"outlined"};const On=In;var at=function(l,e){return h.createElement(oe,w(w({},l),{},{ref:e,icon:On}))};at.displayName="VerticalAlignBottomOutlined";const Nn=h.forwardRef(at);class Mn extends h.Component{render(){return s.jsx("div",{className:"structure-header",children:this.props.children})}}class Tn extends h.Component{render(){return s.jsx("div",{className:"structure-body",children:this.props.children})}}class Pn extends h.Component{render(){return s.jsx("div",{className:"structure-body-left",children:this.props.children})}}class Hn extends h.Component{render(){return s.jsx("div",{id:"structureContent",className:"structure-body-content",children:this.props.children})}}class Bn extends h.Component{render(){return s.jsx("div",{className:"structure-body-right",children:this.props.children})}}class An extends h.Component{render(){return s.jsx("div",{className:"lc-designer-structure",children:this.props.children})}}class _n extends h.Component{render(){return s.jsx("div",{className:"structure-foot",children:this.props.children})}}var b=(i=>(i.ALL="all",i.BASE="base",i.ORNAMENTAL="ornamental",i.BAR="bar",i.COLUMN="column",i.LINE="line",i.AREA="area",i.PIE="pie",i.PROGRESS="progress",i.SCATTER="scatter",i.RADAR="radar",i.ROSE="rose",i.WORD_CLOUD="word_cloud",i.HISTOGRAM="histogram",i.SUNBURST="sunburst",i.TREEMAP="treemap",i))(b||{});const Vn="/light-chaser-app/assets/icon-all-f9f00824.svg",Gn="/light-chaser-app/assets/icon-bar-f92f84a7.svg",$n="/light-chaser-app/assets/icon-column-e9b14410.svg",Kn="/light-chaser-app/assets/icon-area-402a8724.svg",Un="/light-chaser-app/assets/icon-pie-2e2d1ba2.svg",Wn="/light-chaser-app/assets/icon-scatter-52100b79.svg",Fn="/light-chaser-app/assets/icon-line-c6de27ac.svg",Xn="/light-chaser-app/assets/icon-loading-f6e3585b.svg",Yn="/light-chaser-app/assets/icon-flowers-c5648457.svg",qn="/light-chaser-app/assets/icon-optimize-5a4981d5.svg",Qn="/light-chaser-app/assets/icon-points-2e2b718b.svg",Jn=()=>[{icon:Vn,name:"全部",classify:b.ALL},{icon:Qn,name:"基础",classify:b.BASE},{icon:qn,name:"装饰",classify:b.ORNAMENTAL},{icon:Gn,name:"条形图",classify:b.BAR},{icon:$n,name:"柱状图",classify:b.COLUMN},{icon:Fn,name:"折线图",classify:b.LINE},{icon:Kn,name:"面积图",classify:b.AREA},{icon:Un,name:"饼图",classify:b.PIE},{icon:Xn,name:"进度图",classify:b.PROGRESS},{icon:Wn,name:"散点图",classify:b.SCATTER},{icon:Yn,name:"玫瑰图",classify:b.ROSE}];class Zn{constructor(){a(this,"classifies",[]);a(this,"classifyKey","all");a(this,"doInit",()=>{this.classifies=Jn()});a(this,"doClear",()=>{this.classifies=[]});a(this,"setClassifyKey",l=>{this.classifyKey=l});It(this)}}const ge=new Zn;class es{constructor(){a(this,"compInfoArr",[]);a(this,"compKey","");a(this,"visible",!1);a(this,"doInit",()=>{const l=[],{customComponentInfoMap:e}=ie.getLoader();e&&Object.keys(e).forEach(t=>{let n=e[t].getBaseInfo();n.compKey!=="LcBg"&&l.push(n)}),this.compInfoArr=l});a(this,"setVisible",l=>this.visible=l);a(this,"setCompKey",l=>this.compKey=l);Fe(this,{compKey:fe,visible:fe,setVisible:me,setCompKey:me})}}const F=new es;class ts extends h.Component{constructor(e){super(e);a(this,"changeClassifyKey",e=>{const{setClassifyKey:t}=ge,{setVisible:n,visible:o}=F;t(e.currentTarget.id),o||n&&n(!0)});a(this,"buildClassifyList",()=>{const{classifies:e}=ge;let t=[];for(let n=0;n<e.length;n++){const{icon:o,name:r,classify:c}=e[n];t.push(s.jsxs("div",{className:"sort-item",id:c,onClick:this.changeClassifyKey,children:[s.jsx("div",{className:"sort-item-icon",children:s.jsx("img",{style:{width:20},src:o,alt:"all"})}),s.jsx("span",{className:"sort-item-content",children:r})]},n+""))}return t});const{doInit:t}=ge;t&&t()}render(){const e=this.buildClassifyList();return s.jsx("div",{className:"lc-charts-sort",style:{overflowY:"scroll"},children:e})}}const ns=y(ts);class ss extends h.Component{render(){return s.jsx(ns,{})}}const rs=y(ss);class os extends h.Component{constructor(){super(...arguments);a(this,"menuChange",e=>{const{setActiveMenu:t,setContentVisible:n}=_;t&&t(e.currentTarget.id),n&&n(!0)});a(this,"buildMenuList",()=>{const{menus:e}=_;return e.length===0?s.jsxs("div",{style:{writingMode:"vertical-rl",color:"#ced2d8",letterSpacing:"8px",padding:7,fontSize:12},children:[s.jsx(Ot,{style:{fontSize:15,position:"relative",left:2,marginBottom:7}}),"双击组件激活..."]}):e.map(t=>{const n=t.icon;return s.jsxs("div",{className:"menu-item",id:t.key,onClick:this.menuChange,children:[s.jsx("div",{className:"item-icon",children:s.jsx(n,{})}),s.jsx("div",{className:"item-content",children:t.name})]},t.key)})})}render(){return s.jsx("div",{className:"lc-config-menu",children:s.jsx("div",{className:"menu-list",children:this.buildMenuList()})})}}const is=y(os);class as extends h.Component{constructor(){super(...arguments);a(this,"createProxy",e=>new Proxy(e,{get(t,n){const o=t[n];return typeof o=="function"&&o.name==="update"?new Proxy(o,{apply(r,c,u){const p=u[0],g=Nt.getOriginValue(c.config,u[0]);return ne.doStyleUpd(p,g),r.apply(c,u)}}):o}}));a(this,"buildConfigContent",()=>{const{compInstances:e}=v;let{activeMenu:t,activeElem:n}=_,o=ie.getLoader().customComponentInfoMap[n.type+""];if(!o)return;const c=o.getMenuToConfigContentMap()[t],u=this.createProxy(e[n.id+""]);return s.jsx(h.Suspense,{fallback:s.jsx(W,{}),children:s.jsx(c,{controller:u})})});a(this,"onClose",()=>{const{setContentVisible:e}=_;e&&e(!1)})}render(){const{activeMenu:e,menus:t}=_;let n="";for(let o=0;o<t.length;o++)if(t[o].key===e){n=t[o].name;break}return s.jsxs("div",{className:"lc-config-panel",children:[s.jsxs("div",{className:"lc-panel-top",children:[s.jsx("div",{className:"panel-title",children:s.jsx("span",{children:n})}),s.jsx("div",{className:"panel-operate",onClick:this.onClose,children:s.jsx(Xe,{})})]}),s.jsx("div",{className:"lc-panel-content",children:this.buildConfigContent()})]})}}const ls=y(as);class cs extends h.Component{render(){const{visible:l}=_;return s.jsxs(s.Fragment,{children:[s.jsx(is,{}),l&&s.jsx(ls,{})]})}}const ds=y(cs);class hs extends h.Component{constructor(){super(...arguments);a(this,"hotkeys",[{name:"保存项目",key:"ctrl + s"},{name:"复制组件",key:"ctrl + v"},{name:"锁定组件",key:"ctrl + l"},{name:"解锁组件",key:"ctrl + shift + l"},{name:"隐藏组件",key:"ctrl + h"},{name:"开/关辅助边框",key:"ctrl + k"},{name:"元素置顶",key:"ctrl + up-arrow(方向上键)"},{name:"元素置底",key:"ctrl + down-arrow(方向下键)"},{name:"删除组件",key:"delete"},{name:"缩放画布",key:"alt + wheel(鼠标滑轮)"},{name:"拖拽画布",key:"长按鼠标右键"},{name:"组件上移",key:"方向上键"},{name:"组件下移",key:"方向下键"},{name:"组件左移",key:"方向左键"},{name:"组件右移",key:"方向右键"},{name:"组件上扩大",key:"ctrl + shift + 方向上键"},{name:"组件下扩大",key:"ctrl + shift + 方向下键"},{name:"组件左扩大",key:"ctrl + shift + 方向左键"},{name:"组件右扩大",key:"ctrl + shift + 方向右键"},{name:"组件上缩小",key:"ctrl + alt + 方向上键"},{name:"组件下缩小",key:"ctrl + alt + 方向下键"},{name:"组件左缩小",key:"ctrl + alt + 方向左键"},{name:"组件右缩小",key:"ctrl + alt + 方向右键"},{name:"撤销",key:"ctrl + z"},{name:"重做",key:"ctrl + shift + z"},{name:"打开/关闭项目设置",key:"ctrl + 1"},{name:"打开/关闭画布设置",key:"ctrl + 2"},{name:"打开/关闭全局主题设置",key:"ctrl + 3"},{name:"打开/关闭图层",key:"ctrl + 4"},{name:"打开/关闭快捷键说明",key:"ctrl + 5"},{name:"编组",key:"ctrl + g"},{name:"解除编组",key:"ctrl + shift + g"}])}render(){return s.jsx("div",{className:"lc-hotkey-des",style:{color:"white"},children:this.hotkeys.map((e,t)=>s.jsxs("div",{className:"hotkey-des-item",children:[s.jsx("div",{className:"hotkey-content",children:s.jsx("code",{children:e.key})}),s.jsx("div",{className:"hotkey-des",children:e.name})]},t))})}}const us="/light-chaser-app/assets/keyboard-icon-11886aee.svg",ps="/light-chaser-app/assets/layers-icon-a0d92a74.svg";class gs extends h.Component{constructor(){super(...arguments);a(this,"toggleHotKeyDes",()=>{const{hotKeyVisible:e,setHotKeyVisible:t}=Ke;t(!e)});a(this,"toggleLayerList",()=>{const{setVisible:e,visible:t}=se;e&&e(!t)})}render(){const{layoutConfigs:e,projectConfig:{name:t,state:n}}=v,{hotKeyVisible:o}=Ke,{scale:r}=m;let c="";switch(n){case"0":c="草稿";break;case"1":c="发布";break;case"2":c="封存";break}return s.jsxs("div",{className:"lc-designer-footer",children:[s.jsxs("div",{className:"footer-left",children:[s.jsxs("div",{className:"footer-item",onClick:this.toggleHotKeyDes,children:[s.jsx("img",{width:16,alt:"快捷键",src:us})," ",s.jsx("span",{style:{position:"relative",top:2},children:"快捷键"})]}),s.jsxs("div",{className:"footer-item",onClick:this.toggleLayerList,children:[s.jsx("img",{width:16,alt:"图层",src:ps})," ",s.jsx("span",{style:{position:"relative",top:2},children:"图层"})]})]}),s.jsxs("div",{className:"footer-right",children:[s.jsxs("div",{className:"right-info-item",children:["缩放 : ",(r*100).toFixed(0),"%"]}),s.jsxs("div",{className:"right-info-item",children:["当前组件数 : ",Object.keys(e).length]}),s.jsxs("div",{className:"right-info-item",children:["项目 : ",t]}),s.jsxs("div",{className:"right-info-item",children:["状态 : ",c]})]}),s.jsx(Mt,{title:"快捷键说明",visible:o,width:500,onClose:this.toggleHotKeyDes,children:s.jsx(hs,{})})]})}}const fs=y(gs);class ms{constructor(){a(this,"target",null);a(this,"dragTarget",null);a(this,"position",{x:0,y:0})}registerDragger(){this.onDragStart(this.target),this.onDragEnd(this.target)}}class vs extends ms{constructor(e,t,n){super();a(this,"position",{x:0,y:0});a(this,"onDragEnd",()=>{this.dragTarget.addEventListener("pointerup",e=>{e.button===0&&(this.dragTarget.releasePointerCapture(e.pointerId),this.dragTarget.removeEventListener("pointermove",this.onDragMove))})});a(this,"onDragMove",e=>{this.position.x+=e.movementX,this.position.y+=e.movementY,this.target.style.transform="translate("+this.position.x+"px, "+this.position.y+"px)"});a(this,"onDragStart",()=>{this.dragTarget.addEventListener("pointerdown",e=>{e.button===0&&(this.dragTarget.setPointerCapture(e.pointerId),this.dragTarget.addEventListener("pointermove",this.onDragMove))})});this.target=e,this.dragTarget=t,this.registerDragger(),n&&(this.position=n)}}class lt extends h.Component{constructor(){super(...arguments);a(this,"panelRef",null);a(this,"dragTargetRef",null);a(this,"onClose",()=>{const{onClose:e}=this.props;e&&e()})}componentDidMount(){const{initPosition:e={x:0,y:0}}=this.props;this.dragTargetRef&&this.panelRef&&new vs(this.panelRef,this.dragTargetRef,e)}render(){const{initPosition:e={x:0,y:0},title:t,className:n,width:o}=this.props;return s.jsxs("div",{className:`float-panel ${n}`,style:{transform:`translate(${e.x}px, ${e.y}px)`,width:o},ref:r=>this.panelRef=r,children:[s.jsxs("div",{className:"panel-title",children:[s.jsx("div",{className:"title-left",children:t}),s.jsx("div",{ref:r=>this.dragTargetRef=r,className:"title-drag-target",style:{width:"50%",height:"100%"}}),s.jsx("div",{className:"title-right",onClick:this.onClose,children:s.jsx("span",{children:s.jsx(Xe,{})})})]}),this.props.children]})}}class ys extends h.Component{constructor(e){super(e);a(this,"dragStart",e=>{if(e.target.classList.contains("droppable-element")){const t=e.target;e.dataTransfer.setData("type",t.getAttribute("data-type")),e.dataTransfer.setData("name",t.getAttribute("data-name"))}});a(this,"dragover",e=>{e.preventDefault()});a(this,"drop",e=>{e.preventDefault();const t=e.dataTransfer.getData("type"),n=e.dataTransfer.getData("name"),{scale:o,dsContentRef:r}=m,c=r==null?void 0:r.getBoundingClientRect(),u=(e.clientX-((c==null?void 0:c.x)||0))/o,p=(e.clientY-((c==null?void 0:c.y)||0))/o;this.addItem(t,n,[u,p])});a(this,"addItem",(e,t,n)=>{const{addItem:o}=v;let{maxLevel:r,setMaxLevel:c,setAddRecordCompId:u}=m,p={name:t,type:e,width:320,height:200,position:n||[0,0],id:Tt.generateId(),lock:!1,hide:!1,order:++r};u(p.id),c&&c(r),o&&o(p)});a(this,"getChartDom",()=>{let e=[],{classifyKey:t}=ge,{compInfoArr:n,compKey:o}=F;t!=="all"&&(n=n.filter(r=>r.typeKey===t)),o!==""&&(n=n.filter(r=>r.compName.indexOf(o)>=0));for(let r=0;r<n.length;r++){let c=n[r];const{compName:u,compKey:p}=c;let f=ie.getLoader().customComponentInfoMap[p].getChartImg();e.push(s.jsx("div",{className:"list-item droppable-element",draggable:!0,onDoubleClick:()=>this.addItem(p,u),"data-type":p,"data-name":u,children:s.jsxs("div",{style:{pointerEvents:"none"},children:[s.jsxs("div",{className:"item-header",ref:"drag-target",children:[s.jsx("div",{className:"item-name",children:u}),s.jsx("div",{className:"item-type",children:"Antd"})]}),s.jsx("div",{className:"item-content",children:s.jsx("img",{src:f,alt:"组件预览图"})})]})},r+""))}return e});a(this,"onClose",()=>{const{setVisible:e}=F;e&&e(!1)});a(this,"searchChart",e=>{const{setCompKey:t}=F;t&&t(e)});const{doInit:t}=F;t&&t()}componentDidMount(){const e=document.getElementById("designer-ds-content"),t=document.getElementById("component-drag-container");t&&t.addEventListener("dragstart",this.dragStart),e&&e.addEventListener("dragover",this.dragover),e&&e.addEventListener("drop",this.drop)}componentWillUnmount(){const e=document.getElementById("designer-ds-content"),t=document.getElementById("component-drag-container");t&&t.removeEventListener("dragstart",this.dragStart),e&&e.removeEventListener("dragover",this.dragover),e&&e.removeEventListener("drop",this.drop)}render(){return s.jsxs(lt,{className:"comp-list",title:"组件列表",onClose:this.onClose,initPosition:{x:60,y:-window.innerHeight+50},width:190,children:[s.jsx("div",{className:"list-search",children:s.jsx(Ye,{placeholder:"搜索图层",onChange:this.searchChart})}),s.jsx("div",{className:"list-items",id:"component-drag-container",children:this.getChartDom()})]})}}const xs=y(ys);class Cs extends h.Component{constructor(){super(...arguments);a(this,"floatPanelRef",null);a(this,"layerItemsContainerRef",null);a(this,"cancelSelected",e=>{var n;if(!this.floatPanelRef)return;const{panelRef:t}=this.floatPanelRef;if(t&&t.contains(e.target)&&!((n=this.layerItemsContainerRef)!=null&&n.contains(e.target))){const{setTargetIds:o,targetIds:r}=m;r.length>0&&o([])}});a(this,"onClose",()=>{const{setVisible:e}=se;e&&e(!1)});a(this,"searchLayer",e=>{const{setContent:t}=se;t&&t(e)});a(this,"buildLayerList",()=>{const{layoutConfigs:e}=v,{searchContent:t}=se;if(!t||t==="")return De.buildLayerList(e);let n={};return t===":hide"?Object.values(e).forEach(r=>{r.hide&&r.type!=="group"&&(n[r.id]=r)}):t===":lock"?Object.values(e).forEach(r=>{r.lock&&r.type!=="group"&&(n[r.id]=r)}):Object.values(e).forEach(r=>{var c;(c=r.name)!=null&&c.includes(t)&&r.type!=="group"&&(n[r.id]=r)}),Pt.findPathGroupLayer(Object.keys(n)).forEach(r=>{n[r]=e[r]}),De.buildLayerList(n)})}componentDidMount(){var e,t;(t=(e=this.floatPanelRef)==null?void 0:e.panelRef)==null||t.addEventListener("click",this.cancelSelected)}componentWillUnmount(){var e,t;(t=(e=this.floatPanelRef)==null?void 0:e.panelRef)==null||t.removeEventListener("click",this.cancelSelected)}render(){return s.jsxs(lt,{ref:e=>this.floatPanelRef=e,title:"图层",onClose:this.onClose,initPosition:{x:250,y:-window.innerHeight+50},className:"layer-list",children:[s.jsx("div",{className:"list-search",children:s.jsx(Ye,{placeholder:"搜索图层",onChange:this.searchLayer})}),s.jsx("div",{className:"layer-items",children:s.jsx("div",{ref:e=>this.layerItemsContainerRef=e,children:this.buildLayerList()})})]})}}const bs=y(Cs);class Ls extends h.Component{render(){const{visible:l}=F,{visible:e}=se;return s.jsxs(s.Fragment,{children:[l&&s.jsx(xs,{}),e&&s.jsx(bs,{})]})}}const ks=y(Ls);class js{constructor(){a(this,"visible",!1);a(this,"position",[0,0]);a(this,"mouseDownTime",0);a(this,"mouseUpTime",0);a(this,"updateVisible",l=>this.visible=l);a(this,"setPosition",l=>this.position=l);a(this,"setMouseDownTime",l=>this.mouseDownTime=l);a(this,"setMouseUpTime",l=>this.mouseUpTime=l);Fe(this,{visible:fe,position:fe,updateVisible:me,setPosition:me})}}const ae=new js;const ws=re.lazy(()=>Se(()=>import("./index-ed455431.js").then(i=>i.aB),["assets/index-ed455431.js","assets/index-c6fb88d1.css"])),Ds=re.lazy(()=>Se(()=>import("./index-ed455431.js").then(i=>i.aA),["assets/index-ed455431.js","assets/index-c6fb88d1.css"])),Rs=re.lazy(()=>Se(()=>import("./index-ed455431.js").then(i=>i.aC),["assets/index-ed455431.js","assets/index-c6fb88d1.css"]));class Ss extends h.Component{constructor(){super(...arguments);a(this,"buildHeaderList",()=>{let e=[];const{headerItemInstances:t}=ie.getLoader();for(let n=0;n<t.length;n++){const{icon:o,name:r,onClick:c}=t[n];e.push(s.jsx("div",{className:"right-item",onClick:c,children:s.jsxs("span",{className:"item-span",children:[s.jsx(o,{})," ",r]})},n+""))}return e})}render(){const{canvasVisible:e,projectVisible:t,themeVisible:n,bluePrintVisible:o}=Bt,r=this.buildHeaderList();return s.jsxs("div",{className:"designer-header",children:[s.jsx("div",{className:"header-left",children:s.jsx("div",{className:"header-title",children:"L C"})}),s.jsx("div",{className:"header-right",children:r}),e&&s.jsx(h.Suspense,{fallback:s.jsx(W,{}),children:s.jsx(Ds,{})}),t&&s.jsx(h.Suspense,{fallback:s.jsx(W,{}),children:s.jsx(ws,{})}),n&&s.jsx(h.Suspense,{fallback:s.jsx(W,{}),children:s.jsx(Rs,{})}),o&&s.jsx(h.Suspense,{fallback:s.jsx(W,{}),children:s.jsx(Ht,{})})]})}}const Es=y(Ss);var Re=function(i,l){return Re=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},Re(i,l)};function zs(i,l){if(typeof l!="function"&&l!==null)throw new TypeError("Class extends value "+String(l)+" is not a constructor or null");Re(i,l);function e(){this.constructor=i}i.prototype=l===null?Object.create(l):(e.prototype=l.prototype,new e)}var Is=function(i){zs(l,i);function l(){var t=i!==null&&i.apply(this,arguments)||this;return t.state={scrollPos:0},t.width=0,t.height=0,t._zoom=0,t._rulerScale=0,t._observer=null,t._checkResize=function(){t.resize()},t}var e=l.prototype;return e.render=function(){var t=this.props;return this._zoom=t.zoom,h.createElement("canvas",{ref:At(this,"canvasElement"),style:this.props.style})},e.componentDidMount=function(){var t=this.props;this.state.scrollPos=t.defaultScrollPos||0;var n=this.canvasElement,o=n.getContext("2d",{alpha:!1});this.canvasContext=o,t.useResizeObserver?(this._observer=new ResizeObserver(this._checkResize),this._observer.observe(n,{box:"border-box"})):this.resize()},e.componentDidUpdate=function(){this.resize()},e.componentWillUnmount=function(){var t;this.state.scrollPos=0,(t=this._observer)===null||t===void 0||t.disconnect()},e.getScrollPos=function(){return this.state.scrollPos},e.scroll=function(t,n){this.draw(t,n)},e.resize=function(t){var n=this.canvasElement,o=this.props,r=o.width,c=o.height,u=o.scrollPos,p=this._getRulerScale();this.width=r||n.offsetWidth,this.height=c||n.offsetHeight,n.width=this.width*p,n.height=this.height*p,this.draw(u,t)},e.draw=function(t,n){t===void 0&&(t=this.state.scrollPos),n===void 0&&(n=this._zoom),this._zoom=n;var o=this.props,r=o,c=r.unit,u=r.type,p=r.backgroundColor,g=r.lineColor,f=r.textColor,C=r.textBackgroundColor,N=r.direction,V=r.negativeRuler,D=V===void 0?!0:V,le=r.segment,R=le===void 0?10:le,M=r.textFormat,X=r.range,L=X===void 0?[-1/0,1/0]:X,Ee=r.rangeBackgroundColor,ce=r.selectedRanges,ze=r.selectedBackgroundColor,Ie=r.lineWidth,pt=Ie===void 0?1:Ie,gt=r.selectedRangesText,Oe=r.selectedRangesTextColor,ft=Oe===void 0?"#44aaff":Oe,Ne=r.selectedRangesTextOffset,mt=Ne===void 0?[0,0]:Ne,G=this._getRulerScale(),Y=this.width,q=this.height,vt=this.state;vt.scrollPos=t;var d=this.canvasContext,k=u==="horizontal",Me=D!==!1,yt=o.font||"10px sans-serif",ve=o.textAlign||"left",xt=o.textOffset||[0,0],ye=k?q:Y,xe=we("".concat(o.mainLineSize||"100%"),ye),Ct=we("".concat(o.longLineSize||10),ye),bt=we("".concat(o.shortLineSize||7),ye),S=o.lineOffset||[0,0];switch(p==="transparent"?d.clearRect(0,0,Y*G,q*G):(d.rect(0,0,Y*G,q*G),d.fillStyle=p,d.fill()),d.save(),d.scale(G,G),d.strokeStyle=g,d.lineWidth=pt,d.font=yt,d.fillStyle=f,d.textAlign=ve,N){case"start":d.textBaseline="top";break;case"center":d.textBaseline="middle";break;case"end":d.textBaseline="bottom";break}d.translate(.5,0),d.beginPath();for(var Ce=k?Y:q,de=n*c,be=Math.floor(t*n/de),Lt=Math.ceil((t*n+Ce)/de),Te=Lt-be,Pe=Math.max(["left","center","right"].indexOf(ve)-1,-1),E=k?q:Y,Q=[],T=0;T<=Te;++T){var $=(T+be)*c,Le="".concat($);M&&(Le=M($));var kt=d.measureText(Le).width;Q.push({color:f,offset:xt,backgroundColor:C,value:$,text:Le,textSize:kt})}if(ze!=="transparent"&&(ce!=null&&ce.length)&&ce.forEach(function(j){var P=Math.max(j[0],L[0],D?-1/0:0),z=Math.min(j[1],L[1]),Z=(P-t)*n,ee=(z-P)*n;gt&&j.forEach(function(H){var I="".concat(H);M&&(I=M(H));var B=d.measureText(I).width,O=H*n,pe=O+B;_t(Q,function(U,te){var A=U.value,Rt=U.textSize,$e=A*n,St=$e+Rt;$e<=pe&&O<=St&&Q.splice(te,1)}),Q.push({value:H,color:ft,offset:mt,text:I,textSize:B})}),!(ee<=0)&&(d.save(),d.fillStyle=ze,k?d.fillRect(Z,0,ee,E):d.fillRect(0,Z,E,ee),d.restore())}),Ee!=="transparent"&&L[0]!==-1/0&&L[1]!==1/0){var He=(L[0]-t)*n,Be=(L[1]-L[0])*n;d.save(),d.fillStyle=Ee,k?d.fillRect(He,0,Be,E):d.fillRect(0,He,E,Be),d.restore()}for(var T=0;T<=Te;++T){var $=T+be;if(!(!Me&&$<0))for(var Ae=$*c,jt=(Ae-t)*n,K=0;K<R;++K){var he=jt+K/R*de,_e=Ae+K/R*c;if(!(he<0||he>=Ce||_e<L[0]||_e>L[1])){var ue=K===0?xe:K%2===0?Ct:bt,J=0;switch(N){case"start":J=0;break;case"center":J=E/2-ue/2;break;case"end":J=E-ue;break}var Ve=k?[he+S[0],J+S[1]]:[J+S[0],he+S[1]],ke=Ve[0],je=Ve[1],Ge=k?[ke,je+ue]:[ke+ue,je],wt=Ge[0],Dt=Ge[1];d.moveTo(ke+S[0],je+S[1]),d.lineTo(wt+S[0],Dt+S[1])}}}d.stroke(),Q.forEach(function(j){var P=j.value,z=j.offset,Z=j.backgroundColor,ee=j.color,H=j.text,I=j.textSize;if(!(!Me&&P<0)){var B=(P-t)*n;if(!(B<-de||B>=Ce+c*n||P<L[0]||P>L[1])){var O=0;switch(N){case"start":O=17;break;case"center":O=E/2;break;case"end":O=E-17;break}var pe=k?[B+Pe*-3,O]:[O,B+Pe*3],U=pe[0],te=pe[1];if(Z){var A=0;switch(ve){case"left":A=0;break;case"center":A=-I/2;break;case"right":A=-I;break}d.save(),d.fillStyle=Z,k?d.fillRect(U+z[0]+A,0,I,xe):(d.translate(0,te+z[1]),d.rotate(-Math.PI/2),d.fillRect(A,0,I,xe)),d.restore()}d.save(),d.fillStyle=ee,k?d.fillText(H,U+z[0],te+z[1]):(d.translate(U+z[0],te+z[1]),d.rotate(-Math.PI/2),d.fillText(H,0,0)),d.restore()}}}),d.restore()},e._getRulerScale=function(){var t=this.props.defaultPixelScale||2;if(!this._rulerScale){var n=window.devicePixelRatio>1;if(!n&&window.matchMedia){var o=window.matchMedia("only screen and (min--moz-device-pixel-ratio: 1.3), only screen and (-o-min-device-pixel-ratio: 2.6/2), only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen  and (min-device-pixel-ratio: 1.3), only screen and (min-resolution: 1.3dppx)");n=o&&o.matches}this._rulerScale=n?3:t}return this._rulerScale},l.defaultProps={type:"horizontal",zoom:1,width:0,height:0,unit:50,negativeRuler:!0,mainLineSize:"100%",longLineSize:10,shortLineSize:7,segment:10,direction:"end",style:{width:"100%",height:"100%"},backgroundColor:"#333333",font:"10px sans-serif",textColor:"#ffffff",textBackgroundColor:"transparent",lineColor:"#777777",range:[-1/0,1/0],rangeBackgroundColor:"transparent",lineWidth:1,selectedBackgroundColor:"#555555",defaultScrollPos:0},l}(h.PureComponent);const We=Is;class Os extends h.PureComponent{constructor(){super(...arguments);a(this,"state",{render:0});a(this,"rulerX",null);a(this,"rulerY",null);a(this,"unit",50);a(this,"scrollPos",{x:0,y:0});a(this,"baseOffset",20);a(this,"ruleWheel",e=>{const{dsContentRef:t}=m,{x:n,y:o}=t==null?void 0:t.getBoundingClientRect();this.scrollPos.x=-(n-80)/e,this.scrollPos.y=-(o-70)/e,this.unit=Math.floor(50/e),this.setState({render:this.state.render+1})});a(this,"ruleDrag",()=>{const{dsContentRef:e,scale:t}=m,{x:n,y:o}=e==null?void 0:e.getBoundingClientRect();this.scrollPos.x=-(n-80)/t,this.scrollPos.y=-(o-70)/t,this.rulerX&&this.rulerX.scroll(this.scrollPos.x),this.rulerY&&this.rulerY.scroll(this.scrollPos.y)})}componentDidMount(){const{setRuleRef:e}=m;e(this)}render(){const{scale:e}=m;return s.jsxs("div",{className:"lc-ruler",style:{position:"relative"},children:[s.jsx("div",{style:{position:"absolute",width:20,height:20,color:"#838383",textAlign:"center",fontSize:12,top:-1},children:"px"}),s.jsx("div",{className:"lc-ruler-horizontal",style:{height:this.baseOffset,width:`calc(100% - ${this.baseOffset}px)`,position:"relative",left:this.baseOffset},children:s.jsx(We,{ref:t=>this.rulerX=t,scrollPos:this.scrollPos.x,zoom:e,lineColor:"#444b4d",textColor:"#a6a6a6",segment:2,negativeRuler:!0,textOffset:[0,10],backgroundColor:"#1a1a1a",unit:this.unit})}),s.jsx("div",{className:"lc-ruler-vertical",style:{width:this.baseOffset,height:window.innerHeight-this.baseOffset-90,position:"relative",overflow:"hidden"},children:s.jsx(We,{ref:t=>this.rulerY=t,type:"vertical",scrollPos:this.scrollPos.y,lineColor:"#444b4d",textColor:"#a6a6a6",zoom:e,segment:2,negativeRuler:!0,textOffset:[10,0],backgroundColor:"#1a1a1a",unit:this.unit})}),s.jsx("div",{className:"lc-ruler-content",style:{position:"absolute",overflow:"hidden",top:this.baseOffset,left:this.baseOffset},children:this.props.children})]})}}class Ns extends h.Component{render(){return s.jsx("div",{style:{outline:"none"},className:"lc-event-container",children:this.props.children})}}class Ms extends h.Component{constructor(e){super(e);a(this,"movableRef",h.createRef());a(this,"verticalGuidelines",[]);a(this,"horizontalGuidelines",[]);a(this,"onDragStart",e=>{const{target:t}=e,{layoutConfigs:n}=v,{lock:o}=n[t.id];if(o)return!1});a(this,"onDragEnd",e=>{const{updateLayout:t}=v;let{backoff:n,setBackoff:o}=m;const{lastEvent:r,target:c}=e;if(r){const{beforeTranslate:u}=r,p=[{id:c.id,width:c.offsetWidth,height:c.offsetHeight,type:c.dataset.type,position:[u[0],u[1]]}];n?(t(p,!1),o(!1)):ne.doDrag(p)}});a(this,"onDragGroupEnd",e=>{var D;const{targets:t}=e,{updateLayout:n,layoutConfigs:o}=v;if(o[t[0].id].lock)return!1;let{backoff:c,setBackoff:u,setGroupCoordinate:p,groupCoordinate:g}=m,f=[];e.events.forEach(le=>{const{target:R,lastEvent:M}=le;if(M){const{beforeTranslate:X}=M;f.push({id:R.id,width:R.offsetWidth,height:R.offsetHeight,type:R.dataset.type,position:[X[0],X[1]]})}});const C=((D=e==null?void 0:e.lastEvent)==null?void 0:D.beforeTranslate)||[0,0],N=g.minX+C[0],V=g.minY+C[1];p({minX:N,minY:V}),f.length>0&&(c?(n(f,!1),u(!1)):ne.doDrag(f))});a(this,"onResizeEnd",e=>{const{updateLayout:t}=v;let{backoff:n,setBackoff:o}=m;const{target:r,lastEvent:c}=e;if(c){const{width:u,height:p,drag:{translate:g},direction:f}=c,C=[{id:r.id,width:u,height:p,type:r.dataset.type,position:[g[0],g[1]]}];n?(t(C,!1),o(!1)):ne.doResize(C,f)}});a(this,"onResizeGroupEnd",e=>{const{updateLayout:t}=v;let{backoff:n,setBackoff:o}=m,r=[];if(e.events.forEach(p=>{const{target:g,lastEvent:f}=p;if(f){const{drag:{translate:C}}=f;r.push({id:g.id,width:g.offsetWidth,height:g.offsetHeight,type:g.dataset.type,position:[C[0],C[1]]})}}),!e.lastEvent)return;const{dist:c,direction:u}=e.lastEvent;if(r.length>0){n?(t(r,!1),o(!1)):ne.doResize(r,u);const{setGroupCoordinate:p,groupCoordinate:g}=m;u[0]===-1||u[1]===-1?p({minX:g.minX-c[0],minY:g.minY-c[1],groupWidth:g.groupWidth+c[0],groupHeight:g.groupHeight+c[1]}):p({groupWidth:g.groupWidth+c[0],groupHeight:g.groupHeight+c[1]})}});a(this,"onResizeGroup",e=>{e.events.forEach(t=>{t.target.style.width=`${t.width}px`,t.target.style.height=`${t.height}px`,t.target.style.transform=t.drag.transform})});a(this,"onResize",e=>{const{target:t,width:n,height:o,drag:r}=e;t.style.width=`${n}px`,t.style.height=`${o}px`,t.style.transform=`translate(${r.beforeTranslate[0]}px, ${r.beforeTranslate[1]}px)`});a(this,"onResizeStart",e=>{const{target:t}=e,{layoutConfigs:n}=v,{lock:o}=n[t.id];if(o)return!1});a(this,"onDrag",e=>{const{target:t,beforeTranslate:n}=e;t.style.transform=`translate(${n[0]}px, ${n[1]}px)`});a(this,"onDragGroup",e=>{const{targets:t}=e,{layoutConfigs:n}=v;if(n[t[0].id].lock)return!1;e.events.forEach(r=>r.target.style.transform=r.transform)});a(this,"onResizeGroupStart",e=>{const{targets:t}=e,{layoutConfigs:n}=v;if(n[t[0].id].lock)return!1});a(this,"generateSnapStep",(e,t)=>{let n=[];for(let o=0;o<t;o+=e)n.push(o);return n});this.state={targets:[]};const{canvasConfig:{width:t,height:n}}=v;this.verticalGuidelines=this.generateSnapStep(50,t),this.horizontalGuidelines=this.generateSnapStep(50,n)}componentDidMount(){const{setMovableRef:e}=m;e(this.movableRef)}render(){const{readonly:e=!1}=this.props,{selectorRef:t,targets:n,scale:o}=m,{canvasConfig:{rasterize:r,dragStep:c,resizeStep:u}}=v,p=document.getElementsByClassName("lc-comp-item");return s.jsxs(s.Fragment,{children:[this.props.children,s.jsx(Vt,{ref:this.movableRef,target:n,zoom:1/o,draggable:!e,resizable:!e,keepRatio:!1,maxSnapElementGapDistance:100,maxSnapElementGuidelineDistance:100,snappable:!0,snapGap:!0,snapThreshold:5,isDisplaySnapDigit:!0,snapDirections:{top:!0,right:!0,bottom:!0,left:!0,center:!0,middle:!0},elementSnapDirections:{top:!0,right:!0,bottom:!0,left:!0,center:!0,middle:!0},ables:[Ps],dimensionViewable:!0,roundable:!0,verticalGuidelines:this.verticalGuidelines,horizontalGuidelines:this.horizontalGuidelines,isDisplayInnerSnapDigit:!0,isDisplayGridGuidelines:!0,isDisplayShadowRoundControls:!0,displayAroundControls:!0,clipArea:!0,clipVerticalGuidelines:[0,"50%","100%"],clipHorizontalGuidelines:[0,"50%","100%"],clipTargetBounds:!0,elementGuidelines:Array.from(p),throttleDrag:r?c:1,throttleResize:r?u:1,onClickGroup:g=>{var f;return(f=t.current)==null?void 0:f.clickTarget(g.inputEvent,g.inputTarget)},onDrag:this.onDrag,onDragStart:this.onDragStart,onDragEnd:this.onDragEnd,onDragGroup:this.onDragGroup,onDragGroupEnd:this.onDragGroupEnd,onResizeStart:this.onResizeStart,onResize:this.onResize,onResizeEnd:this.onResizeEnd,onResizeGroupStart:this.onResizeGroupStart,onResizeGroup:this.onResizeGroup,onResizeGroupEnd:this.onResizeGroupEnd})]})}}const Ts=y(Ms),Ps={name:"dimensionViewable",props:{dimensionViewable:Boolean},events:{},render(i){const l=i.getRect();return s.jsx("div",{className:"moveable-dimension",style:{left:"-125px",top:"-60px",color:"#cacacaff",fontSize:"14px",position:"absolute",boxSizing:"content-box",borderRadius:"5px",padding:"5px",pointerEvents:"none"},children:s.jsxs("div",{children:[s.jsxs("p",{children:["位置: ",Math.round(l.left)," x ",Math.round(l.top)]}),s.jsxs("p",{children:["尺寸: ",Math.round(l.offsetWidth)," x ",Math.round(l.offsetHeight)]})]})},"dimension-viewer")}};class Hs extends h.Component{constructor(){super(...arguments);a(this,"menuList",[{name:"锁定",icon:Ue,onClick:qe},{name:"解锁",icon:Ue,onClick:Qe},{name:"隐藏",icon:wn,onClick:Je},{name:"复制",icon:Sn,onClick:Ze},{name:"置顶",icon:Ln,onClick:et},{name:"置底",icon:Nn,onClick:tt},{name:"删除",icon:Gt,onClick:nt}])}render(){const{visible:e,position:t=[0,0]}=ae;let n=[];for(let o=0;o<this.menuList.length;o++){let r=this.menuList[o],c=r.icon;n.push(s.jsxs("div",{className:"menu-item",onClick:r.onClick,children:[s.jsx("label",{children:s.jsx(c,{})}),s.jsx("span",{children:r.name})]},o+""))}return s.jsx(s.Fragment,{children:e&&s.jsx("div",{className:"lc-right-menu",style:{position:"fixed",top:t[1],left:t[0]},children:n})})}}const Bs=y(Hs);var x=(i=>(i[i.SINGLE=0]="SINGLE",i[i.COILED=1]="COILED",i))(x||{});const As=["control + s","alt","control + l","control + shift + l","control + h","control + k","control + 1","control + 2","control + 3","control + 4","control + 5","control + g"];class _s extends h.Component{constructor(e){super(e);a(this,"handlerMapping",{});a(this,"currHotKey",[]);a(this,"existHandlerKey","");a(this,"specialDomCache",{});a(this,"getSpecialDomCache",e=>{const t=this.specialDomCache[e];if(t)return t;{const n=document.querySelector(e);return n?(this.specialDomCache[e]=n,n):null}});a(this,"doHandler",(e,t)=>{const{handler:n,triggerType:o=0,range:r}=this.handlerMapping[t]||{};if(n&&(o===0&&this.existHandlerKey!==t||o===1)){const{pointerTarget:c}=m;if(r){const u=this.getSpecialDomCache(r);if(!u||!u.contains(c))return}Array.isArray(n)?n.forEach(u=>u(e)):n(e),this.existHandlerKey=t}});a(this,"keyDown",e=>{const t=e.key.toLowerCase();this.currHotKey.some(o=>o===t)||this.currHotKey.push(t);let n=this.currHotKey.join(" + ");As.some(o=>o===n)&&e.preventDefault(),this.doHandler(e,n)});a(this,"keyUp",e=>{const t=e.key.toLowerCase();this.currHotKey.some(n=>n===t)&&(this.currHotKey=this.currHotKey.filter(n=>n!==t),this.existHandlerKey="")});a(this,"onBlur",()=>{this.currHotKey=[],this.existHandlerKey=""});this.handlerMapping=e.handlerMapping}componentDidMount(){document.addEventListener("keydown",this.keyDown),document.addEventListener("keyup",this.keyUp),window.onblur=this.onBlur}componentWillUnmount(){document.removeEventListener("keydown",this.keyDown),document.removeEventListener("keyup",this.keyUp),window.onblur=null}render(){return null}}const Vs={"control + a":{handler:$t,range:".lc-ruler-content"},"control + v":{handler:Ze,range:".lc-ruler-content"},"control + l":{handler:qe},"control + shift + l":{handler:Qe},"control + h":{handler:Je},"control + arrowup":{handler:et},"control + arrowdown":{handler:tt},"control + s":{handler:Kt},delete:{handler:[Ut,Wt,nt]},"control + z":{handler:Ft,range:".lc-ruler-content"},"control + shift + z":{handler:Xt,range:".lc-ruler-content"},"control + k":{handler:Yt},"control + 1":{handler:qt},"control + 2":{handler:Qt},"control + 3":{handler:Jt},"control + 4":{handler:Zt},"control + 5":{handler:en},arrowup:{handler:tn,triggerType:x.COILED,range:".lc-ruler-content"},arrowdown:{handler:nn,triggerType:x.COILED,range:".lc-ruler-content"},arrowleft:{handler:sn,triggerType:x.COILED,range:".lc-ruler-content"},arrowright:{handler:rn,triggerType:x.COILED,range:".lc-ruler-content"},"control + shift + arrowup":{handler:on,triggerType:x.COILED,range:".lc-ruler-content"},"control + shift + arrowdown":{handler:an,triggerType:x.COILED,range:".lc-ruler-content"},"control + shift + arrowleft":{handler:ln,triggerType:x.COILED,range:".lc-ruler-content"},"control + shift + arrowright":{handler:cn,triggerType:x.COILED,range:".lc-ruler-content"},"control + alt + arrowup":{handler:dn,triggerType:x.COILED,range:".lc-ruler-content"},"control + alt + arrowdown":{handler:hn,triggerType:x.COILED,range:".lc-ruler-content"},"control + alt + arrowleft":{handler:un,triggerType:x.COILED,range:".lc-ruler-content"},"control + alt + arrowright":{handler:pn,triggerType:x.COILED,range:".lc-ruler-content"},"control + g":{handler:gn},"control + shift + g":{handler:fn}},Gs=y(i=>{const{children:l,onDoubleClick:e}=i,t=re.useRef(null),n=re.useRef(null),{canvasConfig:o}=v;return h.useEffect(()=>{const r=t.current,c=n.current;if(r&&c){const{setDsContentRef:u}=m;u(c);const p=new mn({container:r,content:c,posOffset:{x:80,y:70},scaleCallback:g=>{const{scale:f,ratio:C}=g,{setScale:N,setRatio:V,rulerRef:D}=m;N(f),V(C),D==null||D.ruleWheel(f)},dragCallback:()=>{const{rulerRef:g}=m;g==null||g.ruleDrag()}});return()=>{p.destroy()}}},[]),s.jsx("div",{className:"designer-ds-container",ref:t,style:{overflow:"hidden",height:window.innerHeight-90,width:window.innerWidth-95,backgroundColor:"#434343",position:"relative"},children:s.jsx("div",{className:"designer-ds-content lc-drag-scale-provider",id:"designer-ds-content",ref:n,onDoubleClick:e,style:{width:o==null?void 0:o.width,height:o==null?void 0:o.height,background:"#1c1c1c",position:"absolute"},children:l})})});class $s extends h.PureComponent{constructor(){super(...arguments);a(this,"state",{designerRef:null});a(this,"updateActive",e=>{let{id:t,dataset:{type:n}}=e.target;const{activeConfig:o,activeElem:r}=_;vn.isEqual(r,{id:t,type:n})||o(t,n)});a(this,"generateElement",()=>{let{layoutConfigs:e}=v;return Object.values(e).sort((n,o)=>n.order-o.order).map(n=>n.type==="group"?null:s.jsx(yn,{layout:n},n.id))})}componentDidMount(){this.setState({designerRef:document.querySelector(".lc-ruler-content")})}render(){const{layoutConfigs:e}=v;return s.jsxs(s.Fragment,{children:[s.jsx(Ns,{children:s.jsx(xn,{children:s.jsx(Os,{children:s.jsx(Gs,{onDoubleClick:this.updateActive,children:s.jsx(Ts,{children:De.buildCanvasComponents(e)})})})})}),s.jsx(Bs,{}),s.jsx(_s,{handlerMapping:Vs})]})}}const Ks=y($s);class Us extends h.Component{componentDidMount(){ie.getLoader().load(),Ws()}componentWillUnmount(){Fs()}render(){const{loaded:l}=v;return l?s.jsxs(An,{children:[s.jsx(Mn,{children:s.jsx(Es,{})}),s.jsxs(Tn,{children:[s.jsx(Pn,{children:s.jsx(rs,{})}),s.jsx(Hn,{children:s.jsx(Ks,{})}),s.jsx(Bn,{children:s.jsx(ds,{})})]}),s.jsx(_n,{children:s.jsx(fs,{})}),s.jsx(ks,{})]}):s.jsx(W,{})}}const qs=y(Us);function Ws(){document.addEventListener("click",ct),document.addEventListener("contextmenu",dt),document.addEventListener("pointerdown",ht),document.addEventListener("pointerup",ut)}function Fs(){document.removeEventListener("click",ct),document.removeEventListener("contextmenu",dt),document.removeEventListener("pointerdown",ht),document.removeEventListener("pointerup",ut)}const ct=i=>{const{visible:l,updateVisible:e}=ae;l&&i.button===0&&setTimeout(()=>{e(!1)})},dt=i=>{i.preventDefault();const{mouseDownTime:l,mouseUpTime:e,setPosition:t,updateVisible:n}=ae;["lc-comp-item","moveable-area"].some(r=>i.target.classList.contains(r))&&e-l<200?(n&&n(!0),t([i.clientX,i.clientY])):n&&n(!1)},ht=()=>{const{setMouseDownTime:i}=ae;i(Date.now())},ut=i=>{const{setMouseUpTime:l}=ae;l(Date.now());const{setPointerTarget:e}=m;e(i.target)};export{qs as default};
