import{b as p,j as e,r as u}from"./index-CRmipDYU.js";import{G as J,I as z,N as E,a as f,E as O,c as K,o as m,D as y}from"./NumberInput-DwA_3ebS.js";import{M as b}from"./index-FhfevFry.js";import{B as x}from"./button--wGDZYGC.js";import{globalMessage as C}from"./GlobalMessage-CFWlAJYU.js";import{D as F,A as Z,P as q}from"./Delete-CL1xd0_3.js";import{I as Q}from"./index-Di7-uBEQ.js";import{I as S}from"./index-BoLfqrWA.js";const U=Q("copy",!0,function(n){return p.createElement("svg",{width:n.size,height:n.size,viewBox:"0 0 48 48",fill:"none"},p.createElement("path",{d:"M13 12.4316V7.8125C13 6.2592 14.2592 5 15.8125 5H40.1875C41.7408 5 43 6.2592 43 7.8125V32.1875C43 33.7408 41.7408 35 40.1875 35H35.5163",stroke:n.colors[0],strokeWidth:n.strokeWidth,strokeLinecap:n.strokeLinecap,strokeLinejoin:n.strokeLinejoin}),p.createElement("path",{d:"M32.1875 13H7.8125C6.2592 13 5 14.2592 5 15.8125V40.1875C5 41.7408 6.2592 43 7.8125 43H32.1875C33.7408 43 35 41.7408 35 40.1875V15.8125C35 14.2592 33.7408 13 32.1875 13Z",fill:n.colors[1],stroke:n.colors[0],strokeWidth:n.strokeWidth,strokeLinejoin:n.strokeLinejoin}))}),X="/light-chaser-app/assets/default-snapshot-IoTojipW.jpg",Y=n=>{const s={name:"未命名项目",des:"",width:1920,height:1080},c=a=>{a.preventDefault();const{onOk:d}=n;d&&d(s)},i=()=>{const{onCancel:a}=n;a&&a()},{visible:l=!1}=n;return e.jsxs(b,{title:"新建大屏",open:l,className:"add-new-screen-dialog",onCancel:i,footer:[e.jsx(x,{type:"primary",onClick:c,children:"创建"}),e.jsx(x,{onClick:i,children:"取消"})],children:[e.jsx("div",{className:"lc-add-new-screen",children:e.jsxs(J,{gridGap:"15px",columns:2,children:[e.jsx(z,{label:"名称",defaultValue:s.name,onChange:a=>s.name=a}),e.jsx(z,{label:"描述",onChange:a=>s.des=a}),e.jsx(E,{label:"宽度",min:300,defaultValue:s.width,onChange:a=>s.width=Number(a)}),e.jsx(E,{label:"高度",min:300,defaultValue:s.height,onChange:a=>s.height=Number(a)})]})}),e.jsx("div",{className:"add-new-screen-explain",children:e.jsx("p",{children:"说明：1、名称不超过20字，描述不超过60字。2、宽度必须≥500，高度必须≥300"})})]})},ee=u.memo(n=>{const{onOk:s,onCancel:c,visible:i}=n;return e.jsx(b,{title:"删除确认",open:i,onCancel:c,onOk:s,width:350,footer:[e.jsx(x,{type:"primary",onClick:s,children:"确认"}),e.jsx(x,{onClick:c,children:"取消"})],children:e.jsx("div",{style:{color:"#aeaeae",padding:10},children:"确定要删除该项目吗？"})})}),se=n=>{const{onOk:s,onCancel:c,visible:i}=n,l=a=>{a.preventDefault(),s()};return e.jsx(b,{title:"克隆项目",open:i,onCancel:c,onOk:l,width:350,footer:[e.jsx(x,{type:"primary",onClick:l,children:"确认"}),e.jsx(x,{onClick:c,children:"取消"})],children:e.jsx("div",{style:{color:"#a7a7a7",padding:10},children:"确认克隆项目吗？"})})};function te(n){const{cover:s,id:c,saveType:i,doOperate:l}=n,[a,d]=u.useState(!1),[h,v]=u.useState(n.name),g=()=>{if(h!==n.name){const t={id:c,name:h};m[i].updateProject(t)}};return e.jsxs("div",{className:"project-list-item",children:[e.jsx("div",{className:"project-item-cover",style:{backgroundImage:`url(${s})`},children:e.jsxs("div",{className:"operate-icon-list",children:[e.jsx("div",{className:"operate-icon",children:e.jsx(f,{content:"编辑项目",children:e.jsx(O,{onClick:()=>l(c,"edit")})})}),e.jsx("div",{className:"operate-icon",children:e.jsx(f,{content:"预览项目",children:e.jsx(K,{onClick:()=>l(c,"show")})})}),e.jsx("div",{className:"operate-icon",children:e.jsx(f,{content:"删除项目",children:e.jsx(F,{onClick:()=>l(c,"del")})})}),e.jsx("div",{className:"operate-icon",children:e.jsx(f,{content:"复制项目",children:e.jsx(U,{onClick:()=>l(c,"clone")})})})]})}),e.jsxs("div",{className:"project-item-content",children:[e.jsx("div",{className:"project-name",children:a?e.jsx("div",{className:"project-rename-input",children:e.jsx(S,{autoFocus:!0,size:"small",value:h,onBlur:()=>{g(),d(!1)},onKeyDown:t=>{t.key==="Enter"&&(g(),d(!1))},onChange:t=>v(t.target.value)})}):e.jsx("div",{className:"project-name-content",children:h})}),e.jsx("div",{className:"rename-icon",onClick:()=>d(!0),children:a||e.jsx(f,{content:"重命名",children:e.jsx(O,{})})})]})]})}const{Search:ne}=S,je=u.memo(n=>{const{saveType:s}=n,[c,i]=p.useState(!1),[l,a]=p.useState(!1),[d,h]=p.useState(!1),v=u.useRef(""),g=u.useRef(""),[t,N]=p.useState({records:[],total:0,current:1,size:24}),k=(o,r,j)=>{m[s].getProjectInfoPageList({current:o,size:r,searchValue:j}).then(w=>N(w))},L=()=>i(!c),$=o=>{const{name:r,des:j,width:w,height:G}=o,_={name:r,des:j,saveType:s,dataJson:JSON.stringify({canvasManager:{width:w,height:G}})};m[s].createProject(_).then(D=>{var I;D===""?(I=C.messageApi)==null||I.error("创建失败"):(i(!1),window.open(`/light-chaser-app/#/designer?id=${D}&saveType=${s}&mode=${y.EDIT}`,"_blank"),k(t.current,t.size))})},V=()=>i(!1),M=(o,r)=>{switch(r){case"edit":window.open(`/light-chaser-app/#/designer?id=${o}&saveType=${s}&mode=${y.EDIT}`,"_blank");break;case"show":window.open(`/light-chaser-app/#/view?id=${o}&saveType=${s}&mode=${y.VIEW}`,"_blank");break;case"del":v.current=o,a(!0);break;case"clone":g.current=o,h(!0);break}},R=()=>a(!1),T=()=>{m[s].copyProject(g.current).then(o=>{var r,j;o!==""?(h(!1),k(t.current,t.size),(r=C.messageApi)==null||r.success("克隆成功")):(j=C.messageApi)==null||j.error("克隆失败")})},A=()=>h(!1),W=()=>{m[s].deleteProject(v.current).then(o=>{var r;o?(a(!1),k(t.current,t.size)):(r=C.messageApi)==null||r.error("删除失败")})},H=(o,r)=>{m[s].getProjectInfoPageList({current:o,size:r}).then(j=>N(j))},B=o=>{o.key==="Enter"&&P(o.target.value)},P=o=>{m[s].getProjectInfoPageList({current:t.current,size:t.size,searchValue:o}).then(r=>N(r))};return u.useEffect(()=>{k(t.current,t.size)},[]),e.jsxs("div",{className:"project-list-container",children:[e.jsxs("div",{className:"project-list-header",children:[e.jsxs("div",{className:"project-list-header-left",children:[e.jsx(ne,{placeholder:"搜索项目",size:"middle",className:"project-list-search",onKeyDown:B,onSearch:P,style:{width:350}}),e.jsxs(x,{size:"middle",type:"primary",onClick:L,children:[e.jsx(Z,{style:{position:"relative",top:3,marginRight:3}}),"新增"]})]}),e.jsx("div",{className:"project-list-header-right"})]}),e.jsx("div",{className:"project-list",children:t&&t.records.map(o=>e.jsx(te,{id:o.id,name:o.name,cover:o.cover||X,saveType:s,doOperate:M},o.id))}),e.jsx(q,{rootClassName:"project-list-page",defaultCurrent:t==null?void 0:t.current,pageSize:t==null?void 0:t.size,total:t==null?void 0:t.total,onChange:H}),e.jsx(Y,{onOk:$,onCancel:V,visible:c}),e.jsx(ee,{visible:l,onOk:W,onCancel:R}),e.jsx(se,{onOk:()=>T(),onCancel:A,visible:d})]})});export{je as P};
