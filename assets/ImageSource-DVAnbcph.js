import{r as p,j as r}from"./index-RWmFPwSm.js";import{b0 as L,i as A,U as x,o as y,e as I,l as R,aU as S}from"./LayerManager-v1P1ysOv.js";import{D as B}from"./DragAddProvider-_IIQLnDx.js";import{P as E}from"./DesignerPage-3kYYNJme.js";import{H as M}from"./UIContainer-GCIh-2RB.js";import{C as H}from"./Dialog-m2H_yT8V.js";import"./LCGUI-T8HtwnFI.js";import"./index-bkM9-KDb.js";import"./MainRouter-MB1MPfnT.js";import"./useZIndex-MQq7iIjz.js";import"./Data-4t_Ztlq1.js";import"./index-9odaCLPt.js";import"./Accordion-gyHrW4rh.js";import"./Switch-aJkFYk6b.js";import"./Right-oNgrbvoa.js";import"./Radio-KuU4euQC.js";import"./GlobalMessage-Jo_X5Env.js";import"./System-5N8cFjAd.js";import"./FontGlobal-UQ7n6vXp.js";import"./PreviewOpen-crWG6SFP.js";import"./Grid-uqhjZTHE.js";import"./Input-Pc5Q3TnR.js";import"./MonacoEditor-NyM5FgrP.js";import"./Button-oq9KiYLF.js";import"./Plus-WHjdveXs.js";import"./CheckOutlined-Idpaoouy.js";import"./collapse-aS6vX33V.js";import"./useForceUpdate-fdiNPOeT.js";import"./EyeOutlined-Dxa6dlDU.js";import"./omit-eplVU8rd.js";import"./ColorPicker-1Ss6KI5t.js";import"./index-a3pSoQMz.js";import"./Overflow-VPTOdTXx.js";import"./index-0ZB4_kR5.js";import"./Info-XBefL4_C.js";import"./NumberInput-hVga-rRO.js";import"./Select-_iK0IFwx.js";import"./ThemeEditor-zLWr2_Cl.js";import"./CardPanel-urQq8oOP.js";function ve(){const[j,v]=p.useState([]),g=p.useRef(null),b=e=>{var t,a;if(e.target.classList.contains("droppable-element")){const s=e.target;(t=e.dataTransfer)==null||t.setData("imageUrl",s.getAttribute("data-url")),(a=e.dataTransfer)==null||a.setData("imageHash",s.getAttribute("data-hash"))}},D=e=>{e.preventDefault()},N=e=>{var n,d;e.preventDefault();const t=(n=e.dataTransfer)==null?void 0:n.getData("imageUrl"),a=(d=e.dataTransfer)==null?void 0:d.getData("imageHash");if(!t)return;const{scale:s,dsContentRef:o}=I,i=o==null?void 0:o.getBoundingClientRect(),c=(e.clientX-((i==null?void 0:i.x)||0))/s,m=(e.clientY-((i==null?void 0:i.y)||0))/s;U("BaseImage",[c,m],t,a)},U=(e,t=[0,0],a,s)=>{const{elemConfigs:o}=R;let{setAddRecordCompId:i}=I;const{definitionMap:c}=S,m=c[e],{compName:n,width:d=320,height:C=200}=m.getBaseInfo(),h=L.generateId(),f={name:n,type:e,x:Math.round(t[0]),y:Math.round(t[1]),id:h,lock:!1,hide:!1,width:d,height:C};i(f.id),A.doAdd(f);const l=m.getInitConfig();l.style.type="local",l.style.localUrl=a,l.style.hash=s,o[h]=l},u=()=>{const{saveType:e,id:t}=x.parseUrlParams();y[e].getImageSourceList(t).then(a=>{v(a)})};p.useEffect(()=>(u(),g.current=new B(document.getElementById("image-source-list"),document.getElementById("designer-ds-content"),b,D,N),()=>{var e;return(e=g.current)==null?void 0:e.destroy()}),[]);const T=e=>{const{saveType:t}=x.parseUrlParams();y[t].delImageSource(e).then(a=>{a&&u()})};return r.jsx("div",{className:"image-source",children:r.jsx("div",{className:"image-source-list",id:"image-source-list",children:j.map((e,t)=>r.jsxs("div",{className:"image-source-item droppable-element",draggable:!0,"data-url":e.url,"data-hash":e.hash,children:[r.jsxs("div",{className:"image-source-item-header",children:[r.jsx("div",{className:"isi-title",children:e.name||"无名称信息"}),r.jsx("div",{className:"isi-operate",children:r.jsx(E,{title:"确认删除吗?",icon:r.jsx(M,{style:{color:"red",position:"relative",top:3,marginRight:2}}),description:"可能会导致已经使用的图片组件失效!",onConfirm:()=>T(e.id),okText:"是",cancelText:"否",children:r.jsx(H,{})})})]}),r.jsx("div",{className:"image-source-item-body",children:r.jsx("div",{className:"item-bg-image",style:{backgroundImage:`url(${e.url})`}})})]},t))})})}export{ve as default};
