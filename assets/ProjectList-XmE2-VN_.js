import{b as p,j as e,r as x}from"./index-Duc4ZoM_.js";import{D as y}from"./LocalOperator-t4oOcFvM.js";import{D as P}from"./Dialog-vSMHMWDI.js";import u from"./Button-Tm3IfQtm.js";import{Grid as _}from"./Grid-qWvRWUZo.js";import z from"./NumberInput-WrPaUvHm.js";import w from"./Input-Fu5_43az.js";import{o as j}from"./index--SWnmJ5Q.js";import{globalMessage as k}from"./GlobalMessage-I0KrOayq.js";import{a as g}from"./index-foMHq-FM.js";import{D as G,A as J,P as q}from"./Delete-FpkYG1bU.js";import{I as F}from"./index-AfMii643.js";import{E as L,P as Z}from"./PreviewOpen-xNkBcbY-.js";import{B as Q}from"./button-cD7Pe9UH.js";import{I as U}from"./index-tOmn1sxg.js";const X=F("copy",!0,function(t){return p.createElement("svg",{width:t.size,height:t.size,viewBox:"0 0 48 48",fill:"none"},p.createElement("path",{d:"M13 12.4316V7.8125C13 6.2592 14.2592 5 15.8125 5H40.1875C41.7408 5 43 6.2592 43 7.8125V32.1875C43 33.7408 41.7408 35 40.1875 35H35.5163",stroke:t.colors[0],strokeWidth:t.strokeWidth,strokeLinecap:t.strokeLinecap,strokeLinejoin:t.strokeLinejoin}),p.createElement("path",{d:"M32.1875 13H7.8125C6.2592 13 5 14.2592 5 15.8125V40.1875C5 41.7408 6.2592 43 7.8125 43H32.1875C33.7408 43 35 41.7408 35 40.1875V15.8125C35 14.2592 33.7408 13 32.1875 13Z",fill:t.colors[1],stroke:t.colors[0],strokeWidth:t.strokeWidth,strokeLinejoin:t.strokeLinejoin}))}),Y="/light-chaser-app/assets/default-snapshot-CKE6I4qV.jpg",ee=t=>{const n={name:"未命名项目",des:"",width:1920,height:1080},a=r=>{r.preventDefault();const{onOk:d}=t;d&&d(n)},c=()=>{const{onCancel:r}=t;r&&r()},{visible:l=!1}=t;return e.jsx(P,{title:"新建大屏",visible:l,className:"add-new-screen-dialog",onClose:c,children:e.jsxs("form",{onSubmit:a,children:[e.jsx("div",{className:"lc-add-new-screen",children:e.jsxs(_,{gridGap:"15px",columns:2,children:[e.jsx(w,{label:"名称",maxLength:20,defaultValue:n.name,onChange:r=>n.name=r}),e.jsx(w,{label:"描述",maxLength:20,onChange:r=>n.des=r}),e.jsx(z,{label:"宽度",min:300,defaultValue:n.width,onChange:r=>n.width=Number(r)}),e.jsx(z,{label:"高度",min:300,defaultValue:n.height,onChange:r=>n.height=Number(r)})]})}),e.jsxs("div",{className:"add-new-screen-explain",children:[e.jsx("p",{children:"说明："}),e.jsx("p",{children:"1、名称不超过20字，描述不超过60字"}),e.jsx("p",{children:"2、宽度必须≥500，高度必须≥300"})]}),e.jsxs("div",{className:"add-new-screen-footer",children:[e.jsx(u,{type:"submit",children:"创建"}),e.jsx(u,{onClick:c,children:"取消"})]})]})})},se=x.memo(t=>{const{onOk:n,onCancel:a,visible:c}=t;return e.jsxs(P,{title:"删除确认",visible:c,onClose:a,children:[e.jsx("div",{style:{color:"#aeaeae",padding:10},children:"确定要删除该项目吗？"}),e.jsxs("div",{className:"del-pro-confirm",style:{display:"flex",justifyContent:"flex-end",borderTop:"2px solid #272b34",paddingTop:5},children:[e.jsx(u,{onClick:n,children:"确认"}),"  ",e.jsx(u,{onClick:a,children:"取消"})]})]})}),ne=t=>{const{onOk:n,onCancel:a,visible:c}=t,l=r=>{r.preventDefault(),n()};return e.jsxs(P,{title:"克隆项目",visible:c,onClose:a,children:[e.jsx("div",{style:{color:"#a7a7a7",padding:10},children:"确认复制吗？"}),e.jsxs("div",{className:"del-pro-confirm",style:{display:"flex",justifyContent:"flex-end",borderTop:"2px solid #272b34",paddingTop:10},children:[e.jsx(u,{onClick:l,children:"确认"}),"   ",e.jsx(u,{onClick:a,children:"取消"})]})]})};function te(t){const{cover:n,id:a,saveType:c,doOperate:l}=t,[r,d]=x.useState(!1),[m,v]=x.useState(t.name),f=()=>{if(m!==t.name){const s={id:a,name:m};j[c].updateProject(s)}};return e.jsxs("div",{className:"project-list-item",children:[e.jsx("div",{className:"project-item-cover",style:{backgroundImage:`url(${n})`},children:e.jsxs("div",{className:"operate-icon-list",children:[e.jsx("div",{className:"operate-icon",children:e.jsx(g,{content:"编辑项目",children:e.jsx(L,{onClick:()=>l(a,"edit")})})}),e.jsx("div",{className:"operate-icon",children:e.jsx(g,{content:"预览项目",children:e.jsx(Z,{onClick:()=>l(a,"show")})})}),e.jsx("div",{className:"operate-icon",children:e.jsx(g,{content:"删除项目",children:e.jsx(G,{onClick:()=>l(a,"del")})})}),e.jsx("div",{className:"operate-icon",children:e.jsx(g,{content:"复制项目",children:e.jsx(X,{onClick:()=>l(a,"clone")})})})]})}),e.jsxs("div",{className:"project-item-content",children:[e.jsx("div",{className:"project-name",children:r?e.jsx(w,{className:"project-rename-input",type:"text",autoFocus:!0,value:m,onBlur:()=>{d(!1),f()},onKeyDown:s=>{s.key==="Enter"&&(d(!1),f())},onChange:s=>v(s)}):e.jsx("div",{className:"project-name-content",children:m})}),e.jsx("div",{className:"rename-icon",onClick:()=>d(!0),children:r||e.jsx(g,{content:"重命名",children:e.jsx(L,{})})})]})]})}const{Search:oe}=U,Ce=x.memo(t=>{const{saveType:n}=t,[a,c]=p.useState(!1),[l,r]=p.useState(!1),[d,m]=p.useState(!1),v=x.useRef(""),f=x.useRef(""),[s,N]=p.useState({records:[],total:0,current:1,size:24}),C=(o,i,h)=>{j[n].getProjectInfoPageList({current:o,size:i,searchValue:h}).then(b=>N(b))},S=()=>c(!a),O=o=>{const{name:i,des:h,width:b,height:H}=o,K={name:i,des:h,saveType:n,dataJson:JSON.stringify({canvasManager:{width:b,height:H}})};j[n].createProject(K).then(I=>{var E;I===""?(E=k.messageApi)==null||E.error("创建失败"):(c(!1),window.open(`/light-chaser-app/#/designer?id=${I}&saveType=${n}&mode=${y.EDIT}`,"_blank"),C(s.current,s.size))})},$=()=>c(!1),T=(o,i)=>{switch(i){case"edit":window.open(`/light-chaser-app/#/designer?id=${o}&saveType=${n}&mode=${y.EDIT}`,"_blank");break;case"show":window.open(`/light-chaser-app/#/view?id=${o}&saveType=${n}&mode=${y.VIEW}`,"_blank");break;case"del":v.current=o,r(!0);break;case"clone":f.current=o,m(!0);break}},V=()=>r(!1),R=()=>{j[n].copyProject(f.current).then(o=>{var i,h;o!==""?(m(!1),C(s.current,s.size),(i=k.messageApi)==null||i.success("克隆成功")):(h=k.messageApi)==null||h.error("克隆失败")})},A=()=>m(!1),M=()=>{j[n].deleteProject(v.current).then(o=>{var i;o?(r(!1),C(s.current,s.size)):(i=k.messageApi)==null||i.error("删除失败")})},W=(o,i)=>{j[n].getProjectInfoPageList({current:o,size:i}).then(h=>N(h))},B=o=>{o.key==="Enter"&&D(o.target.value)},D=o=>{j[n].getProjectInfoPageList({current:s.current,size:s.size,searchValue:o}).then(i=>N(i))};return x.useEffect(()=>{C(s.current,s.size)},[]),e.jsxs("div",{className:"project-list-container",children:[e.jsxs("div",{className:"project-list-header",children:[e.jsxs("div",{className:"project-list-header-left",children:[e.jsx(oe,{placeholder:"搜索项目",size:"middle",className:"project-list-search",onKeyDown:B,onSearch:D,style:{width:350}}),e.jsxs(Q,{size:"middle",type:"primary",onClick:S,children:[e.jsx(J,{style:{position:"relative",top:3,marginRight:3}}),"新增"]})]}),e.jsx("div",{className:"project-list-header-right"})]}),e.jsx("div",{className:"project-list",children:s&&s.records.map((o,i)=>e.jsx(te,{id:o.id,name:o.name,cover:o.cover||Y,saveType:n,doOperate:T},o.id))}),e.jsx(q,{rootClassName:"project-list-page",defaultCurrent:s==null?void 0:s.current,pageSize:s==null?void 0:s.size,total:s==null?void 0:s.total,onChange:W}),e.jsx(ee,{onOk:O,onCancel:$,visible:a}),e.jsx(se,{visible:l,onOk:M,onCancel:V}),e.jsx(ne,{onOk:()=>R(),onCancel:A,visible:d})]})});export{Ce as P};
