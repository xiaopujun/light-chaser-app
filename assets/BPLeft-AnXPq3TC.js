import{r as c,j as e}from"./index-9HRRaiAT.js";import{aK as l,aY as x,aZ as j,F as N,a_ as O,a$ as L,aW as V,l as B,aE as h}from"./LayerManager-VZvizn0l.js";import{o as p}from"./Dialog-zSzMu_Kg.js";import{D as H}from"./DragAddProvider-_IIQLnDx.js";import{I as w}from"./Button-I8g-a3mm.js";import{A as b,_ as m}from"./AntdIcon-HHnanCFf.js";import"./FetchUtil-Ivd_z0Im.js";import"./Accordion-QZecLODC.js";import"./Switch-nY0zP6zi.js";import"./MainRouter-RJOuNalv.js";import"./useZIndex-jf7RdiJ7.js";import"./Overflow-cY8uLRw2.js";import"./GlobalMessage-YmTFHLN4.js";import"./Radio-uKn8r_jl.js";import"./ColorPicker-CILYDljY.js";import"./CardPanel-EF85JJoG.js";import"./Grid-9fFUumjJ.js";var A={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908 640H804V488c0-4.4-3.6-8-8-8H548v-96h108c8.8 0 16-7.2 16-16V80c0-8.8-7.2-16-16-16H368c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h108v96H228c-4.4 0-8 3.6-8 8v152H116c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h288c8.8 0 16-7.2 16-16V656c0-8.8-7.2-16-16-16H292v-88h440v88H620c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h288c8.8 0 16-7.2 16-16V656c0-8.8-7.2-16-16-16zm-564 76v168H176V716h168zm84-408V140h168v168H428zm420 576H680V716h168v168z"}}]},name:"apartment",theme:"outlined"};const I=A;var g=function(a,n){return c.createElement(b,m(m({},a),{},{ref:n,icon:I}))};g.displayName="ApartmentOutlined";const S=c.forwardRef(g);var z={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 392c8.8 0 16-7.2 16-16V192c0-8.8-7.2-16-16-16H744c-8.8 0-16 7.2-16 16v56H296v-56c0-8.8-7.2-16-16-16H96c-8.8 0-16 7.2-16 16v184c0 8.8 7.2 16 16 16h56v240H96c-8.8 0-16 7.2-16 16v184c0 8.8 7.2 16 16 16h184c8.8 0 16-7.2 16-16v-56h432v56c0 8.8 7.2 16 16 16h184c8.8 0 16-7.2 16-16V648c0-8.8-7.2-16-16-16h-56V392h56zM792 240h88v88h-88v-88zm-648 88v-88h88v88h-88zm88 456h-88v-88h88v88zm648-88v88h-88v-88h88zm-80-64h-56c-8.8 0-16 7.2-16 16v56H296v-56c0-8.8-7.2-16-16-16h-56V392h56c8.8 0 16-7.2 16-16v-56h432v56c0 8.8 7.2 16 16 16h56v240z"}}]},name:"gateway",theme:"outlined"};const M=z;var f=function(a,n){return c.createElement(b,m(m({},a),{},{ref:n,icon:M}))};f.displayName="GatewayOutlined";const k=c.forwardRef(f),le=()=>e.jsxs("div",{className:"bp-left",children:[e.jsx(E,{}),e.jsx($,{})]}),E=p(()=>{const{activeMenu:t}=l,a=[{icon:e.jsx(O,{}),label:"图层节点",key:"layer"},{icon:e.jsx(S,{}),label:"逻辑节点",key:"logical"},{icon:e.jsx(k,{}),label:"全局变量",key:"global"},{icon:e.jsx(L,{}),label:"过滤器",key:"filter"}];return e.jsx("div",{className:"bp-node-sort-list",children:a.map((n,s)=>e.jsxs("div",{className:`bp-left-item ${t===n.key?"bp-left-item-active":""}`,onClick:()=>{l.setActiveMenu(n.key)},children:[e.jsx("div",{className:"bp-item-icon",children:n.icon}),e.jsx("div",{className:"bp-item-label",children:n.label})]},s))})}),G=t=>{var a,n;if(t.target.classList.contains("bp-drag-node")){const s=t.target;(a=t.dataTransfer)==null||a.setData("nodeId",s.getAttribute("data-id")),(n=t.dataTransfer)==null||n.setData("type",s.getAttribute("data-type"))}},P=t=>{t.preventDefault()},D=t=>{var u,v;t.preventDefault();let a=(u=t.dataTransfer)==null?void 0:u.getData("nodeId");const n=(v=t.dataTransfer)==null?void 0:v.getData("type"),{bpDragContentRef:s,canvasScale:r}=h,i=s==null?void 0:s.getBoundingClientRect(),d={x:(t.clientX-((i==null?void 0:i.x)||0))/r,y:(t.clientY-((i==null?void 0:i.y)||0))/r};if(n==="layer-node"){const{setUsedLayerNodes:y}=l;y(a,!0)}else a=V.generateId();const{addBPNodeLayout:o}=h;o({id:a,type:n,position:d})},$=p(()=>{const{activeMenu:t,setSearchValue:a}=l,n=_[t],s=c.useRef(null);return c.useEffect(()=>(s.current=new H(document.getElementById("bp-node-draggable"),document.getElementById("bp-ds-container"),G,P,D),()=>{var r;return(r=s.current)==null?void 0:r.destroy()}),[t]),e.jsxs("div",{className:"bp-node-list",children:[e.jsx("div",{className:"bp-node-list-header",children:e.jsx("div",{className:"bp-node-list-search",children:e.jsx(w,{placeholder:"搜索节点",containerStyle:{width:"100%"},onChange:r=>a(r)})})}),e.jsx("div",{className:"bp-node-list-body",children:e.jsx("div",{className:"bp-node-list-container",id:"bp-node-draggable",style:{overflow:"scroll"},children:n&&e.jsx(n,{})})})]})}),F=p(()=>{const{layerConfigs:t}=B,{usedLayerNodes:a,searchValue:n}=l;let s=t?Object.keys(t):[];return n!==""&&(s=s.filter(r=>{var d;return((d=t[r].name)==null?void 0:d.indexOf(l.searchValue))!==-1})),e.jsx(e.Fragment,{children:s.map((r,i)=>{const d=t[r],o=a[r];return e.jsxs("div",{className:`bp-node-list-item bp-drag-node ${o?"bp-node-list-item-used":""}`,"data-id":d.id,"data-type":"layer-node",draggable:!o,children:[e.jsx("div",{className:"bpn-li-icon",children:e.jsx(x,{})}),e.jsx("div",{className:"bpn-li-label",children:d.name})]},i)})})}),C=p(()=>{const t=[{name:"条件判断",icon:j,type:"condition-node"},{name:"逻辑处理",icon:N,type:"logical-process-node"}].filter(a=>a.name.indexOf(l.searchValue)!==-1);return e.jsx(e.Fragment,{children:t.map((a,n)=>e.jsxs("div",{className:"bp-node-list-item bp-drag-node","data-type":a.type,draggable:!0,children:[e.jsx("div",{className:"bpn-li-icon",children:e.jsx(a.icon,{})}),e.jsx("div",{className:"bpn-li-label",children:a.name})]},n))})}),R=()=>e.jsx("div",{children:"开发中..."}),T=()=>e.jsx("div",{children:"开发中..."}),_={layer:F,logical:C,global:R,filter:T};export{T as BPFilterNodeList,R as BPGlobalVariablesNodeList,F as BPLayerNodeList,C as BPLogicalNodeList,$ as BPNodeList,E as BPNodeSortList,le as default,_ as nodeListMapping};
