import{U as g,D as h}from"./LocalOperator-BbYzoZ36.js";import{A as x,B as C}from"./FontGlobal-I0xzNbJH.js";import{C as k}from"./LayerManager-yWnDoBOm.js";import{r,j as m}from"./index-OsS9UfkW.js";import{O as E}from"./ObjectUtil-nMvTrJhh.js";import"./GlobalMessage-FQtvcjbG.js";import"./MainRouter-Z3gK7D7G.js";import"./useZIndex-g2cfol2D.js";import"./mobxreact.esm-rNVktGB7.js";import"./PreviewOpen-nQ2Iv4_U.js";import"./index-K2O65-hP.js";import"./FetchUtil-Ivd_z0Im.js";import"./index-APrWN4Qi.js";const v=r.forwardRef((c,n)=>{const[t,o]=r.useState({...c}),{style:i,data:s}=t,[u,l]=r.useState(!1),a=r.useRef({}),p=r.useRef(null);r.useImperativeHandle(n,()=>({updateConfig:e=>o({...e}),setEventHandler:e=>a.current=e}));const f=()=>{"click"in a.current&&a.current.click()},d={WebkitTextStrokeWidth:i==null?void 0:i.strokeWidth,WebkitTextStrokeColor:i==null?void 0:i.strokeColor};return m.jsx("div",{onDoubleClick:()=>l(!0),ref:p,className:"base-text-component",style:{...i,...d},onKeyDown:e=>e.stopPropagation(),onClick:f,children:u?m.jsx("input",{ref:e=>e==null?void 0:e.select(),onChange:e=>s.staticData=e.target.value,onBlur:()=>l(!1),autoFocus:!0,type:"text",defaultValue:s==null?void 0:s.staticData}):s==null?void 0:s.staticData})});class I extends x{async create(n,t){this.config=t,this.container=n,this.instance=await k.createAndRender(n,v,t);const{mode:o}=g.parseUrlParams();o===h.EDIT&&(this.container.style.pointerEvents="auto")}destroy(){this.instance=null,this.config=null}getConfig(){return this.config}update(n,t){var o;this.config=E.merge(this.config,n),t=t||{reRender:!0},t.reRender&&((o=this.instance)==null||o.updateConfig(this.config))}updateTheme(n){}registerEvent(){var n,t;if(this.instance){const o=(t=(n=this.config)==null?void 0:n.base)==null?void 0:t.id;this.instance.setEventHandler({click:()=>C.triggerComponentEvent(o,"click",this.config)})}}}export{I as BaseTextController};
