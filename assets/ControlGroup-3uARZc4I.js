import{r as s,b as x,j as e,L as D}from"./index-GgIRiX8R.js";import{w as v,l as k,k as E,O as P}from"./Dialog-SXVfEtoy.js";import{A as m,_ as i}from"./AntdIcon-VOxU8Y5T.js";import{C as G}from"./CaretDownFilled-FOAOknrt.js";import{D as L}from"./DeleteFilled-zZzDigff.js";import"./MainRouter-hXsbV2Mr.js";import"./useZIndex-P8KKfqMZ.js";import"./Overflow-xN1J9DWZ.js";import"./GlobalMessage-mWsH3gwQ.js";var j=function(o,n){return s.createElement(m,i(i({},o),{},{ref:n,icon:G}))};j.displayName="CaretDownFilled";const $=s.forwardRef(j);var U={icon:{tag:"svg",attrs:{viewBox:"0 0 1024 1024",focusable:"false"},children:[{tag:"path",attrs:{d:"M715.8 493.5L335 165.1c-14.2-12.2-35-1.2-35 18.5v656.8c0 19.7 20.8 30.7 35 18.5l380.8-328.4c10.9-9.4 10.9-27.6 0-37z"}}]},name:"caret-right",theme:"filled"};const z=U;var F=function(o,n){return s.createElement(m,i(i({},o),{},{ref:n,icon:z}))};F.displayName="CaretRightFilled";const A=s.forwardRef(F);var I={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm192 472c0 4.4-3.6 8-8 8H544v152c0 4.4-3.6 8-8 8h-48c-4.4 0-8-3.6-8-8V544H328c-4.4 0-8-3.6-8-8v-48c0-4.4 3.6-8 8-8h152V328c0-4.4 3.6-8 8-8h48c4.4 0 8 3.6 8 8v152h152c4.4 0 8 3.6 8 8v48z"}}]},name:"plus-circle",theme:"filled"};const O=I;var b=function(o,n){return s.createElement(m,i(i({},o),{},{ref:n,icon:O}))};b.displayName="PlusCircleFilled";const V=s.forwardRef(b),W=c=>{const{label:o,defaultValue:n=[],template:u,itemName:p}=c,[h,N]=x.useState(!1),R=v.parseSchemaData(u),g={children:[]};n.forEach((r,t)=>{var a;(a=g.children)==null||a.push({type:"accordion",key:t+"",label:(p||"系列")+(t+1),children:[{...v.schemaStructureAssignment(r,k.cloneDeep(u))}]})});const l=s.useRef(n),[d,f]=x.useState(g),w=()=>{var a;const{template:r}=c;if(!r)return;(a=d.children)==null||a.push({type:"accordion",key:l.current.length+"",label:(p||"系列")+(l.current.length+1),children:[r]}),f({...d}),l.current=[...l.current,{...R}];const{onChange:t}=c;t&&t(l.current)},S=()=>{var t;(t=d.children)==null||t.pop(),f({...d}),l.current.pop();const{onChange:r}=c;r&&r(l.current)},y=r=>{const{dataFragment:t}=r,a=Number(Object.keys(t)[0]);l.current[a]=P.merge(l.current[a],t[a]);const{onChange:C}=c;C&&C(l.current)};return e.jsxs("div",{className:"control-group",children:[e.jsxs("div",{className:"control-group-header",children:[e.jsx("div",{className:"cgh-label",children:e.jsx("span",{children:o})}),e.jsxs("div",{className:"cgh-operate",children:[e.jsx("span",{className:"operate-icon",onClick:S,children:e.jsx(L,{})}),e.jsx("span",{className:"operate-icon",onClick:w,children:e.jsx(V,{})}),e.jsx("span",{className:"operate-icon toggle-icon",onClick:()=>N(!h),children:h?e.jsx($,{}):e.jsx(A,{})})]})]}),h&&e.jsx("div",{className:"control-group-body",style:{display:h?"block":"none"},children:e.jsx(s.Suspense,{fallback:e.jsx(D,{}),children:e.jsx(E,{schema:d,onFieldChange:y})})})]})};export{W as default};
