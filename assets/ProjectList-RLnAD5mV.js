import{R as c,j as e,r as u}from"./index-OsS9UfkW.js";import{D as w}from"./LocalOperator-BbYzoZ36.js";import{D as P}from"./Dialog-BERcuBcz.js";import f from"./Button-tVc5ioar.js";import{Grid as Z}from"./Grid-pJgl1oS6.js";import E from"./NumberInput-jcBc5L4J.js";import N from"./Input-0x6URBKt.js";import{o as x}from"./index-APrWN4Qi.js";import{g as C}from"./GlobalMessage-FQtvcjbG.js";import{P as g}from"./index-wIpC5sck.js";import{I as W}from"./index-K2O65-hP.js";import{E as I,P as _}from"./PreviewOpen-nQ2Iv4_U.js";import{P as G}from"./Pagination-x2iFZu2c.js";const J=W("copy",!0,function(t){return c.createElement("svg",{width:t.size,height:t.size,viewBox:"0 0 48 48",fill:"none"},c.createElement("path",{d:"M13 12.4316V7.8125C13 6.2592 14.2592 5 15.8125 5H40.1875C41.7408 5 43 6.2592 43 7.8125V32.1875C43 33.7408 41.7408 35 40.1875 35H35.5163",stroke:t.colors[0],strokeWidth:t.strokeWidth,strokeLinecap:t.strokeLinecap,strokeLinejoin:t.strokeLinejoin}),c.createElement("path",{d:"M32.1875 13H7.8125C6.2592 13 5 14.2592 5 15.8125V40.1875C5 41.7408 6.2592 43 7.8125 43H32.1875C33.7408 43 35 41.7408 35 40.1875V15.8125C35 14.2592 33.7408 13 32.1875 13Z",fill:t.colors[1],stroke:t.colors[0],strokeWidth:t.strokeWidth,strokeLinejoin:t.strokeLinejoin}))}),q=W("delete",!1,function(t){return c.createElement("svg",{width:t.size,height:t.size,viewBox:"0 0 48 48",fill:"none"},c.createElement("path",{d:"M9 10V44H39V10H9Z",fill:t.colors[1],stroke:t.colors[0],strokeWidth:t.strokeWidth,strokeLinejoin:t.strokeLinejoin}),c.createElement("path",{d:"M20 20V33",stroke:t.colors[2],strokeWidth:t.strokeWidth,strokeLinecap:t.strokeLinecap,strokeLinejoin:t.strokeLinejoin}),c.createElement("path",{d:"M28 20V33",stroke:t.colors[2],strokeWidth:t.strokeWidth,strokeLinecap:t.strokeLinecap,strokeLinejoin:t.strokeLinejoin}),c.createElement("path",{d:"M4 10H44",stroke:t.colors[0],strokeWidth:t.strokeWidth,strokeLinecap:t.strokeLinecap,strokeLinejoin:t.strokeLinejoin}),c.createElement("path",{d:"M16 10L19.289 4H28.7771L32 10H16Z",fill:t.colors[1],stroke:t.colors[0],strokeWidth:t.strokeWidth,strokeLinejoin:t.strokeLinejoin}))}),F="/light-chaser-app/assets/default-snapshot-CKE6I4qV.jpg",Q=t=>{const s={name:"未命名项目",des:"",width:1920,height:1080},r=i=>{i.preventDefault();const{onOk:h}=t;h&&h(s)},l=()=>{const{onCancel:i}=t;i&&i()},{visible:d=!1}=t;return e.jsx(P,{title:"新建大屏",visible:d,className:"add-new-screen-dialog",onClose:l,children:e.jsxs("form",{onSubmit:r,children:[e.jsx("div",{className:"lc-add-new-screen",children:e.jsxs(Z,{gridGap:"15px",columns:2,children:[e.jsx(N,{label:"名称",maxLength:20,defaultValue:s.name,onChange:i=>s.name=i}),e.jsx(N,{label:"描述",maxLength:20,onChange:i=>s.des=i}),e.jsx(E,{label:"宽度",min:300,defaultValue:s.width,onChange:i=>s.width=Number(i)}),e.jsx(E,{label:"高度",min:300,defaultValue:s.height,onChange:i=>s.height=Number(i)})]})}),e.jsxs("div",{className:"add-new-screen-explain",children:[e.jsx("p",{children:"说明："}),e.jsx("p",{children:"1、名称不超过20字，描述不超过60字"}),e.jsx("p",{children:"2、宽度必须≥500，高度必须≥300"})]}),e.jsxs("div",{className:"add-new-screen-footer",children:[e.jsx(f,{type:"submit",children:"创建"}),e.jsx(f,{onClick:l,children:"取消"})]})]})})},U=u.memo(t=>{const{onOk:s,onCancel:r,visible:l}=t;return e.jsxs(P,{title:"删除确认",visible:l,onClose:r,children:[e.jsx("div",{style:{color:"#aeaeae",padding:10},children:"确定要删除该项目吗？"}),e.jsxs("div",{className:"del-pro-confirm",style:{display:"flex",justifyContent:"flex-end",borderTop:"2px solid #272b34",paddingTop:5},children:[e.jsx(f,{onClick:s,children:"确认"}),"  ",e.jsx(f,{onClick:r,children:"取消"})]})]})}),X=t=>{const{onOk:s,onCancel:r,visible:l}=t,d=i=>{i.preventDefault(),s()};return e.jsxs(P,{title:"克隆项目",visible:l,onClose:r,children:[e.jsx("div",{style:{color:"#a7a7a7",padding:10},children:"确认复制吗？"}),e.jsxs("div",{className:"del-pro-confirm",style:{display:"flex",justifyContent:"flex-end",borderTop:"2px solid #272b34",paddingTop:10},children:[e.jsx(f,{onClick:d,children:"确认"}),"   ",e.jsx(f,{onClick:r,children:"取消"})]})]})};function Y(t){const{cover:s,id:r,saveType:l,doOperate:d}=t,[i,h]=u.useState(!1),[m,v]=u.useState(t.name),k=()=>{if(m!==t.name){const n={id:r,name:m};x[l].updateProject(n)}};return e.jsxs("div",{className:"project-list-item",children:[e.jsx("div",{className:"project-item-cover",style:{backgroundImage:`url(${s})`},children:e.jsxs("div",{className:"operate-icon-list",children:[e.jsx("div",{className:"operate-icon",children:e.jsx(g,{content:"编辑项目",children:e.jsx(I,{onClick:()=>d(r,"edit")})})}),e.jsx("div",{className:"operate-icon",children:e.jsx(g,{content:"预览项目",children:e.jsx(_,{onClick:()=>d(r,"show")})})}),e.jsx("div",{className:"operate-icon",children:e.jsx(g,{content:"删除项目",children:e.jsx(q,{onClick:()=>d(r,"del")})})}),e.jsx("div",{className:"operate-icon",children:e.jsx(g,{content:"复制项目",children:e.jsx(J,{onClick:()=>d(r,"clone")})})})]})}),e.jsxs("div",{className:"project-item-content",children:[e.jsx("div",{className:"project-name",children:i?e.jsx(N,{className:"project-rename-input",type:"text",autoFocus:!0,value:m,onBlur:()=>{h(!1),k()},onKeyDown:n=>{n.key==="Enter"&&(h(!1),k())},onChange:n=>v(n)}):e.jsx("div",{className:"project-name-content",children:m})}),e.jsx("div",{className:"rename-icon",onClick:()=>h(!0),children:i||e.jsx(g,{content:"重命名",children:e.jsx(I,{})})})]})]})}const je=u.memo(t=>{const{saveType:s}=t,[r,l]=c.useState(!1),[d,i]=c.useState(!1),[h,m]=c.useState(!1),v=u.useRef(""),k=u.useRef(""),[n,L]=c.useState({records:[],total:0,current:1,size:24}),p=(o,a,j)=>{x[s].getProjectInfoPageList({current:o,size:a,searchValue:j}).then(b=>L(b))},V=()=>l(!r),z=o=>{const{name:a,des:j,width:b,height:B}=o,K={name:a,des:j,saveType:s,dataJson:JSON.stringify({canvasManager:{width:b,height:B}})};x[s].createProject(K).then(y=>{var D;y===""?(D=C.messageApi)==null||D.error("创建失败"):(l(!1),window.open(`/light-chaser-app/#/designer?id=${y}&saveType=${s}&mode=${w.EDIT}`,"_blank"),p(n.current,n.size))})},O=()=>l(!1),M=(o,a)=>{switch(a){case"edit":window.open(`/light-chaser-app/#/designer?id=${o}&saveType=${s}&mode=${w.EDIT}`,"_blank");break;case"show":window.open(`/light-chaser-app/#/view?id=${o}&saveType=${s}&mode=${w.VIEW}`,"_blank");break;case"del":v.current=o,i(!0);break;case"clone":k.current=o,m(!0);break}},S=()=>i(!1),T=()=>{x[s].copyProject(k.current).then(o=>{var a,j;o!==""?(m(!1),p(n.current,n.size),(a=C.messageApi)==null||a.success("克隆成功")):(j=C.messageApi)==null||j.error("克隆失败")})},H=()=>m(!1),$=()=>{x[s].deleteProject(v.current).then(o=>{var a;o?(i(!1),p(n.current,n.size)):(a=C.messageApi)==null||a.error("删除失败")})},R=(o,a)=>{x[s].getProjectInfoPageList({current:o,size:a}).then(j=>L(j))},A=o=>{o.key==="Enter"&&x[s].getProjectInfoPageList({current:n.current,size:n.size,searchValue:o.target.value}).then(a=>L(a))};return u.useEffect(()=>{p(n.current,n.size)},[]),e.jsxs("div",{className:"project-list-container",children:[e.jsxs("div",{className:"project-list-header",children:[e.jsx("div",{className:"project-list-header-left",children:e.jsx(N,{className:"list-search",placeholder:"搜索项目",onKeyDown:A})}),e.jsx("div",{className:"project-list-header-right",children:e.jsx(f,{onClick:V,children:"+ 创建"})})]}),e.jsx("div",{className:"project-list",children:n&&n.records.map((o,a)=>e.jsx(Y,{id:o.id,name:o.name,cover:o.cover||F,saveType:s,doOperate:M},o.id))}),e.jsx(G,{rootClassName:"project-list-page",defaultCurrent:n==null?void 0:n.current,pageSize:n==null?void 0:n.size,total:n==null?void 0:n.total,onChange:R}),e.jsx(Q,{onOk:z,onCancel:O,visible:r}),e.jsx(U,{visible:d,onOk:$,onCancel:S}),e.jsx(X,{onOk:()=>T(),onCancel:H,visible:h})]})});export{je as P};
