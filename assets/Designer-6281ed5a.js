var St=Object.defineProperty;var It=(i,l,e)=>l in i?St(i,l,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[l]=e;var a=(i,l,e)=>(It(i,typeof l!="symbol"?l+"":l,e),e);import{r as h,A as ie,_ as w,j as s,c as Ot,e as Fe,f as ae,o as fe,g as me,h as y,i as zt,k as _,O as Nt,l as se,L as U,n as Xe,d as m,D as Mt,p as Ge,q as re,s as f,t as Tt,I as Ye,u as De,v as Pt,R as oe,w as Ee,x as Ht,y as Bt,z as _t,C as we,F as At,M as Vt,H as qe,J as Qe,K as Je,N as Ze,Q as et,T as tt,V as $t,W as nt,X as Kt,Y as Gt,Z as Ut,$ as Wt,a0 as Ft,a1 as Xt,a2 as Yt,a3 as qt,a4 as Qt,a5 as Jt,a6 as Zt,a7 as en,a8 as tn,a9 as nn,aa as sn,ab as rn,ac as on,ad as an,ae as ln,af as cn,ag as dn,ah as hn,ai as un,aj as gn,ak as pn,al as fn,am as mn,an as vn,ao as yn,ap as xn}from"./index-c6beea45.js";var Cn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M859.9 168H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zM518.3 355a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V848c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V509.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 355z"}}]},name:"vertical-align-top",theme:"outlined"};const bn=Cn;var st=function(l,e){return h.createElement(ie,w(w({},l),{},{ref:e,icon:bn}))};st.displayName="VerticalAlignTopOutlined";const Ln=h.forwardRef(st);var kn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M942.2 486.2Q889.47 375.11 816.7 305l-50.88 50.88C807.31 395.53 843.45 447.4 874.7 512 791.5 684.2 673.4 766 512 766q-72.67 0-133.87-22.38L323 798.75Q408 838 512 838q288.3 0 430.2-300.3a60.29 60.29 0 000-51.5zm-63.57-320.64L836 122.88a8 8 0 00-11.32 0L715.31 232.2Q624.86 186 512 186q-288.3 0-430.2 300.3a60.3 60.3 0 000 51.5q56.69 119.4 136.5 191.41L112.48 835a8 8 0 000 11.31L155.17 889a8 8 0 0011.31 0l712.15-712.12a8 8 0 000-11.32zM149.3 512C232.6 339.8 350.7 258 512 258c54.54 0 104.13 9.36 149.12 28.39l-70.3 70.3a176 176 0 00-238.13 238.13l-83.42 83.42C223.1 637.49 183.3 582.28 149.3 512zm246.7 0a112.11 112.11 0 01146.2-106.69L401.31 546.2A112 112 0 01396 512z"}},{tag:"path",attrs:{d:"M508 624c-3.46 0-6.87-.16-10.25-.47l-52.82 52.82a176.09 176.09 0 00227.42-227.42l-52.82 52.82c.31 3.38.47 6.79.47 10.25a111.94 111.94 0 01-112 112z"}}]},name:"eye-invisible",theme:"outlined"};const jn=kn;var rt=function(l,e){return h.createElement(ie,w(w({},l),{},{ref:e,icon:jn}))};rt.displayName="EyeInvisibleOutlined";const wn=h.forwardRef(rt);var Dn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"}}]},name:"copy",theme:"outlined"};const Rn=Dn;var ot=function(l,e){return h.createElement(ie,w(w({},l),{},{ref:e,icon:Rn}))};ot.displayName="CopyOutlined";const En=h.forwardRef(ot);var Sn={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"};const In=Sn;var it=function(l,e){return h.createElement(ie,w(w({},l),{},{ref:e,icon:In}))};it.displayName="LockOutlined";const Ue=h.forwardRef(it);var On={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M859.9 780H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zM505.7 669a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V176c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8z"}}]},name:"vertical-align-bottom",theme:"outlined"};const zn=On;var at=function(l,e){return h.createElement(ie,w(w({},l),{},{ref:e,icon:zn}))};at.displayName="VerticalAlignBottomOutlined";const Nn=h.forwardRef(at);class Mn extends h.Component{render(){return s.jsx("div",{className:"structure-header",children:this.props.children})}}class Tn extends h.Component{render(){return s.jsx("div",{className:"structure-body",children:this.props.children})}}class Pn extends h.Component{render(){return s.jsx("div",{className:"structure-body-left",children:this.props.children})}}class Hn extends h.Component{render(){return s.jsx("div",{id:"structureContent",className:"structure-body-content",children:this.props.children})}}class Bn extends h.Component{render(){return s.jsx("div",{className:"structure-body-right",children:this.props.children})}}class _n extends h.Component{render(){return s.jsx("div",{className:"lc-designer-structure",children:this.props.children})}}class An extends h.Component{render(){return s.jsx("div",{className:"structure-foot",children:this.props.children})}}var L=(i=>(i.ALL="all",i.BASE="base",i.ORNAMENTAL="ornamental",i.BAR="bar",i.COLUMN="column",i.LINE="line",i.AREA="area",i.PIE="pie",i.PROGRESS="progress",i.SCATTER="scatter",i.RADAR="radar",i.ROSE="rose",i.WORD_CLOUD="word_cloud",i.HISTOGRAM="histogram",i.SUNBURST="sunburst",i.TREEMAP="treemap",i))(L||{});const Vn="/light-chaser-app/assets/icon-all-f9f00824.svg",$n="/light-chaser-app/assets/icon-bar-f92f84a7.svg",Kn="/light-chaser-app/assets/icon-column-e9b14410.svg",Gn="/light-chaser-app/assets/icon-area-402a8724.svg",Un="/light-chaser-app/assets/icon-pie-2e2d1ba2.svg",Wn="/light-chaser-app/assets/icon-scatter-52100b79.svg",Fn="/light-chaser-app/assets/icon-line-c6de27ac.svg",Xn="/light-chaser-app/assets/icon-loading-f6e3585b.svg",Yn="/light-chaser-app/assets/icon-flowers-c5648457.svg",qn="/light-chaser-app/assets/icon-optimize-5a4981d5.svg",Qn="/light-chaser-app/assets/icon-points-2e2b718b.svg",Jn=()=>[{icon:Vn,name:"全部",classify:L.ALL},{icon:Qn,name:"基础",classify:L.BASE},{icon:qn,name:"装饰",classify:L.ORNAMENTAL},{icon:$n,name:"条形图",classify:L.BAR},{icon:Kn,name:"柱状图",classify:L.COLUMN},{icon:Fn,name:"折线图",classify:L.LINE},{icon:Gn,name:"面积图",classify:L.AREA},{icon:Un,name:"饼图",classify:L.PIE},{icon:Xn,name:"进度图",classify:L.PROGRESS},{icon:Wn,name:"散点图",classify:L.SCATTER},{icon:Yn,name:"玫瑰图",classify:L.ROSE}];class Zn{constructor(){a(this,"classifies",[]);a(this,"classifyKey","all");a(this,"doInit",()=>{this.classifies=Jn()});a(this,"doClear",()=>{this.classifies=[]});a(this,"setClassifyKey",l=>{this.classifyKey=l});Ot(this)}}const pe=new Zn;class es{constructor(){a(this,"compInfoArr",[]);a(this,"compKey","");a(this,"visible",!1);a(this,"doInit",()=>{const l=[],{customComponentInfoMap:e}=ae.getLoader();e&&Object.keys(e).forEach(t=>{let n=e[t].getBaseInfo();n.compKey!=="LcBg"&&l.push(n)}),this.compInfoArr=l});a(this,"setVisible",l=>this.visible=l);a(this,"setCompKey",l=>this.compKey=l);Fe(this,{compKey:fe,visible:fe,setVisible:me,setCompKey:me})}}const W=new es;class ts extends h.Component{constructor(e){super(e);a(this,"changeClassifyKey",e=>{const{setClassifyKey:t}=pe,{setVisible:n,visible:o}=W;t(e.currentTarget.id),o||n&&n(!0)});a(this,"buildClassifyList",()=>{const{classifies:e}=pe;let t=[];for(let n=0;n<e.length;n++){const{icon:o,name:r,classify:c}=e[n];t.push(s.jsxs("div",{className:"sort-item",id:c,onClick:this.changeClassifyKey,children:[s.jsx("div",{className:"sort-item-icon",children:s.jsx("img",{style:{width:20},src:o,alt:"all"})}),s.jsx("span",{className:"sort-item-content",children:r})]},n+""))}return t});const{doInit:t}=pe;t&&t()}render(){const e=this.buildClassifyList();return s.jsx("div",{className:"lc-charts-sort",style:{overflowY:"scroll"},children:e})}}const ns=y(ts);class ss extends h.Component{render(){return s.jsx(ns,{})}}const rs=y(ss);class os extends h.Component{constructor(){super(...arguments);a(this,"menuChange",e=>{const{setActiveMenu:t,setContentVisible:n}=_;t&&t(e.currentTarget.id),n&&n(!0)});a(this,"buildMenuList",()=>{const{menus:e}=_;return e.length===0?s.jsxs("div",{style:{writingMode:"vertical-rl",color:"#ced2d8",letterSpacing:"8px",padding:7,fontSize:12},children:[s.jsx(zt,{style:{fontSize:15,position:"relative",left:2,marginBottom:7}}),"双击组件激活..."]}):e.map(t=>{const n=t.icon;return s.jsxs("div",{className:"menu-item",id:t.key,onClick:this.menuChange,children:[s.jsx("div",{className:"item-icon",children:s.jsx(n,{})}),s.jsx("div",{className:"item-content",children:t.name})]},t.key)})})}render(){return s.jsx("div",{className:"lc-config-menu",children:s.jsx("div",{className:"menu-list",children:this.buildMenuList()})})}}const is=y(os);class as extends h.Component{constructor(){super(...arguments);a(this,"createProxy",e=>new Proxy(e,{get(t,n){const o=t[n];return typeof o=="function"&&o.name==="update"?new Proxy(o,{apply(r,c,u){const g=u[0],p=Nt.getOriginValue(c.config,u[0]);return se.doStyleUpd(g,p),r.apply(c,u)}}):o}}));a(this,"buildConfigContent",()=>{const{compInstances:e}=m;let{activeMenu:t,activeElem:n}=_,o=ae.getLoader().customComponentInfoMap[n.type+""];if(!o)return;const c=o.getMenuToConfigContentMap()[t],u=this.createProxy(e[n.id+""]);return s.jsx(h.Suspense,{fallback:s.jsx(U,{}),children:s.jsx(c,{controller:u})})});a(this,"onClose",()=>{const{setContentVisible:e}=_;e&&e(!1)})}render(){const{activeMenu:e,menus:t}=_;let n="";for(let o=0;o<t.length;o++)if(t[o].key===e){n=t[o].name;break}return s.jsxs("div",{className:"lc-config-panel",children:[s.jsxs("div",{className:"lc-panel-top",children:[s.jsx("div",{className:"panel-title",children:s.jsx("span",{children:n})}),s.jsx("div",{className:"panel-operate",onClick:this.onClose,children:s.jsx(Xe,{})})]}),s.jsx("div",{className:"lc-panel-content",children:this.buildConfigContent()})]})}}const ls=y(as);class cs extends h.Component{render(){const{visible:l}=_;return s.jsxs(s.Fragment,{children:[s.jsx(is,{}),l&&s.jsx(ls,{})]})}}const ds=y(cs);class hs extends h.Component{constructor(){super(...arguments);a(this,"hotkeys",[{name:"保存项目",key:"ctrl + s"},{name:"复制组件",key:"ctrl + v"},{name:"锁定组件",key:"ctrl + l"},{name:"解锁组件",key:"ctrl + shift + l"},{name:"隐藏组件",key:"ctrl + h"},{name:"开/关辅助边框",key:"ctrl + k"},{name:"元素置顶",key:"ctrl + up-arrow(方向上键)"},{name:"元素置底",key:"ctrl + down-arrow(方向下键)"},{name:"删除组件",key:"delete"},{name:"缩放画布",key:"alt + wheel(鼠标滑轮)"},{name:"拖拽画布",key:"长按鼠标右键"},{name:"组件上移",key:"方向上键"},{name:"组件下移",key:"方向下键"},{name:"组件左移",key:"方向左键"},{name:"组件右移",key:"方向右键"},{name:"组件上扩大",key:"ctrl + shift + 方向上键"},{name:"组件下扩大",key:"ctrl + shift + 方向下键"},{name:"组件左扩大",key:"ctrl + shift + 方向左键"},{name:"组件右扩大",key:"ctrl + shift + 方向右键"},{name:"组件上缩小",key:"ctrl + alt + 方向上键"},{name:"组件下缩小",key:"ctrl + alt + 方向下键"},{name:"组件左缩小",key:"ctrl + alt + 方向左键"},{name:"组件右缩小",key:"ctrl + alt + 方向右键"},{name:"撤销",key:"ctrl + z"},{name:"重做",key:"ctrl + shift + z"},{name:"打开/关闭项目设置",key:"ctrl + 1"},{name:"打开/关闭画布设置",key:"ctrl + 2"},{name:"打开/关闭全局主题设置",key:"ctrl + 3"},{name:"打开/关闭图层",key:"ctrl + 4"},{name:"打开/关闭快捷键说明",key:"ctrl + 5"},{name:"编组",key:"ctrl + g"},{name:"解除编组",key:"ctrl + shift + g"}])}render(){return s.jsx("div",{className:"lc-hotkey-des",style:{color:"white"},children:this.hotkeys.map((e,t)=>s.jsxs("div",{className:"hotkey-des-item",children:[s.jsx("div",{className:"hotkey-content",children:s.jsx("code",{children:e.key})}),s.jsx("div",{className:"hotkey-des",children:e.name})]},t))})}}const us="/light-chaser-app/assets/keyboard-icon-11886aee.svg",gs="/light-chaser-app/assets/layers-icon-a0d92a74.svg";class ps extends h.Component{constructor(){super(...arguments);a(this,"toggleHotKeyDes",()=>{const{hotKeyVisible:e,setHotKeyVisible:t}=Ge;t(!e)});a(this,"toggleLayerList",()=>{const{setVisible:e,visible:t}=re;e&&e(!t)})}render(){const{layoutConfigs:e,projectConfig:{name:t,state:n}}=m,{hotKeyVisible:o}=Ge,{scale:r}=f;let c="";switch(n){case"0":c="草稿";break;case"1":c="发布";break;case"2":c="封存";break}return s.jsxs("div",{className:"lc-designer-footer",children:[s.jsxs("div",{className:"footer-left",children:[s.jsxs("div",{className:"footer-item",onClick:this.toggleHotKeyDes,children:[s.jsx("img",{width:16,alt:"快捷键",src:us})," ",s.jsx("span",{style:{position:"relative",top:2},children:"快捷键"})]}),s.jsxs("div",{className:"footer-item",onClick:this.toggleLayerList,children:[s.jsx("img",{width:16,alt:"图层",src:gs})," ",s.jsx("span",{style:{position:"relative",top:2},children:"图层"})]})]}),s.jsxs("div",{className:"footer-right",children:[s.jsxs("div",{className:"right-info-item",children:["缩放 : ",(r*100).toFixed(0),"%"]}),s.jsxs("div",{className:"right-info-item",children:["当前组件数 : ",Object.keys(e).length]}),s.jsxs("div",{className:"right-info-item",children:["项目 : ",t]}),s.jsxs("div",{className:"right-info-item",children:["状态 : ",c]})]}),s.jsx(Mt,{title:"快捷键说明",visible:o,width:500,onClose:this.toggleHotKeyDes,children:s.jsx(hs,{})})]})}}const fs=y(ps);class ms{constructor(){a(this,"target",null);a(this,"dragTarget",null);a(this,"position",{x:0,y:0})}registerDragger(){this.onDragStart(this.target),this.onDragEnd(this.target)}}class vs extends ms{constructor(e,t,n){super();a(this,"position",{x:0,y:0});a(this,"onDragEnd",()=>{this.dragTarget.addEventListener("pointerup",e=>{e.button===0&&(this.dragTarget.releasePointerCapture(e.pointerId),this.dragTarget.removeEventListener("pointermove",this.onDragMove))})});a(this,"onDragMove",e=>{this.position.x+=e.movementX,this.position.y+=e.movementY,this.target.style.transform="translate("+this.position.x+"px, "+this.position.y+"px)"});a(this,"onDragStart",()=>{this.dragTarget.addEventListener("pointerdown",e=>{e.button===0&&(this.dragTarget.setPointerCapture(e.pointerId),this.dragTarget.addEventListener("pointermove",this.onDragMove))})});this.target=e,this.dragTarget=t,this.registerDragger(),n&&(this.position=n)}}class lt extends h.Component{constructor(){super(...arguments);a(this,"panelRef",null);a(this,"dragTargetRef",null);a(this,"onClose",()=>{const{onClose:e}=this.props;e&&e()})}componentDidMount(){const{initPosition:e={x:0,y:0}}=this.props;this.dragTargetRef&&this.panelRef&&new vs(this.panelRef,this.dragTargetRef,e)}render(){const{initPosition:e={x:0,y:0},title:t,className:n,width:o}=this.props;return s.jsxs("div",{className:`float-panel ${n}`,style:{transform:`translate(${e.x}px, ${e.y}px)`,width:o},ref:r=>this.panelRef=r,children:[s.jsxs("div",{className:"panel-title",children:[s.jsx("div",{className:"title-left",children:t}),s.jsx("div",{ref:r=>this.dragTargetRef=r,className:"title-drag-target",style:{width:"50%",height:"100%"}}),s.jsx("div",{className:"title-right",onClick:this.onClose,children:s.jsx("span",{children:s.jsx(Xe,{})})})]}),this.props.children]})}}class ys extends h.Component{constructor(e){super(e);a(this,"dragStart",e=>{if(e.target.classList.contains("droppable-element")){const t=e.target;e.dataTransfer.setData("type",t.getAttribute("data-type")),e.dataTransfer.setData("name",t.getAttribute("data-name"))}});a(this,"dragover",e=>{e.preventDefault()});a(this,"drop",e=>{e.preventDefault();const t=e.dataTransfer.getData("type");if(!t)return;const n=e.dataTransfer.getData("name"),{scale:o,dsContentRef:r}=f,c=r==null?void 0:r.getBoundingClientRect(),u=(e.clientX-((c==null?void 0:c.x)||0))/o,g=(e.clientY-((c==null?void 0:c.y)||0))/o;this.addItem(t,n,[u,g])});a(this,"addItem",(e,t,n)=>{const{addItem:o}=m;let{maxLevel:r,setMaxLevel:c,setAddRecordCompId:u}=f,g={name:t,type:e,width:320,height:200,position:n||[0,0],id:Tt.generateId(),lock:!1,hide:!1,order:++r};u(g.id),c&&c(r),o&&o(g)});a(this,"getChartDom",()=>{let e=[],{classifyKey:t}=pe,{compInfoArr:n,compKey:o}=W;t!=="all"&&(n=n.filter(r=>r.typeKey===t)),o!==""&&(n=n.filter(r=>r.compName.indexOf(o)>=0));for(let r=0;r<n.length;r++){let c=n[r];const{compName:u,compKey:g}=c;let v=ae.getLoader().customComponentInfoMap[g].getChartImg();e.push(s.jsx("div",{className:"list-item droppable-element",draggable:!0,onDoubleClick:()=>this.addItem(g,u),"data-type":g,"data-name":u,children:s.jsxs("div",{style:{pointerEvents:"none"},children:[s.jsxs("div",{className:"item-header",ref:"drag-target",children:[s.jsx("div",{className:"item-name",children:u}),s.jsx("div",{className:"item-type",children:"Antd"})]}),s.jsx("div",{className:"item-content",children:s.jsx("img",{src:v,alt:"组件预览图"})})]})},r+""))}return e});a(this,"onClose",()=>{const{setVisible:e}=W;e&&e(!1)});a(this,"searchChart",e=>{const{setCompKey:t}=W;t&&t(e)});const{doInit:t}=W;t&&t()}componentDidMount(){const e=document.getElementById("designer-ds-content"),t=document.getElementById("component-drag-container");t&&t.addEventListener("dragstart",this.dragStart),e&&e.addEventListener("dragover",this.dragover),e&&e.addEventListener("drop",this.drop)}componentWillUnmount(){const e=document.getElementById("designer-ds-content"),t=document.getElementById("component-drag-container");t&&t.removeEventListener("dragstart",this.dragStart),e&&e.removeEventListener("dragover",this.dragover),e&&e.removeEventListener("drop",this.drop)}render(){return s.jsxs(lt,{className:"comp-list",title:"组件列表",onClose:this.onClose,initPosition:{x:60,y:-window.innerHeight+50},width:190,children:[s.jsx("div",{className:"list-search",children:s.jsx(Ye,{placeholder:"搜索图层",onChange:this.searchChart})}),s.jsx("div",{className:"list-items",id:"component-drag-container",children:this.getChartDom()})]})}}const xs=y(ys);class Cs extends h.Component{constructor(){super(...arguments);a(this,"floatPanelRef",null);a(this,"layerItemsContainerRef",null);a(this,"cancelSelected",e=>{var n;if(!this.floatPanelRef)return;const{panelRef:t}=this.floatPanelRef;if(t&&t.contains(e.target)&&!((n=this.layerItemsContainerRef)!=null&&n.contains(e.target))){const{setTargetIds:o,targetIds:r}=f;r.length>0&&o([])}});a(this,"onClose",()=>{const{setVisible:e}=re;e&&e(!1)});a(this,"searchLayer",e=>{const{setContent:t}=re;t&&t(e)});a(this,"buildLayerList",()=>{const{layoutConfigs:e}=m,{searchContent:t}=re;if(!t||t==="")return De.buildLayerList(e);let n={};return t===":hide"?Object.values(e).forEach(r=>{r.hide&&r.type!=="group"&&(n[r.id]=r)}):t===":lock"?Object.values(e).forEach(r=>{r.lock&&r.type!=="group"&&(n[r.id]=r)}):Object.values(e).forEach(r=>{var c;(c=r.name)!=null&&c.includes(t)&&r.type!=="group"&&(n[r.id]=r)}),Pt.findPathGroupLayer(Object.keys(n)).forEach(r=>{n[r]=e[r]}),De.buildLayerList(n)})}componentDidMount(){var e,t;(t=(e=this.floatPanelRef)==null?void 0:e.panelRef)==null||t.addEventListener("click",this.cancelSelected)}componentWillUnmount(){var e,t;(t=(e=this.floatPanelRef)==null?void 0:e.panelRef)==null||t.removeEventListener("click",this.cancelSelected)}render(){return s.jsxs(lt,{ref:e=>this.floatPanelRef=e,title:"图层",onClose:this.onClose,initPosition:{x:250,y:-window.innerHeight+50},className:"layer-list",children:[s.jsx("div",{className:"list-search",children:s.jsx(Ye,{placeholder:"搜索图层",onChange:this.searchLayer})}),s.jsx("div",{className:"layer-items",children:s.jsx("div",{ref:e=>this.layerItemsContainerRef=e,children:this.buildLayerList()})})]})}}const bs=y(Cs);class Ls extends h.Component{render(){const{visible:l}=W,{visible:e}=re;return s.jsxs(s.Fragment,{children:[l&&s.jsx(xs,{}),e&&s.jsx(bs,{})]})}}const ks=y(Ls);class js{constructor(){a(this,"visible",!1);a(this,"position",[0,0]);a(this,"mouseDownTime",0);a(this,"mouseUpTime",0);a(this,"updateVisible",l=>this.visible=l);a(this,"setPosition",l=>this.position=l);a(this,"setMouseDownTime",l=>this.mouseDownTime=l);a(this,"setMouseUpTime",l=>this.mouseUpTime=l);Fe(this,{visible:fe,position:fe,updateVisible:me,setPosition:me})}}const le=new js;const ws=oe.lazy(()=>Ee(()=>import("./index-c6beea45.js").then(i=>i.aB),["assets/index-c6beea45.js","assets/index-f36b8124.css"])),Ds=oe.lazy(()=>Ee(()=>import("./index-c6beea45.js").then(i=>i.aA),["assets/index-c6beea45.js","assets/index-f36b8124.css"])),Rs=oe.lazy(()=>Ee(()=>import("./index-c6beea45.js").then(i=>i.aC),["assets/index-c6beea45.js","assets/index-f36b8124.css"]));class Es extends h.Component{constructor(){super(...arguments);a(this,"buildHeaderList",()=>{let e=[];const{headerItemInstances:t}=ae.getLoader();for(let n=0;n<t.length;n++){const{icon:o,name:r,onClick:c}=t[n];e.push(s.jsx("div",{className:"right-item",onClick:c,children:s.jsxs("span",{className:"item-span",children:[s.jsx(o,{})," ",r]})},n+""))}return e})}render(){const{canvasVisible:e,projectVisible:t,themeVisible:n,bluePrintVisible:o}=Bt,r=this.buildHeaderList();return s.jsxs("div",{className:"designer-header",children:[s.jsx("div",{className:"header-left",children:s.jsx("div",{className:"header-title",children:"L C"})}),s.jsx("div",{className:"header-right",children:r}),e&&s.jsx(h.Suspense,{fallback:s.jsx(U,{}),children:s.jsx(Ds,{})}),t&&s.jsx(h.Suspense,{fallback:s.jsx(U,{}),children:s.jsx(ws,{})}),n&&s.jsx(h.Suspense,{fallback:s.jsx(U,{}),children:s.jsx(Rs,{})}),o&&s.jsx(h.Suspense,{fallback:s.jsx(U,{}),children:s.jsx(Ht,{})})]})}}const Ss=y(Es);var Re=function(i,l){return Re=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},Re(i,l)};function Is(i,l){if(typeof l!="function"&&l!==null)throw new TypeError("Class extends value "+String(l)+" is not a constructor or null");Re(i,l);function e(){this.constructor=i}i.prototype=l===null?Object.create(l):(e.prototype=l.prototype,new e)}var Os=function(i){Is(l,i);function l(){var t=i!==null&&i.apply(this,arguments)||this;return t.state={scrollPos:0},t.width=0,t.height=0,t._zoom=0,t._rulerScale=0,t._observer=null,t._checkResize=function(){t.resize()},t}var e=l.prototype;return e.render=function(){var t=this.props;return this._zoom=t.zoom,h.createElement("canvas",{ref:_t(this,"canvasElement"),style:this.props.style})},e.componentDidMount=function(){var t=this.props;this.state.scrollPos=t.defaultScrollPos||0;var n=this.canvasElement,o=n.getContext("2d",{alpha:!1});this.canvasContext=o,t.useResizeObserver?(this._observer=new ResizeObserver(this._checkResize),this._observer.observe(n,{box:"border-box"})):this.resize()},e.componentDidUpdate=function(){this.resize()},e.componentWillUnmount=function(){var t;this.state.scrollPos=0,(t=this._observer)===null||t===void 0||t.disconnect()},e.getScrollPos=function(){return this.state.scrollPos},e.scroll=function(t,n){this.draw(t,n)},e.resize=function(t){var n=this.canvasElement,o=this.props,r=o.width,c=o.height,u=o.scrollPos,g=this._getRulerScale();this.width=r||n.offsetWidth,this.height=c||n.offsetHeight,n.width=this.width*g,n.height=this.height*g,this.draw(u,t)},e.draw=function(t,n){t===void 0&&(t=this.state.scrollPos),n===void 0&&(n=this._zoom),this._zoom=n;var o=this.props,r=o,c=r.unit,u=r.type,g=r.backgroundColor,p=r.lineColor,v=r.textColor,x=r.textBackgroundColor,R=r.direction,A=r.negativeRuler,E=A===void 0?!0:A,F=r.segment,X=F===void 0?10:F,D=r.textFormat,Y=r.range,C=Y===void 0?[-1/0,1/0]:Y,Se=r.rangeBackgroundColor,ce=r.selectedRanges,Ie=r.selectedBackgroundColor,Oe=r.lineWidth,gt=Oe===void 0?1:Oe,pt=r.selectedRangesText,ze=r.selectedRangesTextColor,ft=ze===void 0?"#44aaff":ze,Ne=r.selectedRangesTextOffset,mt=Ne===void 0?[0,0]:Ne,V=this._getRulerScale(),q=this.width,Q=this.height,vt=this.state;vt.scrollPos=t;var d=this.canvasContext,k=u==="horizontal",Me=E!==!1,yt=o.font||"10px sans-serif",ve=o.textAlign||"left",xt=o.textOffset||[0,0],ye=k?Q:q,xe=we("".concat(o.mainLineSize||"100%"),ye),Ct=we("".concat(o.longLineSize||10),ye),bt=we("".concat(o.shortLineSize||7),ye),S=o.lineOffset||[0,0];switch(g==="transparent"?d.clearRect(0,0,q*V,Q*V):(d.rect(0,0,q*V,Q*V),d.fillStyle=g,d.fill()),d.save(),d.scale(V,V),d.strokeStyle=p,d.lineWidth=gt,d.font=yt,d.fillStyle=v,d.textAlign=ve,R){case"start":d.textBaseline="top";break;case"center":d.textBaseline="middle";break;case"end":d.textBaseline="bottom";break}d.translate(.5,0),d.beginPath();for(var Ce=k?q:Q,de=n*c,be=Math.floor(t*n/de),Lt=Math.ceil((t*n+Ce)/de),Te=Lt-be,Pe=Math.max(["left","center","right"].indexOf(ve)-1,-1),I=k?Q:q,J=[],M=0;M<=Te;++M){var $=(M+be)*c,Le="".concat($);D&&(Le=D($));var kt=d.measureText(Le).width;J.push({color:v,offset:xt,backgroundColor:x,value:$,text:Le,textSize:kt})}if(Ie!=="transparent"&&(ce!=null&&ce.length)&&ce.forEach(function(j){var T=Math.max(j[0],C[0],E?-1/0:0),O=Math.min(j[1],C[1]),ee=(T-t)*n,te=(O-T)*n;pt&&j.forEach(function(P){var z="".concat(P);D&&(z=D(P));var H=d.measureText(z).width,N=P*n,ge=N+H;At(J,function(G,ne){var B=G.value,Rt=G.textSize,Ke=B*n,Et=Ke+Rt;Ke<=ge&&N<=Et&&J.splice(ne,1)}),J.push({value:P,color:ft,offset:mt,text:z,textSize:H})}),!(te<=0)&&(d.save(),d.fillStyle=Ie,k?d.fillRect(ee,0,te,I):d.fillRect(0,ee,I,te),d.restore())}),Se!=="transparent"&&C[0]!==-1/0&&C[1]!==1/0){var He=(C[0]-t)*n,Be=(C[1]-C[0])*n;d.save(),d.fillStyle=Se,k?d.fillRect(He,0,Be,I):d.fillRect(0,He,I,Be),d.restore()}for(var M=0;M<=Te;++M){var $=M+be;if(!(!Me&&$<0))for(var _e=$*c,jt=(_e-t)*n,K=0;K<X;++K){var he=jt+K/X*de,Ae=_e+K/X*c;if(!(he<0||he>=Ce||Ae<C[0]||Ae>C[1])){var ue=K===0?xe:K%2===0?Ct:bt,Z=0;switch(R){case"start":Z=0;break;case"center":Z=I/2-ue/2;break;case"end":Z=I-ue;break}var Ve=k?[he+S[0],Z+S[1]]:[Z+S[0],he+S[1]],ke=Ve[0],je=Ve[1],$e=k?[ke,je+ue]:[ke+ue,je],wt=$e[0],Dt=$e[1];d.moveTo(ke+S[0],je+S[1]),d.lineTo(wt+S[0],Dt+S[1])}}}d.stroke(),J.forEach(function(j){var T=j.value,O=j.offset,ee=j.backgroundColor,te=j.color,P=j.text,z=j.textSize;if(!(!Me&&T<0)){var H=(T-t)*n;if(!(H<-de||H>=Ce+c*n||T<C[0]||T>C[1])){var N=0;switch(R){case"start":N=17;break;case"center":N=I/2;break;case"end":N=I-17;break}var ge=k?[H+Pe*-3,N]:[N,H+Pe*3],G=ge[0],ne=ge[1];if(ee){var B=0;switch(ve){case"left":B=0;break;case"center":B=-z/2;break;case"right":B=-z;break}d.save(),d.fillStyle=ee,k?d.fillRect(G+O[0]+B,0,z,xe):(d.translate(0,ne+O[1]),d.rotate(-Math.PI/2),d.fillRect(B,0,z,xe)),d.restore()}d.save(),d.fillStyle=te,k?d.fillText(P,G+O[0],ne+O[1]):(d.translate(G+O[0],ne+O[1]),d.rotate(-Math.PI/2),d.fillText(P,0,0)),d.restore()}}}),d.restore()},e._getRulerScale=function(){var t=this.props.defaultPixelScale||2;if(!this._rulerScale){var n=window.devicePixelRatio>1;if(!n&&window.matchMedia){var o=window.matchMedia("only screen and (min--moz-device-pixel-ratio: 1.3), only screen and (-o-min-device-pixel-ratio: 2.6/2), only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen  and (min-device-pixel-ratio: 1.3), only screen and (min-resolution: 1.3dppx)");n=o&&o.matches}this._rulerScale=n?3:t}return this._rulerScale},l.defaultProps={type:"horizontal",zoom:1,width:0,height:0,unit:50,negativeRuler:!0,mainLineSize:"100%",longLineSize:10,shortLineSize:7,segment:10,direction:"end",style:{width:"100%",height:"100%"},backgroundColor:"#333333",font:"10px sans-serif",textColor:"#ffffff",textBackgroundColor:"transparent",lineColor:"#777777",range:[-1/0,1/0],rangeBackgroundColor:"transparent",lineWidth:1,selectedBackgroundColor:"#555555",defaultScrollPos:0},l}(h.PureComponent);const We=Os;class zs extends h.PureComponent{constructor(){super(...arguments);a(this,"state",{render:0});a(this,"rulerX",null);a(this,"rulerY",null);a(this,"unit",50);a(this,"scrollPos",{x:0,y:0});a(this,"baseOffset",20);a(this,"ruleWheel",e=>{const{dsContentRef:t}=f,{x:n,y:o}=t==null?void 0:t.getBoundingClientRect();this.scrollPos.x=-(n-80)/e,this.scrollPos.y=-(o-70)/e,this.unit=Math.floor(50/e),this.setState({render:this.state.render+1})});a(this,"ruleDrag",()=>{const{dsContentRef:e,scale:t}=f,{x:n,y:o}=e==null?void 0:e.getBoundingClientRect();this.scrollPos.x=-(n-80)/t,this.scrollPos.y=-(o-70)/t,this.rulerX&&this.rulerX.scroll(this.scrollPos.x),this.rulerY&&this.rulerY.scroll(this.scrollPos.y)})}componentDidMount(){const{setRuleRef:e}=f;e(this)}render(){const{scale:e}=f;return s.jsxs("div",{className:"lc-ruler",style:{position:"relative"},children:[s.jsx("div",{style:{position:"absolute",width:20,height:20,color:"#838383",textAlign:"center",fontSize:12,top:-1},children:"px"}),s.jsx("div",{className:"lc-ruler-horizontal",style:{height:this.baseOffset,width:`calc(100% - ${this.baseOffset}px)`,position:"relative",left:this.baseOffset},children:s.jsx(We,{ref:t=>this.rulerX=t,scrollPos:this.scrollPos.x,zoom:e,lineColor:"#444b4d",textColor:"#a6a6a6",segment:2,negativeRuler:!0,textOffset:[0,10],backgroundColor:"#1a1a1a",unit:this.unit})}),s.jsx("div",{className:"lc-ruler-vertical",style:{width:this.baseOffset,height:window.innerHeight-this.baseOffset-90,position:"relative",overflow:"hidden"},children:s.jsx(We,{ref:t=>this.rulerY=t,type:"vertical",scrollPos:this.scrollPos.y,lineColor:"#444b4d",textColor:"#a6a6a6",zoom:e,segment:2,negativeRuler:!0,textOffset:[10,0],backgroundColor:"#1a1a1a",unit:this.unit})}),s.jsx("div",{className:"lc-ruler-content",style:{position:"absolute",overflow:"hidden",top:this.baseOffset,left:this.baseOffset},children:this.props.children})]})}}class Ns extends h.Component{render(){return s.jsx("div",{style:{outline:"none"},className:"lc-event-container",children:this.props.children})}}class Ms extends h.Component{constructor(e){super(e);a(this,"movableRef",h.createRef());a(this,"onDragStart",e=>{const{target:t}=e,{layoutConfigs:n}=m,{lock:o}=n[t.id];if(o)return!1});a(this,"onDragEnd",e=>{const{updateLayout:t}=m;let{backoff:n,setBackoff:o}=f;const{lastEvent:r,target:c}=e;if(c.style.cursor="grab",r){const{beforeTranslate:u}=r,g=[{id:c.id,width:c.offsetWidth,height:c.offsetHeight,type:c.dataset.type,position:[u[0],u[1]]}];n?(t(g,!1),o(!1)):se.doDrag(g)}});a(this,"onDragGroupEnd",e=>{var F;const{targets:t,target:n}=e;n.style.cursor="grab";const{updateLayout:o,layoutConfigs:r}=m;if(r[t[0].id].lock)return!1;let{backoff:u,setBackoff:g,setGroupCoordinate:p,groupCoordinate:v}=f,x=[];e.events.forEach(X=>{const{target:D,lastEvent:Y}=X;if(Y){const{beforeTranslate:C}=Y;x.push({id:D.id,width:D.offsetWidth,height:D.offsetHeight,type:D.dataset.type,position:[C[0],C[1]]})}});const R=((F=e==null?void 0:e.lastEvent)==null?void 0:F.beforeTranslate)||[0,0],A=v.minX+R[0],E=v.minY+R[1];p({minX:A,minY:E}),x.length>0&&(u?(o(x,!1),g(!1)):se.doDrag(x))});a(this,"onResizeEnd",e=>{const{updateLayout:t}=m;let{backoff:n,setBackoff:o}=f;const{target:r,lastEvent:c}=e;if(c){const{width:u,height:g,drag:{translate:p},direction:v}=c,x=[{id:r.id,width:u,height:g,type:r.dataset.type,position:[p[0],p[1]]}];n?(t(x,!1),o(!1)):se.doResize(x,v)}});a(this,"onResizeGroupEnd",e=>{const{updateLayout:t}=m;let{backoff:n,setBackoff:o}=f,r=[];if(e.events.forEach(g=>{const{target:p,lastEvent:v}=g;if(v){const{drag:{translate:x}}=v;r.push({id:p.id,width:p.offsetWidth,height:p.offsetHeight,type:p.dataset.type,position:[x[0],x[1]]})}}),!e.lastEvent)return;const{dist:c,direction:u}=e.lastEvent;if(r.length>0){n?(t(r,!1),o(!1)):se.doResize(r,u);const{setGroupCoordinate:g,groupCoordinate:p}=f;u[0]===-1||u[1]===-1?g({minX:p.minX-c[0],minY:p.minY-c[1],groupWidth:p.groupWidth+c[0],groupHeight:p.groupHeight+c[1]}):g({groupWidth:p.groupWidth+c[0],groupHeight:p.groupHeight+c[1]})}});a(this,"onResizeGroup",e=>{e.events.forEach(t=>{t.target.style.width=`${t.width}px`,t.target.style.height=`${t.height}px`,t.target.style.transform=t.drag.transform})});a(this,"onResize",e=>{const{target:t,width:n,height:o,drag:r}=e;t.style.width=`${n}px`,t.style.height=`${o}px`,t.style.transform=`translate(${r.beforeTranslate[0]}px, ${r.beforeTranslate[1]}px)`});a(this,"onResizeStart",e=>{const{target:t}=e,{layoutConfigs:n}=m,{lock:o}=n[t.id];if(o)return!1});a(this,"onDrag",e=>{const{target:t,beforeTranslate:n}=e;t.style.transform=`translate(${n[0]}px, ${n[1]}px)`,t.style.cursor="grabbing"});a(this,"onDragGroup",e=>{const{targets:t,target:n}=e;n.style.cursor="grabbing";const{layoutConfigs:o}=m;if(o[t[0].id].lock)return!1;e.events.forEach(c=>c.target.style.transform=c.transform)});a(this,"onResizeGroupStart",e=>{const{targets:t}=e,{layoutConfigs:n}=m;if(n[t[0].id].lock)return!1});this.state={targets:[]}}componentDidMount(){const{setMovableRef:e}=f;e(this.movableRef)}render(){const{selectorRef:e,targets:t}=f,{canvasConfig:{rasterize:n,dragStep:o,resizeStep:r}}=m,c=document.getElementsByClassName("lc-comp-item");return s.jsxs(s.Fragment,{children:[this.props.children,s.jsx(Vt,{ref:this.movableRef,target:t,draggable:!0,resizable:!0,keepRatio:!1,maxSnapElementGuidelineDistance:300,snappable:!0,snapGap:!1,snapThreshold:5,isDisplaySnapDigit:!0,snapDirections:{top:!0,right:!0,bottom:!0,left:!0,center:!0,middle:!0},elementSnapDirections:{top:!0,right:!0,bottom:!0,left:!0,center:!0,middle:!0},ables:[Ps],dimensionViewable:!0,verticalGuidelines:["0","50%","100%"],horizontalGuidelines:["0","50%","100%"],isDisplayInnerSnapDigit:!0,elementGuidelines:Array.from(c),throttleDrag:n?o:1,throttleResize:n?r:1,onClickGroup:u=>{var g;return(g=e.current)==null?void 0:g.clickTarget(u.inputEvent,u.inputTarget)},onDrag:this.onDrag,onDragStart:this.onDragStart,onDragEnd:this.onDragEnd,onDragGroup:this.onDragGroup,onDragGroupEnd:this.onDragGroupEnd,onResizeStart:this.onResizeStart,onResize:this.onResize,onResizeEnd:this.onResizeEnd,onResizeGroupStart:this.onResizeGroupStart,onResizeGroup:this.onResizeGroup,onResizeGroupEnd:this.onResizeGroupEnd})]})}}const Ts=y(Ms),Ps={name:"dimensionViewable",props:{dimensionViewable:Boolean},events:{},render(i){const l=i.getRect();return s.jsx("div",{className:"moveable-dimension",style:{left:"-125px",top:"-60px",color:"#cacacaff",fontSize:"14px",position:"absolute",boxSizing:"content-box",borderRadius:"5px",padding:"5px",pointerEvents:"none"},children:s.jsxs("div",{children:[s.jsxs("p",{children:["位置: ",Math.round(l.left)," x ",Math.round(l.top)]}),s.jsxs("p",{children:["尺寸: ",Math.round(l.offsetWidth)," x ",Math.round(l.offsetHeight)]})]})},"dimension-viewer")}};class Hs extends h.Component{constructor(){super(...arguments);a(this,"menuList",[{name:"锁定",icon:Ue,onClick:qe},{name:"解锁",icon:Ue,onClick:Qe},{name:"隐藏",icon:wn,onClick:Je},{name:"复制",icon:En,onClick:Ze},{name:"置顶",icon:Ln,onClick:et},{name:"置底",icon:Nn,onClick:tt},{name:"删除",icon:$t,onClick:nt}])}render(){const{visible:e,position:t=[0,0]}=le;let n=[];for(let o=0;o<this.menuList.length;o++){let r=this.menuList[o],c=r.icon;n.push(s.jsxs("div",{className:"menu-item",onClick:r.onClick,children:[s.jsx("label",{children:s.jsx(c,{})}),s.jsx("span",{children:r.name})]},o+""))}return s.jsx(s.Fragment,{children:e&&s.jsx("div",{className:"lc-right-menu",style:{position:"fixed",top:t[1],left:t[0]},children:n})})}}const Bs=y(Hs);var b=(i=>(i[i.SINGLE=0]="SINGLE",i[i.COILED=1]="COILED",i))(b||{});const _s=["control + s","alt","control + l","control + shift + l","control + h","control + k","control + 1","control + 2","control + 3","control + 4","control + 5","control + g"];class As extends h.Component{constructor(e){super(e);a(this,"handlerMapping",{});a(this,"currHotKey",[]);a(this,"existHandlerKey","");a(this,"specialDomCache",{});a(this,"getSpecialDomCache",e=>{const t=this.specialDomCache[e];if(t)return t;{const n=document.querySelector(e);return n?(this.specialDomCache[e]=n,n):null}});a(this,"doHandler",(e,t)=>{const{handler:n,triggerType:o=0,range:r}=this.handlerMapping[t]||{};if(n&&(o===0&&this.existHandlerKey!==t||o===1)){const{pointerTarget:c}=f;if(r){const u=this.getSpecialDomCache(r);if(!u||!u.contains(c))return}Array.isArray(n)?n.forEach(u=>u(e)):n(e),this.existHandlerKey=t}});a(this,"keyDown",e=>{const t=e.key.toLowerCase();this.currHotKey.some(o=>o===t)||this.currHotKey.push(t);let n=this.currHotKey.join(" + ");_s.some(o=>o===n)&&e.preventDefault(),this.doHandler(e,n)});a(this,"keyUp",e=>{const t=e.key.toLowerCase();this.currHotKey.some(n=>n===t)&&(this.currHotKey=this.currHotKey.filter(n=>n!==t),this.existHandlerKey="")});a(this,"onBlur",()=>{this.currHotKey=[],this.existHandlerKey=""});this.handlerMapping=e.handlerMapping}componentDidMount(){document.addEventListener("keydown",this.keyDown),document.addEventListener("keyup",this.keyUp),window.onblur=this.onBlur}componentWillUnmount(){document.removeEventListener("keydown",this.keyDown),document.removeEventListener("keyup",this.keyUp),window.onblur=null}render(){return null}}const Vs={"control + a":{handler:Kt,range:".lc-ruler-content"},"control + v":{handler:Ze,range:".lc-ruler-content"},"control + l":{handler:qe},"control + shift + l":{handler:Qe},"control + h":{handler:Je},"control + arrowup":{handler:et},"control + arrowdown":{handler:tt},"control + s":{handler:Gt},delete:{handler:[Ut,Wt,nt]},"control + z":{handler:Ft,range:".lc-ruler-content"},"control + shift + z":{handler:Xt,range:".lc-ruler-content"},"control + k":{handler:Yt},"control + 1":{handler:qt},"control + 2":{handler:Qt},"control + 3":{handler:Jt},"control + 4":{handler:Zt},"control + 5":{handler:en},arrowup:{handler:tn,triggerType:b.COILED,range:".lc-ruler-content"},arrowdown:{handler:nn,triggerType:b.COILED,range:".lc-ruler-content"},arrowleft:{handler:sn,triggerType:b.COILED,range:".lc-ruler-content"},arrowright:{handler:rn,triggerType:b.COILED,range:".lc-ruler-content"},"control + shift + arrowup":{handler:on,triggerType:b.COILED,range:".lc-ruler-content"},"control + shift + arrowdown":{handler:an,triggerType:b.COILED,range:".lc-ruler-content"},"control + shift + arrowleft":{handler:ln,triggerType:b.COILED,range:".lc-ruler-content"},"control + shift + arrowright":{handler:cn,triggerType:b.COILED,range:".lc-ruler-content"},"control + alt + arrowup":{handler:dn,triggerType:b.COILED,range:".lc-ruler-content"},"control + alt + arrowdown":{handler:hn,triggerType:b.COILED,range:".lc-ruler-content"},"control + alt + arrowleft":{handler:un,triggerType:b.COILED,range:".lc-ruler-content"},"control + alt + arrowright":{handler:gn,triggerType:b.COILED,range:".lc-ruler-content"},"control + g":{handler:pn},"control + shift + g":{handler:fn}},$s=y(i=>{const{children:l,onDoubleClick:e}=i,t=oe.useRef(null),n=oe.useRef(null),{canvasConfig:o}=m;return h.useEffect(()=>{const r=t.current,c=n.current;if(r&&c){const{setDsContentRef:u}=f;u(c);const g=new mn({container:r,content:c,posOffset:{x:80,y:70},scaleCallback:p=>{const{scale:v,ratio:x}=p,{setScale:R,setRatio:A,rulerRef:E}=f;R(v),A(x),E==null||E.ruleWheel(v)},dragCallback:()=>{const{rulerRef:p}=f;p==null||p.ruleDrag()}});return()=>{g.destroy()}}},[]),s.jsx("div",{className:"designer-ds-container",ref:t,style:{overflow:"hidden",height:window.innerHeight-90,width:window.innerWidth-95,backgroundColor:"#434343",position:"relative",cursor:"crosshair"},children:s.jsx("div",{className:"designer-ds-content lc-drag-scale-provider",id:"designer-ds-content",ref:n,onDoubleClick:e,style:{width:o==null?void 0:o.width,height:o==null?void 0:o.height,background:"#1c1c1c",position:"absolute"},children:l})})});class Ks extends h.PureComponent{constructor(){super(...arguments);a(this,"state",{designerRef:null});a(this,"updateActive",e=>{let{id:t,dataset:{type:n}}=e.target;const{activeConfig:o,activeElem:r}=_;vn.isEqual(r,{id:t,type:n})||o(t,n)});a(this,"generateElement",()=>{let{layoutConfigs:e}=m;return Object.values(e).sort((n,o)=>n.order-o.order).map(n=>n.type==="group"?null:s.jsx(yn,{layout:n},n.id))})}componentDidMount(){this.setState({designerRef:document.querySelector(".lc-ruler-content")})}render(){const{layoutConfigs:e}=m;return s.jsxs(s.Fragment,{children:[s.jsx(Ns,{children:s.jsx(xn,{children:s.jsx(zs,{children:s.jsx($s,{onDoubleClick:this.updateActive,children:s.jsx(Ts,{children:De.buildCanvasComponents(e)})})})})}),s.jsx(Bs,{}),s.jsx(As,{handlerMapping:Vs})]})}}const Gs=y(Ks);class Us extends h.Component{componentDidMount(){ae.getLoader().load(),Ws()}componentWillUnmount(){Fs()}render(){const{loaded:l}=m;return l?s.jsxs(_n,{children:[s.jsx(Mn,{children:s.jsx(Ss,{})}),s.jsxs(Tn,{children:[s.jsx(Pn,{children:s.jsx(rs,{})}),s.jsx(Hn,{children:s.jsx(Gs,{})}),s.jsx(Bn,{children:s.jsx(ds,{})})]}),s.jsx(An,{children:s.jsx(fs,{})}),s.jsx(ks,{})]}):s.jsx(U,{})}}const qs=y(Us);function Ws(){document.addEventListener("click",ct),document.addEventListener("contextmenu",dt),document.addEventListener("pointerdown",ht),document.addEventListener("pointerup",ut)}function Fs(){document.removeEventListener("click",ct),document.removeEventListener("contextmenu",dt),document.removeEventListener("pointerdown",ht),document.removeEventListener("pointerup",ut)}const ct=i=>{const{visible:l,updateVisible:e}=le;l&&i.button===0&&setTimeout(()=>{e(!1)})},dt=i=>{i.preventDefault();const{mouseDownTime:l,mouseUpTime:e,setPosition:t,updateVisible:n}=le;["lc-comp-item","moveable-area"].some(r=>i.target.classList.contains(r))&&e-l<200?(n&&n(!0),t([i.clientX,i.clientY])):n&&n(!1)},ht=()=>{const{setMouseDownTime:i}=le;i(Date.now())},ut=i=>{const{setMouseUpTime:l}=le;l(Date.now());const{setPointerTarget:e}=f;e(i.target)};export{qs as default};
