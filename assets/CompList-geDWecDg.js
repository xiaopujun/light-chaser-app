var u=Object.defineProperty;var x=(p,s,t)=>s in p?u(p,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):p[s]=t;var d=(p,s,t)=>(x(p,typeof s!="symbol"?s+"":s,t),t);import{r as I,j as i}from"./index-OsS9UfkW.js";import{o as D}from"./mobxreact.esm-rNVktGB7.js";import{h as y,D as v,e as h,i as C}from"./LayerManager-yWnDoBOm.js";import{I as j,D as b}from"./LocalOperator-BbYzoZ36.js";import N from"./Input-0x6URBKt.js";import{c as g}from"./DesignerPage-eo07yA5W.js";import{D as A}from"./DragAddProvider-_IIQLnDx.js";import"./ObjectUtil-nMvTrJhh.js";import"./index-K2O65-hP.js";import"./index-APrWN4Qi.js";import"./GlobalMessage-FQtvcjbG.js";import"./MainRouter-Z3gK7D7G.js";import"./useZIndex-g2cfol2D.js";import"./FetchUtil-Ivd_z0Im.js";import"./UIContainer-QUMruXjD.js";import"./index-hcrqZ8so.js";import"./ResizeObserver.es-B32NGzNS.js";import"./Help-EfSmZBRS.js";import"./System-UGwVndg7.js";import"./Dialog-BERcuBcz.js";import"./FontGlobal-I0xzNbJH.js";import"./PreviewOpen-nQ2Iv4_U.js";import"./Grid-pJgl1oS6.js";import"./MonacoEditor-ov8BpsQ9.js";import"./Button-tVc5ioar.js";import"./Plus-s0Jz5-eZ.js";import"./CheckOutlined-r3grTFMw.js";import"./collapse-aS6vX33V.js";import"./useForceUpdate-FVo-4i1b.js";import"./EyeOutlined-32DaWiZk.js";import"./omit--0Qnqbh8.js";import"./index-wIpC5sck.js";import"./Info-a_timmp6.js";import"./Switch-Xsscl7VA.js";import"./NumberInput-jcBc5L4J.js";import"./Select-QnvNqaJ3.js";import"./Radio-gqYk-AVU.js";import"./ThemeEditor-tlpmIS3d.js";import"./ColorPicker-Zriz_5ra.js";import"./index-p8ckIXOR.js";import"./Overflow-UKUJyBo6.js";import"./index-4x1LRhOc.js";import"./CardPanel-UxpYECmD.js";import"./Theme-XU3oEXi4.js";import"./BaseInfoStore-VzdD0w4k.js";class L extends I.Component{constructor(t){super(t);d(this,"dragAddProvider",null);d(this,"dragStart",t=>{var e;if(t.target.classList.contains("droppable-element")){const a=t.target;(e=t.dataTransfer)==null||e.setData("type",a.getAttribute("data-type"))}});d(this,"dragover",t=>{t.preventDefault()});d(this,"drop",t=>{var n;t.preventDefault();const e=(n=t.dataTransfer)==null?void 0:n.getData("type");if(!e)return;const{scale:a,dsContentRef:m}=h,o=m==null?void 0:m.getBoundingClientRect(),r=(t.clientX-((o==null?void 0:o.x)||0))/a,c=(t.clientY-((o==null?void 0:o.y)||0))/a;this.addItem(e,[r,c])});d(this,"addItem",(t,e=[0,0])=>{let{setAddRecordCompId:a}=h;const{definitionMap:m}=C,{compName:o,width:r=320,height:c=200}=m[t].getBaseInfo(),n={name:o,type:t,x:Math.round(e[0]),y:Math.round(e[1]),id:j.generateId(),lock:!1,hide:!1,width:r,height:c};a(n.id),y.doAdd(n)});d(this,"getChartDom",()=>{const t=[];let{compInfoArr:e,search:a,categories:m,subCategories:o}=g;m!=="all"&&(e=e.filter(r=>r.categorize===m)),o!=="all"&&(e=e.filter(r=>r.subCategorize===o)),a!==""&&(e=e.filter(r=>r.compName.indexOf(a)>=0));for(let r=0;r<e.length;r++){const c=e[r],{compName:n,compKey:l}=c,f=v.getLoader(b.EDIT).definitionMap[l].getChartImg();t.push(i.jsx("div",{className:"list-item droppable-element",draggable:!0,onDoubleClick:()=>this.addItem(l),"data-type":l,children:i.jsxs("div",{style:{pointerEvents:"none"},children:[i.jsx("div",{className:"item-header",ref:"drag-target",children:i.jsx("div",{className:"item-name",children:n})}),i.jsx("div",{className:"item-content",children:i.jsx("img",{src:f,alt:n})})]})},r+""))}return t});d(this,"searchChart",t=>{const{setSearch:e}=g;e&&e(t)});const{doInit:e}=g;e&&e()}componentDidMount(){this.dragAddProvider=new A(document.getElementById("component-drag-container"),document.getElementById("designer-ds-content"),this.dragStart,this.dragover,this.drop)}componentWillUnmount(){var t;(t=this.dragAddProvider)==null||t.destroy()}render(){return i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"list-search",children:i.jsx(N,{placeholder:"搜索组件",onChange:this.searchChart})}),i.jsx("div",{className:"list-items",id:"component-drag-container",children:this.getChartDom()})]})}}const vt=D(L);export{vt as default};
