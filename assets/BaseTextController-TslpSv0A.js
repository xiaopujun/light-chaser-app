import{U as g,D as h}from"./index-Ky8VuNT2.js";import{A as x,B as C}from"./FontGlobal-OJzIEJBO.js";import{C as k}from"./LayerManager-9_OZ_v7l.js";import{r,j as u}from"./index-CIZzpp4t.js";import{O as E}from"./FetchUtil-FMEOVjjY.js";import"./GlobalMessage-b_IUatJJ.js";import"./MainRouter-LJqlNU58.js";import"./useZIndex-C48Dwtsu.js";import"./mobxreact.esm-QmaNsbsC.js";import"./PreviewOpen-ZH2J-uf_.js";import"./index-PQsxm07c.js";const v=r.forwardRef((c,n)=>{const[t,o]=r.useState({...c}),{style:i,data:s}=t,[m,l]=r.useState(!1),a=r.useRef({}),f=r.useRef(null);r.useImperativeHandle(n,()=>({updateConfig:e=>o({...e}),setEventHandler:e=>a.current=e}));const p=()=>{"click"in a.current&&a.current.click()},d={WebkitTextStrokeWidth:i==null?void 0:i.strokeWidth,WebkitTextStrokeColor:i==null?void 0:i.strokeColor};return u.jsx("div",{onDoubleClick:()=>l(!0),ref:f,className:"base-text-component",style:{...i,...d},onKeyDown:e=>e.stopPropagation(),onClick:p,children:m?u.jsx("input",{ref:e=>e==null?void 0:e.select(),onChange:e=>s.staticData=e.target.value,onBlur:()=>l(!1),autoFocus:!0,type:"text",defaultValue:s==null?void 0:s.staticData}):s==null?void 0:s.staticData})});class W extends x{async create(n,t){this.config=t,this.container=n,this.instance=await k.createAndRender(n,v,t);const{mode:o}=g.parseUrlParams();o===h.EDIT&&(this.container.style.pointerEvents="auto")}destroy(){this.instance=null,this.config=null}getConfig(){return this.config}update(n,t){var o;this.config=E.merge(this.config,n),t=t||{reRender:!0},t.reRender&&((o=this.instance)==null||o.updateConfig(this.config))}updateTheme(n){}registerEvent(){var n,t;if(this.instance){const o=(t=(n=this.config)==null?void 0:n.base)==null?void 0:t.id;this.instance.setEventHandler({click:()=>C.triggerComponentEvent(o,"click",this.config)})}}}export{W as BaseTextController};
