var pl=Object.defineProperty;var vl=(e,r,t)=>r in e?pl(e,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[r]=t;var N=(e,r,t)=>(vl(e,typeof r!="symbol"?r+"":r,t),t);import{r as _,u as hl,a as gl,C as sa,d as ml,c as la,E as _i,o as xl,b as yl,K as bl,I as Cl,j as C,L as Je,g as zn,R as ae,e as Sl,_ as ca}from"./index-xvHtpy0-.js";import{o as Et,m as xn,a as le,b as ce,t as qa}from"./mobxreact.esm-bhbgzqYc.js";import{d as ie,e as rt,D as yn,I as bn,h as Nt,a as Ni,c as Dl,b as El,L as Ve,l as nr,f as U,U as Ir,o as ln,r as ue,g as Gi,i as Ai,j as pt,k as ar,B as wl,C as Rl,m as Ml,F as Ol,A as Ya,s as Tl,p as Il,n as it,q as ua,t as zr,u as It,v as kt,w as mt,x as xt,y as Xa,z as Ye,E as Pr,G as pe,H as ji,J as Gt,K as He,M as Hi,N as Ft,O as ir,P as jr,Q as fr,R as zl,S as Ct,T as Br,V as Vi,W as ye,X as _t,Y as Bt,Z as we,_ as Fi,$ as Wi,a0 as Pl,a1 as Fe,a2 as kr,a3 as qi,a4 as Yi,a5 as Bl,a6 as Re,a7 as kl,a8 as Ll,a9 as _e,aa as fa,ab as Xi,ac as Hr,ad as _l,ae as cn,af as We,ag as br,ah as da,ai as Nl,aj as Gl,ak as Al,al as jl,am as Ui,an as Hl,ao as Ua,ap as Lr,aq as pa,ar as Vl,as as Fl,at as $a,au as Wl,av as ql,aw as Yl,ax as Xl,ay as _r,az as va,aA as me,aB as Ie,aC as ha,aD as ga,aE as Ul,aF as Ka,aG as $l,aH as Kl,aI as Ja,aJ as Jl,aK as Zl,aL as be,aM as $i,aN as Ql,aO as tc,aP as Ur,aQ as ec,aR as rc}from"./EventOperateStore-IQvFHd5q.js";import Ki from"./Input-LFSkQmW6.js";import{u as nc,T as ac}from"./index-s96thRN1.js";import{A as wt,_ as ft}from"./AntdIcon-4A_YrOev.js";import{l as jn,r as ic,c as Vr}from"./LayerBuilder-WWn-hhWF.js";import{B as Ji,c as Zi,u as oc,g as Za,P as sc,a as lc,D as cc,E as uc,b as fc,U as dc}from"./ColorPicker--GVXJx_9.js";import{Q as pc}from"./QuestionCircleOutlined-ABMv3OQq.js";import{O as vc,l as Nr}from"./ObjectUtil-chSHfPRu.js";import hc from"./Button-8dQiU8Jj.js";import{D as gc,A as mc,P as xc}from"./PlusOutlined-Zd548fDu.js";import Qa from"./Accordion-8bf0R7L0.js";function ti(e){return!!(e&&e.then)}const yc=e=>{const{type:r,children:t,prefixCls:n,buttonProps:a,close:i,autoFocus:o,emitEvent:s,isSilent:l,quitOnNullishReturnValue:c,actionFn:u}=e,f=_.useRef(!1),d=_.useRef(null),[p,v]=hl(!1),h=function(){i==null||i.apply(void 0,arguments)};_.useEffect(()=>{let x=null;return o&&(x=setTimeout(()=>{var b;(b=d.current)===null||b===void 0||b.focus()})),()=>{x&&clearTimeout(x)}},[]);const g=x=>{ti(x)&&(v(!0),x.then(function(){v(!1,!0),h.apply(void 0,arguments),f.current=!1},b=>{if(v(!1,!0),f.current=!1,!(l!=null&&l()))return Promise.reject(b)}))},m=x=>{if(f.current)return;if(f.current=!0,!u){h();return}let b;if(s){if(b=u(x),c&&!ti(b)){f.current=!1,h(x);return}}else if(u.length)b=u(i),f.current=!1;else if(b=u(),!b){h();return}g(b)};return _.createElement(Ji,Object.assign({},Zi(r),{onClick:m,loading:p,prefixCls:n},a,{ref:d}),t)},bc=yc;var Cc={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M859.9 168H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zM518.3 355a8 8 0 00-12.6 0l-112 141.7a7.98 7.98 0 006.3 12.9h73.9V848c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V509.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 355z"}}]},name:"vertical-align-top",theme:"outlined"};const Sc=Cc,Dc=e=>{const{componentCls:r,iconCls:t,antCls:n,zIndexPopup:a,colorText:i,colorWarning:o,marginXXS:s,marginXS:l,fontSize:c,fontWeightStrong:u,colorTextHeading:f}=e;return{[r]:{zIndex:a,[`&${n}-popover`]:{fontSize:c},[`${r}-message`]:{marginBottom:l,display:"flex",flexWrap:"nowrap",alignItems:"start",[`> ${r}-message-icon ${t}`]:{color:o,fontSize:c,lineHeight:1,marginInlineEnd:l},[`${r}-title`]:{fontWeight:u,color:f,"&:only-child":{fontWeight:"normal"}},[`${r}-description`]:{marginTop:s,color:i}},[`${r}-buttons`]:{textAlign:"end",whiteSpace:"nowrap",button:{marginInlineStart:l}}}}},Ec=e=>{const{zIndexPopupBase:r}=e;return{zIndexPopup:r+60}},Qi=gl("Popconfirm",e=>Dc(e),Ec,{resetStyle:!1});var wc=function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(t[n[a]]=e[n[a]]);return t};const to=e=>{const{prefixCls:r,okButtonProps:t,cancelButtonProps:n,title:a,description:i,cancelText:o,okText:s,okType:l="primary",icon:c=_.createElement(_i,null),showCancel:u=!0,close:f,onConfirm:d,onCancel:p,onPopupClick:v}=e,{getPrefixCls:h}=_.useContext(sa),[g]=oc("Popconfirm",ml.Popconfirm),m=Za(a),x=Za(i);return _.createElement("div",{className:`${r}-inner-content`,onClick:v},_.createElement("div",{className:`${r}-message`},c&&_.createElement("span",{className:`${r}-message-icon`},c),_.createElement("div",{className:`${r}-message-text`},m&&_.createElement("div",{className:la(`${r}-title`)},m),x&&_.createElement("div",{className:`${r}-description`},x))),_.createElement("div",{className:`${r}-buttons`},u&&_.createElement(Ji,Object.assign({onClick:p,size:"small"},n),o??(g==null?void 0:g.cancelText)),_.createElement(bc,{buttonProps:Object.assign(Object.assign({size:"small"},Zi(l)),t),actionFn:d,close:f,prefixCls:h("btn"),quitOnNullishReturnValue:!0,emitEvent:!0},s??(g==null?void 0:g.okText))))},Rc=e=>{const{prefixCls:r,placement:t,className:n,style:a}=e,i=wc(e,["prefixCls","placement","className","style"]),{getPrefixCls:o}=_.useContext(sa),s=o("popconfirm",r),[l]=Qi(s);return l(_.createElement(sc,{placement:t,className:la(s,n),style:a,content:_.createElement(to,Object.assign({prefixCls:s},i))}))},Mc=Rc;var Oc=function(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(t[n[a]]=e[n[a]]);return t};const eo=_.forwardRef((e,r)=>{var t,n;const{prefixCls:a,placement:i="top",trigger:o="click",okType:s="primary",icon:l=_.createElement(_i,null),children:c,overlayClassName:u,onOpenChange:f,onVisibleChange:d}=e,p=Oc(e,["prefixCls","placement","trigger","okType","icon","children","overlayClassName","onOpenChange","onVisibleChange"]),{getPrefixCls:v}=_.useContext(sa),[h,g]=nc(!1,{value:(t=e.open)!==null&&t!==void 0?t:e.visible,defaultValue:(n=e.defaultOpen)!==null&&n!==void 0?n:e.defaultVisible}),m=(O,P)=>{g(O,!0),d==null||d(O),f==null||f(O,P)},x=O=>{m(!1,O)},b=O=>{var P;return(P=e.onConfirm)===null||P===void 0?void 0:P.call(void 0,O)},S=O=>{var P;m(!1,O),(P=e.onCancel)===null||P===void 0||P.call(void 0,O)},D=O=>{O.keyCode===bl.ESC&&h&&m(!1,O)},y=O=>{const{disabled:P=!1}=e;P||m(O)},E=v("popconfirm",a),w=la(E,u),[T]=Qi(E);return T(_.createElement(lc,Object.assign({},xl(p,["title"]),{trigger:o,placement:i,onOpenChange:y,open:h,ref:r,overlayClassName:w,content:_.createElement(to,Object.assign({okType:s,icon:l},e,{prefixCls:E,close:x,onConfirm:b,onCancel:S})),"data-popover-inject":!0}),yl(c,{onKeyDown:O=>{var P,z;_.isValidElement(c)&&((z=c==null?void 0:(P=c.props).onKeyDown)===null||z===void 0||z.call(P,O)),D(O)}})))});eo._InternalPanelDoNotUseOrYouWillBeFired=Mc;const Tc=eo;var Ic={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 64H296c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h496v688c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V96c0-17.7-14.3-32-32-32zM704 192H192c-17.7 0-32 14.3-32 32v530.7c0 8.5 3.4 16.6 9.4 22.6l173.3 173.3c2.2 2.2 4.7 4 7.4 5.5v1.9h4.2c3.5 1.3 7.2 2 11 2H704c17.7 0 32-14.3 32-32V224c0-17.7-14.3-32-32-32zM350 856.2L263.9 770H350v86.2zM664 888H414V746c0-22.1-17.9-40-40-40H232V264h432v624z"}}]},name:"copy",theme:"outlined"};const zc=Ic;var Pc={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M193 796c0 17.7 14.3 32 32 32h574c17.7 0 32-14.3 32-32V563c0-176.2-142.8-319-319-319S193 386.8 193 563v233zm72-233c0-136.4 110.6-247 247-247s247 110.6 247 247v193H404V585c0-5.5-4.5-10-10-10h-44c-5.5 0-10 4.5-10 10v171h-75V563zm-48.1-252.5l39.6-39.6c3.1-3.1 3.1-8.2 0-11.3l-67.9-67.9a8.03 8.03 0 00-11.3 0l-39.6 39.6a8.03 8.03 0 000 11.3l67.9 67.9c3.1 3.1 8.1 3.1 11.3 0zm669.6-79.2l-39.6-39.6a8.03 8.03 0 00-11.3 0l-67.9 67.9a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l67.9-67.9c3.1-3.2 3.1-8.2 0-11.3zM832 892H192c-17.7 0-32 14.3-32 32v24c0 4.4 3.6 8 8 8h688c4.4 0 8-3.6 8-8v-24c0-17.7-14.3-32-32-32zM484 180h56c4.4 0 8-3.6 8-8V76c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v96c0 4.4 3.6 8 8 8z"}}]},name:"alert",theme:"outlined"};const Bc=Pc;var ro=function(r,t){return _.createElement(wt,ft(ft({},r),{},{ref:t,icon:Bc}))};ro.displayName="AlertOutlined";const kc=_.forwardRef(ro);var Lc={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908 640H804V488c0-4.4-3.6-8-8-8H548v-96h108c8.8 0 16-7.2 16-16V80c0-8.8-7.2-16-16-16H368c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h108v96H228c-4.4 0-8 3.6-8 8v152H116c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h288c8.8 0 16-7.2 16-16V656c0-8.8-7.2-16-16-16H292v-88h440v88H620c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h288c8.8 0 16-7.2 16-16V656c0-8.8-7.2-16-16-16zm-564 76v168H176V716h168zm84-408V140h168v168H428zm420 576H680V716h168v168z"}}]},name:"apartment",theme:"outlined"};const _c=Lc;var no=function(r,t){return _.createElement(wt,ft(ft({},r),{},{ref:t,icon:_c}))};no.displayName="ApartmentOutlined";const Nc=_.forwardRef(no);var Gc={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 248H728l-32.4-90.8a32.07 32.07 0 00-30.2-21.2H358.6c-13.5 0-25.6 8.5-30.1 21.2L296 248H160c-44.2 0-80 35.8-80 80v456c0 44.2 35.8 80 80 80h704c44.2 0 80-35.8 80-80V328c0-44.2-35.8-80-80-80zm8 536c0 4.4-3.6 8-8 8H160c-4.4 0-8-3.6-8-8V328c0-4.4 3.6-8 8-8h186.7l17.1-47.8 22.9-64.2h250.5l22.9 64.2 17.1 47.8H864c4.4 0 8 3.6 8 8v456zM512 384c-88.4 0-160 71.6-160 160s71.6 160 160 160 160-71.6 160-160-71.6-160-160-160zm0 256c-53 0-96-43-96-96s43-96 96-96 96 43 96 96-43 96-96 96z"}}]},name:"camera",theme:"outlined"};const Ac=Gc;var ao=function(r,t){return _.createElement(wt,ft(ft({},r),{},{ref:t,icon:Ac}))};ao.displayName="CameraOutlined";const jc=_.forwardRef(ao);var Hc={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M326 664H104c-8.8 0-16 7.2-16 16v48c0 8.8 7.2 16 16 16h174v176c0 8.8 7.2 16 16 16h48c8.8 0 16-7.2 16-16V696c0-17.7-14.3-32-32-32zm16-576h-48c-8.8 0-16 7.2-16 16v176H104c-8.8 0-16 7.2-16 16v48c0 8.8 7.2 16 16 16h222c17.7 0 32-14.3 32-32V104c0-8.8-7.2-16-16-16zm578 576H698c-17.7 0-32 14.3-32 32v224c0 8.8 7.2 16 16 16h48c8.8 0 16-7.2 16-16V744h174c8.8 0 16-7.2 16-16v-48c0-8.8-7.2-16-16-16zm0-384H746V104c0-8.8-7.2-16-16-16h-48c-8.8 0-16 7.2-16 16v224c0 17.7 14.3 32 32 32h222c8.8 0 16-7.2 16-16v-48c0-8.8-7.2-16-16-16z"}}]},name:"compress",theme:"outlined"};const Vc=Hc;var io=function(r,t){return _.createElement(wt,ft(ft({},r),{},{ref:t,icon:Vc}))};io.displayName="CompressOutlined";const Fc=_.forwardRef(io);var oo=function(r,t){return _.createElement(wt,ft(ft({},r),{},{ref:t,icon:zc}))};oo.displayName="CopyOutlined";const Wc=_.forwardRef(oo);var so=function(r,t){return _.createElement(wt,ft(ft({},r),{},{ref:t,icon:gc}))};so.displayName="DeleteOutlined";const qc=_.forwardRef(so);var lo=function(r,t){return _.createElement(wt,ft(ft({},r),{},{ref:t,icon:cc}))};lo.displayName="DownOutlined";const Yc=_.forwardRef(lo);var co=function(r,t){return _.createElement(wt,ft(ft({},r),{},{ref:t,icon:uc}))};co.displayName="EyeInvisibleOutlined";const Xc=_.forwardRef(co);var uo=function(r,t){return _.createElement(wt,ft(ft({},r),{},{ref:t,icon:fc}))};uo.displayName="EyeOutlined";const Uc=_.forwardRef(uo);var $c={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M880.1 154H143.9c-24.5 0-39.8 26.7-27.5 48L349 597.4V838c0 17.7 14.2 32 31.8 32h262.4c17.6 0 31.8-14.3 31.8-32V597.4L907.7 202c12.2-21.3-3.1-48-27.6-48zM603.4 798H420.6V642h182.9v156zm9.6-236.6l-9.5 16.6h-183l-9.5-16.6L212.7 226h598.6L613 561.4z"}}]},name:"filter",theme:"outlined"};const Kc=$c;var fo=function(r,t){return _.createElement(wt,ft(ft({},r),{},{ref:t,icon:Kc}))};fo.displayName="FilterOutlined";const Jc=_.forwardRef(fo);var Zc={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 392c8.8 0 16-7.2 16-16V192c0-8.8-7.2-16-16-16H744c-8.8 0-16 7.2-16 16v56H296v-56c0-8.8-7.2-16-16-16H96c-8.8 0-16 7.2-16 16v184c0 8.8 7.2 16 16 16h56v240H96c-8.8 0-16 7.2-16 16v184c0 8.8 7.2 16 16 16h184c8.8 0 16-7.2 16-16v-56h432v56c0 8.8 7.2 16 16 16h184c8.8 0 16-7.2 16-16V648c0-8.8-7.2-16-16-16h-56V392h56zM792 240h88v88h-88v-88zm-648 88v-88h88v88h-88zm88 456h-88v-88h88v88zm648-88v88h-88v-88h88zm-80-64h-56c-8.8 0-16 7.2-16 16v56H296v-56c0-8.8-7.2-16-16-16h-56V392h56c8.8 0 16-7.2 16-16v-56h432v56c0 8.8 7.2 16 16 16h56v240z"}}]},name:"gateway",theme:"outlined"};const Qc=Zc;var po=function(r,t){return _.createElement(wt,ft(ft({},r),{},{ref:t,icon:Qc}))};po.displayName="GatewayOutlined";const tu=_.forwardRef(po);var eu={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M912 820.1V203.9c28-9.9 48-36.6 48-67.9 0-39.8-32.2-72-72-72-31.3 0-58 20-67.9 48H203.9C194 84 167.3 64 136 64c-39.8 0-72 32.2-72 72 0 31.3 20 58 48 67.9v616.2C84 830 64 856.7 64 888c0 39.8 32.2 72 72 72 31.3 0 58-20 67.9-48h616.2c9.9 28 36.6 48 67.9 48 39.8 0 72-32.2 72-72 0-31.3-20-58-48-67.9zM888 112c13.3 0 24 10.7 24 24s-10.7 24-24 24-24-10.7-24-24 10.7-24 24-24zM136 912c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm0-752c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24zm704 680H184V184h656v656zm48 72c-13.3 0-24-10.7-24-24s10.7-24 24-24 24 10.7 24 24-10.7 24-24 24z"}},{tag:"path",attrs:{d:"M288 474h448c8.8 0 16-7.2 16-16V282c0-8.8-7.2-16-16-16H288c-8.8 0-16 7.2-16 16v176c0 8.8 7.2 16 16 16zm56-136h336v64H344v-64zm-56 420h448c8.8 0 16-7.2 16-16V566c0-8.8-7.2-16-16-16H288c-8.8 0-16 7.2-16 16v176c0 8.8 7.2 16 16 16zm56-136h336v64H344v-64z"}}]},name:"group",theme:"outlined"};const ru=eu;var vo=function(r,t){return _.createElement(wt,ft(ft({},r),{},{ref:t,icon:ru}))};vo.displayName="GroupOutlined";const nu=_.forwardRef(vo);var ho=function(r,t){return _.createElement(wt,ft(ft({},r),{},{ref:t,icon:Cl}))};ho.displayName="InfoCircleFilled";const au=_.forwardRef(ho);var iu={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M956.9 845.1L896.4 632V168c0-17.7-14.3-32-32-32h-704c-17.7 0-32 14.3-32 32v464L67.9 845.1C60.4 866 75.8 888 98 888h828.8c22.2 0 37.6-22 30.1-42.9zM200.4 208h624v395h-624V208zm228.3 608l8.1-37h150.3l8.1 37H428.7zm224 0l-19.1-86.7c-.8-3.7-4.1-6.3-7.8-6.3H398.2c-3.8 0-7 2.6-7.8 6.3L371.3 816H151l42.3-149h638.2l42.3 149H652.7z"}}]},name:"laptop",theme:"outlined"};const ou=iu;var go=function(r,t){return _.createElement(wt,ft(ft({},r),{},{ref:t,icon:ou}))};go.displayName="LaptopOutlined";const su=_.forwardRef(go);var lu={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"};const cu=lu;var mo=function(r,t){return _.createElement(wt,ft(ft({},r),{},{ref:t,icon:cu}))};mo.displayName="LockOutlined";const ei=_.forwardRef(mo);var uu={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M868 732h-70.3c-4.8 0-9.3 2.1-12.3 5.8-7 8.5-14.5 16.7-22.4 24.5a353.84 353.84 0 01-112.7 75.9A352.8 352.8 0 01512.4 866c-47.9 0-94.3-9.4-137.9-27.8a353.84 353.84 0 01-112.7-75.9 353.28 353.28 0 01-76-112.5C167.3 606.2 158 559.9 158 512s9.4-94.2 27.8-137.8c17.8-42.1 43.4-80 76-112.5s70.5-58.1 112.7-75.9c43.6-18.4 90-27.8 137.9-27.8 47.9 0 94.3 9.3 137.9 27.8 42.2 17.8 80.1 43.4 112.7 75.9 7.9 7.9 15.3 16.1 22.4 24.5 3 3.7 7.6 5.8 12.3 5.8H868c6.3 0 10.2-7 6.7-12.3C798 160.5 663.8 81.6 511.3 82 271.7 82.6 79.6 277.1 82 516.4 84.4 751.9 276.2 942 512.4 942c152.1 0 285.7-78.8 362.3-197.7 3.4-5.3-.4-12.3-6.7-12.3zm88.9-226.3L815 393.7c-5.3-4.2-13-.4-13 6.3v76H488c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h314v76c0 6.7 7.8 10.5 13 6.3l141.9-112a8 8 0 000-12.6z"}}]},name:"logout",theme:"outlined"};const fu=uu;var xo=function(r,t){return _.createElement(wt,ft(ft({},r),{},{ref:t,icon:fu}))};xo.displayName="LogoutOutlined";const du=_.forwardRef(xo);var pu={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h720c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"minus",theme:"outlined"};const vu=pu;var yo=function(r,t){return _.createElement(wt,ft(ft({},r),{},{ref:t,icon:vu}))};yo.displayName="MinusOutlined";const ma=_.forwardRef(yo);var hu={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M640.6 429.8h257.1c7.9 0 14.3-6.4 14.3-14.3V158.3c0-7.9-6.4-14.3-14.3-14.3H640.6c-7.9 0-14.3 6.4-14.3 14.3v92.9H490.6c-3.9 0-7.1 3.2-7.1 7.1v221.5h-85.7v-96.5c0-7.9-6.4-14.3-14.3-14.3H126.3c-7.9 0-14.3 6.4-14.3 14.3v257.2c0 7.9 6.4 14.3 14.3 14.3h257.1c7.9 0 14.3-6.4 14.3-14.3V544h85.7v221.5c0 3.9 3.2 7.1 7.1 7.1h135.7v92.9c0 7.9 6.4 14.3 14.3 14.3h257.1c7.9 0 14.3-6.4 14.3-14.3v-257c0-7.9-6.4-14.3-14.3-14.3h-257c-7.9 0-14.3 6.4-14.3 14.3v100h-78.6v-393h78.6v100c0 7.9 6.4 14.3 14.3 14.3zm53.5-217.9h150V362h-150V211.9zM329.9 587h-150V437h150v150zm364.2 75.1h150v150.1h-150V662.1z"}}]},name:"partition",theme:"outlined"};const gu=hu;var bo=function(r,t){return _.createElement(wt,ft(ft({},r),{},{ref:t,icon:gu}))};bo.displayName="PartitionOutlined";const mu=_.forwardRef(bo);var xu={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"};const yu=xu;var Co=function(r,t){return _.createElement(wt,ft(ft({},r),{},{ref:t,icon:yu}))};Co.displayName="SaveOutlined";const bu=_.forwardRef(Co);var So=function(r,t){return _.createElement(wt,ft(ft({},r),{},{ref:t,icon:dc}))};So.displayName="UpOutlined";const Cu=_.forwardRef(So);var Su={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M859.9 780H164.1c-4.5 0-8.1 3.6-8.1 8v60c0 4.4 3.6 8 8.1 8h695.8c4.5 0 8.1-3.6 8.1-8v-60c0-4.4-3.6-8-8.1-8zM505.7 669a8 8 0 0012.6 0l112-141.7c4.1-5.2.4-12.9-6.3-12.9h-74.1V176c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v338.3H400c-6.7 0-10.4 7.7-6.3 12.9l112 141.8z"}}]},name:"vertical-align-bottom",theme:"outlined"};const Du=Su;var Do=function(r,t){return _.createElement(wt,ft(ft({},r),{},{ref:t,icon:Du}))};Do.displayName="VerticalAlignBottomOutlined";const Eu=_.forwardRef(Do);var Eo=function(r,t){return _.createElement(wt,ft(ft({},r),{},{ref:t,icon:Sc}))};Eo.displayName="VerticalAlignTopOutlined";const wu=_.forwardRef(Eo);class Ru extends _.Component{constructor(t){super(t);N(this,"changeMenu",t=>{if(!t||t==="")return;const{setMenu:n}=ie;n(t);const{rulerRef:a}=rt;a&&a.ruleWheel()});N(this,"buildClassifyList",()=>{const{menus:t,menu:n}=ie,a=[];for(let i=0;i<t.length;i++){const{icon:o,name:s,key:l}=t[i];a.push(C.jsxs("div",{className:`menu-item ${l===n?"menu-item-active":""}`,onClick:()=>this.changeMenu(l),children:[C.jsx("div",{className:"menu-item-icon",children:C.jsx(o,{})}),C.jsx("span",{className:"menu-item-content",children:s})]},i+""))}return a})}render(){const t=this.buildClassifyList();return C.jsx("div",{className:"designer-left-menus",style:{overflowY:"scroll"},children:t})}}const Mu=Et(Ru);class Ou{constructor(){N(this,"compInfoArr",[]);N(this,"categories","all");N(this,"subCategories","all");N(this,"search","");N(this,"setCategories",r=>this.categories=r);N(this,"setSubCategories",r=>this.subCategories=r);N(this,"setSearch",r=>this.search=r);N(this,"doInit",()=>{const r=[],{definitionMap:t}=yn.getLoader();t&&Object.keys(t).forEach(n=>{const a=t[n].getBaseInfo();a.compKey!=="group"&&r.push(a)}),this.compInfoArr=r});xn(this,{categories:le,subCategories:le,search:le,setCategories:ce,setSubCategories:ce,setSearch:ce})}}const wr=new Ou;class xa{constructor(r,t,n,a,i){N(this,"dragSource",null);N(this,"dragTarget",null);N(this,"dragStart");N(this,"dragOver");N(this,"drop");if(!r||!t)throw new Error("dragSource or dragTarget is null");this.dragSource=r,this.dragTarget=t,this.dragStart=n,this.dragOver=a,this.drop=i,this.dragStart&&this.dragSource&&this.dragSource.addEventListener("dragstart",this.dragStart),this.dragOver&&this.dragTarget&&this.dragTarget.addEventListener("dragover",this.dragOver),this.drop&&this.dragTarget&&this.dragTarget.addEventListener("drop",this.drop)}destroy(){this.dragStart&&this.dragSource&&this.dragSource.removeEventListener("dragstart",this.dragStart),this.dragOver&&this.dragTarget&&this.dragTarget.removeEventListener("dragover",this.dragOver),this.drop&&this.dragTarget&&this.dragTarget.removeEventListener("drop",this.drop)}}class Tu extends _.Component{constructor(t){super(t);N(this,"dragAddProvider",null);N(this,"dragStart",t=>{var n;if(t.target.classList.contains("droppable-element")){const a=t.target;(n=t.dataTransfer)==null||n.setData("type",a.getAttribute("data-type"))}});N(this,"dragover",t=>{t.preventDefault()});N(this,"drop",t=>{var c;t.preventDefault();const n=(c=t.dataTransfer)==null?void 0:c.getData("type");if(!n)return;const{scale:a,dsContentRef:i}=rt,o=i==null?void 0:i.getBoundingClientRect(),s=(t.clientX-((o==null?void 0:o.x)||0))/a,l=(t.clientY-((o==null?void 0:o.y)||0))/a;this.addItem(n,[s,l])});N(this,"addItem",(t,n=[0,0])=>{let{setAddRecordCompId:a}=rt;const{definitionMap:i}=Ni,{compName:o,width:s=320,height:l=200}=i[t].getBaseInfo(),c={name:o,type:t,x:Math.round(n[0]),y:Math.round(n[1]),id:bn.generateId(),lock:!1,hide:!1,width:s,height:l};a(c.id),Nt.doAdd(c)});N(this,"getChartDom",()=>{const t=[];let{compInfoArr:n,search:a,categories:i,subCategories:o}=wr;i!=="all"&&(n=n.filter(s=>s.categorize===i)),o!=="all"&&(n=n.filter(s=>s.subCategorize===o)),a!==""&&(n=n.filter(s=>s.compName.indexOf(a)>=0));for(let s=0;s<n.length;s++){const l=n[s],{compName:c,compKey:u}=l,d=yn.getLoader().definitionMap[u].getChartImg();t.push(C.jsx("div",{className:"list-item droppable-element",draggable:!0,onDoubleClick:()=>this.addItem(u),"data-type":u,children:C.jsxs("div",{style:{pointerEvents:"none"},children:[C.jsxs("div",{className:"item-header",ref:"drag-target",children:[C.jsx("div",{className:"item-name",children:c}),C.jsx("div",{className:"item-type",children:"Antd"})]}),C.jsx("div",{className:"item-content",children:C.jsx("img",{src:d,alt:c})})]})},s+""))}return t});N(this,"searchChart",t=>{const{setSearch:n}=wr;n&&n(t)});const{doInit:n}=wr;n&&n()}componentDidMount(){this.dragAddProvider=new xa(document.getElementById("component-drag-container"),document.getElementById("designer-ds-content"),this.dragStart,this.dragover,this.drop)}componentWillUnmount(){var t;(t=this.dragAddProvider)==null||t.destroy()}render(){return C.jsxs(C.Fragment,{children:[C.jsx("div",{className:"list-search",children:C.jsx(Ki,{placeholder:"搜索组件",onChange:this.searchChart})}),C.jsx("div",{className:"list-items",id:"component-drag-container",children:this.getChartDom()})]})}}const Iu=Et(Tu),zu=()=>C.jsxs("div",{className:"dl-component-list",children:[C.jsxs("div",{className:"dl-cl-header",children:[C.jsx("div",{className:"dl-cl-header-title",children:"组件列表"}),C.jsx("div",{className:"dl-cl-header-operate",children:C.jsx(ma,{onClick:()=>{const{setMenu:e}=ie;e("");const{rulerRef:r}=rt;r==null||r.ruleWheel()}})})]}),C.jsxs("div",{className:"dl-cl-body",children:[C.jsx("div",{className:"main-categories",children:C.jsx(Pu,{})}),C.jsx("div",{className:"sub-categories",children:C.jsx(Bu,{})}),C.jsx("div",{className:"component-list",children:C.jsx(Iu,{})})]})]}),Pu=Et(()=>{const{categories:e,setCategories:r,setSubCategories:t}=wr;return C.jsx(C.Fragment,{children:Dl.map((n,a)=>{const{icon:i,name:o,key:s}=n,l=i;return C.jsx(ac,{className:`clo-item ${e===s?"clo-item-active":""}`,placement:"right",title:o,children:C.jsx(l,{onClick:()=>{r(s),t("all")}})},a)})})}),Bu=Et(()=>{const{categories:e,subCategories:r,setSubCategories:t}=wr;return C.jsx(C.Fragment,{children:El.map((n,a)=>{const{name:i,key:o,parentKey:s}=n;if(e==="all"||o==="all"||s===e)return C.jsx("div",{onClick:()=>t(o),className:`clt-item ${r===o?"clt-item-active":""}`,children:i},a)})})});class ku extends _.Component{constructor(){super(...arguments);N(this,"layerListRef",null);N(this,"layerItemsContainerRef",null);N(this,"cancelSelected",t=>{var n;if(this.layerListRef&&this.layerListRef.contains(t.target)&&!((n=this.layerItemsContainerRef)!=null&&n.contains(t.target))){const{setTargetIds:a,targetIds:i}=rt;i.length>0&&a([])}});N(this,"searchLayer",t=>{const{setContent:n}=nr;n&&n(t)});N(this,"buildLayerList",()=>{const{layerConfigs:t}=U,{searchContent:n}=nr;if(!n||n==="")return jn.buildLayerList(t);const a={};return n===":hide"?Object.values(t).forEach(o=>{o.hide&&o.type!=="group"&&(a[o.id]=o)}):n===":lock"?Object.values(t).forEach(o=>{o.lock&&o.type!=="group"&&(a[o.id]=o)}):Object.values(t).forEach(o=>{var s;(s=o.name)!=null&&s.includes(n)&&o.type!=="group"&&(a[o.id]=o)}),Ve.findPathGroupLayer(Object.keys(a)).forEach(o=>{a[o]=t[o]}),jn.buildLayerList(a)})}componentDidMount(){var t;(t=this.layerListRef)==null||t.addEventListener("click",this.cancelSelected)}componentWillUnmount(){var t;(t=this.layerListRef)==null||t.removeEventListener("click",this.cancelSelected)}render(){return C.jsxs("div",{className:"layer-list",ref:t=>this.layerListRef=t,children:[C.jsxs("div",{className:"dl-ll-header",children:[C.jsx("div",{className:"dl-ll-header-title",children:"图层列表"}),C.jsx("div",{className:"dl-ll-header-operate",children:C.jsx(ma,{onClick:()=>{const{setMenu:t}=ie;t("");const{rulerRef:n}=rt;n==null||n.ruleWheel()}})})]}),C.jsx("div",{className:"list-search",children:C.jsx(Ki,{placeholder:"搜索图层",onChange:this.searchLayer})}),C.jsx("div",{className:"layer-items",children:C.jsx("div",{ref:t=>this.layerItemsContainerRef=t,children:this.buildLayerList()})})]})}}const Lu=Et(ku),_u=()=>{const[e,r]=_.useState([]),t=_.useRef(null),n=c=>{var u,f;if(c.target.classList.contains("droppable-element")){const d=c.target;(u=c.dataTransfer)==null||u.setData("imageUrl",d.getAttribute("data-url")),(f=c.dataTransfer)==null||f.setData("imageHash",d.getAttribute("data-hash"))}},a=c=>{c.preventDefault()},i=c=>{var m,x;c.preventDefault();const u=(m=c.dataTransfer)==null?void 0:m.getData("imageUrl"),f=(x=c.dataTransfer)==null?void 0:x.getData("imageHash");if(!u)return;const{scale:d,dsContentRef:p}=rt,v=p==null?void 0:p.getBoundingClientRect(),h=(c.clientX-((v==null?void 0:v.x)||0))/d,g=(c.clientY-((v==null?void 0:v.y)||0))/d;o("BaseImage",[h,g],u,f)},o=(c,u=[0,0],f,d)=>{const{elemConfigs:p}=U;let{setAddRecordCompId:v}=rt;const{definitionMap:h}=Ni,g=h[c],{compName:m,width:x=320,height:b=200}=g.getBaseInfo(),S=bn.generateId(),D={name:m,type:c,x:Math.round(u[0]),y:Math.round(u[1]),id:S,lock:!1,hide:!1,width:x,height:b};v(D.id),Nt.doAdd(D);const y=g.getInitConfig();y.style.type="local",y.style.localUrl=f,y.style.hash=d,p[S]=y},s=()=>{const{saveType:c,id:u}=Ir.parseUrlParams();ln[c].getImageSourceList(u).then(f=>{r(f)})};_.useEffect(()=>(s(),t.current=new xa(document.getElementById("image-source-list"),document.getElementById("designer-ds-content"),n,a,i),()=>{var c;return(c=t.current)==null?void 0:c.destroy()}),[]);const l=c=>{const{saveType:u}=Ir.parseUrlParams();ln[u].delImageSource(c).then(f=>{f&&s()})};return C.jsx("div",{className:"image-source",children:C.jsx("div",{className:"image-source-list",id:"image-source-list",children:e.map((c,u)=>C.jsxs("div",{className:"image-source-item droppable-element",draggable:!0,"data-url":c.url,"data-hash":c.hash,children:[C.jsxs("div",{className:"image-source-item-header",children:[C.jsx("div",{className:"isi-title",children:c.name||"无名称信息"}),C.jsx("div",{className:"isi-operate",children:C.jsx(Tc,{title:"确认删除吗?",icon:C.jsx(pc,{style:{color:"red"}}),description:"可能会导致已经使用的图片组件失效!",onConfirm:()=>l(c.id),okText:"是",cancelText:"否",children:C.jsx(ma,{})})})]}),C.jsx("div",{className:"image-source-item-body",children:C.jsx("div",{className:"item-bg-image",style:{backgroundImage:`url(${c.url})`}})})]},u))})})},Nu=()=>C.jsxs("div",{className:"source-library",children:[C.jsx("div",{className:"source-categorize",children:C.jsx("div",{className:"categorize-item",children:"图片"})}),C.jsx("div",{className:"source-library-content",children:C.jsx(_u,{})})]}),Gu=Et(()=>{const{menu:e,setDesignerLeftRef:r}=ie,t=_.useRef(null);return _.useEffect(()=>{r(t.current)},[]),C.jsxs("div",{className:"designer-left",ref:t,children:[C.jsx(Mu,{}),e==="components"&&C.jsx(zu,{}),e==="layer-list"&&C.jsx(Lu,{}),e==="source-list"&&C.jsx(Nu,{})]})});class Au extends _.Component{constructor(){super(...arguments);N(this,"menuChange",t=>{const{setActiveMenu:n,setContentVisible:a}=ue;n&&n(t.currentTarget.id),a&&a(!0)});N(this,"buildMenuList",()=>{const{menus:t,activeMenu:n}=ue;return t.length===0?C.jsxs("div",{style:{writingMode:"vertical-rl",color:"#bababa",letterSpacing:"8px",padding:7,fontSize:12},children:[C.jsx(au,{style:{fontSize:15,position:"relative",left:2,marginBottom:7}}),"双击组件激活..."]}):t.map(a=>{const i=a.icon;return C.jsxs("div",{className:`menu-item ${n===a.key?"menu-item-active":""}`,id:a.key,onClick:this.menuChange,children:[C.jsx("div",{className:"item-icon",children:C.jsx(i,{})}),C.jsx("div",{className:"item-content",children:a.name})]},a.key)})})}render(){return C.jsx("div",{className:"lc-config-menu",children:C.jsx("div",{className:"menu-list",children:this.buildMenuList()})})}}const ju=Et(Au);class Hu extends _.Component{constructor(){super(...arguments);N(this,"createProxy",t=>new Proxy(t,{get(n,a){const i=n[a];return typeof i=="function"&&i.name==="update"?new Proxy(i,{apply(o,s,l){const c=l[0],u=vc.getOriginValue(s.config,l[0]);return Nt.doStyleUpd(c,u),o.apply(s,l)}}):i}}));N(this,"buildConfigContent",()=>{const{compController:t}=U,{activeMenu:n,activeElem:a}=ue,i=yn.getLoader().definitionMap[a.type+""];if(!i)return;const s=i.getMenuToConfigContentMap()[n],l=this.createProxy(t[a.id+""]);if(s)return C.jsx(_.Suspense,{fallback:C.jsx(Je,{}),children:C.jsx(s,{controller:l})})});N(this,"onClose",()=>{const{setContentVisible:t,setActiveMenu:n}=ue;t&&t(!1),n&&n("")})}render(){const{activeMenu:t,menus:n}=ue;let a="";for(let i=0;i<n.length;i++)if(n[i].key===t){a=n[i].name;break}return C.jsxs("div",{className:"lc-config-panel",children:[C.jsxs("div",{className:"lc-panel-top",children:[C.jsx("div",{className:"panel-title",children:C.jsx("span",{children:a})}),C.jsx("div",{className:"panel-operate",onClick:this.onClose,children:C.jsx(Gi,{})})]}),C.jsx("div",{className:"lc-panel-content",children:this.buildConfigContent()})]})}}const Vu=Et(Hu);class Fu extends _.Component{render(){const{visible:r}=ue;return C.jsxs(C.Fragment,{children:[C.jsx(ju,{}),r&&C.jsx(Vu,{})]})}}const Wu=Et(Fu),qu=[{name:"保存项目",windows:"ctrl + s",mac:"ctrl + s"},{name:"复制组件",windows:"ctrl + v",mac:"ctrl + v"},{name:"锁定组件",windows:"ctrl + l",mac:"ctrl + l"},{name:"解锁组件",windows:"ctrl + shift + l",mac:"ctrl + shift + l"},{name:"隐藏组件",windows:"ctrl + h",mac:"ctrl + h"},{name:"开/关辅助边框",windows:"ctrl + k",mac:"ctrl + k"},{name:"图层置顶",windows:"ctrl + up-arrow(方向上键)",mac:"ctrl + up-arrow(方向上键)"},{name:"图层置底",windows:"ctrl + down-arrow(方向下键)",mac:"ctrl + down-arrow(方向下键)"},{name:"图层上移",windows:"alt + up-arrow(方向上键)",mac:"options + up-arrow(方向上键)"},{name:"图层下移",windows:"alt + down-arrow(方向下键)",mac:"options + down-arrow(方向下键)"},{name:"删除组件",windows:"delete",mac:"command + backspace"},{name:"缩放画布",windows:"alt + wheel(鼠标滑轮)",mac:"options + wheel(鼠标滑轮)"},{name:"拖拽画布",windows:"长按鼠标右键",mac:"长按鼠标右键"},{name:"组件上移",windows:"方向上键",mac:"方向上键"},{name:"组件下移",windows:"方向下键",mac:"方向下键"},{name:"组件左移",windows:"方向左键",mac:"方向左键"},{name:"组件右移",windows:"方向右键",mac:"方向右键"},{name:"组件上扩大",windows:"ctrl + shift + 方向上键",mac:"ctrl + shift + 方向上键"},{name:"组件下扩大",windows:"ctrl + shift + 方向下键",mac:"ctrl + shift + 方向下键"},{name:"组件左扩大",windows:"ctrl + shift + 方向左键",mac:"ctrl + shift + 方向左键"},{name:"组件右扩大",windows:"ctrl + shift + 方向右键",mac:"ctrl + shift + 方向右键"},{name:"组件上缩小",windows:"ctrl + alt + 方向上键",mac:"ctrl + options + 方向上键"},{name:"组件下缩小",windows:"ctrl + alt + 方向下键",mac:"ctrl + options + 方向下键"},{name:"组件左缩小",windows:"ctrl + alt + 方向左键",mac:"ctrl + options + 方向左键"},{name:"组件右缩小",windows:"ctrl + alt + 方向右键",mac:"ctrl + options + 方向右键"},{name:"撤销",windows:"ctrl + z",mac:"ctrl + z"},{name:"重做",windows:"ctrl + shift + z",mac:"ctrl + shift + z"},{name:"打开/关闭项目设置",windows:"ctrl + 1",mac:"ctrl + 1"},{name:"打开/关闭画布设置",windows:"ctrl + 2",mac:"ctrl + 2"},{name:"打开/关闭全局主题设置",windows:"ctrl + 3",mac:"ctrl + 3"},{name:"打开/关闭快捷键说明",windows:"ctrl + 4",mac:"ctrl + 4"},{name:"编组",windows:"ctrl + g",mac:"ctrl + g"},{name:"解除编组",windows:"ctrl + shift + g",mac:"ctrl + shift + g"},{name:"从分组中移除",windows:"alt + shift + g",mac:"options + shift + g"}],Yu=e=>{const{onClose:r}=e;return C.jsx(Ai,{title:"快捷键说明",visible:!0,width:800,onClose:r,children:C.jsx("div",{className:"lc-hotkey-des",style:{color:"white"},children:C.jsxs("table",{className:"hotkey-des-table",children:[C.jsx("thead",{children:C.jsxs("tr",{children:[C.jsx("th",{style:{width:"10%"},children:"编号"}),C.jsx("th",{style:{textAlign:"left"},children:"功能"}),C.jsx("th",{style:{textAlign:"left"},children:"Windows"}),C.jsx("th",{style:{textAlign:"left"},children:"Mac"})]})}),C.jsx("tbody",{children:qu.map((t,n)=>C.jsxs("tr",{children:[C.jsx("td",{children:n+1}),C.jsx("td",{style:{textAlign:"left"},children:t.name}),C.jsx("td",{style:{textAlign:"left"},children:t.windows}),C.jsx("td",{style:{textAlign:"left"},children:t.mac})]},n))})]})})})};class Xu{constructor(){N(this,"hotKeyVisible",!1);N(this,"snapShotVisible",!1);N(this,"setHotKeyVisible",r=>this.hotKeyVisible=r);N(this,"setSnapShotVisible",r=>this.snapShotVisible=r);xn(this,{hotKeyVisible:le,snapShotVisible:le,setHotKeyVisible:ce,setSnapShotVisible:ce})}}const on=new Xu,Uu=e=>{const{onClose:r}=e,t=_.useRef(null),n=_.useRef(null),a={uid:"-1",name:"image.png",status:"done"},[i,o]=_.useState([]),s=()=>{var f;if(!n.current){(f=zn.messageApi)==null||f.warning("请先上传封面");return}const{saveType:u}=Ir.parseUrlParams();ln[u].uploadCover(n.current).then(d=>{var p,v;d?(p=zn.messageApi)==null||p.info("封面生成成功！"):(v=zn.messageApi)==null||v.error("封面生成失败！")})},l=()=>{t.current&&(URL.revokeObjectURL(t.current),n.current=null),r()},c=u=>{n.current=u;const f=new FileReader;return f.onload=async d=>{const p=new Blob([d.target.result],{type:u.type}),v=URL.createObjectURL(p);t.current=v,o([{...a,url:v}])},f.readAsArrayBuffer(u),!1};return C.jsx(Ai,{title:"封面",className:"cover-config",visible:!0,width:500,onClose:l,children:C.jsxs("div",{className:"cover-content",children:[C.jsx("div",{className:"cover-left",children:C.jsx(mc,{name:"file",beforeUpload:c,listType:"picture-card",fileList:i,accept:"image/*",onRemove:()=>o([]),onPreview:()=>window.open(i[0].url),children:i.length>0?null:C.jsxs("div",{className:"upload-btn",children:[C.jsx(xc,{}),C.jsx("div",{style:{marginTop:8},children:"Upload"})]})})}),C.jsx("div",{className:"cover-right",children:C.jsx(hc,{onClick:s,children:"保存"})})]})})};class $u extends _.Component{constructor(){super(...arguments);N(this,"toggleHotKeyDes",()=>{const{hotKeyVisible:t,setHotKeyVisible:n}=on;n(!t)});N(this,"toggleSnapShot",()=>{const{snapShotVisible:t,setSnapShotVisible:n}=on;n(!t)})}render(){const{layerConfigs:t}=U,{hotKeyVisible:n,snapShotVisible:a}=on,{scale:i}=rt;return C.jsxs("div",{className:"lc-designer-footer",children:[C.jsxs("div",{className:"footer-left",children:[C.jsxs("div",{className:"footer-item",onClick:this.toggleHotKeyDes,children:[C.jsx(su,{}),C.jsx("span",{children:"快捷键"})]}),C.jsxs("div",{className:"footer-item",onClick:this.toggleSnapShot,children:[C.jsx(jc,{}),C.jsx("span",{children:"封面"})]})]}),C.jsxs("div",{className:"footer-right",children:[C.jsxs("div",{className:"right-info-item",children:["缩放 : ",(i*100).toFixed(0),"%"]}),C.jsxs("div",{className:"right-info-item",children:["图层 : ",Object.keys(t).length]})]}),n&&C.jsx(Yu,{onClose:this.toggleHotKeyDes}),a&&C.jsx(Uu,{onClose:this.toggleSnapShot})]})}}const Ku=Et($u);class Ju{constructor(){N(this,"canvasVisible",!1);N(this,"projectVisible",!1);N(this,"themeVisible",!1);N(this,"bluePrintVisible",!1);N(this,"setBluePrintVisible",r=>this.bluePrintVisible=r);N(this,"setCanvasVisible",r=>this.canvasVisible=r);N(this,"setProjectVisible",r=>this.projectVisible=r);N(this,"setThemeVisible",r=>this.themeVisible=r);xn(this,{canvasVisible:le,projectVisible:le,themeVisible:le,bluePrintVisible:le,setCanvasVisible:ce,setProjectVisible:ce,setThemeVisible:ce,setBluePrintVisible:ce})}}const fe=new Ju,Zu=()=>C.jsxs("div",{className:"bp-header",children:[C.jsx("div",{className:"bp-header-title",children:"蓝图编辑器"}),C.jsx("div",{className:"bp-header-menu",children:C.jsx(Gi,{onClick:()=>{const{setBluePrintVisible:e}=fe;e(!1);const{setCanvasTranslate:r,setCanvasScale:t}=pt;r({x:0,y:0}),t(1)}})})]}),Qu=Et(()=>{const{canvasScale:e}=pt;return C.jsx("div",{className:"bp-footer",children:C.jsxs("div",{className:"bp-footer-item",children:["缩放:",(e*100).toFixed(0),"%"]})})}),tf=()=>C.jsxs("div",{className:"bp-left",children:[C.jsx(ef,{}),C.jsx(of,{})]}),ef=Et(()=>{const{activeMenu:e}=ar,r=[{icon:C.jsx(Rl,{}),label:"图层节点",key:"layer"},{icon:C.jsx(Nc,{}),label:"逻辑节点",key:"logical"},{icon:C.jsx(tu,{}),label:"全局变量",key:"global"},{icon:C.jsx(Jc,{}),label:"过滤器",key:"filter"}];return C.jsx("div",{className:"bp-node-sort-list",children:r.map((t,n)=>C.jsxs("div",{className:`bp-left-item ${e===t.key?"bp-left-item-active":""}`,onClick:()=>{ar.setActiveMenu(t.key)},children:[C.jsx("div",{className:"bp-item-icon",children:t.icon}),C.jsx("div",{className:"bp-item-label",children:t.label})]},n))})}),rf=e=>{var r,t;if(e.target.classList.contains("bp-drag-node")){const n=e.target;(r=e.dataTransfer)==null||r.setData("nodeId",n.getAttribute("data-id")),(t=e.dataTransfer)==null||t.setData("type",n.getAttribute("data-type"))}},nf=e=>{e.preventDefault()},af=e=>{var l,c;e.preventDefault();let r=(l=e.dataTransfer)==null?void 0:l.getData("nodeId");const t=(c=e.dataTransfer)==null?void 0:c.getData("type"),{bpDragContentRef:n,canvasScale:a}=pt,i=n==null?void 0:n.getBoundingClientRect(),o={x:(e.clientX-((i==null?void 0:i.x)||0))/a,y:(e.clientY-((i==null?void 0:i.y)||0))/a};if(t==="layer-node"){const{setUsedLayerNodes:u}=ar;u(r,!0)}else r=bn.generateId();const{addBPNodeLayout:s}=pt;s({id:r,type:t,position:o})},of=Et(()=>{const{activeMenu:e}=ar,r=ff[e],t=_.useRef(null);return _.useEffect(()=>(t.current=new xa(document.getElementById("bp-node-draggable"),document.getElementById("bp-ds-container"),rf,nf,af),()=>{var n;return(n=t.current)==null?void 0:n.destroy()}),[e]),C.jsxs("div",{className:"bp-node-list",children:[C.jsx("div",{className:"bp-node-list-header",children:C.jsx("div",{className:"bp-node-list-header-label",children:"图层节点(取自画布已有组件)"})}),C.jsx("div",{className:"bp-node-list-body",children:C.jsx("div",{className:"bp-node-list-container",id:"bp-node-draggable",style:{overflow:"scroll"},children:r&&C.jsx(r,{})})})]})}),sf=Et(()=>{const{layerConfigs:e}=U,{usedLayerNodes:r}=ar;return C.jsx(C.Fragment,{children:e&&Object.keys(e).map((t,n)=>{const a=e[t],i=r[t];return C.jsxs("div",{className:`bp-node-list-item bp-drag-node ${i?"bp-node-list-item-used":""}`,"data-id":a.id,"data-type":"layer-node",draggable:!i,children:[C.jsx("div",{className:"bpn-li-icon",children:C.jsx(wl,{})}),C.jsx("div",{className:"bpn-li-label",children:a.name})]},n)})})}),lf=()=>{const e=[{name:"条件判断",icon:Ml,type:"condition-node"},{name:"逻辑处理",icon:Ol,type:"logical-process-node"}];return C.jsx(C.Fragment,{children:e.map((r,t)=>C.jsxs("div",{className:"bp-node-list-item bp-drag-node","data-type":r.type,draggable:!0,children:[C.jsx("div",{className:"bpn-li-icon",children:C.jsx(r.icon,{})}),C.jsx("div",{className:"bpn-li-label",children:r.name})]},t))})},cf=()=>C.jsx("div",{children:"开发中..."}),uf=()=>C.jsx("div",{children:"开发中..."}),ff={layer:sf,logical:lf,global:cf,filter:uf};class df{constructor(){N(this,"activeNode",null);N(this,"setActiveNode",r=>{this.activeNode=r});xn(this,{activeNode:le,setActiveNode:ce})}}const wo=new df,pf=Et(()=>{const{bpNodeControllerInsMap:e}=pt,{activeNode:r}=wo,t=e[r],n=t==null?void 0:t.getConfig();if(!n)return C.jsx("div",{className:"bp-right node-config-empty-info",children:"请激活节点配置..."});const a=[...n.input,...n.output],i=t.getConfigComponent();return C.jsxs("div",{className:"bp-right bp-node-config",children:[C.jsxs("div",{className:"bp-node-config-header",children:[C.jsx("div",{className:"bp-node-config-name",children:n==null?void 0:n.name}),C.jsx("div",{className:"bp-node-config-info",children:`${n==null?void 0:n.id} | ${n==null?void 0:n.type}`})]}),C.jsx("div",{className:"bp-ap-info-list",children:C.jsx(Qa,{label:"锚点信息",children:a.map(o=>C.jsxs("div",{className:"bp-ap-info-item",children:[C.jsx("div",{className:`bp-ap-info-type ${o.type===0?"type-input":"type-output"}`,children:o.type===0?"输入":"输出"}),C.jsx("div",{className:"bp-ap-info-name",children:o.name})]},o.id))})}),i&&C.jsx("div",{className:"bp-node-config-detail",children:C.jsx(Qa,{label:"节点配置",children:C.jsx(i,{controller:t})})})]})});class zt{static drawBezierCurves(r,t){r.beginPath();for(let n=0;n<t.length;n++){const{startPoint:a,endPoint:i,firstCP:o,secondCP:s,color:l,lineWidth:c,lineDash:u}=t[n];r.strokeStyle=l,r.lineWidth=c,r.moveTo(a.x,a.y),r.setLineDash(u),r.lineDashOffset=0,r.bezierCurveTo(o.x,o.y,s.x,s.y,i.x,i.y)}r.stroke()}static calculateControlPoint(r,t){const n=t.x<r.x?"left":"right",a=Math.abs(t.x-r.x),i={x:0,y:0},o={x:0,y:0};return n==="right"?(i.x=r.x+a*.5,i.y=r.y,o.x=t.x-a*.5,o.y=t.y):(i.x=r.x+a*.8,i.y=r.y,o.x=t.x-a*.8,o.y=t.y),{firstCP:i,secondCP:o}}static sampleBezierCurve(r,t,n,a,i){const o=[];for(let s=0;s<=i;s++){const l=s/i,c=(1-l)**3*r.x+3*(1-l)**2*l*t.x+3*(1-l)*l**2*n.x+l**3*a.x,u=(1-l)**3*r.y+3*(1-l)**2*l*t.y+3*(1-l)*l**2*n.y+l**3*a.y;o.push({x:c,y:u})}return o}static drawPoint(r,t,n,a){r.fillStyle=a,r.fillRect(t.x-n/2,t.y-n/2,n,n)}static isMouseInRectangle(r,t,n){const a=Math.abs(n.x-t.x);let i,o;n.x<t.x?(i=Math.min(t.x+a*.2,n.x-a*.2),o=Math.max(t.x+a*.2,n.x-a*.2)):(i=Math.min(t.x,n.x),o=Math.max(t.x,n.x));const s=Math.min(t.y,n.y),l=Math.max(t.y,n.y);return r.x>=i&&r.x<=o&&r.y>=s&&r.y<=l}static distanceBetweenPointAndLine(r,t,n){const a=r.x-t.x,i=r.y-t.y,o=n.x-t.x,s=n.y-t.y,l=a*o+i*s,c=o*o+s*s;let u=-1;c!==0&&(u=l/c);let f,d;u<0?(f=t.x,d=t.y):u>1?(f=n.x,d=n.y):(f=t.x+u*o,d=t.y+u*s);const p=r.x-f,v=r.y-d;return Math.sqrt(p*p+v*v)}static isMouseOnLine(r,t,n){for(let a=0;a<t.length-1;a++)if(zt.distanceBetweenPointAndLine(r,t[a],t[a+1])<=n)return!0;return!1}static updSegmentSamplingPoint(){const{bpLines:r}=pt;Object.values(r).forEach(t=>{const{startPoint:n,firstCP:a,secondCP:i,endPoint:o}=t;t.samplePoints=zt.sampleBezierCurve(n,a,i,o,20)})}}class vf extends ae.Component{constructor(){super(...arguments);N(this,"upLayer",null);N(this,"downLayer",null);N(this,"currentLine",{color:"#c0c0c0",lineWidth:1,lineDash:[10,10],startPoint:{x:0,y:0},endPoint:{x:0,y:0},firstCP:{x:0,y:0},secondCP:{x:0,y:0}});N(this,"keyDown",!1);N(this,"keyMove",!1);N(this,"bpMouseDown",t=>{const{target:n}=t;if(!n||!n.classList.contains("ap-circle"))return;const a=t.target,i=a.id.split(":");if(i&&i.length===3&&i[2]===Ya.INPUT.toString())return;const{canvasOffset:o}=pt,{x:s,y:l,width:c,height:u}=a.getBoundingClientRect();this.currentLine.startPoint={x:s+c/2-o.x,y:l+u/2-o.y},this.currentLine.startAnchorId=a.id,this.keyDown=!0});N(this,"bpMouseUp",t=>{var P,z;const{nodeContainerRef:n,upCtx:a}=pt,{width:i,height:o}=n==null?void 0:n.getBoundingClientRect(),s=t.target;if(!this.keyMove||!s||!s.classList.contains("ap-circle")||((P=s.id)==null?void 0:P.split(":")[2])!==Ya.INPUT.toString()){a==null||a.clearRect(0,0,i,o),this.keyDown=!1;return}const{canvasOffset:l}=pt;this.keyMove=!1,this.keyDown=!1,pt.upCtx.clearRect(0,0,i,o),this.currentLine.id=bn.generateId(),this.currentLine.lineDash=[],this.currentLine.lineWidth=1,this.currentLine.color="#a2a2a2",this.currentLine.endAnchorId=t.target.id;const{x:c,y:u,width:f,height:d}=(z=t.target)==null?void 0:z.getBoundingClientRect();this.currentLine.endPoint={x:c+f/2-l.x,y:u+d/2-l.y},zt.drawBezierCurves(pt.downCtx,[this.currentLine]);const{id:p,startPoint:v,endPoint:h,firstCP:g,secondCP:m,lineDash:x,startAnchorId:b,endAnchorId:S,color:D,lineWidth:y}=this.currentLine,E=zt.sampleBezierCurve(v,g,m,h,20),{addAPMap:w,addLine:T,addAPLineMap:O}=pt;T({id:p,color:D,lineWidth:y,lineDash:x,startPoint:{...v},endPoint:{...h},firstCP:{...g},secondCP:{...m},samplePoints:E,startAnchorId:b,endAnchorId:S}),w(this.currentLine.startAnchorId,this.currentLine.endAnchorId),O(this.currentLine.startAnchorId,this.currentLine.id),O(this.currentLine.endAnchorId,this.currentLine.id)});N(this,"bpMouseMove",t=>{if(!this.keyDown)return;this.keyMove=!0;const{startPoint:n,endPoint:a}=this.currentLine,{nodeContainerRef:i,canvasOffset:o}=pt,{width:s,height:l}=i==null?void 0:i.getBoundingClientRect();this.currentLine.endPoint={x:t.clientX-o.x,y:t.clientY-o.y};const c=zt.calculateControlPoint(n,a);this.currentLine.firstCP=c.firstCP,this.currentLine.secondCP=c.secondCP,pt.upCtx.clearRect(0,0,s,l),zt.drawBezierCurves(pt.upCtx,[{color:"#c0c0c0",lineWidth:1,lineDash:[10,10],startPoint:this.currentLine.startPoint,endPoint:this.currentLine.endPoint,firstCP:this.currentLine.firstCP,secondCP:this.currentLine.secondCP}])})}componentDidMount(){const{setUpCtx:t,setDownCtx:n}=pt;t(this.upLayer.getContext("2d")),n(this.downLayer.getContext("2d")),document.addEventListener("mousedown",this.bpMouseDown),document.addEventListener("mouseup",this.bpMouseUp),document.addEventListener("mousemove",this.bpMouseMove)}componentWillUnmount(){document.removeEventListener("mousedown",this.bpMouseDown),document.removeEventListener("mouseup",this.bpMouseUp),document.removeEventListener("mousemove",this.bpMouseMove)}render(){const t=window.innerWidth-670,n=window.innerHeight-85,a={position:"inherit",top:0,left:0};return C.jsxs("div",{style:{position:"absolute"},children:[C.jsx("canvas",{style:a,width:t,height:n,ref:i=>this.downLayer=i}),C.jsx("canvas",{style:a,width:t,height:n,ref:i=>this.upLayer=i})]})}}function ya(e,r){for(var t=e.length,n=0;n<t;++n)if(r(e[n],n))return!0;return!1}function Ro(e,r){for(var t=e.length,n=0;n<t;++n)if(r(e[n],n))return e[n];return null}function Mo(e){var r=e;if(typeof r>"u"){if(typeof navigator>"u"||!navigator)return"";r=navigator.userAgent||""}return r.toLowerCase()}function ba(e,r){try{return new RegExp(e,"g").exec(r)}catch{return null}}function hf(){if(typeof navigator>"u"||!navigator||!navigator.userAgentData)return!1;var e=navigator.userAgentData,r=e.brands||e.uaList;return!!(r&&r.length)}function gf(e,r){var t=ba("("+e+")((?:\\/|\\s|:)([0-9|\\.|_]+))",r);return t?t[3]:""}function Hn(e){return e.replace(/_/g,".")}function Sr(e,r){var t=null,n="-1";return ya(e,function(a){var i=ba("("+a.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",r);return!i||a.brand?!1:(t=a,n=i[3]||"-1",a.versionAlias?n=a.versionAlias:a.versionTest&&(n=gf(a.versionTest.toLowerCase(),r)||n),n=Hn(n),!0)}),{preset:t,version:n}}function Cr(e,r){var t={brand:"",version:"-1"};return ya(e,function(n){var a=Oo(r,n);return a?(t.brand=n.id,t.version=n.versionAlias||a.version,t.version!=="-1"):!1}),t}function Oo(e,r){return Ro(e,function(t){var n=t.brand;return ba(""+r.test,n.toLowerCase())})}var Vn=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],To=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],Fn=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],Io=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],zo=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function Po(e){return!!Sr(Io,e).preset}function mf(e){var r=Mo(e),t=!!/mobi/g.exec(r),n={name:"unknown",version:"-1",majorVersion:-1,webview:Po(r),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},a={name:"unknown",version:"-1",majorVersion:-1},i=Sr(Vn,r),o=i.preset,s=i.version,l=Sr(zo,r),c=l.preset,u=l.version,f=Sr(To,r);if(n.chromium=!!f.preset,n.chromiumVersion=f.version,!n.chromium){var d=Sr(Fn,r);n.webkit=!!d.preset,n.webkitVersion=d.version}return c&&(a.name=c.id,a.version=u,a.majorVersion=parseInt(u,10)),o&&(n.name=o.id,n.version=s,n.webview&&a.name==="ios"&&n.name!=="safari"&&(n.webview=!1)),n.majorVersion=parseInt(n.version,10),{browser:n,os:a,isMobile:t,isHints:!1}}function xf(e){var r=navigator.userAgentData,t=(r.uaList||r.brands).slice(),n=e&&e.fullVersionList,a=r.mobile||!1,i=t[0],o=(e&&e.platform||r.platform||navigator.platform).toLowerCase(),s={name:i.brand,version:i.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!Cr(Io,t).brand||Po(Mo())},l={name:"unknown",version:"-1",majorVersion:-1};s.webkit=!s.chromium&&ya(Fn,function(v){return Oo(t,v)});var c=Cr(To,t);if(s.chromium=!!c.brand,s.chromiumVersion=c.version,!s.chromium){var u=Cr(Fn,t);s.webkit=!!u.brand,s.webkitVersion=u.version}var f=Ro(zo,function(v){return new RegExp(""+v.test,"g").exec(o)});if(l.name=f?f.id:"",e&&(l.version=e.platformVersion),n&&n.length){var d=Cr(Vn,n);s.name=d.brand||s.name,s.version=d.version||s.version}else{var p=Cr(Vn,t);s.name=p.brand||s.name,s.version=p.brand&&e?e.uaFullVersion:p.version}return s.webkit&&(l.name=a?"ios":"mac"),l.name==="ios"&&s.webview&&(s.version="-1"),l.version=Hn(l.version),s.version=Hn(s.version),l.majorVersion=parseInt(l.version,10),s.majorVersion=parseInt(s.version,10),{browser:s,os:l,isMobile:a,isHints:!0}}function yf(e){return typeof e>"u"&&hf()?xf():mf(e)}var Wn=function(){return Wn=Object.assign||function(r){for(var t,n=1,a=arguments.length;n<a;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}return r},Wn.apply(this,arguments)};function bf(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(t[n[a]]=e[n[a]]);return t}function Bo(e,r){var t=Tl(r),n=t.className;return _.forwardRef(function(a,i){var o=a.className,s=o===void 0?"":o;a.cspNonce;var l=bf(a,["className","cspNonce"]),c=_.useRef();return _.useImperativeHandle(i,function(){return c.current},[]),_.useEffect(function(){var u=t.inject(c.current,{nonce:a.cspNonce});return function(){u.destroy()}},[]),_.createElement(e,Wn({ref:c,"data-styled-id":n,className:"".concat(s," ").concat(n)},l))})}var qn=function(e,r){return qn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])},qn(e,r)};function Fr(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");qn(e,r);function t(){this.constructor=e}e.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var R=function(){return R=Object.assign||function(r){for(var t,n=1,a=arguments.length;n<a;n++){t=arguments[n];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(r[i]=t[i])}return r},R.apply(this,arguments)};function Cf(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(e);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(t[n[a]]=e[n[a]]);return t}function Sf(e,r,t,n){var a=arguments.length,i=a<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,t):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(e,r,t,n);else for(var s=e.length-1;s>=0;s--)(o=e[s])&&(i=(a<3?o(i):a>3?o(r,t,i):o(r,t))||i);return a>3&&i&&Object.defineProperty(r,t,i),i}function Df(e){var r=typeof Symbol=="function"&&Symbol.iterator,t=r&&e[r],n=0;if(t)return t.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function M(e,r){var t=typeof Symbol=="function"&&e[Symbol.iterator];if(!t)return e;var n=t.call(e),a,i=[],o;try{for(;(r===void 0||r-- >0)&&!(a=n.next()).done;)i.push(a.value)}catch(s){o={error:s}}finally{try{a&&!a.done&&(t=n.return)&&t.call(n)}finally{if(o)throw o.error}}return i}function W(e,r,t){if(t||arguments.length===2)for(var n=0,a=r.length,i;n<a;n++)(i||!(n in r))&&(i||(i=Array.prototype.slice.call(r,0,n)),i[n]=r[n]);return e.concat(i||Array.prototype.slice.call(r))}function Wr(e,r){return R({events:[],props:[],name:e},r)}var Ef=["n","w","s","e"],Ca=["n","w","s","e","nw","ne","sw","se"];function wf(e,r){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*e,'px" height="').concat(32*e,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(r,'deg);transform-origin: 16px 16px"></path></svg>')}function Rf(e){var r=wf(1,e),t=Math.round(e/45)*45%180,n="ns-resize";return t===135?n="nwse-resize":t===45?n="nesw-resize":t===90&&(n="ew-resize"),"cursor:".concat(n,";cursor: url('").concat(r,"') 16 16, ").concat(n,";")}var dr=yf(),ko=dr.browser.webkit,Lo=ko&&function(){var e=typeof window>"u"?{userAgent:""}:window.navigator,r=/applewebkit\/([^\s]+)/g.exec(e.userAgent.toLowerCase());return r?parseFloat(r[1])<605:!1}(),_o=dr.browser.name,No=parseInt(dr.browser.version,10),Mf=_o==="chrome",Of=dr.browser.chromium,Tf=parseInt(dr.browser.chromiumVersion,10)||0,If=Mf&&No>=109||Of&&Tf>=109,zf=_o==="firefox",Pf=parseInt(dr.browser.webkitVersion,10)>=612||No>=15,Sa="moveable-",Bf=Ca.map(function(e){var r="",t="",n="center",a="center",i="calc(var(--moveable-control-padding, 20) * -1px)";return e.indexOf("n")>-1&&(r="top: ".concat(i,";"),a="bottom"),e.indexOf("s")>-1&&(r="top: 0px;",a="top"),e.indexOf("w")>-1&&(t="left: ".concat(i,";"),n="right"),e.indexOf("e")>-1&&(t="left: 0px;",n="left"),'.around-control[data-direction*="'.concat(e,`"] {
        `).concat(t).concat(r,`
        transform-origin: `).concat(n," ").concat(a,`;
    }`)}).join(`
`),kf=`
{
position: absolute;
width: 1px;
height: 1px;
left: 0;
top: 0;
z-index: 3000;
--moveable-color: #4af;
--zoom: 1;
--zoompx: 1px;
--moveable-line-padding: 0;
--moveable-control-padding: 0;
will-change: transform;
outline: 1px solid transparent;
}
.control-box {
z-index: 0;
}
.line, .control {
position: absolute;
left: 0;
top: 0;
will-change: transform;
}
.control {
width: 14px;
height: 14px;
border-radius: 50%;
border: 2px solid #fff;
box-sizing: border-box;
background: #4af;
background: var(--moveable-color);
margin-top: -7px;
margin-left: -7px;
border: 2px solid #fff;
z-index: 10;
}
.around-control {
position: absolute;
will-change: transform;
width: calc(var(--moveable-control-padding, 20) * 1px);
height: calc(var(--moveable-control-padding, 20) * 1px);
left: calc(var(--moveable-control-padding, 20) * -0.5px);
top: calc(var(--moveable-control-padding, 20) * -0.5px);
box-sizing: border-box;
background: transparent;
z-index: 8;
cursor: alias;
transform-origin: center center;
}
`.concat(Bf,`
.padding {
position: absolute;
top: 0px;
left: 0px;
width: 100px;
height: 100px;
transform-origin: 0 0;
}
.line {
width: 1px;
height: 1px;
background: #4af;
background: var(--moveable-color);
transform-origin: 0px 50%;
}
.line.edge {
z-index: 1;
background: transparent;
}
.line.dashed {
box-sizing: border-box;
background: transparent;
}
.line.dashed.horizontal {
border-top: 1px dashed #4af;
border-top-color: #4af;
border-top-color: var(--moveable-color);
}
.line.dashed.vertical {
border-left: 1px dashed #4af;
border-left-color: #4af;
border-left-color: var(--moveable-color);
}
.line.vertical {
transform: translateX(-50%);
}
.line.horizontal {
transform: translateY(-50%);
}
.line.vertical.bold {
width: 2px;
}
.line.horizontal.bold {
height: 2px;
}

.control.origin {
border-color: #f55;
background: #fff;
width: 12px;
height: 12px;
margin-top: -6px;
margin-left: -6px;
pointer-events: none;
}
`).concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(e){return`
.direction[data-rotation="`.concat(e,'"], :global .view-control-rotation').concat(e,` {
`).concat(Rf(e),`
}
`)}).join(`
`),`

.line.direction:before {
content: "";
position: absolute;
width: 100%;
height: calc(var(--moveable-line-padding, 0) * 1px);
bottom: 0;
left: 0;
}
.group {
z-index: -1;
}
.area {
position: absolute;
}
.area-pieces {
position: absolute;
top: 0;
left: 0;
display: none;
}
.area.avoid, .area.pass {
pointer-events: none;
}
.area.avoid+.area-pieces {
display: block;
}
.area-piece {
position: absolute;
}

`).concat(Lo?`:global svg *:before {
content:"";
transform-origin: inherit;
}`:"",`
`),Lf=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],Yn=1e-4,Vt=1e-7,$r=1e-9,Xn=Math.pow(10,10),ri=-Xn,_f={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},Da={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},Go={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},Nf=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag","getControlBoxElement","getMoveables","getDragElement"];function qr(e,r,t,n,a,i){var o,s;i===void 0&&(i="draggable");var l=(s=(o=r.gestos[i])===null||o===void 0?void 0:o.move(t,e.inputEvent))!==null&&s!==void 0?s:{},c=l.originalDatas||l.datas,u=c[i]||(c[i]={});return R(R({},a?Es(r,l):l),{isPinch:!!n,parentEvent:!0,datas:u,originalDatas:e.originalDatas})}var or=function(){function e(r){var t;r===void 0&&(r="draggable"),this.ableName=r,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=(t={},t[r]={},t)}return e.prototype.dragStart=function(r,t){this.isDrag=!1,this.isFlag=!1;var n=t.originalDatas;return this.datas=n,n[this.ableName]||(n[this.ableName]={}),R(R({},this.move(r,t.inputEvent)),{type:"dragstart"})},e.prototype.drag=function(r,t){return this.move([r[0]-this.prevX,r[1]-this.prevY],t)},e.prototype.move=function(r,t){var n,a,i=!1;if(!this.isFlag)this.prevX=r[0],this.prevY=r[1],this.startX=r[0],this.startY=r[1],n=r[0],a=r[1],this.isFlag=!0;else{var o=this.isDrag;n=this.prevX+r[0],a=this.prevY+r[1],(r[0]||r[1])&&(this.isDrag=!0),!o&&this.isDrag&&(i=!0)}return this.prevX=n,this.prevY=a,{type:"drag",clientX:n,clientY:a,inputEvent:t,isFirstDrag:i,isDrag:this.isDrag,distX:n-this.startX,distY:a-this.startY,deltaX:r[0],deltaY:r[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},e}();function rr(e,r,t,n){var a=e.length===16,i=a?4:3,o=Ue(e,t,n,i),s=M(o,4),l=M(s[0],2),c=l[0],u=l[1],f=M(s[1],2),d=f[0],p=f[1],v=M(s[2],2),h=v[0],g=v[1],m=M(s[3],2),x=m[0],b=m[1],S=M(Dt(e,r,i),2),D=S[0],y=S[1],E=Math.min(c,d,h,x),w=Math.min(u,p,g,b),T=Math.max(c,d,h,x),O=Math.max(u,p,g,b);c=c-E||0,d=d-E||0,h=h-E||0,x=x-E||0,u=u-w||0,p=p-w||0,g=g-w||0,b=b-w||0,D=D-E||0,y=y-w||0;var P=e[0],z=e[i+1],I=Jt(P*z);return{left:E,top:w,right:T,bottom:O,origin:[D,y],pos1:[c,u],pos2:[d,p],pos3:[h,g],pos4:[x,b],direction:I}}function Ao(e,r){var t=r.clientX,n=r.clientY,a=r.datas,i=e.state,o=i.moveableClientRect,s=i.rootMatrix,l=i.is3d,c=i.pos1,u=o.left,f=o.top,d=l?4:3,p=M(it(cr(s,[t-u,n-f],d),c),2),v=p[0],h=p[1],g=M(ve({datas:a,distX:v,distY:h}),2),m=g[0],x=g[1];return[m,x]}function Xe(e,r){var t=r.datas,n=e.state,a=n.allMatrix,i=n.beforeMatrix,o=n.is3d,s=n.left,l=n.top,c=n.origin,u=n.offsetMatrix,f=n.targetMatrix,d=n.transformOrigin,p=o?4:3;t.is3d=o,t.matrix=a,t.targetMatrix=f,t.beforeMatrix=i,t.offsetMatrix=u,t.transformOrigin=d,t.inverseMatrix=ye(a,p),t.inverseBeforeMatrix=ye(i,p),t.absoluteOrigin=ir(xt([s,l],c),p),t.startDragBeforeDist=Ft(t.inverseBeforeMatrix,t.absoluteOrigin,p),t.startDragDist=Ft(t.inverseMatrix,t.absoluteOrigin,p)}function Gf(e){return rr(e.datas.beforeTransform,[50,50],100,100).direction}function Cn(e,r,t){var n=r.datas,a=r.originalDatas.beforeRenderable,i=n.transformIndex,o=a.nextTransforms,s=o.length,l=a.nextTransformAppendedIndexes,c=-1;i===-1?(t==="translate"?c=0:t==="rotate"&&(c=zr(o,function(p){return p.match(/scale\(/g)})),c===-1&&(c=o.length),n.transformIndex=c):Re(l,function(p){return p.index===i&&p.functionName===t})?c=i:c=i+l.filter(function(p){return p.index<i}).length;var u=cp(o,e.state,c),f=u.targetFunction,d=t==="rotate"?"rotateZ":t;n.beforeFunctionTexts=u.beforeFunctionTexts,n.afterFunctionTexts=u.afterFunctionTexts,n.beforeTransform=u.beforeFunctionMatrix,n.beforeTransform2=u.beforeFunctionMatrix2,n.targetTansform=u.targetFunctionMatrix,n.afterTransform=u.afterFunctionMatrix,n.afterTransform2=u.afterFunctionMatrix2,n.targetAllTransform=u.allFunctionMatrix,f.functionName===d?(n.afterFunctionTexts.splice(0,1),n.isAppendTransform=!1):s>c&&(n.isAppendTransform=!0,a.nextTransformAppendedIndexes=W(W([],M(l),!1),[{functionName:t,index:c,isAppend:!0}],!1))}function Sn(e,r,t){return"".concat(e.beforeFunctionTexts.join(" ")," ").concat(e.isAppendTransform?t:r," ").concat(e.afterFunctionTexts.join(" "))}function Af(e){var r=e.datas,t=e.distX,n=e.distY,a=M(Ho({datas:r,distX:t,distY:n}),2),i=a[0],o=a[1],s=jo(r,Ll([i,o],4));return Ft(s,ir([0,0,0],4),4)}function jo(e,r,t){var n=e.beforeTransform,a=e.afterTransform,i=e.beforeTransform2,o=e.afterTransform2,s=e.targetAllTransform,l=t?Bt(s,r,4):Bt(r,s,4),c=Bt(ye(t?i:n,4),l,4),u=Bt(c,ye(t?o:a,4),4);return u}function Ho(e){var r=e.datas,t=e.distX,n=e.distY,a=r.inverseBeforeMatrix,i=r.is3d,o=r.startDragBeforeDist,s=r.absoluteOrigin,l=i?4:3;return it(Ft(a,xt(s,[t,n]),l),o)}function ve(e,r){var t=e.datas,n=e.distX,a=e.distY,i=t.inverseBeforeMatrix,o=t.inverseMatrix,s=t.is3d,l=t.startDragBeforeDist,c=t.startDragDist,u=t.absoluteOrigin,f=s?4:3;return it(Ft(r?i:o,xt(u,[n,a]),f),r?l:c)}function jf(e,r){var t=e.datas,n=e.distX,a=e.distY,i=t.beforeMatrix,o=t.matrix,s=t.is3d,l=t.startDragBeforeDist,c=t.startDragDist,u=t.absoluteOrigin,f=s?4:3;return it(Ft(r?i:o,xt(r?l:c,[n,a]),f),u)}function Hf(e,r,t,n,a,i){return n===void 0&&(n=r),a===void 0&&(a=t),i===void 0&&(i=[0,0]),e?e.map(function(o,s){var l=pa(o),c=l.value,u=l.unit,f=s?a:n,d=s?t:r;if(o==="%"||isNaN(c)){var p=f?i[s]/f:0;return d*p}else if(u!=="%")return c;return d*c/100}):i}function Vo(e){var r=[];return e[1]>=0&&(e[0]>=0&&r.push(3),e[0]<=0&&r.push(2)),e[1]<=0&&(e[0]>=0&&r.push(1),e[0]<=0&&r.push(0)),r}function Vf(e,r){return Vo(r).map(function(t){return e[t]})}function Pt(e,r){var t=(r[0]+1)/2,n=(r[1]+1)/2,a=[_e(e[0][0],e[1][0],t,1-t),_e(e[0][1],e[1][1],t,1-t)],i=[_e(e[2][0],e[3][0],t,1-t),_e(e[2][1],e[3][1],t,1-t)];return[_e(a[0],i[0],n,1-n),_e(a[1],i[1],n,1-n)]}function Ff(e,r,t,n,a,i){var o=Ue(r,t,n,a),s=Pt(o,i),l=e[0]-s[0],c=e[1]-s[1];return[l,c]}function Yr(e,r,t,n){return Bt(e,Mr(r,n,t),n)}function Wf(e,r,t,n){var a=e.transformOrigin,i=e.offsetMatrix,o=e.is3d,s=o?4:3,l;if(Ye(t)){var c=r.beforeTransform,u=r.afterTransform;n?l=pe(Pr(t),4,s):l=pe(Bt(Bt(c,Pr([t]),4),u,4),4,s)}else l=t;return Yr(i,l,a,s)}function qf(e,r){var t=e.transformOrigin,n=e.offsetMatrix,a=e.is3d,i=e.targetMatrix,o=e.targetAllTransform,s=a?4:3;return Yr(n,Bt(o||i,va(r,s),s),t,s)}function Dn(e,r){var t=pr(r);return{setTransform:function(n,a){a===void 0&&(a=-1),t.startTransforms=Gt(n)?n:Fe(n),Un(e,r,a)},setTransformIndex:function(n){Un(e,r,n)}}}function En(e,r,t){var n=pr(r),a=n.startTransforms;Un(e,r,zr(a,function(i){return i.indexOf("".concat(t,"("))===0}))}function Un(e,r,t){var n=pr(r),a=r.datas;if(a.transformIndex=t,t!==-1){var i=n.startTransforms[t];if(i){var o=e.state,s=kr([i],{"x%":function(l){return l/100*o.offsetWidth},"y%":function(l){return l/100*o.offsetHeight}});a.startValue=s[0].functionValue}}}function Ea(e,r){var t=pr(e);t.nextTransforms=Fe(r)}function pr(e){return e.originalDatas.beforeRenderable}function un(e){var r=e.originalDatas.beforeRenderable;return r.nextTransforms}function Kr(e){return(un(e)||[]).join(" ")}function Jr(e){return pr(e).nextStyle}function Fo(e,r,t,n,a){Ea(a,r);var i=jt.drag(e,qr(a,e.state,t,n,!1)),o=i?i.transform:r;return R(R({transform:r,drag:i},Ht({transform:o},a)),{afterTransform:o})}function wa(e,r,t,n,a,i){var o=Wf(e.state,a,r,i),s=Uf(e,t,n,o);return s}function Wo(e,r,t,n,a,i,o){var s=wa(e,r,t,a,i,o),l=e.state,c=l.left,u=l.top,f=e.props.groupable,d=f?c:0,p=f?u:0,v=it(n,s);return it(v,[d,p])}function Yf(e,r,t,n,a,i,o){var s=Wo(e,r,t,n,a,i,o);return s}function Xf(e,r,t){return[r?-1+e[0]/(r/2):0,t?-1+e[1]/(t/2):0]}function Uf(e,r,t,n){n===void 0&&(n=e.state.allMatrix);var a=e.state,i=a.width,o=a.height,s=a.is3d,l=s?4:3,c=[i/2*(1+r[0])+t[0],o/2*(1+r[1])+t[1]];return Dt(n,c,l)}function $f(e,r,t){var n=t.fixedDirection,a=t.fixedPosition,i=t.fixedOffset;return Wo(e,"rotate(".concat(r,"deg)"),n,a,i,t)}function Kf(e,r,t,n,a,i){var o=e.props.groupable,s=e.state,l=s.transformOrigin,c=s.offsetMatrix,u=s.is3d,f=s.width,d=s.height,p=s.left,v=s.top,h=i.fixedDirection,g=i.nextTargetMatrix||s.targetMatrix,m=u?4:3,x=Hf(a,r,t,f,d,l),b=o?p:0,S=o?v:0,D=Yr(c,g,x,m),y=Ff(n,D,r,t,m,h);return it(y,[b,S])}function Jf(e,r){return Pt(te(e.state),r)}function Zf(e,r){var t=e.targetGesto,n=e.controlGesto,a;return t!=null&&t.isFlag()&&(a=t.getEventData()[r]),!a&&(n!=null&&n.isFlag())&&(a=n.getEventData()[r]),a||{}}function Qf(e){if(e&&e.getRootNode){var r=e.getRootNode();if(r.nodeType===11)return r}}function td(e){var r=e("scale"),t=e("rotate"),n=e("translate"),a=[];return n&&n!=="0px"&&n!=="none"&&a.push("translate(".concat(n.split(/\s+/).join(","),")")),t&&t!=="1"&&t!=="none"&&a.push("rotate(".concat(t,")")),r&&r!=="1"&&r!=="none"&&a.push("scale(".concat(r.split(/\s+/).join(","),")")),a}function qo(e,r,t){for(var n=e,a=[],i=ha(e)||Ie(e),o=!t&&e===r||e===i,s=o,l=!1,c=3,u,f,d,p=!1,v=Ar(r,r,!0).offsetParent,h=1;n&&!s;){s=o;var g=Yt(n),m=g("position"),x=ps(n),b=m==="fixed",S=td(g),D=Kl(Kd(x)),y=void 0,E=!1,w=!1,T=0,O=0,P=0,z=0,I={hasTransform:!1,fixedContainer:null};b&&(p=!0,I=ep(n),v=I.fixedContainer);var k=D.length;!l&&(k===16||S.length)&&(l=!0,c=4,ta(a),d&&(d=pe(d,3,4))),l&&k===9&&(D=pe(D,3,4));var B=tp(n,e),V=B.tagName,H=B.hasOffset,G=B.isSVG,L=B.origin,F=B.targetOrigin,A=B.offset,Z=M(A,2),J=Z[0],Y=Z[1];V==="svg"&&d&&(a.push({type:"target",target:n,matrix:rp(n,c)}),a.push({type:"offset",target:n,matrix:_t(c)}));var X=parseFloat(g("zoom"))||1;if(b)y=I.fixedContainer,E=!0;else{var q=Ar(n,r,!1,!0,g),$=q.offsetZoom;if(y=q.offsetParent,E=q.isEnd,w=q.isStatic,h*=$,(q.isCustomElement||$!==1)&&w)J-=y.offsetLeft,Y-=y.offsetTop;else if(zf||If){var et=q.parentSlotElement;if(et){for(var ot=y,at=0,Q=0;ot&&Qf(ot);)at+=ot.offsetLeft,Q+=ot.offsetTop,ot=ot.offsetParent;J-=at,Y-=Q}}}if(ko&&!Pf&&H&&!G&&w&&(m==="relative"||m==="static")&&(J-=y.offsetLeft,Y-=y.offsetTop,o=o||E),b)H&&I.hasTransform&&(P=y.clientLeft,z=y.clientTop);else if(H&&v!==y&&(T=y.clientLeft,O=y.clientTop),H&&y===i){var tt=vs(n,!1);J+=tt[0],Y+=tt[1]}if(a.push({type:"target",target:n,matrix:Mr(D,c,L)}),S.length&&(a.push({type:"offset",target:n,matrix:_t(c)}),a.push({type:"target",target:n,matrix:Mr(Pr(S),c,L)})),H){var gt=n===e,ct=gt?0:n.scrollLeft,ut=gt?0:n.scrollTop;a.push({type:"offset",target:n,matrix:We([J-ct+T-P,Y-ut+O-z],c)})}else a.push({type:"offset",target:n,origin:L});if(X!==1&&a.push({type:"zoom",target:n,matrix:Mr(va([X,X],c),c,[0,0])}),d||(d=D),u||(u=L),f||(f=F),s||b)break;n=y,o=E,(!t||n===i)&&(s=o)}return d||(d=_t(c)),u||(u=[0,0]),f||(f=[0,0]),{zoom:h,offsetContainer:v,matrixes:a,targetMatrix:d,transformOrigin:u,targetOrigin:f,is3d:l,hasFixed:p}}var Ne=null,Ge=null,Ze=null;function sr(e){e?(window.Map&&(Ne=new Map,Ge=new Map),Ze=[]):(Ne=null,Ze=null,Ge=null)}function ed(e){var r=Ge==null?void 0:Ge.get(e);if(r)return r;var t=Or(e,!0);return Ge&&Ge.set(e,t),t}function rd(e,r){if(Ze){var t=Re(Ze,function(a){return a[0][0]==e&&a[0][1]==r});if(t)return t[1]}var n=qo(e,r,!0);return Ze&&Ze.push([[e,r],n]),n}function Yt(e){var r=Ne==null?void 0:Ne.get(e);if(!r){var t=_r(e).getComputedStyle(e);if(!Ne)return function(i){return t[i]};r={style:t,cached:{}},Ne.set(e,r)}var n=r.cached,a=r.style;return function(i){return i in n||(n[i]=a[i]),n[i]}}function ne(e,r,t){var n=t.originalDatas;n.groupable=n.groupable||{};var a=n.groupable;a.childDatas=a.childDatas||[];var i=a.childDatas;return e.moveables.map(function(o,s){return i[s]=i[s]||{},i[s][r]=i[s][r]||{},R(R({},t),{isRequestChild:!0,datas:i[s][r],originalDatas:i[s]})})}function Pn(e,r,t,n,a,i,o){var s=!!t.match(/Start$/g),l=!!t.match(/End$/g),c=a.isPinch,u=a.datas,f=ne(e,r.name,a),d=e.moveables,p=f.map(function(v,h){var g=d[h],m=g.state,x=m.gestos,b=v;if(s)b=new or(o).dragStart(n,v);else{if(x[o]||(x[o]=u.childGestos[h]),!x[o])return;b=qr(v,m,n,c,i,o)}var S=r[t](g,R(R({},b),{parentFlag:!0}));return l&&(x[o]=null),S});return s&&(u.childGestos=d.map(function(v){return v.state.gestos[o]})),p}function xe(e,r,t,n,a,i){a===void 0&&(a=function(u,f){return f});var o=!!t.match(/End$/g),s=ne(e,r.name,n),l=e.moveables,c=s.map(function(u,f){var d=l[f],p=u;p=a(d,u);var v=r[t](d,R(R({},p),{parentFlag:!0}));return v&&i&&i(d,u,v,f),o&&(d.state.gestos={}),v});return c}function fn(e,r,t,n){var a=t.fixedDirection,i=t.fixedPosition,o=n.datas.startPositions||te(r.state),s=Pt(o,a),l=M(Ft(fa(-e.rotation/180*Math.PI,3),[s[0]-i[0],s[1]-i[1],1],3),2),c=l[0],u=l[1];return n.datas.originalX=c,n.datas.originalY=u,n}function Yo(e,r,t,n){var a=e.getState(),i=a.renderPoses,o=a.rotation,s=a.direction,l=qe(e.props,r).zoom,c=Rr(o/Math.PI*180),u={},f=e.renderState;f.renderDirectionMap||(f.renderDirectionMap={});var d=f.renderDirectionMap;t.forEach(function(v){var h=v.dir;u[h]=!0});var p=Jt(s);return t.map(function(v){var h=v.data,g=v.classNames,m=v.dir,x=Da[m];if(!x||!u[m])return null;d[m]=!0;var b=(mt(c,15)+p*Go[m]+720)%180,S={};return fr(h).forEach(function(D){S["data-".concat(D)]=h[D]}),n.createElement("div",R({className:nt.apply(void 0,W(["control","direction",m,r],M(g),!1)),"data-rotation":b,"data-direction":m},S,{key:"direction-".concat(m),style:hn.apply(void 0,W([o,l],M(x.map(function(D){return i[D]})),!1))}))})}function Xo(e,r,t,n){var a=qe(e.props,t),i=a.renderDirections,o=i===void 0?r:i,s=a.displayAroundControls;if(!o)return[];var l=o===!0?Ca:o;return W(W([],M(s?Jo(e,n,t,l):[]),!1),M(Yo(e,t,l.map(function(c){return{data:{},classNames:[],dir:c}}),n)),!1)}function Gr(e,r,t,n,a,i){for(var o=[],s=6;s<arguments.length;s++)o[s-6]=arguments[s];var l=kt(t,n),c=r?mt(l/Math.PI*180,15)%180:-1;return e.createElement("div",{key:"line-".concat(i),className:nt.apply(void 0,W(["line","direction",r?"edge":"",r],M(o),!1)),"data-rotation":c,"data-line-key":i,"data-direction":r,style:Er(t,n,a,l)})}function Uo(e,r,t,n,a){var i=t===!0?Ef:t;return i.map(function(o,s){var l=M(Da[o],2),c=l[0],u=l[1];if(u!=null)return Gr(e,o,n[c],n[u],a,"".concat(r,"Edge").concat(s),r)}).filter(Boolean)}function $o(e){return function(r,t){var n=qe(r.props,e).edge;return n&&(n===!0||n.length)?W(W([],M(Uo(t,e,n,r.getState().renderPoses,r.props.zoom)),!1),M(nd(r,e,t)),!1):Ko(r,e,t)}}function Ko(e,r,t){return Xo(e,Ca,r,t)}function nd(e,r,t){return Xo(e,["nw","ne","sw","se"],r,t)}function Jo(e,r,t,n){var a=e.renderState;a.renderDirectionMap||(a.renderDirectionMap={});var i=e.getState(),o=i.renderPoses,s=i.rotation,l=i.direction,c=a.renderDirectionMap,u=e.props.zoom,f=Jt(l),d=s/Math.PI*180;return(n||fr(c)).map(function(p){var v=Da[p];if(!v)return null;var h=(mt(d,15)+f*Go[p]+720)%180,g=["around-control"];return t&&g.push("direction",t),r.createElement("div",{className:nt.apply(void 0,W([],M(g),!1)),"data-rotation":h,"data-direction":p,key:"direction-around-".concat(p),style:hn.apply(void 0,W([s,u],M(v.map(function(m){return o[m]})),!1))})})}function Ra(e,r,t){var n=e||{},a=n.position,i=a===void 0?"client":a,o=n.left,s=o===void 0?-1/0:o,l=n.top,c=l===void 0?-1/0:l,u=n.right,f=u===void 0?1/0:u,d=n.bottom,p=d===void 0?1/0:d,v={position:i,left:s,top:c,right:f,bottom:p};return{vertical:ni(v,r,!0),horizontal:ni(v,t,!1)}}function wn(e,r){var t=e.state,n=t.containerClientRect,a=n.clientHeight,i=n.clientWidth,o=n.clientLeft,s=n.clientTop,l=t.snapOffset,c=l.left,u=l.top,f=l.right,d=l.bottom,p=r||e.props.bounds||{},v=p.position||"client",h=v==="css",g=p.left,m=g===void 0?-1/0:g,x=p.top,b=x===void 0?-1/0:x,S=p.right,D=S===void 0?h?-1/0:1/0:S,y=p.bottom,E=y===void 0?h?-1/0:1/0:y;return h&&(D=i+f-c-D,E=a+d-u-E),{left:m+c-o,right:D+c-o,top:b+u-s,bottom:E+u-s}}function ad(e,r,t){var n=wn(e),a=n.left,i=n.top,o=n.right,s=n.bottom,l=M(t,2),c=l[0],u=l[1],f=M(it(t,r),2),d=f[0],p=f[1];j(d)<Vt&&(d=0),j(p)<Vt&&(p=0);var v=p>0,h=d>0,g={isBound:!1,offset:0,pos:0},m={isBound:!1,offset:0,pos:0};if(d===0&&p===0)return{vertical:g,horizontal:m};if(d===0)v?s<u&&(m.pos=s,m.offset=u-s):i>u&&(m.pos=i,m.offset=u-i);else if(p===0)h?o<c&&(g.pos=o,g.offset=c-o):a>c&&(g.pos=a,g.offset=c-a);else{var x=p/d,b=t[1]-x*c,S=0,D=0,y=!1;h&&o<=c?(S=x*o+b,D=o,y=!0):!h&&c<=a&&(S=x*a+b,D=a,y=!0),y&&(S<i||S>s)&&(y=!1),y||(v&&s<=u?(S=s,D=(S-b)/x,y=!0):!v&&u<=i&&(S=i,D=(S-b)/x,y=!0)),y&&(g.isBound=!0,g.pos=D,g.offset=c-D,m.isBound=!0,m.pos=S,m.offset=u-S)}return{vertical:g,horizontal:m}}function ni(e,r,t){var n=e[t?"left":"top"],a=e[t?"right":"bottom"],i=Math.min.apply(Math,W([],M(r),!1)),o=Math.max.apply(Math,W([],M(r),!1)),s=[];return n+1>i&&s.push({direction:"start",isBound:!0,offset:i-n,pos:n}),a-1<o&&s.push({direction:"end",isBound:!0,offset:o-a,pos:a}),s.length||s.push({isBound:!1,offset:0,pos:0}),s.sort(function(l,c){return j(c.offset)-j(l.offset)})}function ai(e,r,t){var n=t?e.map(function(a){return Hr(a,t)}):e;return n.some(function(a){return a[0]<r.left&&j(a[0]-r.left)>.1||a[0]>r.right&&j(a[0]-r.right)>.1||a[1]<r.top&&j(a[1]-r.top)>.1||a[1]>r.bottom&&j(a[1]-r.bottom)>.1})}function id(e,r,t){var n=Qt(e),a=Math.sqrt(n*n-r*r)||0;return[a,-a].sort(function(i,o){return j(i-e[t?0:1])-j(o-e[t?0:1])}).map(function(i){return kt([0,0],t?[i,r]:[r,i])})}function od(e,r,t,n,a){if(!e.props.bounds)return[];var i=a*Math.PI/180,o=wn(e),s=o.left,l=o.top,c=o.right,u=o.bottom,f=s-n[0],d=c-n[0],p=l-n[1],v=u-n[1],h={left:f,top:p,right:d,bottom:v};if(!ai(t,h,0))return[];var g=[];return[[f,0],[d,0],[p,1],[v,1]].forEach(function(m){var x=M(m,2),b=x[0],S=x[1];t.forEach(function(D){var y=kt([0,0],D);g.push.apply(g,W([],M(id(D,b,S).map(function(E){return i+E-y}).filter(function(E){return!ai(r,h,E)}).map(function(E){return mt(E*180/Math.PI,Vt)})),!1))})}),g}var sd=["left","right","center"],ld=["top","bottom","middle"],ii={left:"start",right:"end",center:"center",top:"start",bottom:"end",middle:"center"},Me={start:"left",end:"right",center:"center"},Oe={start:"top",end:"bottom",center:"middle"};function Qe(){return{left:!1,top:!1,right:!1,bottom:!1}}function vr(e,r){var t=e.props,n=t.snappable,a=t.bounds,i=t.innerBounds,o=t.verticalGuidelines,s=t.horizontalGuidelines,l=t.snapGridWidth,c=t.snapGridHeight,u=e.state,f=u.guidelines,d=u.enableSnap;return!n||!d||r&&n!==!0&&n.indexOf(r)<0?!1:!!(l||c||a||i||f&&f.length||o&&o.length||s&&s.length)}function Ma(e){return e===!1?{}:e===!0||!e?{left:!0,right:!0,top:!0,bottom:!0}:e}function cd(e,r){var t=Ma(e),n={};for(var a in t)a in r&&t[a]&&(n[a]=r[a]);return n}function Oa(e,r){var t=cd(e,r),n=ld.filter(function(i){return i in t}),a=sd.filter(function(i){return i in t});return{horizontalNames:n,verticalNames:a,horizontal:n.map(function(i){return t[i]}),vertical:a.map(function(i){return t[i]})}}function ud(e,r,t){var n=Dt(e,[r.clientLeft,r.clientTop],t);return[r.left+n[0],r.top+n[1]]}function fd(e){var r=M(e,2),t=r[0],n=r[1],a=n[0]-t[0],i=n[1]-t[1];Math.abs(a)<me&&(a=0),Math.abs(i)<me&&(i=0);var o=0,s=0,l=0;return a?i?(o=-i/a,s=1,l=o*t[0]-t[1]):(s=1,l=-t[1]):(o=-1,l=t[0]),[o,s,l].map(function(c){return mt(c,me)})}function Rn(e,r,t,n,a,i){n===void 0&&(n=[]),a===void 0&&(a=[]);var o=e.props,s=sp(i,o.snapThreshold,5);return Zo(e.state.guidelines,r,t,n,a,s)}function Zo(e,r,t,n,a,i){return{vertical:si(e,"vertical",r,i,n),horizontal:si(e,"horizontal",t,i,a)}}function dd(e,r,t){var n=M(t,2),a=n[0],i=n[1],o=M(r,2),s=o[0],l=o[1],c=M(it(t,r),2),u=c[0],f=c[1],d=f>0,p=u>0;u=gn(u),f=gn(f);var v={isSnap:!1,offset:0,pos:0},h={isSnap:!1,offset:0,pos:0};if(u===0&&f===0)return{vertical:v,horizontal:h};var g=Rn(e,u?[a]:[],f?[i]:[]),m=g.vertical,x=g.horizontal;m.posInfos.filter(function(V){var H=V.pos;return p?H>=s:H<=s}),x.posInfos.filter(function(V){var H=V.pos;return d?H>=l:H<=l}),m.isSnap=m.posInfos.length>0,x.isSnap=x.posInfos.length>0;var b=$n(m),S=b.isSnap,D=b.guideline,y=$n(x),E=y.isSnap,w=y.guideline,T=E?w.pos[1]:0,O=S?D.pos[0]:0;if(u===0)E&&(h.isSnap=!0,h.pos=w.pos[1],h.offset=i-h.pos);else if(f===0)S&&(v.isSnap=!0,v.pos=O,v.offset=a-O);else{var P=f/u,z=t[1]-P*a,I=0,k=0,B=!1;S?(k=O,I=P*k+z,B=!0):E&&(I=T,k=(I-z)/P,B=!0),B&&(v.isSnap=!0,v.pos=k,v.offset=a-k,h.isSnap=!0,h.pos=I,h.offset=i-I)}return{vertical:v,horizontal:h}}function De(e){var r="";return e===-1||e==="top"||e==="left"?r="start":e===0||e==="center"||e==="middle"?r="center":(e===1||e==="right"||e==="bottom")&&(r="end"),r}function oi(e,r,t){var n=Oa(e.props.snapDirections,r),a=Rn(e,n.vertical,n.horizontal,n.verticalNames.map(function(s){return De(s)}),n.horizontalNames.map(function(s){return De(s)}),t),i=De(n.horizontalNames[a.horizontal.index]),o=De(n.verticalNames[a.vertical.index]);return{vertical:R(R({},a.vertical),{direction:o}),horizontal:R(R({},a.horizontal),{direction:i})}}function $n(e){var r=e.isSnap;if(!r)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var t=e.posInfos[0],n=t.guidelineInfos[0],a=n.offset,i=n.dist,o=n.guideline;return{isSnap:r,offset:a,dist:i,pos:t.pos,guideline:o}}function si(e,r,t,n,a){var i,o;if(a===void 0&&(a=[]),!e||!e.length)return{isSnap:!1,index:-1,direction:"",posInfos:[]};var s=r==="vertical",l=s?0:1,c=t.map(function(f,d){var p=a[d]||"",v=e.map(function(h){var g=h.pos,m=f-g[l];return{offset:m,dist:j(m),guideline:h,direction:p}}).filter(function(h){var g=h.guideline,m=h.dist,x=g.type;return!(x!==r||m>n)}).sort(function(h,g){return h.dist-g.dist});return{pos:f,index:d,guidelineInfos:v,direction:p}}).filter(function(f){return f.guidelineInfos.length>0}).sort(function(f,d){return f.guidelineInfos[0].dist-d.guidelineInfos[0].dist}),u=c.length>0;return{isSnap:u,index:u?c[0].index:-1,direction:(o=(i=c[0])===null||i===void 0?void 0:i.direction)!==null&&o!==void 0?o:"",posInfos:c}}function pd(e,r,t,n){n===void 0&&(n=1);var a=[];t[0]&&t[1]?a=[t,[-t[0],t[1]],[t[0],-t[1]]]:!t[0]&&!t[1]?[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(f,d,p){var v=p[d+1]||p[0];a.push(f),a.push([(f[0]+v[0])/2,(f[1]+v[1])/2])}):e.props.keepRatio?a.push([-1,-1],[-1,1],[1,-1],[1,1],t):(a.push.apply(a,W([],M(Vf([[-1,-1],[1,-1],[-1,-1],[1,1]],t)),!1)),a.length>1&&a.push([(a[0][0]+a[1][0])/2,(a[0][1]+a[1][1])/2]));var i=a.map(function(f){return Pt(r,f)}),o=i.map(function(f){return f[0]}),s=i.map(function(f){return f[1]}),l=Rn(e,o,s,a.map(function(f){return De(f[0])}),a.map(function(f){return De(f[1])}),n),c=De(a.map(function(f){return f[0]})[l.vertical.index]),u=De(a.map(function(f){return f[1]})[l.horizontal.index]);return{vertical:R(R({},l.vertical),{direction:c}),horizontal:R(R({},l.horizontal),{direction:u})}}function Qo(e,r){var t=j(e.offset),n=j(r.offset);return e.isBound&&r.isBound?n-t:e.isBound?-1:r.isBound?1:e.isSnap&&r.isSnap?n-t:e.isSnap?-1:r.isSnap||t<Vt?1:n<Vt?-1:t-n}function dn(e,r){return e.slice().sort(function(t,n){var a=t.sign[r],i=n.sign[r],o=t.offset[r],s=n.offset[r];if(a){if(!i)return-1}else return 1;return Qo({isBound:t.isBound,isSnap:t.isSnap,offset:o},{isBound:n.isBound,isSnap:n.isSnap,offset:s})})[0]}function vd(e,r,t){var n=[];if(t)j(r[0])!==1||j(r[1])!==1?n.push([r,[-1,-1]],[r,[-1,1]],[r,[1,-1]],[r,[1,1]]):n.push([r,[e[0],-e[1]]],[r,[-e[0],e[1]]]),n.push([r,e]);else if(e[0]&&e[1]||!e[0]&&!e[1]){var a=e[0]?e:[1,1];[1,-1].forEach(function(o){[1,-1].forEach(function(s){var l=[o*a[0],s*a[1]];r[0]===l[0]&&r[1]===l[1]||n.push([r,l])})})}else if(e[0]){var i=j(r[0])===1?[1]:[1,-1];i.forEach(function(o){n.push([[r[0],-1],[o*e[0],-1]],[[r[0],0],[o*e[0],0]],[[r[0],1],[o*e[0],1]])})}else if(e[1]){var i=j(r[1])===1?[1]:[1,-1];i.forEach(function(s){n.push([[-1,r[1]],[-1,s*e[1]]],[[0,r[1]],[0,s*e[1]]],[[1,r[1]],[1,s*e[1]]])})}return n}function ts(e,r){var t=Ka([r[0][0],r[1][0]]),n=Ka([r[0][1],r[1][1]]);return{vertical:t<=e[0],horizontal:n<=e[1]}}function Ta(e,r){var t=M(r,2),n=t[0],a=t[1],i=a[0]-n[0],o=a[1]-n[1];j(i)<Vt&&(i=0),j(o)<Vt&&(o=0);var s,l;if(!i)s=n[0],l=e[0];else if(!o)s=n[1],l=e[1];else{var c=o/i;s=c*(e[0]-n[0])+n[1],l=e[1]}return s-l}function es(e,r,t,n){return n===void 0&&(n=Vt),e.every(function(a){var i=Ta(a,r),o=i<=0;return o===t||j(i)<=n})}function li(e,r,t,n,a){return a===void 0&&(a=0),n&&r-a<=e||!n&&e<=t+a?{isBound:!0,offset:n?r-e:t-e}:{isBound:!1,offset:0}}function hd(e,r){var t=r.line,n=r.centerSign,a=r.verticalSign,i=r.horizontalSign,o=r.lineConstants,s=e.props.innerBounds;if(!s)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var l=s.left,c=s.top,u=s.width,f=s.height,d=[[l,c],[l,c+f]],p=[[l,c],[l+u,c]],v=[[l+u,c],[l+u,c+f]],h=[[l,c+f],[l+u,c+f]];if(es([[l,c],[l+u,c],[l,c+f],[l+u,c+f]],t,n))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var g=Ee(t,o,p,a),m=Ee(t,o,h,a),x=Ee(t,o,d,i),b=Ee(t,o,v,i),S=g.isBound&&m.isBound,D=g.isBound||m.isBound,y=x.isBound&&b.isBound,E=x.isBound||b.isBound,w=lr(g.offset,m.offset),T=lr(x.offset,b.offset),O=[0,0],P=!1,z=!1;return j(T)<j(w)?(O=[w,0],P=D,z=S):(O=[0,T],P=E,z=y),{isAllBound:z,isVerticalBound:D,isHorizontalBound:E,isBound:P,offset:O}}function Ee(e,r,t,n,a,i){var o=M(r,2),s=o[0],l=o[1],c=e[0],u=t[0],f=t[1],d=gn(f[1]-u[1]),p=gn(f[0]-u[0]),v=l,h=s,g=-s/l;if(p){if(!d){if(i&&!v)return{isBound:!1,offset:0};if(h){var S=(u[1]-c[1])/g+c[0];return li(S,u[0],f[0],n,a)}else{var x=u[1]-c[1],b=j(x)<=(a||0);return{isBound:b,offset:b?x:0}}}}else{if(i&&!h)return{isBound:!1,offset:0};if(v){var m=g*(u[0]-c[0])+c[1];return li(m,u[1],f[1],n,a)}else{var x=u[0]-c[0],b=j(x)<=(a||0);return{isBound:b,offset:b?x:0}}}return{isBound:!1,offset:0}}function rs(e,r,t){return r.map(function(n){var a=hd(e,n),i=a.isBound,o=a.offset,s=a.isVerticalBound,l=a.isHorizontalBound,c=n.multiple,u=ve({datas:t,distX:o[0],distY:o[1]}).map(function(f,d){return f*(c[d]?2/c[d]:0)});return{sign:c,isBound:i,isVerticalBound:s,isHorizontalBound:l,isSnap:!1,offset:u}})}function gd(e,r,t){var n,a=Ia(e,r,[0,0],!1).map(function(d){return R(R({},d),{multiple:d.multiple.map(function(p){return j(p)*2})})}),i=rs(e,a,t),o=dn(i,0),s=dn(i,1),l=0,c=0,u=o.isVerticalBound||s.isVerticalBound,f=o.isHorizontalBound||s.isHorizontalBound;return(u||f)&&(n=M(jf({datas:t,distX:-o.offset[0],distY:-s.offset[1]}),2),l=n[0],c=n[1]),{vertical:{isBound:u,offset:l},horizontal:{isBound:f,offset:c}}}function md(e,r){var t=[],n=e[0],a=e[1];return n&&a?t.push([[0,a*2],e,[-n,a]],[[n*2,0],e,[n,-a]]):n?(t.push([[n*2,0],[n,1],[n,-1]]),r&&t.push([[0,-1],[n,-1],[-n,-1]],[[0,1],[n,1],[-n,1]])):a?(t.push([[0,a*2],[1,a],[-1,a]]),r&&t.push([[-1,0],[-1,a],[-1,-a]],[[1,0],[1,a],[1,-a]])):t.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),t}function Ia(e,r,t,n){var a=e.state,i=a.allMatrix,o=a.is3d,s=Ue(i,100,100,o?4:3),l=Pt(s,[0,0]);return md(t,n).map(function(c){var u=M(c,3),f=u[0],d=u[1],p=u[2],v=[Pt(s,d),Pt(s,p)],h=fd(v),g=ts(l,v),m=g.vertical,x=g.horizontal,b=Ta(l,v)<=0;return{multiple:f,centerSign:b,verticalSign:m,horizontalSign:x,lineConstants:h,line:[Pt(r,d),Pt(r,p)]}})}function ci(e,r,t,n){var a=n?e.map(function(i){return Hr(i,n)}):e;return[[a[0],a[1]],[a[1],a[3]],[a[3],a[2]],[a[2],a[0]]].some(function(i){var o=Ta(t,i)<=0;return!es(r,i,o)})}function xd(e){var r=M(e,2),t=r[0],n=r[1],a=n[0]-t[0],i=n[1]-t[1];if(!a)return j(t[0]);if(!i)return j(t[1]);var o=i/a;return j((-o*t[0]+t[1])/Math.sqrt(Math.pow(o,2)+1))}function yd(e){var r=M(e,2),t=r[0],n=r[1],a=n[0]-t[0],i=n[1]-t[1];if(!a)return[t[0],0];if(!i)return[0,t[1]];var o=i/a,s=-o*t[0]+t[1];return[-s/(o+1/o),s/(o*o+1)]}function bd(e,r,t,n,a){var i=e.props.innerBounds,o=a*Math.PI/180;if(!i)return[];var s=i.left,l=i.top,c=i.width,u=i.height,f=s-n[0],d=s+c-n[0],p=l-n[1],v=l+u-n[1],h=[[f,p],[d,p],[f,v],[d,v]],g=Pt(t,[0,0]);if(!ci(t,h,g,0))return[];var m=[],x=h.map(function(b){return[Qt(b),kt([0,0],b)]});return[[t[0],t[1]],[t[1],t[3]],[t[3],t[2]],[t[2],t[0]]].forEach(function(b){var S=kt([0,0],yd(b)),D=xd(b);m.push.apply(m,W([],M(x.filter(function(y){var E=M(y,1),w=E[0];return w&&D<=w}).map(function(y){var E=M(y,2),w=E[0],T=E[1],O=Math.acos(w?D/w:0),P=T+O,z=T-O;return[o+P-S,o+z-S]}).reduce(function(y,E){return y.push.apply(y,W([],M(E),!1)),y},[]).filter(function(y){return!ci(r,h,g,y)}).map(function(y){return mt(y*180/Math.PI,Vt)})),!1))}),m}function Cd(e){var r=e.props.innerBounds,t=Qe();if(!r)return{boundMap:t,vertical:[],horizontal:[]};var n=e.getRect(),a=n.pos1,i=n.pos2,o=n.pos3,s=n.pos4,l=[a,i,o,s],c=Pt(l,[0,0]),u=r.left,f=r.top,d=r.width,p=r.height,v=[[u,f],[u,f+p]],h=[[u,f],[u+d,f]],g=[[u+d,f],[u+d,f+p]],m=[[u,f+p],[u+d,f+p]],x=Ia(e,l,[0,0],!1),b=[],S=[];return x.forEach(function(D){var y=D.line,E=D.lineConstants,w=ts(c,y),T=w.horizontal,O=w.vertical,P=Ee(y,E,h,O,1,!0),z=Ee(y,E,m,O,1,!0),I=Ee(y,E,v,T,1,!0),k=Ee(y,E,g,T,1,!0);P.isBound&&!t.top&&(b.push(f),t.top=!0),z.isBound&&!t.bottom&&(b.push(f+p),t.bottom=!0),I.isBound&&!t.left&&(S.push(u),t.left=!0),k.isBound&&!t.right&&(S.push(u+d),t.right=!0)}),{boundMap:t,horizontal:b,vertical:S}}function Sd(e,r,t,n){var a=r[0]-e[0],i=r[1]-e[1];if(j(a)<me&&(a=0),j(i)<me&&(i=0),!a)return n?[0,0]:[0,t];if(!i)return n?[t,0]:[0,0];var o=i/a,s=e[1]-o*e[0];if(n){var l=o*(r[0]+t)+s;return[t,l-r[1]]}else{var c=(r[1]+t-s)/o;return[c-r[0],t]}}function Kn(e,r,t,n,a){var i=Sd(e,r,t,n);if(!i)return{isOutside:!1,offset:[0,0]};var o=He(e,r),s=He(i,e),l=He(i,r),c=s>o||l>o,u=M(ve({datas:a,distX:i[0],distY:i[1]}),2),f=u[0],d=u[1];return{offset:[f,d],isOutside:c}}function pn(e,r){return e.isBound?e.offset:r.isSnap?$n(r).offset:0}function Dd(e,r,t,n,a){var i=M(r,2),o=i[0],s=i[1],l=M(t,2),c=l[0],u=l[1],f=M(n,2),d=f[0],p=f[1],v=M(a,2),h=v[0],g=v[1],m=-h,x=-g;if(e&&o&&s){m=0,x=0;var b=[];if(c&&u?b.push([0,g],[h,0]):c?b.push([h,0]):u?b.push([0,g]):d&&p?b.push([0,g],[h,0]):d?b.push([h,0]):p&&b.push([0,g]),b.length){b.sort(function(E,w){return Qt(it([o,s],E))-Qt(it([o,s],w))});var S=b[0];if(S[0]&&j(o)>me)m=-S[0],x=s*j(o+m)/j(o)-s;else if(S[1]&&j(s)>me){var D=s;x=-S[1],m=o*j(s+x)/j(D)-o}if(e&&u&&c)if(j(m)>me&&j(m)<j(h)){var y=j(h)/j(m);m*=y,x*=y}else if(j(x)>me&&j(x)<j(g)){var y=j(g)/j(x);m*=y,x*=y}else m=lr(-h,m),x=lr(-g,x)}}else m=o||c?-h:0,x=s||u?-g:0;return[m,x]}function Ed(e,r,t,n,a,i){if(!vr(e,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var o=Ba(i.absolutePoses,[r,t]),s=Zt(o),l=s.left,c=s.right,u=s.top,f=s.bottom,d={horizontal:o.map(function(k){return k[1]}),vertical:o.map(function(k){return k[0]})},p=Ma(e.props.snapDirections),v=Oa(p,{left:l,right:c,top:u,bottom:f,center:(l+c)/2,middle:(u+f)/2}),h=Mn(e,a,v,d),g=h.vertical,m=h.horizontal,x=gd(e,o,i),b=x.vertical,S=x.horizontal,D=g.isSnap,y=m.isSnap,E=g.isBound||b.isBound,w=m.isBound||S.isBound,T=lr(g.offset,b.offset),O=lr(m.offset,S.offset),P=M(Dd(n,[r,t],[E,w],[D,y],[T,O]),2),z=P[0],I=P[1];return[{isBound:E,isSnap:D,offset:z},{isBound:w,isSnap:y,offset:I}]}function Mn(e,r,t,n){n===void 0&&(n=t);var a=Ra(wn(e),n.vertical,n.horizontal),i=a.horizontal,o=a.vertical,s=r?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:Rn(e,t.vertical,t.horizontal),l=s.horizontal,c=s.vertical,u=pn(i[0],l),f=pn(o[0],c),d=j(u),p=j(f);return{horizontal:{isBound:i[0].isBound,isSnap:l.isSnap,snapIndex:l.index,offset:u,dist:d,bounds:i,snap:l},vertical:{isBound:o[0].isBound,isSnap:c.isSnap,snapIndex:c.index,offset:f,dist:p,bounds:o,snap:c}}}function ui(e,r,t,n,a){var i=Ra(r,t,n),o=i.horizontal,s=i.vertical,l=Zo(e,t,n,[],[],a),c=l.horizontal,u=l.vertical,f=pn(o[0],c),d=pn(s[0],u),p=j(f),v=j(d);return{horizontal:{isBound:o[0].isBound,isSnap:c.isSnap,snapIndex:c.index,offset:f,dist:p,bounds:o,snap:c},vertical:{isBound:s[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:d,dist:v,bounds:s,snap:u}}}function wd(e,r,t,n){var a=kt(e,r)/Math.PI*180,i=t.vertical,o=i.isBound,s=i.isSnap,l=i.dist,c=t.horizontal,u=c.isBound,f=c.isSnap,d=c.dist,p=a%180,v=p<3||p>177,h=p>87&&p<93;return d<l&&(o||s&&!h&&(!n||!v))?"vertical":u||f&&!v&&(!n||!h)?"horizontal":""}function Rd(e,r,t,n,a,i){return t.map(function(o){var s=M(o,2),l=s[0],c=s[1],u=Pt(r,l),f=Pt(r,c),d=n?Md(e,u,f,a):Mn(e,a,{vertical:[f[0]],horizontal:[f[1]]}),p=d.horizontal,v=p.offset,h=p.isBound,g=p.isSnap,m=d.vertical,x=m.offset,b=m.isBound,S=m.isSnap,D=it(c,l);if(!x&&!v)return{isBound:b||h,isSnap:S||g,sign:D,offset:[0,0]};var y=wd(u,f,d,n);if(!y)return{sign:D,isBound:!1,isSnap:!1,offset:[0,0]};var E=y==="vertical",w=[0,0];return!n&&j(c[0])===1&&j(c[1])===1&&l[0]!==c[0]&&l[1]!==c[1]?w=ve({datas:i,distX:-x,distY:-v}):w=Kn(u,f,-(E?x:v),E,i).offset,w=w.map(function(T,O){return T*(D[O]?2/D[O]:0)}),{sign:D,isBound:E?b:h,isSnap:E?S:g,offset:w}})}function fi(e,r){return e.isBound?e.offset:r.isSnap?r.offset:0}function Md(e,r,t,n){var a=ad(e,r,t),i=a.horizontal,o=a.vertical,s=n?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:dd(e,r,t),l=s.horizontal,c=s.vertical,u=fi(i,l),f=fi(o,c),d=j(u),p=j(f);return{horizontal:{isBound:i.isBound,isSnap:l.isSnap,offset:u,dist:d},vertical:{isBound:o.isBound,isSnap:c.isSnap,offset:f,dist:p}}}function Od(e,r,t,n,a){var i=[-t[0],-t[1]],o=e.state,s=o.width,l=o.height,c=e.props.bounds,u=1/0,f=1/0;if(c){var d=[[t[0],-t[1]],[-t[0],t[1]]],p=c.left,v=p===void 0?-1/0:p,h=c.top,g=h===void 0?-1/0:h,m=c.right,x=m===void 0?1/0:m,b=c.bottom,S=b===void 0?1/0:b;d.forEach(function(D){var y=D[0]!==i[0],E=D[1]!==i[1],w=Pt(r,D),T=kt(n,w)*360/Math.PI;if(E){var O=w.slice();(j(T-360)<2||j(T-180)<2)&&(O[1]=n[1]);var P=Kn(n,O,(n[1]<w[1]?S:g)-w[1],!1,a),z=M(P.offset,2),I=z[1],k=P.isOutside;isNaN(I)||(f=l+(k?1:-1)*j(I))}if(y){var O=w.slice();(j(T-90)<2||j(T-270)<2)&&(O[0]=n[0]);var B=Kn(n,O,(n[0]<w[0]?x:v)-w[0],!0,a),V=M(B.offset,1),H=V[0],G=B.isOutside;isNaN(H)||(u=s+(G?1:-1)*j(H))}})}return{maxWidth:u,maxHeight:f}}var jt={name:"draggable",props:["draggable","throttleDrag","throttleDragRotate","hideThrottleDragRotateLine","startDragRotate","edgeDraggable"],events:["dragStart","drag","dragEnd","dragGroupStart","dragGroup","dragGroupEnd"],requestStyle:function(){return["left","top","right","bottom"]},requestChildStyle:function(){return["left","top","right","bottom"]},render:function(e,r){var t=e.props,n=t.hideThrottleDragRotateLine,a=t.throttleDragRotate,i=t.zoom,o=e.getState(),s=o.dragInfo,l=o.beforeOrigin;if(n||!a||!s)return[];var c=s.dist;if(!c[0]&&!c[1])return[];var u=Qt(c),f=kt(c,[0,0]);return[r.createElement("div",{className:nt("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(u,"px"),transform:"translate(".concat(l[0],"px, ").concat(l[1],"px) rotate(").concat(f,"rad) scaleY(").concat(i,")")}})]},dragStart:function(e,r){var t=r.datas,n=r.parentEvent,a=r.parentGesto,i=e.state,o=i.gestos,s=i.style;if(o.draggable)return!1;o.draggable=a||e.targetGesto,t.datas={},t.left=parseFloat(s.left||"")||0,t.top=parseFloat(s.top||"")||0,t.bottom=parseFloat(s.bottom||"")||0,t.right=parseFloat(s.right||"")||0,t.startValue=[0,0],Xe(e,r),En(e,r,"translate"),Yd(e,t),t.prevDist=[0,0],t.prevBeforeDist=[0,0],t.isDrag=!1,t.deltaOffset=[0,0];var l=dt(e,r,R({set:function(u){t.startValue=u}},Dn(e,r))),c=n||K(e,"onDragStart",l);return c!==!1?(t.isDrag=!0,e.state.dragInfo={startRect:e.getRect(),dist:[0,0]}):(o.draggable=null,t.isPinch=!1),t.isDrag?l:!1},drag:function(e,r){if(r){Cn(e,r,"translate");var t=r.datas,n=r.parentEvent,a=r.parentFlag,i=r.isPinch,o=r.deltaOffset,s=r.useSnap,l=r.isRequest,c=r.distX,u=r.distY,f=t.isDrag,d=t.prevDist,p=t.prevBeforeDist,v=t.startValue;if(f){o&&(c+=o[0],u+=o[1]);var h=e.props,g=h.parentMoveable,m=n?0:h.throttleDrag||0,x=n?0:h.throttleDragRotate||0,b=0,S=!1,D=!1,y=!1,E=!1;if(!n&&x>0&&(c||u)){var w=h.startDragRotate||0,T=mt(w+kt([0,0],[c,u])*180/Math.PI,x)-w,O=u*Math.abs(Math.cos((T-90)/180*Math.PI)),P=c*Math.abs(Math.cos(T/180*Math.PI)),z=Qt([P,O]);b=T*Math.PI/180,c=z*Math.cos(b),u=z*Math.sin(b)}if(!i&&!n&&!a){var I=M(Ed(e,c,u,x,!s&&l||o,t),2),k=I[0],B=I[1];S=k.isSnap,D=k.isBound,y=B.isSnap,E=B.isBound;var V=k.offset,H=B.offset;c+=V,u+=H}var G=xt(Ho({datas:t,distX:c,distY:u}),v),L=xt(Af({datas:t,distX:c,distY:u}),v);Xa(L,Vt),Xa(G,Vt),x||(!S&&!D&&(L[0]=mt(L[0],m),G[0]=mt(G[0],m)),!y&&!E&&(L[1]=mt(L[1],m),G[1]=mt(G[1],m)));var F=it(G,v),A=it(L,v),Z=it(A,d),J=it(F,p);t.prevDist=A,t.prevBeforeDist=F,t.passDelta=Z,t.passDist=A;var Y=t.left+F[0],X=t.top+F[1],q=t.right-F[0],$=t.bottom-F[1],et=Sn(t,"translate(".concat(L[0],"px, ").concat(L[1],"px)"),"translate(".concat(A[0],"px, ").concat(A[1],"px)"));if(Ea(r,et),e.state.dragInfo.dist=n?[0,0]:A,!(!n&&!g&&Z.every(function(gt){return!gt})&&J.some(function(gt){return!gt}))){var ot=e.state,at=ot.width,Q=ot.height,tt=dt(e,r,R({transform:et,dist:A,delta:Z,translate:L,beforeDist:F,beforeDelta:J,beforeTranslate:G,left:Y,top:X,right:q,bottom:$,width:at,height:Q,isPinch:i},Ht({transform:et},r)));return!n&&K(e,"onDrag",tt),tt}}}},dragAfter:function(e,r){var t=r.datas,n=t.deltaOffset;return n[0]||n[1]?(t.deltaOffset=[0,0],this.drag(e,R(R({},r),{deltaOffset:n}))):!1},dragEnd:function(e,r){var t=r.parentEvent,n=r.datas;if(e.state.dragInfo=null,!!n.isDrag){n.isDrag=!1;var a=Xt(e,r,{});return!t&&K(e,"onDragEnd",a),a}},dragGroupStart:function(e,r){var t=r.datas,n=r.clientX,a=r.clientY,i=this.dragStart(e,r);if(!i)return!1;var o=Pn(e,this,"dragStart",[n||0,a||0],r,!1,"draggable"),s=R(R({},i),{targets:e.props.targets,events:o}),l=K(e,"onDragGroupStart",s);return t.isDrag=l!==!1,t.isDrag?i:!1},dragGroup:function(e,r){var t=r.datas;if(t.isDrag){var n=this.drag(e,r),a=r.datas.passDelta,i=Pn(e,this,"drag",a,r,!1,"draggable");if(n){var o=R({targets:e.props.targets,events:i},n);return K(e,"onDragGroup",o),o}}},dragGroupEnd:function(e,r){var t=r.isDrag,n=r.datas;if(n.isDrag){this.dragEnd(e,r);var a=Pn(e,this,"dragEnd",[0,0],r,!1,"draggable");return K(e,"onDragGroupEnd",Xt(e,r,{targets:e.props.targets,events:a})),t}},request:function(e){var r={},t=e.getRect(),n=0,a=0,i=!1;return{isControl:!1,requestStart:function(o){return i=o.useSnap,{datas:r,useSnap:i}},request:function(o){return"x"in o?n=o.x-t.left:"deltaX"in o&&(n+=o.deltaX),"y"in o?a=o.y-t.top:"deltaY"in o&&(a+=o.deltaY),{datas:r,distX:n,distY:a,useSnap:i}},requestEnd:function(){return{datas:r,isDrag:!0,useSnap:i}}}},unset:function(e){e.state.gestos.draggable=null,e.state.dragInfo=null}};function ns(e,r){var t=Pt(e,r),n=[0,0];return{fixedPosition:t,fixedDirection:r,fixedOffset:n}}function Td(e,r){var t=e.allMatrix,n=e.is3d,a=e.width,i=e.height,o=n?4:3,s=[a/2*(1+r[0]),i/2*(1+r[1])],l=Dt(t,s,o),c=[0,0];return{fixedPosition:l,fixedDirection:r,fixedOffset:c}}function as(e,r){var t=e.allMatrix,n=e.is3d,a=e.width,i=e.height,o=n?4:3,s=Xf(r,a,i),l=Dt(t,r,o),c=[a?0:r[0],i?0:r[1]];return{fixedPosition:l,fixedDirection:s,fixedOffset:c}}var di=_a("resizable"),Jn={name:"resizable",ableGroup:"size",canPinch:!0,props:["resizable","throttleResize","renderDirections","displayAroundControls","keepRatio","resizeFormat","keepRatioFinally","edge","checkResizableError"],events:["resizeStart","beforeResize","resize","resizeEnd","resizeGroupStart","beforeResizeGroup","resizeGroup","resizeGroupEnd"],render:$o("resizable"),dragControlCondition:di,viewClassName:La("resizable"),dragControlStart:function(e,r){var t,n=r.inputEvent,a=r.isPinch,i=r.isGroup,o=r.parentDirection,s=r.parentGesto,l=r.datas,c=r.parentFixedDirection,u=r.parentEvent,f=ys(o,a,n,l),d=e.state,p=d.target,v=d.width,h=d.height,g=d.gestos;if(!f||!p||g.resizable)return!1;g.resizable=s||e.controlGesto,!a&&Xe(e,r),l.datas={},l.direction=f,l.startOffsetWidth=v,l.startOffsetHeight=h,l.prevWidth=0,l.prevHeight=0,l.minSize=[0,0],l.startWidth=d.inlineCSSWidth||d.cssWidth,l.startHeight=d.inlineCSSHeight||d.cssHeight,l.maxSize=[1/0,1/0],i||(l.minSize=[d.minOffsetWidth,d.minOffsetHeight],l.maxSize=[d.maxOffsetWidth,d.maxOffsetHeight]);var m=e.props.transformOrigin||"% %";l.transformOrigin=m&&Ye(m)?m.split(" "):m,l.startOffsetMatrix=d.offsetMatrix,l.startTransformOrigin=d.transformOrigin,l.isWidth=(t=r==null?void 0:r.parentIsWidth)!==null&&t!==void 0?t:!f[0]&&!f[1]||f[0]||!f[1];function x(T){l.ratio=T&&isFinite(T)?T:0}l.startPositions=te(e.state);function b(T){var O=ns(l.startPositions,T);l.fixedDirection=O.fixedDirection,l.fixedPosition=O.fixedPosition,l.fixedOffset=O.fixedOffset}function S(T){var O=as(e.state,T);l.fixedDirection=O.fixedDirection,l.fixedPosition=O.fixedPosition,l.fixedOffset=O.fixedOffset}function D(T){l.minSize=[Ct("".concat(T[0]),0)||0,Ct("".concat(T[1]),0)||0]}function y(T){var O=[T[0]||1/0,T[1]||1/0];(!Br(O[0])||isFinite(O[0]))&&(O[0]=Ct("".concat(O[0]),0)||1/0),(!Br(O[1])||isFinite(O[1]))&&(O[1]=Ct("".concat(O[1]),0)||1/0),l.maxSize=O}x(v/h),b(c||[-f[0],-f[1]]),l.setFixedDirection=b,l.setFixedPosition=S,l.setMin=D,l.setMax=y;var E=dt(e,r,{direction:f,startRatio:l.ratio,set:function(T){var O=M(T,2),P=O[0],z=O[1];l.startWidth=P,l.startHeight=z},setMin:D,setMax:y,setRatio:x,setFixedDirection:b,setFixedPosition:S,setOrigin:function(T){l.transformOrigin=T},dragStart:jt.dragStart(e,new or().dragStart([0,0],r))}),w=u||K(e,"onResizeStart",E);return l.startFixedDirection=l.fixedDirection,l.startFixedPosition=l.fixedPosition,w!==!1&&(l.isResize=!0,e.state.snapRenderInfo={request:r.isRequest,direction:f}),l.isResize?E:!1},dragControl:function(e,r){var t,n=r.datas,a=r.parentFlag,i=r.isPinch,o=r.parentKeepRatio,s=r.dragClient,l=r.parentDist,c=r.useSnap,u=r.isRequest,f=r.isGroup,d=r.parentEvent,p=r.resolveMatrix,v=n.isResize,h=n.transformOrigin,g=n.startWidth,m=n.startHeight,x=n.prevWidth,b=n.prevHeight,S=n.minSize,D=n.maxSize,y=n.ratio,E=n.startOffsetWidth,w=n.startOffsetHeight,T=n.isWidth;if(!v)return;if(p){var O=e.state.is3d,P=n.startOffsetMatrix,z=n.startTransformOrigin,I=O?4:3,k=Pr(un(r)),B=Math.sqrt(k.length);I!==B&&(k=pe(k,B,I));var V=Yr(P,k,z,I),H=Ue(V,E,w,I);n.startPositions=H,n.nextTargetMatrix=k,n.nextAllMatrix=V}var G=qe(e.props,"resizable"),L=G.resizeFormat,F=G.throttleResize,A=F===void 0?a?0:1:F,Z=G.parentMoveable,J=G.keepRatioFinally,Y=n.direction,X=Y,q=0,$=0;!Y[0]&&!Y[1]&&(X=[1,1]);var et=y&&(o??G.keepRatio)||!1;function ot(){var St=n.fixedDirection,Rt=Rs(X,et,n,r);q=Rt.distWidth,$=Rt.distHeight;var At=X[0]-St[0]||et?Math.max(E+q,Vt):E,Wt=X[1]-St[1]||et?Math.max(w+$,Vt):w;return et&&E&&w&&(T?Wt=At/y:At=Wt*y),[At,Wt]}var at=M(ot(),2),Q=at[0],tt=at[1];d||(n.setFixedDirection(n.fixedDirection),K(e,"onBeforeResize",dt(e,r,{startFixedDirection:n.startFixedDirection,startFixedPosition:n.startFixedPosition,setFixedDirection:function(St){var Rt;return n.setFixedDirection(St),Rt=M(ot(),2),Q=Rt[0],tt=Rt[1],[Q,tt]},setFixedPosition:function(St){var Rt;return n.setFixedPosition(St),Rt=M(ot(),2),Q=Rt[0],tt=Rt[1],[Q,tt]},boundingWidth:Q,boundingHeight:tt,setSize:function(St){var Rt;Rt=M(St,2),Q=Rt[0],tt=Rt[1]}},!0)));var gt=s;s||(!a&&i?gt=Jf(e,[0,0]):gt=n.fixedPosition);var ct=[0,0];i||(ct=Wd(e,Q,tt,Y,gt,!c&&u,n)),l&&(!l[0]&&(ct[0]=0),!l[1]&&(ct[1]=0));function ut(){var St;L&&(St=M(L([Q,tt]),2),Q=St[0],tt=St[1]),Q=mt(Q,A),tt=mt(tt,A)}if(et){X[0]&&X[1]&&ct[0]&&ct[1]&&(j(ct[0])>j(ct[1])?ct[1]=0:ct[0]=0);var st=!ct[0]&&!ct[1];st&&ut(),X[0]&&!X[1]||ct[0]&&!ct[1]||st&&T?(Q+=ct[0],tt=Q/y):(!X[0]&&X[1]||!ct[0]&&ct[1]||st&&!T)&&(tt+=ct[1],Q=tt*y)}else Q+=ct[0],tt+=ct[1],Q=Math.max(0,Q),tt=Math.max(0,tt);t=M(ji([Q,tt],S,D,et?y:!1),2),Q=t[0],tt=t[1],ut(),et&&(f||J)&&(T?tt=Q/y:Q=tt*y),q=Q-E,$=tt-w;var bt=[q-x,$-b];n.prevWidth=q,n.prevHeight=$;var vt=Kf(e,Q,tt,gt,h,n);if(!(!Z&&bt.every(function(St){return!St})&&vt.every(function(St){return!St}))){var lt=jt.drag(e,qr(r,e.state,vt,!!i,!1,"draggable")),ht=lt.transform,Ot=g+q,Lt=m+$,Tt=dt(e,r,R({width:Ot,height:Lt,offsetWidth:Math.round(Q),offsetHeight:Math.round(tt),startRatio:y,boundingWidth:Q,boundingHeight:tt,direction:Y,dist:[q,$],delta:bt,isPinch:!!i,drag:lt},Cs({style:{width:"".concat(Ot,"px"),height:"".concat(Lt,"px")},transform:ht},lt,r)));return!d&&K(e,"onResize",Tt),Tt}},dragControlAfter:function(e,r){var t=r.datas,n=t.isResize,a=t.startOffsetWidth,i=t.startOffsetHeight,o=t.prevWidth,s=t.prevHeight;if(!(!n||e.props.checkResizableError===!1)){var l=e.state,c=l.width,u=l.height,f=c-(a+o),d=u-(i+s),p=j(f)>3,v=j(d)>3;if(p&&(t.startWidth+=f,t.startOffsetWidth+=f,t.prevWidth+=f),v&&(t.startHeight+=d,t.startOffsetHeight+=d,t.prevHeight+=d),p||v)return this.dragControl(e,r)}},dragControlEnd:function(e,r){var t=r.datas,n=r.parentEvent;if(t.isResize){t.isResize=!1;var a=Xt(e,r,{});return!n&&K(e,"onResizeEnd",a),a}},dragGroupControlCondition:di,dragGroupControlStart:function(e,r){var t=r.datas,n=this.dragControlStart(e,R(R({},r),{isGroup:!0}));if(!n)return!1;var a=ne(e,"resizable",r),i=t.startOffsetWidth,o=t.startOffsetHeight;function s(){var p=t.minSize;a.forEach(function(v){var h=v.datas,g=h.minSize,m=h.startOffsetWidth,x=h.startOffsetHeight,b=i*(m?g[0]/m:0),S=o*(x?g[1]/x:0);p[0]=Math.max(p[0],b),p[1]=Math.max(p[1],S)})}function l(){var p=t.maxSize;a.forEach(function(v){var h=v.datas,g=h.maxSize,m=h.startOffsetWidth,x=h.startOffsetHeight,b=i*(m?g[0]/m:0),S=o*(x?g[1]/x:0);p[0]=Math.min(p[0],b),p[1]=Math.min(p[1],S)})}var c=xe(e,this,"dragControlStart",r,function(p,v){return fn(e,p,t,v)});s(),l();var u=function(p){n.setFixedDirection(p),c.forEach(function(v,h){v.setFixedDirection(p),fn(e,v.moveable,t,a[h])})};t.setFixedDirection=u;var f=R(R({},n),{targets:e.props.targets,events:c.map(function(p){return R(R({},p),{setMin:function(v){p.setMin(v),s()},setMax:function(v){p.setMax(v),l()}})}),setFixedDirection:u,setMin:function(p){n.setMin(p),s()},setMax:function(p){n.setMax(p),l()}}),d=K(e,"onResizeGroupStart",f);return t.isResize=d!==!1,t.isResize?n:!1},dragGroupControl:function(e,r){var t=r.datas;if(t.isResize){var n=qe(e.props,"resizable");Tn(e,"onBeforeResize",function(p){K(e,"onBeforeResizeGroup",dt(e,r,R(R({},p),{targets:n.targets}),!0))});var a=this.dragControl(e,R(R({},r),{isGroup:!0}));if(a){var i=a.boundingWidth,o=a.boundingHeight,s=a.dist,l=n.keepRatio,c=[i/(i-s[0]),o/(o-s[1])],u=t.fixedPosition,f=xe(e,this,"dragControl",r,function(p,v){var h=M(Ft(fa(e.rotation/180*Math.PI,3),[v.datas.originalX*c[0],v.datas.originalY*c[1],1],3),2),g=h[0],m=h[1];return R(R({},v),{parentDist:null,parentScale:c,dragClient:xt(u,[g,m]),parentKeepRatio:l})}),d=R({targets:n.targets,events:f},a);return K(e,"onResizeGroup",d),d}}},dragGroupControlEnd:function(e,r){var t=r.isDrag,n=r.datas;if(n.isResize){this.dragControlEnd(e,r);var a=xe(e,this,"dragControlEnd",r),i=Xt(e,r,{targets:e.props.targets,events:a});return K(e,"onResizeGroupEnd",i),t}},request:function(e){var r={},t=0,n=0,a=!1,i=e.getRect();return{isControl:!0,requestStart:function(o){var s;return a=o.useSnap,{datas:r,parentDirection:o.direction||[1,1],parentIsWidth:(s=o==null?void 0:o.horizontal)!==null&&s!==void 0?s:!0,useSnap:a}},request:function(o){return"offsetWidth"in o?t=o.offsetWidth-i.offsetWidth:"deltaWidth"in o&&(t+=o.deltaWidth),"offsetHeight"in o?n=o.offsetHeight-i.offsetHeight:"deltaHeight"in o&&(n+=o.deltaHeight),{datas:r,parentDist:[t,n],parentKeepRatio:o.keepRatio,useSnap:a}},requestEnd:function(){return{datas:r,isDrag:!0,useSnap:a}}}},unset:function(e){e.state.gestos.resizable=null}};function Bn(e,r,t,n,a){var i=e.props.groupable,o=e.state,s=o.is3d?4:3,l=r.origin,c=Dt(e.state.rootMatrix,it([l[0],l[1]],i?[0,0]:[o.left,o.top]),s),u=xt([a.left,a.top],c);r.startAbsoluteOrigin=u,r.prevDeg=kt(u,[t,n])/Math.PI*180,r.defaultDeg=r.prevDeg,r.prevSnapDeg=0,r.loop=0,r.startDist=He(u,[t,n])}function sn(e,r,t){var n=t.defaultDeg,a=t.prevDeg,i=a%360,o=Math.floor(a/360);i<0&&(i+=360),i>e&&i>270&&e<90?++o:i<e&&i<90&&e>270&&--o;var s=r*(o*360+e-n);return t.prevDeg=n+s,s}function kn(e,r,t,n){return sn(kt(n.startAbsoluteOrigin,[e,r])/Math.PI*180,t,n)}function Ln(e,r,t,n,a,i){var o=e.props.throttleRotate,s=o===void 0?0:o,l=t.prevSnapDeg,c=0,u=!1;if(i){var f=Fd(e,r,n,a+n);u=f.isSnap,c=a+f.dist}u||(c=mt(a+n,s));var d=c-a;return t.prevSnapDeg=d,[d-l,d,c]}function is(e,r,t){var n=M(r,4),a=n[0],i=n[1],o=n[2],s=n[3];if(e==="none")return[];if(Gt(e))return e.map(function(g){return is(g,[a,i,o,s],t)[0]});var l=M((e||"top").split("-"),2),c=l[0],u=l[1],f=[a,i];c==="left"?f=[o,a]:c==="right"?f=[i,s]:c==="bottom"&&(f=[s,o]);var d=[(f[0][0]+f[1][0])/2,(f[0][1]+f[1][1])/2],p=ms(f,t);if(u){var v=u==="top"||u==="left",h=c==="bottom"||c==="left";d=f[v&&!h||!v&&h?0:1]}return[[d,p]]}function Zn(e,r){if(r.isRequest)return r.requestAble==="rotatable";var t=r.inputEvent.target;if(It(t,nt("rotation-control"))||e.props.rotateAroundControls&&It(t,nt("around-control"))||It(t,nt("control"))&&It(t,nt("rotatable")))return!0;var n=e.props.rotationTarget;return n?Na(n,!0).some(function(a){return a?t===a||t.contains(a):!1}):!1}var Id=`.rotation {
position: absolute;
height: 40px;
width: 1px;
transform-origin: 50% 100%;
height: calc(40px * var(--zoom));
top: auto;
left: 0;
bottom: 100%;
will-change: transform;
}
.rotation .rotation-line {
display: block;
width: 100%;
height: 100%;
transform-origin: 50% 50%;
}
.rotation .rotation-control {
border-color: #4af;
border-color: var(--moveable-color);
background:#fff;
cursor: alias;
}
:global .view-rotation-dragging, .rotatable.direction.control {
cursor: alias;
}
.rotatable.direction.control.move {
cursor: move;
}
`,zd={name:"rotatable",canPinch:!0,props:["rotatable","rotationPosition","throttleRotate","renderDirections","rotationTarget","rotateAroundControls","edge","resolveAblesWithRotatable","displayAroundControls"],events:["rotateStart","beforeRotate","rotate","rotateEnd","rotateGroupStart","beforeRotateGroup","rotateGroup","rotateGroupEnd"],css:[Id],viewClassName:function(e){return e.isDragging("rotatable")?nt("view-rotation-dragging"):""},render:function(e,r){var t=qe(e.props,"rotatable"),n=t.rotatable,a=t.rotationPosition,i=t.zoom,o=t.renderDirections,s=t.rotateAroundControls,l=t.resolveAblesWithRotatable,c=e.getState(),u=c.renderPoses,f=c.direction;if(!n)return null;var d=is(a,u,f),p=[];if(d.forEach(function(m,x){var b=M(m,2),S=b[0],D=b[1];p.push(r.createElement("div",{key:"rotation".concat(x),className:nt("rotation"),style:{transform:"translate(-50%) translate(".concat(S[0],"px, ").concat(S[1],"px) rotate(").concat(D,"rad)")}},r.createElement("div",{className:nt("line rotation-line"),style:{transform:"scaleX(".concat(i,")")}}),r.createElement("div",{className:nt("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(i,")")}})))}),o){var v=fr(l||{}),h={};v.forEach(function(m){l[m].forEach(function(x){h[x]=m})});var g=[];Gt(o)&&(g=o.map(function(m){var x=h[m];return{data:x?{resolve:x}:{},classNames:x?["move"]:[],dir:m}})),p.push.apply(p,W([],M(Yo(e,"rotatable",g,r)),!1))}return s&&p.push.apply(p,W([],M(Jo(e,r)),!1)),p},dragControlCondition:Zn,dragControlStart:function(e,r){var t,n,a=r.datas,i=r.clientX,o=r.clientY,s=r.parentRotate,l=r.parentFlag,c=r.isPinch,u=r.isRequest,f=e.state,d=f.target,p=f.left,v=f.top,h=f.direction,g=f.beforeDirection,m=f.targetTransform,x=f.moveableClientRect,b=f.offsetMatrix,S=f.targetMatrix,D=f.allMatrix,y=f.width,E=f.height;if(!u&&!d)return!1;var w=e.getRect();a.rect=w,a.transform=m,a.left=p,a.top=v;var T=function(X){var q=as(e.state,X);a.fixedDirection=q.fixedDirection,a.fixedOffset=q.fixedOffset,a.fixedPosition=q.fixedPosition,A&&A.setFixedPosition(X)},O=function(X){var q=Td(e.state,X);a.fixedDirection=q.fixedDirection,a.fixedOffset=q.fixedOffset,a.fixedPosition=q.fixedPosition,A&&A.setFixedDirection(X)},P=i,z=o;if(u||c||l){var I=s||0;a.beforeInfo={origin:w.beforeOrigin,prevDeg:I,defaultDeg:I,prevSnapDeg:0,startDist:0},a.afterInfo=R(R({},a.beforeInfo),{origin:w.origin}),a.absoluteInfo=R(R({},a.beforeInfo),{origin:w.origin,startValue:I})}else{var k=(n=r.inputEvent)===null||n===void 0?void 0:n.target;if(k){var B=k.getAttribute("data-direction")||"",V=_f[B];if(V){a.isControl=!0,a.isAroundControl=It(k,nt("around-control")),a.controlDirection=V;var H=k.getAttribute("data-resolve");H&&(a.resolveAble=H);var G=ip(f.rootMatrix,f.renderPoses,x);t=M(Pt(G,V),2),P=t[0],z=t[1]}}a.beforeInfo={origin:w.beforeOrigin},a.afterInfo={origin:w.origin},a.absoluteInfo={origin:w.origin,startValue:w.rotation};var L=T;T=function(X){var q=f.is3d?4:3,$=M(xt(Xi(S,q),X),2),et=$[0],ot=$[1],at=Ft(b,ir([et,ot],q)),Q=Ft(D,ir([X[0],X[1]],q));L(X);var tt=f.posDelta;a.beforeInfo.origin=it(at,tt),a.afterInfo.origin=it(Q,tt),a.absoluteInfo.origin=it(Q,tt),Bn(e,a.beforeInfo,P,z,x),Bn(e,a.afterInfo,P,z,x),Bn(e,a.absoluteInfo,P,z,x)},O=function(X){var q=Pt([[0,0],[y,0],[0,E],[y,E]],X);T(q)}}a.startClientX=P,a.startClientY=z,a.direction=h,a.beforeDirection=g,a.startValue=0,a.datas={},En(e,r,"rotate");var F=!1,A=!1;if(a.isControl&&a.resolveAble){var Z=a.resolveAble;Z==="resizable"&&(A=Jn.dragControlStart(e,R(R({},new or("resizable").dragStart([0,0],r)),{parentPosition:a.controlPosition,parentFixedPosition:a.fixedPosition})))}A||(F=jt.dragStart(e,new or().dragStart([0,0],r))),T(op(e));var J=dt(e,r,R(R({set:function(X){a.startValue=X*Math.PI/180},setFixedDirection:O,setFixedPosition:T},Dn(e,r)),{dragStart:F,resizeStart:A})),Y=K(e,"onRotateStart",J);return a.isRotate=Y!==!1,f.snapRenderInfo={request:r.isRequest},a.isRotate?J:!1},dragControl:function(e,r){var t,n,a,i=r.datas,o=r.clientDistX,s=r.clientDistY,l=r.parentRotate,c=r.parentFlag,u=r.isPinch,f=r.groupDelta,d=r.resolveMatrix,p=i.beforeDirection,v=i.beforeInfo,h=i.afterInfo,g=i.absoluteInfo,m=i.isRotate,x=i.startValue,b=i.rect,S=i.startClientX,D=i.startClientY;if(m){Cn(e,r,"rotate");var y=Gf(r),E=p*y,w=e.props.parentMoveable,T=0,O,P,z=0,I,k,B=0,V,H,G=180/Math.PI*x,L=g.startValue,F=!1,A=S+o,Z=D+s;if(!c&&"parentDist"in r){var J=r.parentDist;O=J,I=J,V=J}else u||c?(O=sn(l,p,v),I=sn(l,E,h),V=sn(l,E,g)):(O=kn(A,Z,p,v),I=kn(A,Z,E,h),V=kn(A,Z,E,g),F=!0);if(P=G+O,k=G+I,H=L+V,K(e,"onBeforeRotate",dt(e,r,{beforeRotation:P,rotation:k,absoluteRotation:H,setRotation:function(gt){I=gt-G,O=I,V=I}},!0)),t=M(Ln(e,b,v,O,G,F),3),T=t[0],O=t[1],P=t[2],n=M(Ln(e,b,h,I,G,F),3),z=n[0],I=n[1],k=n[2],a=M(Ln(e,b,g,V,L,F),3),B=a[0],V=a[1],H=a[2],!(!B&&!z&&!T&&!w&&!d)){var Y=Sn(i,"rotate(".concat(k,"deg)"),"rotate(".concat(I,"deg)"));d&&(i.fixedPosition=wa(e,i.targetAllTransform,i.fixedDirection,i.fixedOffset,i));var X=$f(e,I,i),q=it(xt(f||[0,0],X),i.prevInverseDist||[0,0]);i.prevInverseDist=X,i.requestValue=null;var $=Fo(e,Y,q,u,r),et=$,ot=He([A,Z],g.startAbsoluteOrigin)-g.startDist,at=void 0;if(i.resolveAble==="resizable"){var Q=Jn.dragControl(e,R(R({},qr(r,e.state,[r.deltaX,r.deltaY],!!u,!1,"resizable")),{resolveMatrix:!0,parentDistance:ot}));Q&&(at=Q,et=Cs(et,Q,r))}var tt=dt(e,r,R(R({delta:z,dist:I,rotate:k,rotation:k,beforeDist:O,beforeDelta:T,beforeRotate:P,beforeRotation:P,absoluteDist:V,absoluteDelta:B,absoluteRotate:H,absoluteRotation:H,isPinch:!!u,resize:at},$),et));return K(e,"onRotate",tt),tt}}},dragControlEnd:function(e,r){var t=r.datas;if(t.isRotate){t.isRotate=!1;var n=Xt(e,r,{});return K(e,"onRotateEnd",n),n}},dragGroupControlCondition:Zn,dragGroupControlStart:function(e,r){var t=r.datas,n=e.state,a=n.left,i=n.top,o=n.beforeOrigin,s=this.dragControlStart(e,r);if(!s)return!1;s.set(t.beforeDirection*e.rotation);var l=xe(e,this,"dragControlStart",r,function(f,d){var p=f.state,v=p.left,h=p.top,g=p.beforeOrigin,m=xt(it([v,h],[a,i]),it(g,o));return d.datas.startGroupClient=m,d.datas.groupClient=m,R(R({},d),{parentRotate:0})}),c=R(R({},s),{targets:e.props.targets,events:l}),u=K(e,"onRotateGroupStart",c);return t.isRotate=u!==!1,t.isRotate?s:!1},dragGroupControl:function(e,r){var t=r.datas;if(t.isRotate){Tn(e,"onBeforeRotate",function(c){K(e,"onBeforeRotateGroup",dt(e,r,R(R({},c),{targets:e.props.targets}),!0))});var n=this.dragControl(e,r);if(n){var a=t.beforeDirection,i=n.beforeDist,o=i/180*Math.PI,s=xe(e,this,"dragControl",r,function(c,u){var f=u.datas.startGroupClient,d=M(u.datas.groupClient,2),p=d[0],v=d[1],h=M(Hr(f,o*a),2),g=h[0],m=h[1],x=[g-p,m-v];return u.datas.groupClient=[g,m],R(R({},u),{parentRotate:i,groupDelta:x})});e.rotation=a*n.beforeRotation;var l=R({targets:e.props.targets,events:s,set:function(c){e.rotation=c},setGroupRotation:function(c){e.rotation=c}},n);return K(e,"onRotateGroup",l),l}}},dragGroupControlEnd:function(e,r){var t=r.isDrag,n=r.datas;if(n.isRotate){this.dragControlEnd(e,r);var a=xe(e,this,"dragControlEnd",r),i=Xt(e,r,{targets:e.props.targets,events:a});return K(e,"onRotateGroupEnd",i),t}},request:function(e){var r={},t=0,n=e.getRotation();return{isControl:!0,requestStart:function(){return{datas:r}},request:function(a){return"deltaRotate"in a?t+=a.deltaRotate:"rotate"in a&&(t=a.rotate-n),{datas:r,parentDist:t}},requestEnd:function(){return{datas:r,isDrag:!0}}}}};function Pd(e,r){var t,n=e.direction,a=e.classNames,i=e.size,o=e.pos,s=e.zoom,l=e.key,c=n==="horizontal",u=c?"Y":"X";return r.createElement("div",{key:l,className:a.join(" "),style:(t={},t[c?"width":"height"]="".concat(i),t.transform="translate(".concat(o[0],", ").concat(o[1],") translate").concat(u,"(-50%) scale").concat(u,"(").concat(s,")"),t)})}function za(e,r){return Pd(R(R({},e),{classNames:W([nt("line","guideline",e.direction)],M(e.classNames),!1).filter(function(t){return t}),size:e.size||"".concat(e.sizeValue,"px"),pos:e.pos||e.posValue.map(function(t){return"".concat(mt(t,.1),"px")})}),r)}function pi(e,r,t,n,a,i,o,s){var l=e.props.zoom;return t.map(function(c,u){var f=c.type,d=c.pos,p=[0,0];return p[o]=n,p[o?0:1]=-a+d,za({key:"".concat(r,"TargetGuideline").concat(u),classNames:[nt("target","bold",f)],posValue:p,sizeValue:i,zoom:l,direction:r},s)})}function vi(e,r,t,n,a,i){var o=e.props,s=o.zoom,l=o.isDisplayInnerSnapDigit,c=r==="horizontal"?Me:Oe,u=a[c.start],f=a[c.end];return t.filter(function(d){var p=d.hide,v=d.elementRect;if(p)return!1;if(l&&v){var h=v.rect;if(h[c.start]<=u&&f<=h[c.end])return!1}return!0}).map(function(d,p){var v=d.pos,h=d.size,g=d.element,m=d.className,x=[-n[0]+v[0],-n[1]+v[1]];return za({key:"".concat(r,"-default-guideline-").concat(p),classNames:g?[nt("bold"),m]:[nt("normal"),m],direction:r,posValue:x,sizeValue:h,zoom:s},i)})}function Dr(e,r,t,n,a,i,o,s){var l,c=e.props,u=c.snapDigit,f=u===void 0?0:u,d=c.isDisplaySnapDigit,p=d===void 0?!0:d,v=c.snapDistFormat,h=v===void 0?function(D,y){return D}:v,g=c.zoom,m=r==="horizontal"?"X":"Y",x=r==="vertical"?"height":"width",b=Math.abs(a),S=p?parseFloat(b.toFixed(f)):0;return s.createElement("div",{key:"".concat(r,"-").concat(t,"-guideline-").concat(n),className:nt("guideline-group",r),style:(l={left:"".concat(i[0],"px"),top:"".concat(i[1],"px")},l[x]="".concat(b,"px"),l)},za({direction:r,classNames:[nt(t),o],size:"100%",posValue:[0,0],sizeValue:b,zoom:g},s),s.createElement("div",{className:nt("size-value","gap"),style:{transform:"translate".concat(m,"(-50%) scale(").concat(g,")")}},S>0?h(S,r):""))}function Bd(e,r,t,n){var a=e==="vertical"?0:1,i=e==="vertical"?1:0,o=a?Me:Oe,s=t[o.start],l=t[o.end];return Ss(r,function(c){return c.pos[a]}).map(function(c){var u=[],f=[],d=[];return c.forEach(function(p){var v,h,g=p.element,m=p.elementRect.rect;if(m[o.end]<s)u.push(p);else if(l<m[o.start])f.push(p);else if(m[o.start]<=s&&l<=m[o.end]&&n){var x=p.pos,b={element:g,rect:R(R({},m),(v={},v[o.end]=m[o.start],v))},S={element:g,rect:R(R({},m),(h={},h[o.start]=m[o.end],h))},D=[0,0],y=[0,0];D[a]=x[a],D[i]=x[i],y[a]=x[a],y[i]=x[i]+p.size,u.push({type:e,pos:D,size:0,elementRect:b,direction:"",elementDirection:"end"}),f.push({type:e,pos:y,size:0,elementRect:S,direction:"",elementDirection:"start"})}}),u.sort(function(p,v){return v.pos[i]-p.pos[i]}),f.sort(function(p,v){return p.pos[i]-v.pos[i]}),{total:c,start:u,end:f,inner:d}})}function kd(e,r,t,n,a){var i=e.props.isDisplayInnerSnapDigit,o=[];return["vertical","horizontal"].forEach(function(s){var l=r.filter(function(g){return g.type===s}),c=s==="vertical"?1:0,u=c?0:1,f=Bd(s,l,n,i),d=c?Oe:Me,p=c?Me:Oe,v=n[d.start],h=n[d.end];f.forEach(function(g){var m=g.total,x=g.start,b=g.end,S=g.inner,D=t[u]+m[0].pos[u]-n[p.start],y=n;x.forEach(function(E){var w=E.elementRect.rect,T=y[d.start]-w[d.end];if(T>0){var O=[0,0];O[c]=t[c]+y[d.start]-v-T,O[u]=D,o.push(Dr(e,s,"dashed",o.length,T,O,E.className,a))}y=w}),y=n,b.forEach(function(E){var w=E.elementRect.rect,T=w[d.start]-y[d.end];if(T>0){var O=[0,0];O[c]=t[c]+y[d.end]-v,O[u]=D,o.push(Dr(e,s,"dashed",o.length,T,O,E.className,a))}y=w}),S.forEach(function(E){var w=E.elementRect.rect,T=v-w[d.start],O=w[d.end]-h,P=[0,0],z=[0,0];P[c]=t[c]-T,P[u]=D,z[c]=t[c]+h-v,z[u]=D,o.push(Dr(e,s,"dashed",o.length,T,P,E.className,a)),o.push(Dr(e,s,"dashed",o.length,O,z,E.className,a))})})}),o}function Ld(e,r,t,n,a){var i=[];return["horizontal","vertical"].forEach(function(o){var s=r.filter(function(g){return g.type===o}).slice(0,1),l=o==="vertical"?0:1,c=l?0:1,u=l?Oe:Me,f=l?Me:Oe,d=n[u.start],p=n[u.end],v=n[f.start],h=n[f.end];s.forEach(function(g){var m=g.gap,x=g.gapRects,b=Math.max.apply(Math,W([v],M(x.map(function(y){var E=y.rect;return E[f.start]})),!1)),S=Math.min.apply(Math,W([h],M(x.map(function(y){var E=y.rect;return E[f.end]})),!1)),D=(b+S)/2;b===S||D===(v+h)/2||x.forEach(function(y){var E=y.rect,w=y.className,T=[t[0],t[1]];if(E[u.end]<d)T[l]+=E[u.end]-d;else if(p<E[u.start])T[l]+=E[u.start]-d-m;else return;T[c]+=D-v,i.push(Dr(e,l?"vertical":"horizontal","gap",i.length,m,T,w,a))})})}),i}function Qn(e){var r=e.state,t=r.containerClientRect,n=r.hasFixed,a=t.overflow,i=t.scrollHeight,o=t.scrollWidth,s=t.clientHeight,l=t.clientWidth,c=t.clientLeft,u=t.clientTop,f=e.props,d=f.snapGap,p=d===void 0?!0:d,v=f.verticalGuidelines,h=f.horizontalGuidelines,g=f.snapThreshold,m=g===void 0?5:g,x=f.snapGridWidth,b=x===void 0?0:x,S=f.snapGridHeight,D=S===void 0?0:S,y=f.maxSnapElementGuidelineDistance,E=y===void 0?1/0:y,w=f.isDisplayGridGuidelines,T=Zt(te(e.state)),O=T.top,P=T.left,z=T.bottom,I=T.right,k={top:O,left:P,bottom:z,right:I,center:(P+I)/2,middle:(O+z)/2},B=Gd(e),V=W([],M(B),!1);p&&V.push.apply(V,W([],M(_d(e,k,m)),!1));var H=R({},r.snapOffset||{left:0,top:0,bottom:0,right:0});if(V.push.apply(V,W([],M(Nd(b,D,a?o:l,a?i:s,c,u,H,w)),!1)),n){var G=t.left,L=t.top;H.left+=G,H.top+=L,H.right+=G,H.bottom+=L}return V.push.apply(V,W([],M(ss(h||!1,v||!1,a?o:l,a?i:s,c,u,H)),!1)),V=V.filter(function(F){var A=F.element,Z=F.elementRect,J=F.type;if(!A||!Z)return!0;var Y=Z.rect;return os(k,Y,J,E)}),V}function _d(e,r,t){var n=e.props,a=n.maxSnapElementGuidelineDistance,i=a===void 0?1/0:a,o=n.maxSnapElementGapDistance,s=o===void 0?1/0:o,l=e.state.elementRects,c=[];return[["vertical",Me,Oe],["horizontal",Oe,Me]].forEach(function(u){var f=M(u,3),d=f[0],p=f[1],v=f[2],h=r[p.start],g=r[p.end],m=r[p.center],x=r[v.start],b=r[v.end];function S(E){var w=E.rect;return w[p.end]<h+t?h-w[p.end]:g-t<w[p.start]?w[p.start]-g:-1}var D=l.filter(function(E){var w=E.rect;return w[v.start]>b||w[v.end]<x?!1:S(E)>0}).sort(function(E,w){return S(E)-S(w)}),y=[];D.forEach(function(E){D.forEach(function(w){if(E!==w){var T=E.rect,O=w.rect,P=T[v.start],z=T[v.end],I=O[v.start],k=O[v.end];P>k||I>z||y.push([E,w])}})}),y.forEach(function(E){var w=M(E,2),T=w[0],O=w[1],P=T.rect,z=O.rect,I=P[p.start],k=P[p.end],B=z[p.start],V=z[p.end],H=0,G=0,L=!1,F=!1,A=!1;if(k<=h&&g<=B){if(F=!0,H=(B-k-(g-h))/2,G=k+H+(g-h)/2,j(G-m)>t)return}else if(k<B&&V<h+t){if(L=!0,H=B-k,G=V+H,j(G-h)>t)return}else if(k<B&&g-t<I){if(A=!0,H=B-k,G=I-H,j(G-g)>t)return}else return;H&&os(r,z,d,i)&&(H>s||c.push({type:d,pos:d==="vertical"?[G,0]:[0,G],element:O.element,size:0,className:O.className,isStart:L,isCenter:F,isEnd:A,gap:H,hide:!0,gapRects:[T,O],direction:"",elementDirection:""}))})}),c}function Nd(e,r,t,n,a,i,o,s){a===void 0&&(a=0),i===void 0&&(i=0);var l=[],c=o.left,u=o.top;if(r)for(var f=0;f<=n;f+=r)l.push({type:"horizontal",pos:[c,mt(f-i+u,.1)],className:nt("grid-guideline"),size:t,hide:!s,direction:""});if(e)for(var f=0;f<=t;f+=e)l.push({type:"vertical",pos:[mt(f-a+c,.1),u],className:nt("grid-guideline"),size:n,hide:!s,direction:""});return l}function os(e,r,t,n){return t==="horizontal"?j(e.right-r.left)<=n||j(e.left-r.right)<=n||e.left<=r.right&&r.left<=e.right:t==="vertical"?j(e.bottom-r.top)<=n||j(e.top-r.bottom)<=n||e.top<=r.bottom&&r.top<=e.bottom:!0}function Gd(e){var r=e.state,t=e.props.elementGuidelines,n=t===void 0?[]:t;if(!n.length)return r.elementRects=[],[];var a=(r.elementRects||[]).filter(function(d){return!d.refresh}),i=n.map(function(d){return jr(d)&&"element"in d?R(R({},d),{element:de(d.element,!0)}):{element:de(d,!0)}}).filter(function(d){return d.element}),o=_l(a.map(function(d){return d.element}),i.map(function(d){return d.element})),s=o.maintained,l=o.added,c=[];s.forEach(function(d){var p=M(d,2),v=p[0],h=p[1];c[h]=a[v]}),Ad(e,l.map(function(d){return i[d]})).map(function(d,p){c[l[p]]=d}),r.elementRects=c;var u=Ma(e.props.elementSnapDirections),f=[];return c.forEach(function(d){var p=d.element,v=d.top,h=v===void 0?u.top:v,g=d.left,m=g===void 0?u.left:g,x=d.right,b=x===void 0?u.right:x,S=d.bottom,D=S===void 0?u.bottom:S,y=d.center,E=y===void 0?u.center:y,w=d.middle,T=w===void 0?u.middle:w,O=d.className,P=d.rect,z=Oa({top:h,right:b,left:m,bottom:D,center:E,middle:T},P),I=z.horizontal,k=z.vertical,B=z.horizontalNames,V=z.verticalNames,H=P.top,G=P.left,L=P.right-G,F=P.bottom-H,A=[L,F];k.forEach(function(Z,J){f.push({type:"vertical",element:p,pos:[mt(Z,.1),H],size:F,sizes:A,className:O,elementRect:d,elementDirection:ii[V[J]]||V[J],direction:""})}),I.forEach(function(Z,J){f.push({type:"horizontal",element:p,pos:[G,mt(Z,.1)],size:L,sizes:A,className:O,elementRect:d,elementDirection:ii[B[J]]||B[J],direction:""})})}),f}function hi(e,r){return e?e.map(function(t){var n=jr(t)?t:{pos:t},a=n.pos;return Br(a)?n:R(R({},n),{pos:Ct(a,r)})}):[]}function ss(e,r,t,n,a,i,o){a===void 0&&(a=0),i===void 0&&(i=0),o===void 0&&(o={left:0,top:0,right:0,bottom:0});var s=[],l=o.left,c=o.top,u=o.bottom,f=o.right,d=t+f-l,p=n+u-c;return hi(e,p).forEach(function(v){s.push({type:"horizontal",pos:[l,mt(v.pos-i+c,.1)],size:d,className:v.className,direction:""})}),hi(r,d).forEach(function(v){s.push({type:"vertical",pos:[mt(v.pos-a+l,.1),c],size:p,className:v.className,direction:""})}),s}function Ad(e,r){if(!r.length)return[];var t=e.props.groupable,n=e.state,a=n.containerClientRect,i=n.rootMatrix,o=n.is3d,s=n.offsetDelta,l=o?4:3,c=M(ud(i,a,l),2),u=c[0],f=c[1],d=t?0:s[0],p=t?0:s[1];return r.map(function(v){var h=v.element.getBoundingClientRect(),g=h.left-u-d,m=h.top-f-p,x=m+h.height,b=g+h.width,S=M(cr(i,[g,m],l),2),D=S[0],y=S[1],E=M(cr(i,[b,x],l),2),w=E[0],T=E[1];return R(R({},v),{rect:{left:D,right:w,top:y,bottom:T,center:(D+w)/2,middle:(y+T)/2}})})}function Zr(e){var r=e.state,t=r.container,n=e.props.snapContainer||t;if(r.snapContainer===n&&r.guidelines&&r.guidelines.length)return!1;var a=r.containerClientRect,i={left:0,top:0,bottom:0,right:0};if(t!==n){var o=de(n,!0);if(o){var s=Or(o),l=bi(r,[s.left-a.left,s.top-a.top]),c=bi(r,[s.right-a.right,s.bottom-a.bottom]);i.left=mt(l[0],1e-5),i.top=mt(l[1],1e-5),i.right=mt(c[0],1e-5),i.bottom=mt(c[1],1e-5)}}return r.snapContainer=n,r.snapOffset=i,r.guidelines=Qn(e),r.enableSnap=!0,!0}function ls(e,r,t,n,a,i){var o=Ue(e,r,t,i?4:3),s=Pt(o,n);return Ba(o,it(a,s))}function gi(e){return e?e/j(e):0}function jd(e,r,t,n,a,i){var o=i.fixedDirection,s=vd(t,o,n),l=Ia(e,r,t,n),c=W(W([],M(Rd(e,r,s,n,a,i)),!1),M(rs(e,l,i)),!1),u=dn(c,0),f=dn(c,1);return{width:{isBound:u.isBound,offset:u.offset[0]},height:{isBound:f.isBound,offset:f.offset[1]}}}function Hd(e,r,t,n,a,i,o,s,l){var c=Pt(r,o),u=Mn(e,s,{vertical:[c[0]],horizontal:[c[1]]}),f=u.horizontal.offset,d=u.vertical.offset;if(mt(d,Yn)||mt(f,Yn)){var p=M(ve({datas:l,distX:-d,distY:-f}),2),v=p[0],h=p[1],g=Math.min(a||1/0,t+o[0]*v),m=Math.min(i||1/0,n+o[1]*h);return[g-t,m-n]}return[0,0]}function cs(e,r,t,n,a,i,o,s){for(var l=te(e.state),c=e.props.keepRatio,u=0,f=0,d=0;d<2;++d){var p=r(u,f),v=jd(e,p,a,c,o,s),h=v.width,g=v.height,m=h.isBound,x=g.isBound,b=h.offset,S=g.offset;if(d===1&&(m||(b=0),x||(S=0)),d===0&&o&&!m&&!x)return[0,0];if(c){var D=j(b)*(t?1/t:1),y=j(S)*(n?1/n:1),E=m&&x?D<y:x||!m&&D<y;E?b=t*S/n:S=n*b/t}u+=b,f+=S}if(!c&&a[0]&&a[1]){var w=Od(e,l,a,i,s),T=w.maxWidth,O=w.maxHeight,P=M(Hd(e,r(u,f).map(function(k){return k.map(function(B){return mt(B,Yn)})}),t+u,n+f,T,O,a,o,s),2),b=P[0],S=P[1];u+=b,f+=S}return[u,f]}function Rr(e){return e<0&&(e=e%360+360),e%=360,e}function Vd(e,r){r=Rr(r);var t=Math.floor(e/360),n=t*360+360-r,a=t*360+r;return j(e-n)<j(e-a)?n:a}function _n(e,r){e=Rr(e),r=Rr(r);var t=Rr(e-r);return Math.min(t,360-t)}function Fd(e,r,t,n){var a,i=e.props,o=(a=i[us])!==null&&a!==void 0?a:5,s=i[fs];if(vr(e,"rotatable")){var l=r.pos1,c=r.pos2,u=r.pos3,f=r.pos4,d=r.origin,p=t*Math.PI/180,v=[l,c,u,f].map(function(S){return it(S,d)}),h=v.map(function(S){return Hr(S,p)}),g=W(W([],M(od(e,v,h,d,t)),!1),M(bd(e,v,h,d,t)),!1);g.sort(function(S,D){return j(S-t)-j(D-t)});var m=g.length>0;if(m)return{isSnap:m,dist:m?g[0]:t}}if(s!=null&&s.length&&o){var x=s.slice().sort(function(S,D){return _n(S,n)-_n(D,n)}),b=x[0];if(_n(b,n)<=o)return{isSnap:!0,dist:t+Vd(n,b)-n}}return{isSnap:!1,dist:t}}function Wd(e,r,t,n,a,i,o){if(!vr(e,"resizable"))return[0,0];var s=o.fixedDirection,l=o.nextAllMatrix,c=e.state,u=c.allMatrix,f=c.is3d;return cs(e,function(d,p){return ls(l||u,r+d,t+p,s,a,f)},r,t,n,a,i,o)}function qd(e,r,t,n,a){if(!vr(e,"scalable"))return[0,0];var i=a.startOffsetWidth,o=a.startOffsetHeight,s=a.fixedPosition,l=a.fixedDirection,c=a.is3d,u=cs(e,function(f,d){return ls(qf(a,xt(r,[f/i,d/o])),i,o,l,s,c)},i,o,t,s,n,a);return[u[0]/i,u[1]/o]}function Yd(e,r){r.absolutePoses=te(e.state)}function mi(e){var r=[];return e.forEach(function(t){t.guidelineInfos.forEach(function(n){var a=n.guideline;Re(r,function(i){return i.guideline===a})||(a.direction="",r.push({guideline:a,posInfo:t}))})}),r.map(function(t){var n=t.guideline,a=t.posInfo;return R(R({},n),{direction:a.direction})})}function xi(e,r,t,n,a,i){var o=Ra(wn(e,i),r,t),s=o.vertical,l=o.horizontal,c=Qe();s.forEach(function(v){v.isBound&&(v.direction==="start"&&(c.left=!0),v.direction==="end"&&(c.right=!0),n.push({type:"bounds",pos:v.pos}))}),l.forEach(function(v){v.isBound&&(v.direction==="start"&&(c.top=!0),v.direction==="end"&&(c.bottom=!0),a.push({type:"bounds",pos:v.pos}))});var u=Cd(e),f=u.boundMap,d=u.vertical,p=u.horizontal;return d.forEach(function(v){zr(n,function(h){var g=h.type,m=h.pos;return g==="bounds"&&m===v})>=0||n.push({type:"bounds",pos:v})}),p.forEach(function(v){zr(a,function(h){var g=h.type,m=h.pos;return g==="bounds"&&m===v})>=0||a.push({type:"bounds",pos:v})}),{boundMap:c,innerBoundMap:f}}var Xd=_a("",["resizable","scalable"]),us="snapRotationThreshold",fs="snapRotationDegrees",Ud={name:"snappable",dragRelation:"strong",props:["snappable","snapContainer","snapDirections","elementSnapDirections","snapGap","snapGridWidth","snapGridHeight","isDisplaySnapDigit","isDisplayInnerSnapDigit","isDisplayGridGuidelines","snapDigit","snapThreshold","snapRenderThreshold",us,fs,"horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","innerBounds","snapDistFormat","maxSnapElementGuidelineDistance","maxSnapElementGapDistance"],events:["snap","bound"],css:[`:host {
--bounds-color: #d66;
}
.guideline {
pointer-events: none;
z-index: 2;
}
.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}
.guideline-group {
position: absolute;
top: 0;
left: 0;
}
.guideline-group .size-value {
position: absolute;
color: #f55;
font-size: 12px;
font-size: calc(12px * var(--zoom));
font-weight: bold;
}
.guideline-group.horizontal .size-value {
transform-origin: 50% 100%;
transform: translateX(-50%);
left: 50%;
bottom: 5px;
bottom: calc(2px + 3px * var(--zoom));
}
.guideline-group.vertical .size-value {
transform-origin: 0% 50%;
top: 50%;
transform: translateY(-50%);
left: 5px;
left: calc(2px + 3px * var(--zoom));
}
.guideline.gap {
background: #f55;
}
.size-value.gap {
color: #f55;
}
`],render:function(e,r){var t=e.state,n=t.top,a=t.left,i=t.pos1,o=t.pos2,s=t.pos3,l=t.pos4,c=t.snapRenderInfo,u=e.props.snapRenderThreshold,f=u===void 0?1:u;if(!c||!c.render||!vr(e,""))return er(e,"boundMap",Qe(),function(Y){return JSON.stringify(Y)}),er(e,"innerBoundMap",Qe(),function(Y){return JSON.stringify(Y)}),[];t.guidelines=Qn(e);var d=Math.min(i[0],o[0],s[0],l[0]),p=Math.min(i[1],o[1],s[1],l[1]),v=c.externalPoses||[],h=te(e.state),g=[],m=[],x=[],b=[],S=[],D=Zt(h),y=D.width,E=D.height,w=D.top,T=D.left,O=D.bottom,P=D.right,z={left:T,right:P,top:w,bottom:O,center:(T+P)/2,middle:(w+O)/2},I=v.length>0,k=I?Zt(v):{};if(!c.request){if(c.direction&&S.push(pd(e,h,c.direction,f)),c.snap){var B=Zt(h);c.center&&(B.middle=(B.top+B.bottom)/2,B.center=(B.left+B.right)/2),S.push(oi(e,B,f))}I&&(c.center&&(k.middle=(k.top+k.bottom)/2,k.center=(k.left+k.right)/2),S.push(oi(e,k,f))),S.forEach(function(Y){var X=Y.vertical.posInfos,q=Y.horizontal.posInfos;g.push.apply(g,W([],M(X.filter(function($){var et=$.guidelineInfos;return et.some(function(ot){var at=ot.guideline;return!at.hide})}).map(function($){return{type:"snap",pos:$.pos}})),!1)),m.push.apply(m,W([],M(q.filter(function($){var et=$.guidelineInfos;return et.some(function(ot){var at=ot.guideline;return!at.hide})}).map(function($){return{type:"snap",pos:$.pos}})),!1)),x.push.apply(x,W([],M(mi(X)),!1)),b.push.apply(b,W([],M(mi(q)),!1))})}var V=xi(e,[T,P],[w,O],g,m),H=V.boundMap,G=V.innerBoundMap;I&&xi(e,[k.left,k.right],[k.top,k.bottom],g,m,c.externalBounds);var L=W(W([],M(x),!1),M(b),!1),F=L.filter(function(Y){return Y.element&&!Y.gapRects}),A=L.filter(function(Y){return Y.gapRects}).sort(function(Y,X){return Y.gap-X.gap});K(e,"onSnap",{guidelines:L.filter(function(Y){var X=Y.element;return!X}),elements:F,gaps:A},!0);var Z=er(e,"boundMap",H,function(Y){return JSON.stringify(Y)},Qe()),J=er(e,"innerBoundMap",G,function(Y){return JSON.stringify(Y)},Qe());return(H===Z||G===J)&&K(e,"onBound",{bounds:H,innerBounds:G},!0),W(W(W(W(W(W([],M(kd(e,F,[d,p],z,r)),!1),M(Ld(e,A,[d,p],z,r)),!1),M(vi(e,"horizontal",b,[a,n],z,r)),!1),M(vi(e,"vertical",x,[a,n],z,r)),!1),M(pi(e,"horizontal",m,d,n,y,0,r)),!1),M(pi(e,"vertical",g,p,a,E,1,r)),!1)},dragStart:function(e,r){e.state.snapRenderInfo={request:r.isRequest,snap:!0,center:!0},Zr(e)},drag:function(e){var r=e.state;Zr(e)||(r.guidelines=Qn(e)),r.snapRenderInfo&&(r.snapRenderInfo.render=!0)},pinchStart:function(e){this.unset(e)},dragEnd:function(e){this.unset(e)},dragControlCondition:function(e,r){if(Xd(e,r)||Zn(e,r))return!0;if(!r.isRequest&&r.inputEvent)return It(r.inputEvent.target,nt("snap-control"))},dragControlStart:function(e){e.state.snapRenderInfo=null,Zr(e)},dragControl:function(e){this.drag(e)},dragControlEnd:function(e){this.unset(e)},dragGroupStart:function(e,r){this.dragStart(e,r)},dragGroup:function(e){this.drag(e)},dragGroupEnd:function(e){this.unset(e)},dragGroupControlStart:function(e){e.state.snapRenderInfo=null,Zr(e)},dragGroupControl:function(e){this.drag(e)},dragGroupControlEnd:function(e){this.unset(e)},unset:function(e){var r=e.state;r.enableSnap=!1,r.guidelines=[],r.snapRenderInfo=null,r.elementRects=[]}};function $d(e,r){return[e[0]*r[0],e[1]*r[1]]}function nt(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return Il.apply(void 0,W([Sa],M(e),!1))}function ds(e){e()}function Kd(e){return!e||e==="none"?[1,0,0,1,0,0]:jr(e)?e:Pr(e)}function Mr(e,r,t){return cn(r,We(t,r),e,We(t.map(function(n){return-n}),r))}function Jd(e,r,t){if(r==="%"){var n=Pa(e.ownerSVGElement);return n[t?"width":"height"]/100}return 1}function Zd(e){var r=Qd(ka(e,":before"));return r.map(function(t,n){var a=pa(t),i=a.value,o=a.unit;return i*Jd(e,o,n===0)})}function vn(e){return e?e.split(" "):["0","0"]}function Qd(e){return vn(e.transformOrigin)}function ps(e){var r=Yt(e),t=r("transform");if(t&&t!=="none")return t;if("transform"in e){var n=e.transform,a=n.baseVal;if(!a)return"";var i=a.length;if(!i)return"";for(var o=[],s=function(c){var u=a[c].matrix;o.push("matrix(".concat(["a","b","c","d","e","f"].map(function(f){return u[f]}).join(", "),")"))},l=0;l<i;++l)s(l);return o.join(" ")}return""}function Ar(e,r,t,n,a){var i,o,s=ha(e)||Ie(e),l=!1,c,u;if(!e||t)c=e;else{var f=(i=e==null?void 0:e.assignedSlot)===null||i===void 0?void 0:i.parentElement,d=e.parentElement;f?(l=!0,u=d,c=f):c=d}for(var p=!1,v=e===r||c===r,h="relative",g=1,m=parseFloat(a==null?void 0:a("zoom"))||1,x=a==null?void 0:a("position");c&&c!==s;){r===c&&(v=!0);var b=Yt(c),S=c.tagName.toLowerCase(),D=ps(c),y=b("willChange"),E=parseFloat(b("zoom"))||1;if(h=b("position"),n&&E!==1){g=E;break}if(!t&&n&&m!==1&&x&&x!=="absolute"||S==="svg"||h!=="static"||D&&D!=="none"||y==="transform")break;var w=(o=e==null?void 0:e.assignedSlot)===null||o===void 0?void 0:o.parentNode,T=c.parentNode;w&&(l=!0,u=T);var O=T;if(O&&O.nodeType===11){c=O.host,p=!0,h=Yt(c)("position");break}c=O,h="relative"}return{offsetZoom:g,hasSlot:l,parentSlotElement:u,isCustomElement:p,isStatic:h==="static",isEnd:v||!c||c===s,offsetParent:c||s}}function tp(e,r){var t,n=e.tagName.toLowerCase(),a=e.offsetLeft,i=e.offsetTop,o=Yt(e),s=ga(a),l=!s,c,u;return!l&&n!=="svg"?(c=Lo?Zd(e):vn(o("transformOrigin")).map(function(f){return parseFloat(f)}),u=c.slice(),l=!0,t=M(np(e,c,e===r&&r.tagName.toLowerCase()==="g"),4),a=t[0],i=t[1],c[0]=t[2],c[1]=t[3]):(c=vn(o("transformOrigin")).map(function(f){return parseFloat(f)}),u=c.slice()),{tagName:n,isSVG:s,hasOffset:l,offset:[a||0,i||0],origin:c,targetOrigin:u}}function vs(e,r){var t=Yt(e),n=Yt(Ie(e)),a=n("position");if(!r&&(!a||a==="static"))return[0,0];var i=parseInt(n("marginLeft"),10),o=parseInt(n("marginTop"),10);return t("position")==="absolute"&&((t("top")!=="auto"||t("bottom")!=="auto")&&(o=0),(t("left")!=="auto"||t("right")!=="auto")&&(i=0)),[i,o]}function ta(e){e.forEach(function(r){var t=r.matrix;t&&(r.matrix=pe(t,3,4))})}function ep(e){for(var r=e.parentElement,t=!1,n=Ie(e);r;){var a=ka(r).transform;if(a&&a!=="none"){t=!0;break}if(r===n)break;r=r.parentElement}return{fixedContainer:r||n,hasTransform:t}}function On(e,r){return r===void 0&&(r=e.length>9),"".concat(r?"matrix3d":"matrix","(").concat(Hi(e,!r).join(","),")")}function Pa(e){var r=e.clientWidth,t=e.clientHeight;if(!e)return{x:0,y:0,width:0,height:0,clientWidth:r,clientHeight:t};var n=e.viewBox,a=n&&n.baseVal||{x:0,y:0,width:0,height:0};return{x:a.x,y:a.y,width:a.width||r,height:a.height||t,clientWidth:r,clientHeight:t}}function rp(e,r){var t,n=Pa(e),a=n.width,i=n.height,o=n.clientWidth,s=n.clientHeight,l=o/a,c=s/i,u=e.preserveAspectRatio.baseVal,f=u.align,d=u.meetOrSlice,p=[0,0],v=[l,c],h=[0,0];if(f!==1){var g=(f-2)%3,m=Math.floor((f-2)/3);p[0]=a*g/2,p[1]=i*m/2;var x=d===2?Math.max(c,l):Math.min(l,c);v[0]=x,v[1]=x,h[0]=(o-a)/2*g,h[1]=(s-i)/2*m}var b=va(v,r);return t=M(h,2),b[r*(r-1)]=t[0],b[r*(r-1)+1]=t[1],Mr(b,r,p)}function np(e,r,t){if(!e.getBBox||!t&&e.tagName.toLowerCase()==="g")return[0,0,0,0];var n=e.getBBox(),a=Pa(e.ownerSVGElement),i=n.x-a.x,o=n.y-a.y;return[i,o,r[0]-i,r[1]-o]}function Dt(e,r,t){return Ft(e,ir(r,t),t)}function Ue(e,r,t,n){return[[0,0],[r,0],[0,t],[r,t]].map(function(a){return Dt(e,a,n)})}function Zt(e){var r=e.map(function(c){return c[0]}),t=e.map(function(c){return c[1]}),n=Math.min.apply(Math,W([],M(r),!1)),a=Math.min.apply(Math,W([],M(t),!1)),i=Math.max.apply(Math,W([],M(r),!1)),o=Math.max.apply(Math,W([],M(t),!1)),s=i-n,l=o-a;return{left:n,top:a,right:i,bottom:o,width:s,height:l}}function yi(e,r,t,n){var a=Ue(e,r,t,n);return Zt(a)}function ap(e,r,t,n,a){var i,o=e.target,s=e.origin,l=r.matrix,c=gs(o),u=c.offsetWidth,f=c.offsetHeight,d=t.getBoundingClientRect(),p=[0,0];t===Ie(t)&&(p=vs(o,!0));for(var v=o.getBoundingClientRect(),h=v.left-d.left+t.scrollLeft-(t.clientLeft||0)+p[0],g=v.top-d.top+t.scrollTop-(t.clientTop||0)+p[1],m=v.width,x=v.height,b=cn(n,a,l),S=yi(b,u,f,n),D=S.left,y=S.top,E=S.width,w=S.height,T=Dt(b,s,n),O=it(T,[D,y]),P=[h+O[0]*m/E,g+O[1]*x/w],z=[0,0],I=0;++I<10;){var k=ye(a,n);i=M(it(Dt(k,P,n),Dt(k,T,n)),2),z[0]=i[0],z[1]=i[1];var B=cn(n,a,We(z,n),l),V=yi(B,u,f,n),H=V.left,G=V.top,L=H-h,F=G-g;if(j(L)<2&&j(F)<2)break;P[0]-=L,P[1]-=F}return z.map(function(A){return Math.round(A)})}function ip(e,r,t){var n=e.length===16,a=n?4:3,i=r.map(function(l){return Dt(e,l,a)}),o=t.left,s=t.top;return i.map(function(l){return[l[0]+o,l[1]+s]})}function Qt(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function hs(e,r){return Qt([r[0]-e[0],r[1]-e[1]])}function Er(e,r,t,n){t===void 0&&(t=1),n===void 0&&(n=kt(e,r));var a=hs(e,r);return{transform:"translateY(-50%) translate(".concat(e[0],"px, ").concat(e[1],"px) rotate(").concat(n,"rad) scaleY(").concat(t,")"),width:"".concat(a,"px")}}function hn(e,r){for(var t=[],n=2;n<arguments.length;n++)t[n-2]=arguments[n];var a=t.length,i=t.reduce(function(s,l){return s+l[0]},0)/a,o=t.reduce(function(s,l){return s+l[1]},0)/a;return{transform:"translateZ(0px) translate(".concat(i,"px, ").concat(o,"px) rotate(").concat(e,"rad) scale(").concat(r,")")}}function qe(e,r){var t=e[r];return jr(t)?R(R({},e),t):e}function gs(e){var r=e&&!ga(e.offsetWidth),t=0,n=0,a=0,i=0,o=0,s=0,l=0,c=0,u=0,f=0,d=0,p=0,v=1/0,h=1/0,g=1/0,m=1/0,x=0,b=0,S=!1;if(e)if(!r&&e.tagName.toLowerCase()!=="svg"){var D=e.getBBox();S=!0,t=D.width,n=D.height,o=t,s=n,l=t,c=n,a=t,i=n}else{var y=Yt(e),E=e.style,w=y("boxSizing")==="border-box",T=parseFloat(y("borderLeftWidth"))||0,O=parseFloat(y("borderRightWidth"))||0,P=parseFloat(y("borderTopWidth"))||0,z=parseFloat(y("borderBottomWidth"))||0,I=parseFloat(y("paddingLeft"))||0,k=parseFloat(y("paddingRight"))||0,B=parseFloat(y("paddingTop"))||0,V=parseFloat(y("paddingBottom"))||0,H=I+k,G=B+V,L=T+O,F=P+z,A=H+L,Z=G+F,J=y("position"),Y=0,X=0;if("clientLeft"in e){var q=null;if(J==="absolute"){var $=Ar(e,Ie(e));q=$.offsetParent}else q=e.parentElement;if(q){var et=Yt(q);Y=parseFloat(et("width")),X=parseFloat(et("height"))}}u=Math.max(H,Ct(y("minWidth"),Y)||0),f=Math.max(G,Ct(y("minHeight"),X)||0),v=Ct(y("maxWidth"),Y),h=Ct(y("maxHeight"),X),isNaN(v)&&(v=1/0),isNaN(h)&&(h=1/0),x=Ct(E.width,0)||0,b=Ct(E.height,0)||0,o=parseFloat(y("width"))||0,s=parseFloat(y("height"))||0,l=j(o-x)<1?Ja(u,x||o,v):o,c=j(s-b)<1?Ja(f,b||s,h):s,t=l,n=c,a=l,i=c,w?(g=v,m=h,d=u,p=f,l=t-A,c=n-Z):(g=v+A,m=h+Z,d=u+A,p=f+Z,t=l+A,n=c+Z),a=l+H,i=c+G}return{svg:S,offsetWidth:t,offsetHeight:n,clientWidth:a,clientHeight:i,contentWidth:l,contentHeight:c,inlineCSSWidth:x,inlineCSSHeight:b,cssWidth:o,cssHeight:s,minWidth:u,minHeight:f,maxWidth:v,maxHeight:h,minOffsetWidth:d,minOffsetHeight:p,maxOffsetWidth:g,maxOffsetHeight:m}}function ms(e,r){return kt(r>0?e[0]:e[1],r>0?e[1]:e[0])}function Qr(){return{left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function xs(e,r){var t=e===Ie(e)||e===ha(e),n={clientLeft:e.clientLeft,clientTop:e.clientTop,clientWidth:e.clientWidth,clientHeight:e.clientHeight,scrollWidth:e.scrollWidth,scrollHeight:e.scrollHeight,overflow:!1};return t&&(n.clientHeight=Math.max(r.height,n.clientHeight),n.scrollHeight=Math.max(r.height,n.scrollHeight)),n.overflow=Yt(e)("overflow")!=="visible",R(R({},r),n)}function Nn(e,r,t,n){var a=e.left,i=e.right,o=e.top,s=e.bottom,l=r.top,c=r.left,u={left:c+a,top:l+o,right:c+i,bottom:l+s,width:i-a,height:s-o};return t&&n?xs(t,u):u}function Or(e,r){var t=0,n=0,a=0,i=0;if(e){var o=e.getBoundingClientRect();t=o.left,n=o.top,a=o.width,i=o.height}var s={left:t,top:n,width:a,height:i,right:t+a,bottom:n+i};return e&&r?xs(e,s):s}function op(e){var r=e.props,t=r.groupable,n=r.svgOrigin,a=e.getState(),i=a.offsetWidth,o=a.offsetHeight,s=a.svg,l=a.transformOrigin;return!t&&s&&n?Ga(n,i,o):l}function ys(e,r,t,n){var a;if(e)a=e;else if(r)a=[0,0];else{var i=t.target;a=bs(i,n)}return a}function bs(e,r){if(e){var t=e.getAttribute("data-rotation")||"",n=e.getAttribute("data-direction");if(r.deg=t,!!n){var a=[0,0];return n.indexOf("w")>-1&&(a[0]=-1),n.indexOf("e")>-1&&(a[0]=1),n.indexOf("n")>-1&&(a[1]=-1),n.indexOf("s")>-1&&(a[1]=1),a}}}function Ba(e,r){return[xt(r,e[0]),xt(r,e[1]),xt(r,e[2]),xt(r,e[3])]}function te(e){var r=e.left,t=e.top,n=e.pos1,a=e.pos2,i=e.pos3,o=e.pos4;return Ba([n,a,i,o],[r,t])}function ea(e,r){e[r?"controlAbles":"targetAbles"].forEach(function(t){t.unset&&t.unset(e)})}function tr(e,r){var t=r?"controlGesto":"targetGesto",n=e[t];(n==null?void 0:n.isIdle())===!1&&ea(e,r),n==null||n.unset(),e[t]=null}function Ht(e,r){if(r){var t=pr(r);t.nextStyle=R(R({},t.nextStyle),e)}return{style:e,cssText:fr(e).map(function(n){return"".concat(zl(n,"-"),": ").concat(e[n],";")}).join("")}}function Cs(e,r,t){var n=r.afterTransform||r.transform;return R(R({},Ht(R(R(R({},e.style),r.style),{transform:n}),t)),{afterTransform:n,transform:e.transform})}function dt(e,r,t,n){var a=r.datas;a.datas||(a.datas={});var i=R(R({},t),{target:e.state.target,clientX:r.clientX,clientY:r.clientY,inputEvent:r.inputEvent,currentTarget:e,moveable:e,datas:a.datas,isRequest:r.isRequest,isRequestChild:r.isRequestChild,isFirstDrag:!!r.isFirstDrag,isTrusted:r.isTrusted!==!1,stopAble:function(){a.isEventStart=!1},stopDrag:function(){var o;(o=r.stop)===null||o===void 0||o.call(r)}});return a.isStartEvent?n||(a.lastEvent=i):a.isStartEvent=!0,i}function Xt(e,r,t){var n=r.datas,a="isDrag"in t?t.isDrag:r.isDrag;return n.datas||(n.datas={}),R(R({isDrag:a},t),{moveable:e,target:e.state.target,clientX:r.clientX,clientY:r.clientY,inputEvent:r.inputEvent,currentTarget:e,lastEvent:n.lastEvent,isDouble:r.isDouble,datas:n.datas,isFirstDrag:!!r.isFirstDrag})}function Tn(e,r,t){e._emitter.on(r,t)}function K(e,r,t,n,a){return e.triggerEvent(r,t,n,a)}function ka(e,r){return _r(e).getComputedStyle(e,r)}function tn(e,r,t){var n={},a={};return e.filter(function(i){var o=i.name;if(n[o]||!r.some(function(s){return i[s]}))return!1;if(!t&&i.ableGroup){if(a[i.ableGroup])return!1;a[i.ableGroup]=!0}return n[o]=!0,!0})}function ra(e,r){return e===r||e==null&&r==null}function sp(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];for(var t=e.length-1,n=0;n<t;++n){var a=e[n];if(!ga(a))return a}return e[t]}function Ss(e,r){var t=[],n=[];return e.forEach(function(a,i){var o=r(a,i,e),s=n.indexOf(o),l=t[s]||[];s===-1&&(n.push(o),t.push(l)),l.push(a)}),t}function lp(e,r){var t=[],n={};return e.forEach(function(a,i){var o=r(a,i,e),s=n[o];s||(s=[],n[o]=s,t.push(s)),s.push(a)}),t}function Ds(e){return e.reduce(function(r,t){return r.concat(t)},[])}function lr(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];return e.sort(function(t,n){return j(n)-j(t)}),e[0]}function cr(e,r,t){return Ft(ye(e,t),ir(r,t),t)}function Es(e,r){var t,n=e.is3d,a=e.rootMatrix,i=n?4:3;return t=M(cr(a,[r.distX,r.distY],i),2),r.distX=t[0],r.distY=t[1],r}function en(e,r,t,n){if(!t[0]&&!t[1])return r;var a=Dt(e,[gi(t[0]),0],n),i=Dt(e,[0,gi(t[1])],n),o=Dt(e,[t[0]/Qt(a),t[1]/Qt(i)],n);return xt(r,o)}function re(e,r,t){return t?"".concat(e/r*100,"%"):"".concat(e,"px")}function gn(e){return j(e)<=Vt?0:e}function La(e){return function(r){if(!r.isDragging(e))return"";var t=Zf(r,e),n=t.deg;return n?nt("view-control-rotation".concat(n)):""}}function _a(e,r){return r===void 0&&(r=[e]),function(t,n){if(n.isRequest)return r.some(function(i){return n.requestAble===i})?n.parentDirection:!1;var a=n.inputEvent.target;return It(a,nt("direction"))&&(!e||It(a,nt(e)))}}function cp(e,r,t){var n,a=kr(e,{"x%":function(D){return D/100*r.offsetWidth},"y%":function(D){return D/100*r.offsetHeight}}),i=e.slice(0,t<0?void 0:t),o=e.slice(0,t<0?void 0:t+1),s=e[t]||"",l=t<0?[]:e.slice(t),c=t<0?[]:e.slice(t+1),u=a.slice(0,t<0?void 0:t),f=a.slice(0,t<0?void 0:t+1),d=(n=a[t])!==null&&n!==void 0?n:kr([""])[0],p=t<0?[]:a.slice(t),v=t<0?[]:a.slice(t+1),h=d?[d]:[],g=br(u),m=br(f),x=br(p),b=br(v),S=Bt(g,x,4);return{transforms:e,beforeFunctionMatrix:g,beforeFunctionMatrix2:m,targetFunctionMatrix:br(h),afterFunctionMatrix:x,afterFunctionMatrix2:b,allFunctionMatrix:S,beforeFunctions:u,beforeFunctions2:f,targetFunction:h[0],afterFunctions:p,afterFunctions2:v,beforeFunctionTexts:i,beforeFunctionTexts2:o,targetFunctionText:s,afterFunctionTexts:l,afterFunctionTexts2:c}}function up(e){return!e||!jr(e)||da(e)?!1:Gt(e)||"length"in e}function de(e,r){return e?da(e)?e:Ye(e)?r?document.querySelector(e):e:Nl(e)?e():Gl(e)?e:"current"in e?e.current:e:null}function Na(e,r){if(!e)return[];var t=up(e)?[].slice.call(e):[e];return t.reduce(function(n,a){return Ye(a)&&r?W(W([],M(n),!1),M([].slice.call(document.querySelectorAll(a))),!1):(Gt(a)?n.push(Na(a,r)):n.push(de(a,r)),n)},[])}function fp(e,r,t){var n=kt(e,r)/Math.PI*180;return n=t>=0?n:180-n,n=n>=0?n:360+n,n}function bi(e,r){var t=e.rootMatrix,n=e.is3d,a=n?4:3,i=ye(t,a);return n||(i=pe(i,3,4)),i[12]=0,i[13]=0,i[14]=0,Al(i,r)}function ws(e,r,t,n,a){var i=M(e,2),o=i[0],s=i[1],l=0,c=0;if(a&&o&&s){var u=kt([0,0],r),f=kt([0,0],n),d=Qt(r),p=Math.cos(u-f)*d;if(!n[0])c=p,l=c*t;else if(!n[1])l=p,c=l/t;else{var v=n[0]*o,h=n[1]*s,g=Math.atan2(v+r[0],h+r[1]),m=Math.atan2(v,h);g<0&&(g+=Math.PI*2),m<0&&(m+=Math.PI*2);var x=0;j(g-m)<Math.PI/2||j(g-m)>Math.PI/2*3||(m+=Math.PI),x=g-m,x>Math.PI*2?x-=Math.PI*2:x>Math.PI?x=2*Math.PI-x:x<-Math.PI&&(x=-2*Math.PI-x);var b=Qt([v+r[0],h+r[1]])*Math.cos(x);l=b*Math.sin(m)-v,c=b*Math.cos(m)-h,n[0]<0&&(l*=-1),n[1]<0&&(c*=-1)}}else l=n[0]*r[0],c=n[1]*r[1];return[l,c]}function Rs(e,r,t,n){var a,i=t.ratio,o=t.startOffsetWidth,s=t.startOffsetHeight,l=0,c=0,u=n.distX,f=n.distY,d=n.pinchScale,p=n.parentDistance,v=n.parentDist,h=n.parentScale,g=t.fixedDirection,m=[0,1].map(function(E){return j(e[E]-g[E])}),x=[0,1].map(function(E){var w=m[E];return w!==0&&(w=2/w),w});if(v)l=v[0],c=v[1],r&&(l?c||(c=l/i):l=c*i);else if(Br(d))l=(d-1)*o,c=(d-1)*s;else if(h)l=(h[0]-1)*o,c=(h[1]-1)*s;else if(p){var b=o*m[0],S=s*m[1],D=Qt([b,S]);l=p/D*b*x[0],c=p/D*S*x[1]}else{var y=ve({datas:t,distX:u,distY:f});y=x.map(function(E,w){return y[w]*E}),a=M(ws([o,s],y,i,e,r),2),l=a[0],c=a[1]}return{distWidth:l,distHeight:c}}function na(e,r){if(r){if(e==="left")return{x:"0%",y:"50%"};if(e==="top")return{x:"50%",y:"50%"};if(e==="center")return{x:"50%",y:"50%"};if(e==="right")return{x:"100%",y:"50%"};if(e==="bottom")return{x:"50%",y:"100%"};var t=M(e.split(" "),2),n=t[0],a=t[1],i=na(n||""),o=na(a||""),s=R(R({},i),o),l={x:"50%",y:"50%"};return s.x&&(l.x=s.x),s.y&&(l.y=s.y),s.value&&(s.x&&!s.y&&(l.y=s.value),!s.x&&s.y&&(l.x=s.value)),l}return e==="left"?{x:"0%"}:e==="right"?{x:"100%"}:e==="top"?{y:"0%"}:e==="bottom"?{y:"100%"}:e?e==="center"?{value:"50%"}:{value:e}:{}}function Ga(e,r,t){var n=na(e,!0),a=n.x,i=n.y;return[Ct(a,r)||0,Ct(i,t)||0]}function dp(e,r,t){var n=e.map(function(i){return it(i,r)}),a=n.map(function(i){return Hr(i,t)});return{prev:n,next:a,result:a.map(function(i){return xt(i,r)})}}function Ms(e,r){return e.length===r.length&&e.every(function(t,n){var a=r[n],i=Gt(t),o=Gt(a);return i&&o?Ms(t,a):!i&&!o?t===a:!1})}function er(e,r,t,n,a){var i=e._store,o=i[r];if(!(r in i))if(a!=null)i[r]=a,o=a;else return i[r]=t,t;return o===t||n(o)===n(t)?o:(i[r]=t,t)}function Jt(e){return e>=0?1:-1}function j(e){return Math.abs(e)}function Gn(e,r){return jl(e).map(function(t){return r(t)})}function Os(e){return Br(e)?{top:e,left:e,right:e,bottom:e}:{left:e.left||0,top:e.top||0,right:e.right||0,bottom:e.bottom||0}}var pp=Wr("pinchable",{props:["pinchable"],events:["pinchStart","pinch","pinchEnd","pinchGroupStart","pinchGroup","pinchGroupEnd"],dragStart:function(){return!0},pinchStart:function(e,r){var t=r.datas,n=r.targets,a=r.angle,i=r.originalDatas,o=e.props,s=o.pinchable,l=o.ables;if(!s)return!1;var c="onPinch".concat(n?"Group":"","Start"),u="drag".concat(n?"Group":"","ControlStart"),f=(s===!0?e.controlAbles:l.filter(function(h){return s.indexOf(h.name)>-1})).filter(function(h){return h.canPinch&&h[u]}),d=dt(e,r,{});n&&(d.targets=n);var p=K(e,c,d);t.isPinch=p!==!1,t.ables=f;var v=t.isPinch;return v?(f.forEach(function(h){if(i[h.name]=i[h.name]||{},!!h[u]){var g=R(R({},r),{datas:i[h.name],parentRotate:a,isPinch:!0});h[u](e,g)}}),e.state.snapRenderInfo={request:r.isRequest,direction:[0,0]},v):!1},pinch:function(e,r){var t=r.datas,n=r.scale,a=r.distance,i=r.originalDatas,o=r.inputEvent,s=r.targets,l=r.angle;if(t.isPinch){var c=a*(1-1/n),u=dt(e,r,{});s&&(u.targets=s);var f="onPinch".concat(s?"Group":"");K(e,f,u);var d=t.ables,p="drag".concat(s?"Group":"","Control");return d.forEach(function(v){v[p]&&v[p](e,R(R({},r),{datas:i[v.name],inputEvent:o,resolveMatrix:!0,pinchScale:n,parentDistance:c,parentRotate:l,isPinch:!0}))}),u}},pinchEnd:function(e,r){var t=r.datas,n=r.isPinch,a=r.inputEvent,i=r.targets,o=r.originalDatas;if(t.isPinch){var s="onPinch".concat(i?"Group":"","End"),l=Xt(e,r,{isDrag:n});i&&(l.targets=i),K(e,s,l);var c=t.ables,u="drag".concat(i?"Group":"","ControlEnd");return c.forEach(function(f){f[u]&&f[u](e,R(R({},r),{isDrag:n,datas:o[f.name],inputEvent:a,isPinch:!0}))}),n}},pinchGroupStart:function(e,r){return this.pinchStart(e,R(R({},r),{targets:e.props.targets}))},pinchGroup:function(e,r){return this.pinch(e,R(R({},r),{targets:e.props.targets}))},pinchGroupEnd:function(e,r){return this.pinchEnd(e,R(R({},r),{targets:e.props.targets}))}}),Ci=_a("scalable"),vp={name:"scalable",ableGroup:"size",canPinch:!0,props:["scalable","throttleScale","renderDirections","keepRatio","edge","displayAroundControls"],events:["scaleStart","beforeScale","scale","scaleEnd","scaleGroupStart","beforeScaleGroup","scaleGroup","scaleGroupEnd"],render:$o("scalable"),dragControlCondition:Ci,viewClassName:La("scalable"),dragControlStart:function(e,r){var t=r.datas,n=r.isPinch,a=r.inputEvent,i=r.parentDirection,o=ys(i,n,a,t),s=e.state,l=s.width,c=s.height,u=s.targetTransform,f=s.target,d=s.pos1,p=s.pos2,v=s.pos4;if(!o||!f)return!1;n||Xe(e,r),t.datas={},t.transform=u,t.prevDist=[1,1],t.direction=o,t.startOffsetWidth=l,t.startOffsetHeight=c,t.startValue=[1,1];var h=!o[0]&&!o[1]||o[0]||!o[1];En(e,r,"scale"),t.isWidth=h;function g(y){t.ratio=y&&isFinite(y)?y:0}t.startPositions=te(e.state);function m(y){var E=ns(t.startPositions,y);t.fixedDirection=E.fixedDirection,t.fixedPosition=E.fixedPosition,t.fixedOffset=E.fixedOffset}t.setFixedDirection=m,g(He(d,p)/He(p,v)),m([-o[0],-o[1]]);var x=function(y){t.minScaleSize=y},b=function(y){t.maxScaleSize=y};x([-1/0,-1/0]),b([1/0,1/0]);var S=dt(e,r,R(R({direction:o,set:function(y){t.startValue=y},setRatio:g,setFixedDirection:m,setMinScaleSize:x,setMaxScaleSize:b},Dn(e,r)),{dragStart:jt.dragStart(e,new or().dragStart([0,0],r))})),D=K(e,"onScaleStart",S);return t.startFixedDirection=t.fixedDirection,D!==!1&&(t.isScale=!0,e.state.snapRenderInfo={request:r.isRequest,direction:o}),t.isScale?S:!1},dragControl:function(e,r){Cn(e,r,"scale");var t=r.datas,n=r.parentKeepRatio,a=r.parentFlag,i=r.isPinch,o=r.dragClient,s=r.isRequest,l=r.useSnap,c=r.resolveMatrix,u=t.prevDist,f=t.direction,d=t.startOffsetWidth,p=t.startOffsetHeight,v=t.isScale,h=t.startValue,g=t.isWidth,m=t.ratio;if(!v)return!1;var x=e.props,b=x.throttleScale,S=x.parentMoveable,D=f;!f[0]&&!f[1]&&(D=[1,1]);var y=m&&(n??x.keepRatio)||!1,E=e.state,w=[h[0],h[1]];function T(){var at=Rs(D,y,t,r),Q=at.distWidth,tt=at.distHeight,gt=d?(d+Q)/d:1,ct=p?(p+tt)/p:1;h[0]||(w[0]=Q/d),h[1]||(w[1]=tt/p);var ut=(D[0]||y?gt:1)*w[0],st=(D[1]||y?ct:1)*w[1];return ut===0&&(ut=Jt(u[0])*$r),st===0&&(st=Jt(u[1])*$r),[ut,st]}var O=T();if(!i&&e.props.groupable){var P=E.snapRenderInfo||{},z=P.direction;Gt(z)&&(z[0]||z[1])&&(E.snapRenderInfo={direction:f,request:r.isRequest})}K(e,"onBeforeScale",dt(e,r,{scale:O,setFixedDirection:function(at){return t.setFixedDirection(at),O=T(),O},startFixedDirection:t.startFixedDirection,setScale:function(at){O=at}},!0));var I=[O[0]/w[0],O[1]/w[1]],k=o,B=[0,0],V=!o&&!a&&i;if(V||c?k=wa(e,t.targetAllTransform,[0,0],[0,0],t):o||(k=t.fixedPosition),i||(B=qd(e,I,f,!l&&s,t)),y){D[0]&&D[1]&&B[0]&&B[1]&&(Math.abs(B[0]*d)>Math.abs(B[1]*p)?B[1]=0:B[0]=0);var H=!B[0]&&!B[1];if(H&&(g?I[0]=mt(I[0]*w[0],b)/w[0]:I[1]=mt(I[1]*w[1],b)/w[1]),D[0]&&!D[1]||B[0]&&!B[1]||H&&g){I[0]+=B[0];var G=d*I[0]*w[0]/m;I[1]=G/p/w[1]}else if(!D[0]&&D[1]||!B[0]&&B[1]||H&&!g){I[1]+=B[1];var L=p*I[1]*w[1]*m;I[0]=L/d/w[0]}}else I[0]+=B[0],I[1]+=B[1],B[0]||(I[0]=mt(I[0]*w[0],b)/w[0]),B[1]||(I[1]=mt(I[1]*w[1],b)/w[1]);I[0]===0&&(I[0]=Jt(u[0])*$r),I[1]===0&&(I[1]=Jt(u[1])*$r),O=$d(I,[w[0],w[1]]);var F=[d,p],A=[d*O[0],p*O[1]];A=ji(A,t.minScaleSize,t.maxScaleSize,y?m:!1),O=Gn(2,function(at){return F[at]?A[at]/F[at]:A[at]}),I=Gn(2,function(at){return O[at]/w[at]});var Z=Gn(2,function(at){return u[at]?I[at]/u[at]:I[at]}),J="scale(".concat(I.join(", "),")"),Y="scale(".concat(O.join(", "),")"),X=Sn(t,Y,J),q=!h[0]||!h[1],$=Yf(e,q?Y:J,t.fixedDirection,k,t.fixedOffset,t,q),et=V?$:it($,t.prevInverseDist||[0,0]);if(t.prevDist=I,t.prevInverseDist=$,O[0]===u[0]&&O[1]===u[1]&&et.every(function(at){return!at})&&!S&&!V)return!1;var ot=dt(e,r,R({offsetWidth:d,offsetHeight:p,direction:f,scale:O,dist:I,delta:Z,isPinch:!!i},Fo(e,X,et,i,r)));return K(e,"onScale",ot),ot},dragControlEnd:function(e,r){var t=r.datas;if(!t.isScale)return!1;t.isScale=!1;var n=Xt(e,r,{});return K(e,"onScaleEnd",n),n},dragGroupControlCondition:Ci,dragGroupControlStart:function(e,r){var t=r.datas,n=this.dragControlStart(e,r);if(!n)return!1;var a=ne(e,"resizable",r);t.moveableScale=e.scale;var i=xe(e,this,"dragControlStart",r,function(c,u){return fn(e,c,t,u)}),o=function(c){n.setFixedDirection(c),i.forEach(function(u,f){u.setFixedDirection(c),fn(e,u.moveable,t,a[f])})};t.setFixedDirection=o;var s=R(R({},n),{targets:e.props.targets,events:i,setFixedDirection:o}),l=K(e,"onScaleGroupStart",s);return t.isScale=l!==!1,t.isScale?s:!1},dragGroupControl:function(e,r){var t=r.datas;if(t.isScale){Tn(e,"onBeforeScale",function(u){K(e,"onBeforeScaleGroup",dt(e,r,R(R({},u),{targets:e.props.targets}),!0))});var n=this.dragControl(e,r);if(n){var a=n.dist,i=t.moveableScale;e.scale=[a[0]*i[0],a[1]*i[1]];var o=e.props.keepRatio,s=t.fixedPosition,l=xe(e,this,"dragControl",r,function(u,f){var d=M(Ft(fa(e.rotation/180*Math.PI,3),[f.datas.originalX*a[0],f.datas.originalY*a[1],1],3),2),p=d[0],v=d[1];return R(R({},f),{parentDist:null,parentScale:a,parentKeepRatio:o,dragClient:xt(s,[p,v])})}),c=R({targets:e.props.targets,events:l},n);return K(e,"onScaleGroup",c),c}}},dragGroupControlEnd:function(e,r){var t=r.isDrag,n=r.datas;if(n.isScale){this.dragControlEnd(e,r);var a=xe(e,this,"dragControlEnd",r),i=Xt(e,r,{targets:e.props.targets,events:a});return K(e,"onScaleGroupEnd",i),t}},request:function(){var e={},r=0,t=0,n=!1;return{isControl:!0,requestStart:function(a){return n=a.useSnap,{datas:e,parentDirection:a.direction||[1,1],useSnap:n}},request:function(a){return r+=a.deltaWidth,t+=a.deltaHeight,{datas:e,parentDist:[r,t],parentKeepRatio:a.keepRatio,useSnap:n}},requestEnd:function(){return{datas:e,isDrag:!0,useSnap:n}}}}};function Se(e,r){return e.map(function(t,n){return _e(t,r[n],1,2)})}function Si(e,r,t){var n=kt(e,r),a=kt(e,t),i=a-n;return i>=0?i:i+2*Math.PI}function hp(e,r){var t=Si(e[0],e[1],e[2]),n=Si(r[0],r[1],r[2]),a=Math.PI;return!(t>=a&&n<=a||t<=a&&n>=a)}var gp={name:"warpable",ableGroup:"size",props:["warpable","renderDirections","edge","displayAroundControls"],events:["warpStart","warp","warpEnd"],viewClassName:La("warpable"),render:function(e,r){var t=e.props,n=t.resizable,a=t.scalable,i=t.warpable,o=t.zoom;if(n||a||!i)return[];var s=e.state,l=s.pos1,c=s.pos2,u=s.pos3,f=s.pos4,d=Se(l,c),p=Se(c,l),v=Se(l,u),h=Se(u,l),g=Se(u,f),m=Se(f,u),x=Se(c,f),b=Se(f,c);return W([r.createElement("div",{className:nt("line"),key:"middeLine1",style:Er(d,g,o)}),r.createElement("div",{className:nt("line"),key:"middeLine2",style:Er(p,m,o)}),r.createElement("div",{className:nt("line"),key:"middeLine3",style:Er(v,x,o)}),r.createElement("div",{className:nt("line"),key:"middeLine4",style:Er(h,b,o)})],M(Ko(e,"warpable",r)),!1)},dragControlCondition:function(e,r){if(r.isRequest)return!1;var t=r.inputEvent.target;return It(t,nt("direction"))&&It(t,nt("warpable"))},dragControlStart:function(e,r){var t=r.datas,n=r.inputEvent,a=e.props.target,i=n.target,o=bs(i,t);if(!o||!a)return!1;var s=e.state,l=s.transformOrigin,c=s.is3d,u=s.targetTransform,f=s.targetMatrix,d=s.width,p=s.height,v=s.left,h=s.top;t.datas={},t.targetTransform=u,t.warpTargetMatrix=c?f:pe(f,3,4),t.targetInverseMatrix=Vi(ye(t.warpTargetMatrix,4),3,4),t.direction=o,t.left=v,t.top=h,t.poses=[[0,0],[d,0],[0,p],[d,p]].map(function(x){return it(x,l)}),t.nextPoses=t.poses.map(function(x){var b=M(x,2),S=b[0],D=b[1];return Ft(t.warpTargetMatrix,[S,D,0,1],4)}),t.startValue=_t(4),t.prevMatrix=_t(4),t.absolutePoses=te(s),t.posIndexes=Vo(o),Xe(e,r),En(e,r,"matrix3d"),s.snapRenderInfo={request:r.isRequest,direction:o};var g=dt(e,r,R({set:function(x){t.startValue=x}},Dn(e,r))),m=K(e,"onWarpStart",g);return m!==!1&&(t.isWarp=!0),t.isWarp},dragControl:function(e,r){var t=r.datas,n=r.isRequest,a=r.distX,i=r.distY,o=t.targetInverseMatrix,s=t.prevMatrix,l=t.isWarp,c=t.startValue,u=t.poses,f=t.posIndexes,d=t.absolutePoses;if(!l)return!1;if(Cn(e,r,"matrix3d"),vr(e,"warpable")){var p=f.map(function(T){return d[T]});p.length>1&&p.push([(p[0][0]+p[1][0])/2,(p[0][1]+p[1][1])/2]);var v=Mn(e,n,{horizontal:p.map(function(T){return T[1]+i}),vertical:p.map(function(T){return T[0]+a})}),h=v.horizontal,g=v.vertical;i-=h.offset,a-=g.offset}var m=ve({datas:t,distX:a,distY:i},!0),x=t.nextPoses.slice();if(f.forEach(function(T){x[T]=xt(x[T],m)}),!Lf.every(function(T){return hp(T.map(function(O){return u[O]}),T.map(function(O){return x[O]}))}))return!1;var b=ua(u[0],u[2],u[1],u[3],x[0],x[2],x[1],x[3]);if(!b.length)return!1;var S=Bt(o,b,4),D=jo(t,S,!0),y=Bt(ye(s,4),D,4);t.prevMatrix=D;var E=Bt(c,D,4),w=Sn(t,"matrix3d(".concat(E.join(", "),")"),"matrix3d(".concat(D.join(", "),")"));return Ea(r,w),K(e,"onWarp",dt(e,r,R({delta:y,matrix:E,dist:D,multiply:Bt,transform:w},Ht({transform:w},r)))),!0},dragControlEnd:function(e,r){var t=r.datas,n=r.isDrag;return t.isWarp?(t.isWarp=!1,K(e,"onWarpEnd",Xt(e,r,{})),n):!1}},mp=nt("area-pieces"),rn=nt("area-piece"),Ts=nt("avoid"),xp=nt("view-dragging");function An(e){var r=e.areaElement;if(r){var t=e.state,n=t.width,a=t.height;Ui(r,Ts),r.style.cssText+="left: 0px; top: 0px; width: ".concat(n,"px; height: ").concat(a,"px")}}function Di(e){return e.createElement("div",{key:"area_pieces",className:mp},e.createElement("div",{className:rn}),e.createElement("div",{className:rn}),e.createElement("div",{className:rn}),e.createElement("div",{className:rn}))}var Is={name:"dragArea",props:["dragArea","passDragArea"],events:["click","clickGroup"],render:function(e,r){var t=e.props,n=t.target,a=t.dragArea,i=t.groupable,o=t.passDragArea,s=e.getState(),l=s.width,c=s.height,u=s.renderPoses,f=o?nt("area","pass"):nt("area");if(i)return[r.createElement("div",{key:"area",ref:we(e,"areaElement"),className:f}),Di(r)];if(!n||!a)return[];var d=ua([0,0],[l,0],[0,c],[l,c],u[0],u[1],u[2],u[3]),p=d.length?On(d,!0):"none";return[r.createElement("div",{key:"area",ref:we(e,"areaElement"),className:f,style:{top:"0px",left:"0px",width:"".concat(l,"px"),height:"".concat(c,"px"),transformOrigin:"0 0",transform:p}}),Di(r)]},dragStart:function(e,r){var t=r.datas,n=r.clientX,a=r.clientY,i=r.inputEvent;if(!i)return!1;t.isDragArea=!1;var o=e.areaElement,s=e.state,l=s.moveableClientRect,c=s.renderPoses,u=s.rootMatrix,f=s.is3d,d=l.left,p=l.top,v=Zt(c),h=v.left,g=v.top,m=v.width,x=v.height,b=f?4:3,S=M(cr(u,[n-d,a-p],b),2),D=S[0],y=S[1];D-=h,y-=g;var E=[{left:h,top:g,width:m,height:y-10},{left:h,top:g,width:D-10,height:x},{left:h,top:g+y+10,width:m,height:x-y-10},{left:h+D+10,top:g,width:m-D-10,height:x}],w=[].slice.call(o.nextElementSibling.children);E.forEach(function(T,O){w[O].style.cssText="left: ".concat(T.left,"px;top: ").concat(T.top,"px; width: ").concat(T.width,"px; height: ").concat(T.height,"px;")}),Fi(o,Ts),s.disableNativeEvent=!0},drag:function(e,r){var t=r.datas,n=r.inputEvent;if(this.enableNativeEvent(e),!n)return!1;t.isDragArea||(t.isDragArea=!0,An(e))},dragEnd:function(e,r){this.enableNativeEvent(e);var t=r.inputEvent,n=r.datas;if(!t)return!1;n.isDragArea||An(e)},dragGroupStart:function(e,r){return this.dragStart(e,r)},dragGroup:function(e,r){return this.drag(e,r)},dragGroupEnd:function(e,r){return this.dragEnd(e,r)},unset:function(e){An(e),e.state.disableNativeEvent=!1},enableNativeEvent:function(e){var r=e.state;r.disableNativeEvent&&Wi(function(){r.disableNativeEvent=!1})}},yp=Wr("origin",{props:["origin","svgOrigin"],render:function(e,r){var t=e.props,n=t.zoom,a=t.svgOrigin,i=t.groupable,o=e.getState(),s=o.beforeOrigin,l=o.rotation,c=o.svg,u=o.allMatrix,f=o.is3d,d=o.left,p=o.top,v=o.offsetWidth,h=o.offsetHeight,g;if(!i&&c&&a){var m=M(Ga(a,v,h),2),x=m[0],b=m[1],S=f?4:3,D=Dt(u,[x,b],S);g=hn(l,n,it(D,[d,p]))}else g=hn(l,n,s);return[r.createElement("div",{className:nt("control","origin"),style:g,key:"beforeOrigin"})]}});function bp(e){var r=e.scrollContainer;return[r.scrollLeft,r.scrollTop]}var Cp={name:"scrollable",canPinch:!0,props:["scrollable","scrollContainer","scrollThreshold","scrollThrottleTime","getScrollPosition","scrollOptions"],events:["scroll","scrollGroup"],dragRelation:"strong",dragStart:function(e,r){var t=e.props,n=t.scrollContainer,a=n===void 0?e.getContainer():n,i=t.scrollOptions,o=new Pl,s=de(a,!0);r.datas.dragScroll=o,e.state.dragScroll=o;var l=r.isControl?"controlGesto":"targetGesto",c=r.targets;o.on("scroll",function(u){var f=u.container,d=u.direction,p=dt(e,r,{scrollContainer:f,direction:d}),v=c?"onScrollGroup":"onScroll";c&&(p.targets=c),K(e,v,p)}).on("move",function(u){var f=u.offsetX,d=u.offsetY,p=u.inputEvent;e[l].scrollBy(f,d,p.inputEvent,!0)}).on("scrollDrag",function(u){var f=u.next;f(e[l].getCurrentEvent())}),o.dragStart(r,R({container:s},i))},checkScroll:function(e,r){var t=r.datas.dragScroll;if(t){var n=e.props,a=n.scrollContainer,i=a===void 0?e.getContainer():a,o=n.scrollThreshold,s=o===void 0?0:o,l=n.scrollThrottleTime,c=l===void 0?0:l,u=n.getScrollPosition,f=u===void 0?bp:u,d=n.scrollOptions;return t.drag(r,R({container:i,threshold:s,throttleTime:c,getScrollPosition:function(p){return f({scrollContainer:p.container,direction:p.direction})}},d)),!0}},drag:function(e,r){return this.checkScroll(e,r)},dragEnd:function(e,r){r.datas.dragScroll.dragEnd(),r.datas.dragScroll=null},dragControlStart:function(e,r){return this.dragStart(e,R(R({},r),{isControl:!0}))},dragControl:function(e,r){return this.drag(e,r)},dragControlEnd:function(e,r){return this.dragEnd(e,r)},dragGroupStart:function(e,r){return this.dragStart(e,R(R({},r),{targets:e.props.targets}))},dragGroup:function(e,r){return this.drag(e,R(R({},r),{targets:e.props.targets}))},dragGroupEnd:function(e,r){return this.dragEnd(e,R(R({},r),{targets:e.props.targets}))},dragGroupControlStart:function(e,r){return this.dragStart(e,R(R({},r),{targets:e.props.targets,isControl:!0}))},dragGroupControl:function(e,r){return this.drag(e,R(R({},r),{targets:e.props.targets}))},dragGroupControEnd:function(e,r){return this.dragEnd(e,R(R({},r),{targets:e.props.targets}))},unset:function(e){var r,t=e.state;(r=t.dragScroll)===null||r===void 0||r.dragEnd(),t.dragScroll=null}},zs={name:"",props:["target","dragTargetSelf","dragTarget","dragContainer","container","warpSelf","rootContainer","useResizeObserver","useMutationObserver","zoom","dragFocusedInput","transformOrigin","ables","className","pinchThreshold","pinchOutside","triggerAblesSimultaneously","checkInput","cspNonce","translateZ","hideDefaultLines","props","flushSync","stopPropagation","preventClickEventOnDrag","preventClickDefault","viewContainer","persistData","useAccuratePosition","firstRenderState","linePadding","controlPadding","preventDefault","requestStyles"],events:["changeTargets"]},Sp=Wr("padding",{props:["padding"],render:function(e,r){var t=e.props;if(t.dragArea)return[];var n=Os(t.padding||{}),a=n.left,i=n.top,o=n.right,s=n.bottom,l=e.getState(),c=l.renderPoses,u=l.pos1,f=l.pos2,d=l.pos3,p=l.pos4,v=[u,f,d,p],h=[];return a>0&&h.push([0,2]),i>0&&h.push([0,1]),o>0&&h.push([1,3]),s>0&&h.push([2,3]),h.map(function(g,m){var x=M(g,2),b=x[0],S=x[1],D=v[b],y=v[S],E=c[b],w=c[S],T=ua([0,0],[100,0],[0,100],[100,100],D,y,E,w);if(T.length)return r.createElement("div",{key:"padding".concat(m),className:nt("padding"),style:{transform:On(T,!0)}})})}}),Ei=["nw","ne","se","sw"];function nn(e,r){var t=e[0]+e[1],n=t>r?r/t:1;return e[0]*=n,e[1]=r-e[1]*n,e}var Dp=[1,2,5,6],Ep=[0,3,4,7],Ae=[1,-1,-1,1],je=[1,1,-1,-1];function Aa(e,r,t,n,a,i,o,s){a===void 0&&(a=0),i===void 0&&(i=0),o===void 0&&(o=t),s===void 0&&(s=n);var l=[],c=!1,u=e.filter(function(d){return!d.virtual}),f=u.map(function(d){var p=d.horizontal,v=d.vertical,h=d.pos;if(v&&!c&&(c=!0,l.push("/")),c){var g=Math.max(0,v===1?h[1]-i:s-h[1]);return l.push(re(g,n,r)),g}else{var g=Math.max(0,p===1?h[0]-a:o-h[0]);return l.push(re(g,t,r)),g}});return{radiusPoses:u,styles:l,raws:f}}function Ps(e){for(var r=[0,0],t=[0,0],n=e.length,a=0;a<n;++a){var i=e[a];i.sub&&(i.horizontal&&(r[1]===0&&(r[0]=a),r[1]=a-r[0]+1,t[0]=a+1),i.vertical&&(t[1]===0&&(t[0]=a),t[1]=a-t[0]+1))}return{horizontalRange:r,verticalRange:t}}function Bs(e,r,t,n,a,i,o){var s,l,c,u;i===void 0&&(i=[0,0]),o===void 0&&(o=!1);var f=e.indexOf("/"),d=(f>-1?e.slice(0,f):e).length,p=e.slice(0,d),v=e.slice(d+1),h=p.length,g=v.length,m=g>0,x=M(p,4),b=x[0],S=b===void 0?"0px":b,D=x[1],y=D===void 0?S:D,E=x[2],w=E===void 0?S:E,T=x[3],O=T===void 0?y:T,P=M(v,4),z=P[0],I=z===void 0?S:z,k=P[1],B=k===void 0?m?I:y:k,V=P[2],H=V===void 0?m?I:w:V,G=P[3],L=G===void 0?m?B:O:G,F=[S,y,w,O].map(function(q){return Ct(q,r)}),A=[I,B,H,L].map(function(q){return Ct(q,t)}),Z=F.slice(),J=A.slice();s=M(nn([Z[0],Z[1]],r),2),Z[0]=s[0],Z[1]=s[1],l=M(nn([Z[3],Z[2]],r),2),Z[3]=l[0],Z[2]=l[1],c=M(nn([J[0],J[3]],t),2),J[0]=c[0],J[3]=c[1],u=M(nn([J[1],J[2]],t),2),J[1]=u[0],J[2]=u[1];var Y=o?Z:Z.slice(0,Math.max(i[0],h)),X=o?J:J.slice(0,Math.max(i[1],g));return W(W([],M(Y.map(function(q,$){var et=Ei[$];return{virtual:$>=h,horizontal:Ae[$],vertical:0,pos:[n+q,a+(je[$]===-1?t:0)],sub:!0,raw:F[$],direction:et}})),!1),M(X.map(function(q,$){var et=Ei[$];return{virtual:$>=g,horizontal:0,vertical:je[$],pos:[n+(Ae[$]===-1?r:0),a+q],sub:!0,raw:A[$],direction:et}})),!1)}function wp(e,r,t,n,a){a===void 0&&(a=r.length);var i=Ps(e.slice(n)),o=i.horizontalRange,s=i.verticalRange,l=t-n,c=0;if(l===0)c=a;else if(l>0&&l<o[1])c=o[1]-l;else if(l>=s[0])c=s[0]+s[1]-l;else return;e.splice(t,c),r.splice(t,c)}function Rp(e,r,t,n,a,i,o,s,l,c,u){c===void 0&&(c=0),u===void 0&&(u=0);var f=Ps(e.slice(t)),d=f.horizontalRange,p=f.verticalRange;if(n>-1)for(var v=Ae[n]===1?i-c:s-i,h=d[1];h<=n;++h){var g=je[h]===1?u:l,m=0;if(n===h?m=i:h===0?m=c+v:Ae[h]===-1&&(m=s-(r[t][0]-c)),e.splice(t+h,0,{horizontal:Ae[h],vertical:0,pos:[m,g]}),r.splice(t+h,0,[m,g]),h===0)break}else if(a>-1){var x=je[a]===1?o-u:l-o;if(d[1]===0&&p[1]===0){var b=[c+x,u];e.push({horizontal:Ae[0],vertical:0,pos:b}),r.push(b)}for(var S=p[0],h=p[1];h<=a;++h){var m=Ae[h]===1?c:s,g=0;if(a===h?g=o:h===0?g=u+x:je[h]===1?g=r[t+S][1]:je[h]===-1&&(g=l-(r[t+S][1]-u)),e.push({horizontal:0,vertical:je[h],pos:[m,g]}),r.push([m,g]),h===0)break}}}function Mp(e,r){r===void 0&&(r=e.map(function(a){return a.raw}));var t=e.map(function(a,i){return a.horizontal?r[i]:null}).filter(function(a){return a!=null}),n=e.map(function(a,i){return a.vertical?r[i]:null}).filter(function(a){return a!=null});return{horizontals:t,verticals:n}}var Op=[[0,-1,"n"],[1,0,"e"]],Tp=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function ja(e,r,t){var n=e.props.clipRelative,a=e.state,i=a.width,o=a.height,s=r,l=s.type,c=s.poses,u=l==="rect",f=l==="circle";if(l==="polygon")return t.map(function(y){return"".concat(re(y[0],i,n)," ").concat(re(y[1],o,n))});if(u||l==="inset"){var d=t[1][1],p=t[3][0],v=t[7][0],h=t[5][1];if(u)return[d,p,h,v].map(function(y){return"".concat(y,"px")});var g=[d,i-p,o-h,v].map(function(y,E){return re(y,E%2?i:o,n)});if(t.length>8){var m=M(it(t[4],t[0]),2),x=m[0],b=m[1];g.push.apply(g,W(["round"],M(Aa(c.slice(8).map(function(y,E){return R(R({},y),{pos:t[E]})}),n,x,b,v,d,p,h).styles),!1))}return g}else if(f||l==="ellipse"){var S=t[0],D=re(j(t[1][1]-S[1]),f?Math.sqrt((i*i+o*o)/2):o,n),g=f?[D]:[re(j(t[2][0]-S[0]),i,n),D];return g.push("at",re(S[0],i,n),re(S[1],o,n)),g}}function mn(e,r,t,n){var a=[n,(n+r)/2,r],i=[e,(e+t)/2,t];return Tp.map(function(o){var s=M(o,3),l=s[0],c=s[1],u=s[2],f=a[l+1],d=i[c+1];return{vertical:j(c),horizontal:j(l),direction:u,pos:[f,d]}})}function ks(e){var r=[1/0,-1/0],t=[1/0,-1/0];return e.forEach(function(n){var a=n.pos;r[0]=Math.min(r[0],a[0]),r[1]=Math.max(r[1],a[0]),t[0]=Math.min(t[0],a[1]),t[1]=Math.max(t[1],a[1])}),[j(r[1]-r[0]),j(t[1]-t[0])]}function wi(e,r,t,n,a){var i,o,s,l,c,u,f,d,p;if(e){var v=a;if(!v){var h=Yt(e),g=h("clipPath");v=g!=="none"?g:h("clip")}if(!((!v||v==="none"||v==="auto")&&(v=n,!v))){var m=Hl(v),x=m.prefix,b=x===void 0?v:x,S=m.value,D=S===void 0?"":S,y=b==="circle",E=" ";if(b==="polygon"){var w=Ua(D||"0% 0%, 100% 0%, 100% 100%, 0% 100%");E=",";var T=w.map(function(Ot){var Lt=M(Ot.split(" "),2),Tt=Lt[0],St=Lt[1];return{vertical:1,horizontal:1,pos:[Ct(Tt,r),Ct(St,t)]}}),O=Lr(T.map(function(Ot){return Ot.pos}));return{type:b,clipText:v,poses:T,splitter:E,left:O.minX,right:O.maxX,top:O.minY,bottom:O.maxY}}else if(y||b==="ellipse"){var P="",z="",I=0,k=0,w=Fe(D);if(y){var B="";i=M(w,4),o=i[0],B=o===void 0?"50%":o,s=i[2],P=s===void 0?"50%":s,l=i[3],z=l===void 0?"50%":l,I=Ct(B,Math.sqrt((r*r+t*t)/2)),k=I}else{var V="",H="";c=M(w,5),u=c[0],V=u===void 0?"50%":u,f=c[1],H=f===void 0?"50%":f,d=c[3],P=d===void 0?"50%":d,p=c[4],z=p===void 0?"50%":p,I=Ct(V,r),k=Ct(H,t)}var G=[Ct(P,r),Ct(z,t)],T=W([{vertical:1,horizontal:1,pos:G,direction:"nesw"}],M(Op.slice(0,y?1:2).map(function(Tt){return{vertical:j(Tt[1]),horizontal:Tt[0],direction:Tt[2],sub:!0,pos:[G[0]+Tt[0]*I,G[1]+Tt[1]*k]}})),!1);return{type:b,clipText:v,radiusX:I,radiusY:k,left:G[0]-I,top:G[1]-k,right:G[0]+I,bottom:G[1]+k,poses:T,splitter:E}}else if(b==="inset"){var w=Fe(D||"0 0 0 0"),L=w.indexOf("round"),F=(L>-1?w.slice(0,L):w).length,A=w.slice(F+1),Z=M(w.slice(0,F),4),J=Z[0],Y=Z[1],X=Y===void 0?J:Y,q=Z[2],$=q===void 0?J:q,et=Z[3],ot=et===void 0?X:et,at=M([J,$].map(function(Tt){return Ct(Tt,t)}),2),Q=at[0],tt=at[1],gt=M([ot,X].map(function(Tt){return Ct(Tt,r)}),2),ct=gt[0],ut=gt[1],st=r-ut,bt=t-tt,vt=Bs(A,st-ct,bt-Q,ct,Q),T=W(W([],M(mn(Q,st,bt,ct)),!1),M(vt),!1);return{type:"inset",clipText:v,poses:T,top:Q,left:ct,right:st,bottom:bt,radius:A,splitter:E}}else if(b==="rect"){var w=Ua(D||"0px, ".concat(r,"px, ").concat(t,"px, 0px"));E=",";var lt=M(w.map(function(At){var Wt=pa(At).value;return Wt}),4),ht=lt[0],ut=lt[1],tt=lt[2],ct=lt[3],T=mn(ht,ut,tt,ct);return{type:"rect",clipText:v,poses:T,top:ht,right:ut,bottom:tt,left:ct,values:w,splitter:E}}}}}function Ip(e,r,t,n,a){var i=e[r],o=i.direction,s=i.sub,l=e.map(function(){return[0,0]}),c=o?o.split(""):[];if(n&&r<8){var u=c.filter(function(I){return I==="w"||I==="e"}),f=c.filter(function(I){return I==="n"||I==="s"}),d=u[0],p=f[0];l[r]=t;var v=M(ks(e),2),h=v[0],g=v[1],m=h&&g?h/g:0;if(m&&a){var x=(r+4)%8,b=e[x].pos,S=[0,0];o.indexOf("w")>-1?S[0]=-1:o.indexOf("e")>-1&&(S[0]=1),o.indexOf("n")>-1?S[1]=-1:o.indexOf("s")>-1&&(S[1]=1);var D=ws([h,g],t,m,S,!0),y=h+D[0],E=g+D[1],w=b[1],T=b[1],O=b[0],P=b[0];S[0]===-1?O=P-y:S[0]===1?P=O+y:(O=O-y/2,P=P+y/2),S[1]===-1?w=T-E:(S[1]===1||(w=T-E/2),T=w+E);var z=mn(w,P,T,O);e.forEach(function(I,k){l[k][0]=z[k].pos[0]-I.pos[0],l[k][1]=z[k].pos[1]-I.pos[1]})}else e.forEach(function(I,k){var B=I.direction;B&&(B.indexOf(d)>-1&&(l[k][0]=t[0]),B.indexOf(p)>-1&&(l[k][1]=t[1]))}),d&&(l[1][0]=t[0]/2,l[5][0]=t[0]/2),p&&(l[3][1]=t[1]/2,l[7][1]=t[1]/2)}else o&&!s?c.forEach(function(I){var k=I==="n"||I==="s";e.forEach(function(B,V){var H=B.direction,G=B.horizontal,L=B.vertical;!H||H.indexOf(I)===-1||(l[V]=[k||!G?0:t[0],!k||!L?0:t[1]])})}):l[r]=t;return l}function zp(e,r){var t=M(Ao(e,r),2),n=t[0],a=t[1],i=r.datas,o=i.clipPath,s=i.clipIndex,l=o,c=l.type,u=l.poses,f=l.splitter,d=u.map(function(x){return x.pos});if(c==="polygon")d.splice(s,0,[n,a]);else if(c==="inset"){var p=Dp.indexOf(s),v=Ep.indexOf(s),h=u.length;if(Rp(u,d,8,p,v,n,a,d[4][0],d[4][1],d[0][0],d[0][1]),h===u.length)return}else return;var g=ja(e,o,d),m="".concat(c,"(").concat(g.join(f),")");K(e,"onClip",dt(e,r,R({clipEventType:"added",clipType:c,poses:d,clipStyles:g,clipStyle:m,distX:0,distY:0},Ht({clipPath:m},r))))}function Pp(e,r){var t=r.datas,n=t.clipPath,a=t.clipIndex,i=n,o=i.type,s=i.poses,l=i.splitter,c=s.map(function(p){return p.pos}),u=c.length;if(o==="polygon")s.splice(a,1),c.splice(a,1);else if(o==="inset"){if(a<8||(wp(s,c,a,8,u),u===s.length))return}else return;var f=ja(e,n,c),d="".concat(o,"(").concat(f.join(l),")");K(e,"onClip",dt(e,r,R({clipEventType:"removed",clipType:o,poses:c,clipStyles:f,clipStyle:d,distX:0,distY:0},Ht({clipPath:d},r))))}var Bp={name:"clippable",props:["clippable","defaultClipPath","customClipPath","keepRatio","clipRelative","clipArea","dragWithClip","clipTargetBounds","clipVerticalGuidelines","clipHorizontalGuidelines","clipSnapThreshold"],events:["clipStart","clip","clipEnd"],css:[`.control.clip-control {
background: #6d6;
cursor: pointer;
}
.control.clip-control.clip-radius {
background: #d66;
}
.line.clip-line {
background: #6e6;
cursor: move;
z-index: 1;
}
.clip-area {
position: absolute;
top: 0;
left: 0;
}
.clip-ellipse {
position: absolute;
cursor: move;
border: 1px solid #6d6;
border: var(--zoompx) solid #6d6;
border-radius: 50%;
transform-origin: 0px 0px;
}`,`:host {
--bounds-color: #d66;
}`,`.guideline {
pointer-events: none;
z-index: 2;
}`,`.line.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}`],render:function(e,r){var t=e.props,n=t.customClipPath,a=t.defaultClipPath,i=t.clipArea,o=t.zoom,s=t.groupable,l=e.getState(),c=l.target,u=l.width,f=l.height,d=l.allMatrix,p=l.is3d,v=l.left,h=l.top,g=l.pos1,m=l.pos2,x=l.pos3,b=l.pos4,S=l.clipPathState,D=l.snapBoundInfos,y=l.rotation;if(!c||s)return[];var E=wi(c,u,f,a||"inset",S||n);if(!E)return[];var w=p?4:3,T=E.type,O=E.poses,P=O.map(function(ut){var st=Dt(d,ut.pos,w);return[st[0]-v,st[1]-h]}),z=[],I=[],k=T==="rect",B=T==="inset",V=T==="polygon";if(k||B||V){var H=B?P.slice(0,8):P;I=H.map(function(ut,st){var bt=st===0?H[H.length-1]:H[st-1],vt=kt(bt,ut),lt=hs(bt,ut);return r.createElement("div",{key:"clipLine".concat(st),className:nt("line","clip-line","snap-control"),"data-clip-index":st,style:{width:"".concat(lt,"px"),transform:"translate(".concat(bt[0],"px, ").concat(bt[1],"px) rotate(").concat(vt,"rad) scaleY(").concat(o,")")}})})}if(z=P.map(function(ut,st){return r.createElement("div",{key:"clipControl".concat(st),className:nt("control","clip-control","snap-control"),"data-clip-index":st,style:{transform:"translate(".concat(ut[0],"px, ").concat(ut[1],"px) rotate(").concat(y,"rad) scale(").concat(o,")")}})}),B&&z.push.apply(z,W([],M(P.slice(8).map(function(ut,st){return r.createElement("div",{key:"clipRadiusControl".concat(st),className:nt("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+st,style:{transform:"translate(".concat(ut[0],"px, ").concat(ut[1],"px) rotate(").concat(y,"rad) scale(").concat(o,")")}})})),!1)),T==="circle"||T==="ellipse"){var G=E.left,L=E.top,F=E.radiusX,A=E.radiusY,Z=M(it(Dt(d,[G,L],w),Dt(d,[0,0],w)),2),J=Z[0],Y=Z[1],X="none";if(!i){for(var q=Math.max(10,F/5,A/5),$=[],et=0;et<=q;++et){var ot=Math.PI*2/q*et;$.push([F+(F-o)*Math.cos(ot),A+(A-o)*Math.sin(ot)])}$.push([F,-2]),$.push([-2,-2]),$.push([-2,A*2+2]),$.push([F*2+2,A*2+2]),$.push([F*2+2,-2]),$.push([F,-2]),X="polygon(".concat($.map(function(ut){return"".concat(ut[0],"px ").concat(ut[1],"px")}).join(", "),")")}z.push(r.createElement("div",{key:"clipEllipse",className:nt("clip-ellipse","snap-control"),style:{width:"".concat(F*2,"px"),height:"".concat(A*2,"px"),clipPath:X,transform:"translate(".concat(-v+J,"px, ").concat(-h+Y,"px) ").concat(On(d))}}))}if(i){var at=Zt(W([g,m,x,b],M(P),!1)),Q=at.width,tt=at.height,gt=at.left,ct=at.top;if(V||k||B){var $=B?P.slice(0,8):P;z.push(r.createElement("div",{key:"clipArea",className:nt("clip-area","snap-control"),style:{width:"".concat(Q,"px"),height:"".concat(tt,"px"),transform:"translate(".concat(gt,"px, ").concat(ct,"px)"),clipPath:"polygon(".concat($.map(function(st){return"".concat(st[0]-gt,"px ").concat(st[1]-ct,"px")}).join(", "),")")}}))}}return D&&["vertical","horizontal"].forEach(function(ut){var st=D[ut],bt=ut==="horizontal";st.isSnap&&I.push.apply(I,W([],M(st.snap.posInfos.map(function(vt,lt){var ht=vt.pos,Ot=it(Dt(d,bt?[0,ht]:[ht,0],w),[v,h]),Lt=it(Dt(d,bt?[u,ht]:[ht,f],w),[v,h]);return Gr(r,"",Ot,Lt,o,"clip".concat(ut,"snap").concat(lt),"guideline")})),!1)),st.isBound&&I.push.apply(I,W([],M(st.bounds.map(function(vt,lt){var ht=vt.pos,Ot=it(Dt(d,bt?[0,ht]:[ht,0],w),[v,h]),Lt=it(Dt(d,bt?[u,ht]:[ht,f],w),[v,h]);return Gr(r,"",Ot,Lt,o,"clip".concat(ut,"bounds").concat(lt),"guideline","bounds","bold")})),!1))}),W(W([],M(z),!1),M(I),!1)},dragControlCondition:function(e,r){return r.inputEvent&&(r.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(e,r){var t=e.props,n=t.dragWithClip,a=n===void 0?!0:n;return a?!1:this.dragControlStart(e,r)},drag:function(e,r){return this.dragControl(e,R(R({},r),{isDragTarget:!0}))},dragEnd:function(e,r){return this.dragControlEnd(e,r)},dragControlStart:function(e,r){var t=e.state,n=e.props,a=n.defaultClipPath,i=n.customClipPath,o=t.target,s=t.width,l=t.height,c=r.inputEvent?r.inputEvent.target:null,u=c&&c.getAttribute("class")||"",f=r.datas,d=wi(o,s,l,a||"inset",i);if(!d)return!1;var p=d.clipText,v=d.type,h=d.poses,g=K(e,"onClipStart",dt(e,r,{clipType:v,clipStyle:p,poses:h.map(function(m){return m.pos})}));return g===!1?(f.isClipStart=!1,!1):(f.isControl=u&&u.indexOf("clip-control")>-1,f.isLine=u.indexOf("clip-line")>-1,f.isArea=u.indexOf("clip-area")>-1||u.indexOf("clip-ellipse")>-1,f.clipIndex=c?parseInt(c.getAttribute("data-clip-index"),10):-1,f.clipPath=d,f.isClipStart=!0,t.clipPathState=p,Xe(e,r),!0)},dragControl:function(e,r){var t,n,a,i=r.datas,o=r.originalDatas,s=r.isDragTarget;if(!i.isClipStart)return!1;var l=i,c=l.isControl,u=l.isLine,f=l.isArea,d=l.clipIndex,p=l.clipPath;if(!p)return!1;var v=qe(e.props,"clippable"),h=v.keepRatio,g=0,m=0,x=o.draggable,b=ve(r);s&&x?(t=M(x.prevBeforeDist,2),g=t[0],m=t[1]):(n=M(b,2),g=n[0],m=n[1]);var S=[g,m],D=e.state,y=D.width,E=D.height,w=!f&&!c&&!u,T=p.type,O=p.poses,P=p.splitter,z=O.map(function(yt){return yt.pos});w&&(g=-g,m=-m);var I=!c||O[d].direction==="nesw",k=T==="inset"||T==="rect",B=O.map(function(){return[0,0]});if(c&&!I){var V=O[d],H=V.horizontal,G=V.vertical,L=[g*j(H),m*j(G)];B=Ip(O,d,L,k,h)}else I&&(B=z.map(function(){return[g,m]}));var F=z.map(function(yt,Mt){return xt(yt,B[Mt])}),A=W([],M(F),!1);D.snapBoundInfos=null;var Z=p.type==="circle",J=p.type==="ellipse";if(Z||J){var Y=Zt(F),X=j(Y.bottom-Y.top),q=j(J?Y.right-Y.left:X),$=F[0][1]+X,et=F[0][0]-q,ot=F[0][0]+q;Z&&(A.push([ot,Y.bottom]),B.push([1,0])),A.push([Y.left,$]),B.push([0,1]),A.push([et,Y.bottom]),B.push([1,0])}var at=ss((v.clipHorizontalGuidelines||[]).map(function(yt){return Ct("".concat(yt),E)}),(v.clipVerticalGuidelines||[]).map(function(yt){return Ct("".concat(yt),y)}),y,E),Q=[],tt=[];if(Z||J)Q=[A[4][0],A[2][0]],tt=[A[1][1],A[3][1]];else if(k){var gt=[A[0],A[2],A[4],A[6]],ct=[B[0],B[2],B[4],B[6]];Q=gt.filter(function(yt,Mt){return ct[Mt][0]}).map(function(yt){return yt[0]}),tt=gt.filter(function(yt,Mt){return ct[Mt][1]}).map(function(yt){return yt[1]})}else Q=A.filter(function(yt,Mt){return B[Mt][0]}).map(function(yt){return yt[0]}),tt=A.filter(function(yt,Mt){return B[Mt][1]}).map(function(yt){return yt[1]});var ut=[0,0],st=ui(at,v.clipTargetBounds&&{left:0,top:0,right:y,bottom:E},Q,tt,5),bt=st.horizontal,vt=st.vertical,lt=bt.offset,ht=vt.offset;if(bt.isBound&&(ut[1]+=lt),vt.isBound&&(ut[0]+=ht),(J||Z)&&B[0][0]===0&&B[0][1]===0){var Y=Zt(F),Ot=Y.bottom-Y.top,Lt=J?Y.right-Y.left:Ot,Tt=vt.isBound?j(ht):vt.snapIndex===0?-ht:ht,St=bt.isBound?j(lt):bt.snapIndex===0?-lt:lt;Lt-=Tt,Ot-=St,Z&&(Ot=Qo(vt,bt)>0?Ot:Lt,Lt=Ot);var Rt=A[0];A[1][1]=Rt[1]-Ot,A[2][0]=Rt[0]+Lt,A[3][1]=Rt[1]+Ot,A[4][0]=Rt[0]-Lt}else if(k&&h&&c){var At=M(ks(O),2),Wt=At[0],hr=At[1],ze=Wt&&hr?Wt/hr:0,Pe=O[d],Be=Pe.direction||"",ke=A[1][1],$=A[5][1],et=A[7][0],ot=A[3][0];j(lt)<=j(ht)?lt=Jt(lt)*j(ht)/ze:ht=Jt(ht)*j(lt)*ze,Be.indexOf("w")>-1?et-=ht:Be.indexOf("e")>-1?ot-=ht:(et+=ht/2,ot-=ht/2),Be.indexOf("n")>-1?ke-=lt:Be.indexOf("s")>-1?$-=lt:(ke+=lt/2,$-=lt/2);var gr=mn(ke,ot,$,et);A.forEach(function(ee,ge){var Kt;Kt=M(gr[ge].pos,2),ee[0]=Kt[0],ee[1]=Kt[1]})}else A.forEach(function(yt,Mt){var se=B[Mt];se[0]&&(yt[0]-=ht),se[1]&&(yt[1]-=lt)});var mr=ja(e,p,F),xr="".concat(T,"(").concat(mr.join(P),")");if(D.clipPathState=xr,Z||J)Q=[A[4][0],A[2][0]],tt=[A[1][1],A[3][1]];else if(k){var gt=[A[0],A[2],A[4],A[6]];Q=gt.map(function(Mt){return Mt[0]}),tt=gt.map(function(Mt){return Mt[1]})}else Q=A.map(function(yt){return yt[0]}),tt=A.map(function(yt){return yt[1]});if(D.snapBoundInfos=ui(at,v.clipTargetBounds&&{left:0,top:0,right:y,bottom:E},Q,tt,1),x){var In=D.is3d,Ut=D.allMatrix,he=In?4:3,$t=ut;s&&($t=[S[0]+ut[0]-b[0],S[1]+ut[1]-b[1]]),x.deltaOffset=Bt(Ut,[$t[0],$t[1],0,0],he)}return K(e,"onClip",dt(e,r,R({clipEventType:"changed",clipType:T,poses:F,clipStyle:xr,clipStyles:mr,distX:g,distY:m},Ht((a={},a[T==="rect"?"clip":"clipPath"]=xr,a),r)))),!0},dragControlEnd:function(e,r){this.unset(e);var t=r.isDrag,n=r.datas,a=r.isDouble,i=n.isLine,o=n.isClipStart,s=n.isControl;return o?(K(e,"onClipEnd",Xt(e,r,{})),a&&(s?Pp(e,r):i&&zp(e,r)),a||t):!1},unset:function(e){e.state.clipPathState="",e.state.snapBoundInfos=null}},kp={name:"originDraggable",props:["originDraggable","originRelative"],events:["dragOriginStart","dragOrigin","dragOriginEnd"],css:[`:host[data-able-origindraggable] .control.origin {
pointer-events: auto;
}`],dragControlCondition:function(e,r){return r.isRequest?r.requestAble==="originDraggable":It(r.inputEvent.target,nt("origin"))},dragControlStart:function(e,r){var t=r.datas;Xe(e,r);var n=dt(e,r,{dragStart:jt.dragStart(e,new or().dragStart([0,0],r))}),a=K(e,"onDragOriginStart",n);return t.startOrigin=e.state.transformOrigin,t.startTargetOrigin=e.state.targetOrigin,t.prevOrigin=[0,0],t.isDragOrigin=!0,a===!1?(t.isDragOrigin=!1,!1):n},dragControl:function(e,r){var t=r.datas,n=r.isPinch,a=r.isRequest;if(!t.isDragOrigin)return!1;var i=M(ve(r),2),o=i[0],s=i[1],l=e.state,c=l.width,u=l.height,f=l.offsetMatrix,d=l.targetMatrix,p=l.is3d,v=e.props.originRelative,h=v===void 0?!0:v,g=p?4:3,m=[o,s];if(a){var x=r.distOrigin;(x[0]||x[1])&&(m=x)}var b=xt(t.startOrigin,m),S=xt(t.startTargetOrigin,m),D=it(m,t.prevOrigin),y=Yr(f,d,b,g),E=e.getRect(),w=Zt(Ue(y,c,u,g)),T=[E.left-w.left,E.top-w.top];t.prevOrigin=m;var O=[re(S[0],c,h),re(S[1],u,h)].join(" "),P=jt.drag(e,qr(r,e.state,T,!!n,!1)),z=dt(e,r,R(R({width:c,height:u,origin:b,dist:m,delta:D,transformOrigin:O,drag:P},Ht({transformOrigin:O,transform:P.transform},r)),{afterTransform:P.transform}));return K(e,"onDragOrigin",z),z},dragControlEnd:function(e,r){var t=r.datas;return t.isDragOrigin?(K(e,"onDragOriginEnd",Xt(e,r,{})),!0):!1},dragGroupControlCondition:function(e,r){return this.dragControlCondition(e,r)},dragGroupControlStart:function(e,r){var t=this.dragControlStart(e,r);return!!t},dragGroupControl:function(e,r){var t=this.dragControl(e,r);return t?(e.transformOrigin=t.transformOrigin,!0):!1},request:function(e){var r={},t=e.getRect(),n=0,a=0,i=t.transformOrigin,o=[0,0];return{isControl:!0,requestStart:function(){return{datas:r}},request:function(s){return"deltaOrigin"in s?(o[0]+=s.deltaOrigin[0],o[1]+=s.deltaOrigin[1]):"origin"in s?(o[0]=s.origin[0]-i[0],o[1]=s.origin[1]-i[1]):("x"in s?n=s.x-t.left:"deltaX"in s&&(n+=s.deltaX),"y"in s?a=s.y-t.top:"deltaY"in s&&(a+=s.deltaY)),{datas:r,distX:n,distY:a,distOrigin:o}},requestEnd:function(){return{datas:r,isDrag:!0}}}}};function Lp(e,r,t,n){var a=e.filter(function(l){var c=l.virtual,u=l.horizontal;return u&&!c}).length,i=e.filter(function(l){var c=l.virtual,u=l.vertical;return u&&!c}).length,o=-1;if(r===0&&(a===0?o=0:a===1&&(o=1)),r===2&&(a<=2?o=2:a<=3&&(o=3)),r===3&&(i===0?o=4:i<4&&(o=7)),r===1&&(i<=1?o=5:i<=2&&(o=6)),!(o===-1||!e[o].virtual)){var s=e[o];_p(e,o),o<4?s.pos[0]=t:s.pos[1]=n}}function _p(e,r){r<4?e.slice(0,r+1).forEach(function(t){t.virtual=!1}):(e[0].virtual&&(e[0].virtual=!1),e.slice(4,r+1).forEach(function(t){t.virtual=!1}))}function Np(e,r){r<4?e.slice(r,4).forEach(function(t){t.virtual=!0}):e.slice(r).forEach(function(t){t.virtual=!0})}function Ri(e,r,t,n,a){n===void 0&&(n=[0,0]);var i=[];return!e||e==="0px"?i=[]:i=Fe(e),Bs(i,r,t,0,0,n,a)}function Mi(e,r,t,n,a){var i=e.state,o=i.width,s=i.height,l=Aa(a,e.props.roundRelative,o,s),c=l.raws,u=l.styles,f=l.radiusPoses,d=Mp(f,c),p=d.horizontals,v=d.verticals,h=u.join(" ");i.borderRadiusState=h;var g=dt(e,r,R({horizontals:p,verticals:v,borderRadius:h,width:o,height:s,delta:n,dist:t},Ht({borderRadius:h},r)));return K(e,"onRound",g),g}function Oi(e){var r,t,n=e.getState().style,a=n.borderRadius||"";if(!a&&e.props.groupable){var i=e.moveables[0],o=e.getTargets()[0];o&&((i==null?void 0:i.props.target)===o?(a=(t=(r=e.moveables[0])===null||r===void 0?void 0:r.state.style.borderRadius)!==null&&t!==void 0?t:"",n.borderRadius=a):(a=ka(o).borderRadius,n.borderRadius=a))}return a}var Gp={name:"roundable",props:["roundable","roundRelative","minRoundControls","maxRoundControls","roundClickable","roundPadding","isDisplayShadowRoundControls"],events:["roundStart","round","roundEnd","roundGroupStart","roundGroup","roundGroupEnd"],css:[`.control.border-radius {
background: #d66;
cursor: pointer;
z-index: 3;
}`,`.control.border-radius.vertical {
background: #d6d;
z-index: 2;
}`,`.control.border-radius.virtual {
opacity: 0.5;
z-index: 1;
}`,`:host.round-line-clickable .line.direction {
cursor: pointer;
}`],className:function(e){var r=e.props.roundClickable;return r===!0||r==="line"?nt("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},requestChildStyle:function(){return["borderRadius"]},render:function(e,r){var t=e.getState(),n=t.target,a=t.width,i=t.height,o=t.allMatrix,s=t.is3d,l=t.left,c=t.top,u=t.borderRadiusState,f=e.props,d=f.minRoundControls,p=d===void 0?[0,0]:d,v=f.maxRoundControls,h=v===void 0?[4,4]:v,g=f.zoom,m=f.roundPadding,x=m===void 0?0:m,b=f.isDisplayShadowRoundControls,S=f.groupable;if(!n)return null;var D=u||Oi(e),y=s?4:3,E=Ri(D,a,i,p,!0);if(!E)return null;var w=0,T=0,O=S?[0,0]:[l,c];return E.map(function(P,z){var I=P.horizontal,k=P.vertical,B=P.direction||"",V=W([],M(P.pos),!1);T+=Math.abs(I),w+=Math.abs(k),I&&B.indexOf("n")>-1&&(V[1]-=x),k&&B.indexOf("w")>-1&&(V[0]-=x),I&&B.indexOf("s")>-1&&(V[1]+=x),k&&B.indexOf("e")>-1&&(V[0]+=x);var H=it(Dt(o,V,y),O),G=P.vertical?w<=h[1]&&(b||!P.virtual):T<=h[0]&&(b||!P.virtual);return r.createElement("div",{key:"borderRadiusControl".concat(z),className:nt("control","border-radius",P.vertical?"vertical":"",P.virtual?"virtual":""),"data-radius-index":z,style:{display:G?"block":"none",transform:"translate(".concat(H[0],"px, ").concat(H[1],"px) scale(").concat(g,")")}})})},dragControlCondition:function(e,r){if(!r.inputEvent||r.isRequest)return!1;var t=r.inputEvent.target.getAttribute("class")||"";return t.indexOf("border-radius")>-1||t.indexOf("moveable-line")>-1&&t.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(e,r){return this.dragControlCondition(e,r)},dragControlStart:function(e,r){var t=r.inputEvent,n=r.datas,a=t.target,i=a.getAttribute("class")||"",o=i.indexOf("border-radius")>-1,s=i.indexOf("moveable-line")>-1&&i.indexOf("moveable-direction")>-1,l=o?parseInt(a.getAttribute("data-radius-index"),10):-1,c=-1;if(s){var u=a.getAttribute("data-line-key")||"";u&&(c=parseInt(u.replace(/render-line-/g,""),10),isNaN(c)&&(c=-1))}if(!o&&!s)return!1;var f=dt(e,r,{}),d=K(e,"onRoundStart",f);if(d===!1)return!1;n.lineIndex=c,n.controlIndex=l,n.isControl=o,n.isLine=s,Xe(e,r);var p=e.props,v=p.roundRelative,h=p.minRoundControls,g=h===void 0?[0,0]:h,m=e.state,x=m.width,b=m.height;n.isRound=!0,n.prevDist=[0,0];var S=Oi(e),D=Ri(S||"",x,b,g,!0)||[];return n.controlPoses=D,m.borderRadiusState=Aa(D,v,x,b).styles.join(" "),f},dragControl:function(e,r){var t=r.datas,n=t.controlPoses;if(!t.isRound||!t.isControl||!n.length)return!1;var a=t.controlIndex,i=M(ve(r),2),o=i[0],s=i[1],l=[o,s],c=it(l,t.prevDist),u=e.props.maxRoundControls,f=u===void 0?[4,4]:u,d=e.state,p=d.width,v=d.height,h=n[a],g=h.vertical,m=h.horizontal,x=n.map(function(S){var D=S.horizontal,y=S.vertical,E=[D*m*l[0],y*g*l[1]];if(D){if(f[0]===1)return E;if(f[0]<4&&D!==m)return E}else{if(f[1]===0)return E[1]=y*m*l[0]/p*v,E;if(g){if(f[1]===1)return E;if(f[1]<4&&y!==g)return E}}return[0,0]});x[a]=l;var b=n.map(function(S,D){return R(R({},S),{pos:xt(S.pos,x[D])})});return a<4?b.slice(0,a+1).forEach(function(S){S.virtual=!1}):b.slice(4,a+1).forEach(function(S){S.virtual=!1}),t.prevDist=[o,s],Mi(e,r,l,c,b)},dragControlEnd:function(e,r){var t=e.state;t.borderRadiusState="";var n=r.datas,a=r.isDouble;if(!n.isRound)return!1;var i=n.isControl,o=n.controlIndex,s=n.isLine,l=n.lineIndex,c=n.controlPoses,u=c.filter(function(m){var x=m.virtual;return x}).length,f=e.props.roundClickable,d=f===void 0?!0:f;if(a&&d){if(i&&(d===!0||d==="control"))Np(c,o);else if(s&&(d===!0||d==="line")){var p=M(Ao(e,r),2),v=p[0],h=p[1];Lp(c,l,v,h)}u!==c.filter(function(m){var x=m.virtual;return x}).length&&Mi(e,r,[0,0],[0,0],c)}var g=Xt(e,r,{});return K(e,"onRoundEnd",g),t.borderRadiusState="",g},dragGroupControlStart:function(e,r){var t=this.dragControlStart(e,r);if(!t)return!1;var n=e.moveables,a=e.props.targets,i=ne(e,"roundable",r),o=R({targets:e.props.targets,events:i.map(function(s,l){return R(R({},s),{target:a[l],moveable:n[l],currentTarget:n[l]})})},t);return K(e,"onRoundGroupStart",o),t},dragGroupControl:function(e,r){var t=this.dragControl(e,r);if(!t)return!1;var n=e.moveables,a=e.props.targets,i=ne(e,"roundable",r),o=R({targets:e.props.targets,events:i.map(function(s,l){return R(R(R({},s),{target:a[l],moveable:n[l],currentTarget:n[l]}),Ht({borderRadius:t.borderRadius},s))})},t);return K(e,"onRoundGroup",o),o},dragGroupControlEnd:function(e,r){var t=e.moveables,n=e.props.targets,a=ne(e,"roundable",r);Tn(e,"onRound",function(s){var l=R({targets:e.props.targets,events:a.map(function(c,u){return R(R(R({},c),{target:n[u],moveable:t[u],currentTarget:t[u]}),Ht({borderRadius:s.borderRadius},c))})},s);K(e,"onRoundGroup",l)});var i=this.dragControlEnd(e,r);if(!i)return!1;var o=R({targets:e.props.targets,events:a.map(function(s,l){var c;return R(R({},s),{target:n[l],moveable:t[l],currentTarget:t[l],lastEvent:(c=s.datas)===null||c===void 0?void 0:c.lastEvent})})},i);return K(e,"onRoundGroupEnd",o),o},unset:function(e){e.state.borderRadiusState=""}};function Ap(e,r){var t=r?4:3,n=_t(t),a="matrix".concat(r?"3d":"","(").concat(n.join(","),")");return e===a||e==="matrix(1,0,0,1,0,0)"}var Ls={isPinch:!0,name:"beforeRenderable",props:[],events:["beforeRenderStart","beforeRender","beforeRenderEnd","beforeRenderGroupStart","beforeRenderGroup","beforeRenderGroupEnd"],dragRelation:"weak",setTransform:function(e,r){var t=e.state,n=t.is3d,a=t.targetMatrix,i=t.inlineTransform,o=n?"matrix3d(".concat(a.join(","),")"):"matrix(".concat(Hi(a,!0),")"),s=!i||i==="none"?o:i;r.datas.startTransforms=Ap(s,n)?[]:Fe(s)},resetStyle:function(e){var r=e.datas;r.nextStyle={},r.nextTransforms=e.datas.startTransforms,r.nextTransformAppendedIndexes=[]},fillDragStartParams:function(e,r){return dt(e,r,{setTransform:function(t){r.datas.startTransforms=Gt(t)?t:Fe(t)},isPinch:!!r.isPinch})},fillDragParams:function(e,r){return dt(e,r,{isPinch:!!r.isPinch})},dragStart:function(e,r){this.setTransform(e,r),this.resetStyle(r),K(e,"onBeforeRenderStart",this.fillDragStartParams(e,r))},drag:function(e,r){r.datas.startTransforms||this.setTransform(e,r),this.resetStyle(r),K(e,"onBeforeRender",dt(e,r,{isPinch:!!r.isPinch}))},dragEnd:function(e,r){r.datas.startTransforms||(this.setTransform(e,r),this.resetStyle(r)),K(e,"onBeforeRenderEnd",dt(e,r,{isPinch:!!r.isPinch,isDrag:r.isDrag}))},dragGroupStart:function(e,r){var t=this;this.dragStart(e,r);var n=ne(e,"beforeRenderable",r),a=e.moveables,i=n.map(function(o,s){var l=a[s];return t.setTransform(l,o),t.resetStyle(o),t.fillDragStartParams(l,o)});K(e,"onBeforeRenderGroupStart",dt(e,r,{isPinch:!!r.isPinch,targets:e.props.targets,setTransform:function(){},events:i}))},dragGroup:function(e,r){var t=this;this.drag(e,r);var n=ne(e,"beforeRenderable",r),a=e.moveables,i=n.map(function(o,s){var l=a[s];return t.resetStyle(o),t.fillDragParams(l,o)});K(e,"onBeforeRenderGroup",dt(e,r,{isPinch:!!r.isPinch,targets:e.props.targets,events:i}))},dragGroupEnd:function(e,r){this.dragEnd(e,r),K(e,"onBeforeRenderGroupEnd",dt(e,r,{isPinch:!!r.isPinch,isDrag:r.isDrag,targets:e.props.targets}))},dragControlStart:function(e,r){return this.dragStart(e,r)},dragControl:function(e,r){return this.drag(e,r)},dragControlEnd:function(e,r){return this.dragEnd(e,r)},dragGroupControlStart:function(e,r){return this.dragGroupStart(e,r)},dragGroupControl:function(e,r){return this.dragGroup(e,r)},dragGroupControlEnd:function(e,r){return this.dragGroupEnd(e,r)}},_s={name:"renderable",props:[],events:["renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd"],dragRelation:"weak",dragStart:function(e,r){K(e,"onRenderStart",dt(e,r,{isPinch:!!r.isPinch}))},drag:function(e,r){K(e,"onRender",this.fillDragParams(e,r))},dragAfter:function(e,r){return this.drag(e,r)},dragEnd:function(e,r){K(e,"onRenderEnd",this.fillDragEndParams(e,r))},dragGroupStart:function(e,r){K(e,"onRenderGroupStart",dt(e,r,{isPinch:!!r.isPinch,targets:e.props.targets}))},dragGroup:function(e,r){var t=this,n=ne(e,"beforeRenderable",r),a=e.moveables,i=n.map(function(o,s){var l=a[s];return t.fillDragParams(l,o)});K(e,"onRenderGroup",dt(e,r,R(R({isPinch:!!r.isPinch,targets:e.props.targets,transform:Kr(r),transformObject:{}},Ht(Jr(r))),{events:i})))},dragGroupEnd:function(e,r){var t=this,n=ne(e,"beforeRenderable",r),a=e.moveables,i=n.map(function(o,s){var l=a[s];return t.fillDragEndParams(l,o)});K(e,"onRenderGroupEnd",dt(e,r,R({isPinch:!!r.isPinch,isDrag:r.isDrag,targets:e.props.targets,events:i,transformObject:{},transform:Kr(r)},Ht(Jr(r)))))},dragControlStart:function(e,r){return this.dragStart(e,r)},dragControl:function(e,r){return this.drag(e,r)},dragControlAfter:function(e,r){return this.dragAfter(e,r)},dragControlEnd:function(e,r){return this.dragEnd(e,r)},dragGroupControlStart:function(e,r){return this.dragGroupStart(e,r)},dragGroupControl:function(e,r){return this.dragGroup(e,r)},dragGroupControlEnd:function(e,r){return this.dragGroupEnd(e,r)},fillDragParams:function(e,r){var t={};return kr(un(r)||[]).forEach(function(n){t[n.name]=n.functionValue}),dt(e,r,R({isPinch:!!r.isPinch,transformObject:t,transform:Kr(r)},Ht(Jr(r))))},fillDragEndParams:function(e,r){var t={};return kr(un(r)||[]).forEach(function(n){t[n.name]=n.functionValue}),dt(e,r,R({isPinch:!!r.isPinch,isDrag:r.isDrag,transformObject:t,transform:Kr(r)},Ht(Jr(r))))}};function Tr(e,r,t,n,a,i,o){i.clientDistX=i.distX,i.clientDistY=i.distY;var s=a==="Start",l=a==="End",c=a==="After",u=e.state.target,f=i.isRequest,d=n.indexOf("Control")>-1;if(!u||s&&d&&!f&&e.areaElement===i.inputEvent.target)return!1;var p=W([],M(r),!1);if(f){var v=i.requestAble;p.some(function(z){return z.name===v})||p.push.apply(p,W([],M(e.props.ables.filter(function(z){return z.name===v})),!1))}if(!p.length||p.every(function(z){return z.dragRelation}))return!1;var h=i.inputEvent,g;l&&h&&(g=document.elementFromPoint(i.clientX,i.clientY)||h.target);var m=!1,x=function(){var z;m=!0,(z=i.stop)===null||z===void 0||z.call(i)},b=s&&(!e.targetGesto||!e.controlGesto||!e.targetGesto.isFlag()||!e.controlGesto.isFlag());b&&e.updateRect(a,!0,!1);var S=i.datas,D=d?"controlGesto":"targetGesto",y=e[D],E=function(z,I,k){if(!(I in z)||y!==e[D])return!1;var B=z.name,V=S[B]||(S[B]={});if(s&&(V.isEventStart=!k||!z[k]||z[k](e,i)),!V.isEventStart)return!1;var H=z[I](e,R(R({},i),{stop:x,datas:V,originalDatas:S,inputTarget:g}));return e._emitter.off(),s&&H===!1&&(V.isEventStart=!1),H};b&&p.forEach(function(z){z.unset&&z.unset(e)}),E(Ls,"drag".concat(n).concat(a));var w=0,T=0;t.forEach(function(z){if(m)return!1;var I="".concat(z).concat(n).concat(a),k="".concat(z).concat(n,"Condition");a===""&&!f&&Es(e.state,i);var B=p.filter(function(G){return G[I]});B=B.filter(function(G,L){return G.name&&B.indexOf(G)===L});var V=B.filter(function(G){return E(G,I,k)}),H=V.length;m&&++w,H&&++T,!m&&s&&B.length&&!H&&(w+=B.filter(function(G){var L=G.name,F=S[L];return F.isEventStart?G.dragRelation!=="strong":!1}).length?1:0)}),(!c||T)&&E(_s,"drag".concat(n).concat(a));var O=y!==e[D]||w===t.length;if((l||m||O)&&(e.state.gestos={},e.moveables&&e.moveables.forEach(function(z){z.state.gestos={}}),p.forEach(function(z){z.unset&&z.unset(e)})),s&&!O&&!f&&T&&e.props.preventDefault&&(i==null||i.preventDefault()),e.isUnmounted||O)return!1;if(!s&&T&&!o||l){var P=e.props.flushSync||ds;P(function(){e.updateRect(l?a:"",!0,!1),e.forceUpdate()})}return!s&&!l&&!c&&T&&!o&&Tr(e,r,t,n,a+"After",i),!0}function aa(e){return function(r){var t,n=r.inputEvent.target,a=e.areaElement,i=e._dragTarget;return!i||!((t=e.controlGesto)===null||t===void 0)&&t.isFlag()?!1:n===i||i.contains(n)||n===a||!e.isMoveableElement(n)&&!e.controlBox.contains(n)||It(n,"moveable-area")||It(n,"moveable-padding")||It(n,"moveable-edgeDraggable")}}function Ns(e,r,t){var n=e.controlBox,a=[],i=e.props,o=i.dragArea,s=e.state.target,l=i.dragTarget;return a.push(n),(!o||l)&&a.push(r),!o&&l&&s&&r!==s&&i.dragTargetSelf&&a.push(s),Ha(e,a,"targetAbles",t,{dragStart:aa(e),pinchStart:aa(e)})}function Ha(e,r,t,n,a){a===void 0&&(a={});var i=t==="targetAbles",o=e.props,s=o.pinchOutside,l=o.pinchThreshold,c=o.preventClickEventOnDrag,u=o.preventClickDefault,f=o.checkInput,d=o.dragFocusedInput,p=o.preventDefault,v=p===void 0?!0:p,h=o.dragContainer,g=de(h,!0),m={preventDefault:v,preventRightClick:!0,preventWheelClick:!0,container:g||_r(e.getControlBoxElement()),pinchThreshold:l,pinchOutside:s,preventClickEventOnDrag:i?c:!1,preventClickEventOnDragStart:i?u:!1,preventClickEventByCondition:i?null:function(S){return e.controlBox.contains(S.target)},checkInput:i?f:!1,dragFocusedInput:d},x=new Ul(r,m),b=n==="Control";return["drag","pinch"].forEach(function(S){["Start","","End"].forEach(function(D){x.on("".concat(S).concat(D),function(y){var E,w=y.eventType,T=S==="drag"&&y.isPinch;if(a[w]&&!a[w](y)){y.stop();return}if(!T){var O=S==="drag"?[S]:["drag",S],P=W([],M(e[t]),!1),z=Tr(e,P,O,n,D,y);z?(e.props.stopPropagation||D==="Start"&&b)&&((E=y==null?void 0:y.inputEvent)===null||E===void 0||E.stopPropagation()):y.stop()}})})}),x}var jp=function(){function e(r,t,n){var a=this;this.target=r,this.moveable=t,this.eventName=n,this.ables=[],this._onEvent=function(i){var o=a.eventName,s=a.moveable;s.state.disableNativeEvent||a.ables.forEach(function(l){l[o](s,{inputEvent:i})})},r.addEventListener(n.toLowerCase(),this._onEvent)}return e.prototype.setAbles=function(r){this.ables=r},e.prototype.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},e}();function Hp(e,r,t,n){var a;t===void 0&&(t=r);var i=qo(e,r),o=i.matrixes,s=i.is3d,l=i.targetMatrix,c=i.transformOrigin,u=i.targetOrigin,f=i.offsetContainer,d=i.hasFixed,p=i.zoom,v=rd(f,t),h=v.matrixes,g=v.is3d,m=v.offsetContainer,x=v.zoom,b=n||g||s,S=b?4:3,D=e.tagName.toLowerCase()!=="svg"&&"ownerSVGElement"in e,y=l,E=_t(S),w=_t(S),T=_t(S),O=_t(S),P=o.length,z=h.map(function(L){return R(R({},L),{matrix:L.matrix?W([],M(L.matrix),!1):void 0})}).reverse();o.reverse(),!s&&b&&(y=pe(y,3,4),ta(o)),!g&&b&&ta(z),z.forEach(function(L){w=Bt(w,L.matrix,S)});var I=t||Ie(e),k=((a=z[0])===null||a===void 0?void 0:a.target)||Ar(I,I,!0).offsetParent,B=z.slice(1).reduce(function(L,F){return Bt(L,F.matrix,S)},_t(S));o.forEach(function(L,F){if(P-2===F&&(T=E.slice()),P-1===F&&(O=E.slice()),!L.matrix){var A=o[F+1],Z=ap(L,A,k,S,Bt(B,E,S));L.matrix=We(Z,S)}E=Bt(E,L.matrix,S)});var V=!D&&s;y||(y=_t(V?4:3));var H=On(D&&y.length===16?pe(y,4,3):y,V),G=w;return w=Vi(w,S,S),{hasZoom:p!==1||x!==1,hasFixed:d,matrixes:o,rootMatrix:w,originalRootMatrix:G,beforeMatrix:T,offsetMatrix:O,allMatrix:E,targetMatrix:y,targetTransform:H,inlineTransform:e.style.transform,transformOrigin:c,targetOrigin:u,is3d:b,offsetContainer:f,offsetRootContainer:m}}function Vp(e,r,t,n){t===void 0&&(t=r);var a=0,i=0,o=0,s={},l=gs(e);if(e&&(a=l.offsetWidth,i=l.offsetHeight),e){var c=Hp(e,r,t,n),u=rr(c.allMatrix,c.transformOrigin,a,i);s=R(R({},c),u);var f=rr(c.allMatrix,[50,50],100,100);o=ms([f.pos1,f.pos2],f.direction)}var d=n?4:3;return R(R(R({hasZoom:!1,width:a,height:i,rotation:o},l),{originalRootMatrix:_t(d),rootMatrix:_t(d),beforeMatrix:_t(d),offsetMatrix:_t(d),allMatrix:_t(d),targetMatrix:_t(d),targetTransform:"",inlineTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!!n,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null,matrixes:[]}),s)}function ia(e,r,t,n,a,i){i===void 0&&(i=[]);var o=1,s=[0,0],l=Qr(),c=Qr(),u=Qr(),f=Qr(),d=[0,0],p={},v=Vp(r,t,a,!0);if(r){var h=Yt(r);i.forEach(function(z){p[z]=h(z)});var g=v.is3d?4:3,m=rr(v.offsetMatrix,xt(v.transformOrigin,Xi(v.targetMatrix,g)),v.width,v.height);o=m.direction,s=xt(m.origin,[m.left-v.left,m.top-v.top]),f=Or(v.offsetRootContainer);var x=Ar(n,n,!0).offsetParent||v.offsetRootContainer;if(v.hasZoom){var b=rr(Bt(v.originalRootMatrix,v.allMatrix),v.transformOrigin,v.width,v.height),S=rr(v.originalRootMatrix,vn(Yt(x)("transformOrigin")).map(function(z){return parseFloat(z)}),x.offsetWidth,x.offsetHeight);if(l=Nn(b,f),u=Nn(S,f,x,!0),e){var D=b.left,y=b.top;c=Nn({left:D,top:y,bottom:y,right:y},f)}}else{l=Or(r),u=ed(x),e&&(c=Or(e));var E=u.left,w=u.top,T=u.clientLeft,O=u.clientTop,P=[l.left-E,l.top-w];d=it(cr(v.rootMatrix,P,4),[T+v.left,O+v.top])}}return R({targetClientRect:l,containerClientRect:u,moveableClientRect:c,rootContainerClientRect:f,beforeDirection:o,beforeOrigin:s,originalBeforeOrigin:s,target:r,style:p,offsetDelta:d},v)}function Ti(e){var r=e.pos1,t=e.pos2,n=e.pos3,a=e.pos4;if(!r||!t||!n||!a)return null;var i=Lr([r,t,n,a]),o=[i.minX,i.minY],s=it(e.origin,o);return r=it(r,o),t=it(t,o),n=it(n,o),a=it(a,o),R(R({},e),{left:e.left,top:e.top,posDelta:o,pos1:r,pos2:t,pos3:n,pos4:a,origin:s,beforeOrigin:s,isPersisted:!0})}var ur=function(e){Fr(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.state=R({container:null,gestos:{},renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},ia(null)),t.renderState={},t.enabledAbles=[],t.targetAbles=[],t.controlAbles=[],t.rotation=0,t.scale=[1,1],t.isMoveableMounted=!1,t.isUnmounted=!1,t.events={mouseEnter:null,mouseLeave:null},t._emitter=new Vl,t._prevOriginalDragTarget=null,t._originalDragTarget=null,t._prevDragTarget=null,t._dragTarget=null,t._prevPropTarget=null,t._propTarget=null,t._prevDragArea=!1,t._isPropTargetChanged=!1,t._hasFirstTarget=!1,t._reiszeObserver=null,t._observerId=0,t._mutationObserver=null,t._rootContainer=null,t._viewContainer=null,t._viewClassNames=[],t._store={},t.checkUpdateRect=function(){if(!t.isDragging()){var n=t.props.parentMoveable;if(n){n.checkUpdateRect();return}Fl(t._observerId),t._observerId=Wi(function(){t.isDragging()||t.updateRect()})}},t._onPreventClick=function(n){n.stopPropagation(),n.preventDefault()},t}return r.prototype.render=function(){var t=this.props,n=this.getState(),a=t.parentPosition,i=t.className,o=t.target,s=t.zoom,l=t.cspNonce,c=t.translateZ,u=t.cssStyled,f=t.groupable,d=t.linePadding,p=t.controlPadding;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var v=M(a||[0,0],2),h=v[0],g=v[1],m=n.left,x=n.top,b=n.target,S=n.direction,D=n.hasFixed,y=n.offsetDelta,E=t.targets,w=this.isDragging(),T={};this.getEnabledAbles().forEach(function(B){T["data-able-".concat(B.name.toLowerCase())]=!0});var O=this._getAbleClassName(),P=E&&E.length&&(b||f)||o||!this._hasFirstTarget&&this.state.isPersisted,z=this.controlBox||this.props.firstRenderState||this.props.persistData,I=[m-h,x-g];!f&&t.useAccuratePosition&&(I[0]+=y[0],I[1]+=y[1]);var k={position:D?"fixed":"absolute",display:P?"block":"none",visibility:z?"visible":"hidden",transform:"translate3d(".concat(I[0],"px, ").concat(I[1],"px, ").concat(c,")"),"--zoom":s,"--zoompx":"".concat(s,"px")};return d&&(k["--moveable-line-padding"]=d),p&&(k["--moveable-control-padding"]=p),_.createElement(u,R({cspNonce:l,ref:we(this,"controlBox"),className:"".concat(nt("control-box",S===-1?"reverse":"",w?"dragging":"")," ").concat(O," ").concat(i)},T,{onClick:this._onPreventClick,style:k}),this.renderAbles(),this._renderLines())},r.prototype.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1;var t=this.props,n=t.parentMoveable,a=t.container;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),!a&&!n&&!this.state.isPersisted&&(this.updateRect("",!1,!1),this.forceUpdate())},r.prototype.componentDidUpdate=function(t){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateTargets(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(t)},r.prototype.componentWillUnmount=function(){var t,n;this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off(),(t=this._reiszeObserver)===null||t===void 0||t.disconnect(),(n=this._mutationObserver)===null||n===void 0||n.disconnect();var a=this._viewContainer;a&&this._changeAbleViewClassNames([]),tr(this,!1),tr(this,!0);var i=this.events;for(var o in i){var s=i[o];s&&s.destroy()}},r.prototype.getTargets=function(){var t=this.props.target;return t?[t]:[]},r.prototype.getAble=function(t){var n=this.props.ables||[];return Re(n,function(a){return a.name===t})},r.prototype.getContainer=function(){var t=this.props,n=t.parentMoveable,a=t.wrapperMoveable,i=t.container;return i||a&&a.getContainer()||n&&n.getContainer()||this.controlBox.parentElement},r.prototype.getControlBoxElement=function(){return this.controlBox},r.prototype.getDragElement=function(){return this._dragTarget},r.prototype.isMoveableElement=function(t){var n;return t&&(((n=t.getAttribute)===null||n===void 0?void 0:n.call(t,"class"))||"").indexOf(Sa)>-1},r.prototype.dragStart=function(t){var n=this.targetGesto,a=this.controlGesto;return n&&aa(this)({inputEvent:t})?n.isFlag()||n.triggerDragStart(t):a&&this.isMoveableElement(t.target)&&(a.isFlag()||a.triggerDragStart(t)),this},r.prototype.hitTest=function(t){var n=this.state,a=n.target,i=n.pos1,o=n.pos2,s=n.pos3,l=n.pos4,c=n.targetClientRect;if(!a)return 0;var u;if(da(t)){var f=t.getBoundingClientRect();u={left:f.left,top:f.top,width:f.width,height:f.height}}else u=R({width:0,height:0},t);var d=u.left,p=u.top,v=u.width,h=u.height,g=$a([i,o,l,s],c),m=Wl(g,[[d,p],[d+v,p],[d+v,p+h],[d,p+h]]),x=ql(g);return!m||!x?0:Math.min(100,m/x*100)},r.prototype.isInside=function(t,n){var a=this.state,i=a.target,o=a.pos1,s=a.pos2,l=a.pos3,c=a.pos4,u=a.targetClientRect;return i?Yl([t,n],$a([o,s,c,l],u)):!1},r.prototype.updateRect=function(t,n,a){a===void 0&&(a=!0);var i=this.props,o=!i.parentPosition&&!i.wrapperMoveable;o&&sr(!0);var s=i.parentMoveable,l=this.state,c=l.target||i.target,u=this.getContainer(),f=s?s._rootContainer:this._rootContainer,d=ia(this.controlBox,c,u,u,f||u,this._getRequestStyles());if(!c&&this._hasFirstTarget&&i.persistData){var p=Ti(i.persistData);for(var v in p)d[v]=p[v]}o&&sr(),this.updateState(d,s?!1:a)},r.prototype.isDragging=function(t){var n,a,i=this.targetGesto,o=this.controlGesto;if(i!=null&&i.isFlag()){if(!t)return!0;var s=i.getEventData();return!!(!((n=s[t])===null||n===void 0)&&n.isEventStart)}if(o!=null&&o.isFlag()){if(!t)return!0;var s=o.getEventData();return!!(!((a=s[t])===null||a===void 0)&&a.isEventStart)}return!1},r.prototype.updateTarget=function(t){this.updateRect(t,!0)},r.prototype.getRect=function(){var t=this.state,n=te(this.state),a=M(n,4),i=a[0],o=a[1],s=a[2],l=a[3],c=Zt(n),u=t.width,f=t.height,d=c.width,p=c.height,v=c.left,h=c.top,g=[t.left,t.top],m=xt(g,t.origin),x=xt(g,t.beforeOrigin),b=t.transformOrigin;return{width:d,height:p,left:v,top:h,pos1:i,pos2:o,pos3:s,pos4:l,offsetWidth:u,offsetHeight:f,beforeOrigin:x,origin:m,transformOrigin:b,rotation:this.getRotation()}},r.prototype.getManager=function(){return this},r.prototype.stopDrag=function(t){if(!t||t==="target"){var n=this.targetGesto;(n==null?void 0:n.isIdle())===!1&&ea(this,!1),n==null||n.stop()}if(!t||t==="control"){var n=this.controlGesto;(n==null?void 0:n.isIdle())===!1&&ea(this,!0),n==null||n.stop()}},r.prototype.getRotation=function(){var t=this.state,n=t.pos1,a=t.pos2,i=t.direction;return fp(n,a,i)},r.prototype.request=function(t,n,a){n===void 0&&(n={});var i=this,o=i.props,s=o.parentMoveable||o.wrapperMoveable||i,l=s.props.ables,c=o.groupable,u=Re(l,function(m){return m.name===t});if(this.isDragging()||!u||!u.request)return{request:function(){return this},requestEnd:function(){return this}};var f=u.request(i),d=a||n.isInstant,p=f.isControl?"controlAbles":"targetAbles",v="".concat(c?"Group":"").concat(f.isControl?"Control":""),h=W([],M(s[p]),!1),g={request:function(m){return Tr(i,h,["drag"],v,"",R(R({},f.request(m)),{requestAble:t,isRequest:!0}),d),g},requestEnd:function(){return Tr(i,h,["drag"],v,"End",R(R({},f.requestEnd()),{requestAble:t,isRequest:!0}),d),g}};return Tr(i,h,["drag"],v,"Start",R(R({},f.requestStart(n)),{requestAble:t,isRequest:!0}),d),d?g.request(n).requestEnd():g},r.prototype.getMoveables=function(){return[this]},r.prototype.destroy=function(){this.componentWillUnmount()},r.prototype.updateRenderPoses=function(){var t=this.getState(),n=this.props,a=n.padding,i=t.originalBeforeOrigin,o=t.transformOrigin,s=t.allMatrix,l=t.is3d,c=t.pos1,u=t.pos2,f=t.pos3,d=t.pos4,p=t.left,v=t.top,h=t.isPersisted;if(!a){t.renderPoses=[c,u,f,d];return}var g=Os(a),m=g.left,x=g.top,b=g.bottom,S=g.right,D=l?4:3,y=[];h?y=o:this.controlBox&&n.groupable?y=i:y=xt(i,[p,v]);var E=cn(D,We(y.map(function(w){return-w}),D),s,We(o,D));t.renderPoses=[en(E,c,[-m,-x],D),en(E,u,[S,-x],D),en(E,f,[-m,b],D),en(E,d,[S,b],D)]},r.prototype.checkUpdate=function(){this._isPropTargetChanged=!1;var t=this.props,n=t.target,a=t.container,i=t.parentMoveable,o=this.state,s=o.target,l=o.container;if(!(!s&&!n)){this.updateAbles();var c=!ra(s,n),u=c||!ra(l,a);if(u){var f=a||this.controlBox;f&&this.unsetAbles(),this.updateState({target:n,container:a}),!i&&f&&this.updateRect("End",!1,!1),this._isPropTargetChanged=c}}},r.prototype.waitToChangeTarget=function(){return new Promise(function(){})},r.prototype.triggerEvent=function(t,n){var a=this.props;if(this._emitter.trigger(t,n),a.parentMoveable&&n.isRequest&&!n.isRequestChild)return a.parentMoveable.triggerEvent(t,n,!0);var i=a[t];return i&&i(n)},r.prototype.useCSS=function(t,n){var a=this.props.customStyledMap,i=t+n;return a[i]||(a[i]=Bo(t,n)),a[i]},r.prototype.getState=function(){var t,n=this.props;(n.target||!((t=n.targets)===null||t===void 0)&&t.length)&&(this._hasFirstTarget=!0);var a=this.controlBox,i=n.persistData,o=n.firstRenderState;if(o&&!a)return o;if(!this._hasFirstTarget&&i){var s=Ti(i);if(s)return this.updateState(s,!1),this.state}return this.state.isPersisted=!1,this.state},r.prototype.updateSelectors=function(){},r.prototype.unsetAbles=function(){var t=this;this.targetAbles.forEach(function(n){n.unset&&n.unset(t)})},r.prototype.updateAbles=function(t,n){t===void 0&&(t=this.props.ables),n===void 0&&(n="");var a=this.props,i=a.triggerAblesSimultaneously,o=this.getEnabledAbles(t),s="drag".concat(n,"Start"),l="pinch".concat(n,"Start"),c="drag".concat(n,"ControlStart"),u=tn(o,[s,l],i),f=tn(o,[c],i);this.enabledAbles=o,this.targetAbles=u,this.controlAbles=f},r.prototype.updateState=function(t,n){if(n){if(this.isUnmounted)return;this.setState(t)}else{var a=this.state;for(var i in t)a[i]=t[i]}},r.prototype.getEnabledAbles=function(t){t===void 0&&(t=this.props.ables);var n=this.props;return t.filter(function(a){return a&&(a.always&&n[a.name]!==!1||n[a.name])})},r.prototype.renderAbles=function(){var t=this,n=this.props,a=n.triggerAblesSimultaneously,i={createElement:_.createElement};return this.renderState={},lp(Ds(tn(this.getEnabledAbles(),["render"],a).map(function(o){var s=o.render;return s(t,i)||[]})).filter(function(o){return o}),function(o){var s=o.key;return s}).map(function(o){return o[0]})},r.prototype.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},r.prototype._getRequestStyles=function(){var t=this.getEnabledAbles().reduce(function(n,a){var i,o,s=(o=(i=a.requestStyle)===null||i===void 0?void 0:i.call(a))!==null&&o!==void 0?o:[];return W(W([],M(n),!1),M(s),!1)},W([],M(this.props.requestStyles||[]),!1));return t},r.prototype._updateObserver=function(t){this._updateResizeObserver(t),this._updateMutationObserver(t)},r.prototype._updateEvents=function(){var t=this.controlBox,n=this.targetAbles.length,a=this.controlAbles.length,i=this._dragTarget,o=!n&&this.targetGesto||this._isTargetChanged(!0);o&&(tr(this,!1),this.updateState({gestos:{}})),a||tr(this,!0),i&&n&&!this.targetGesto&&(this.targetGesto=Ns(this,i,"")),!this.controlGesto&&a&&(this.controlGesto=Ha(this,t,"controlAbles","Control"))},r.prototype._updateTargets=function(){var t=this.props;this._prevPropTarget=this._propTarget,this._prevDragTarget=this._dragTarget,this._prevOriginalDragTarget=this._originalDragTarget,this._prevDragArea=t.dragArea,this._propTarget=t.target,this._originalDragTarget=t.dragTarget||t.target,this._dragTarget=de(this._originalDragTarget,!0)},r.prototype._renderLines=function(){var t=this.props,n=t,a=n.zoom,i=n.hideDefaultLines,o=n.hideChildMoveableDefaultLines,s=n.parentMoveable;if(i||s&&o)return[];var l=this.getState().renderPoses,c={createElement:_.createElement};return[[0,1],[1,3],[3,2],[2,0]].map(function(u,f){var d=M(u,2),p=d[0],v=d[1];return Gr(c,"",l[p],l[v],a,"render-line-".concat(f))})},r.prototype._isTargetChanged=function(t){var n=this.props,a=n.dragTarget||n.target,i=this._prevOriginalDragTarget,o=this._prevDragArea,s=n.dragArea,l=!s&&i!==a,c=(t||s)&&o!==s;return l||c||this._prevPropTarget!=this._propTarget},r.prototype._updateNativeEvents=function(){var t=this,n=this.props,a=n.dragArea?this.areaElement:this.state.target,i=this.events,o=fr(i);if(this._isTargetChanged())for(var s in i){var l=i[s];l&&l.destroy(),i[s]=null}if(a){var c=this.enabledAbles;o.forEach(function(u){var f=tn(c,[u]),d=f.length>0,p=i[u];if(!d){p&&(p.destroy(),i[u]=null);return}p||(p=new jp(a,t,u),i[u]=p),p.setAbles(f)})}},r.prototype._checkUpdateRootContainer=function(){var t=this.props.rootContainer;!this._rootContainer&&t&&(this._rootContainer=de(t,!0))},r.prototype._checkUpdateViewContainer=function(){var t=this.props.viewContainer;!this._viewContainer&&t&&(this._viewContainer=de(t,!0));var n=this._viewContainer;n&&this._changeAbleViewClassNames(W(W([],M(this._getAbleViewClassNames()),!1),[this.isDragging()?xp:""],!1))},r.prototype._changeAbleViewClassNames=function(t){var n=this._viewContainer,a=Ss(t.filter(Boolean),function(c){return c}).map(function(c){var u=M(c,1),f=u[0];return f}),i=this._viewClassNames,o=Xl(i,a),s=o.removed,l=o.added;s.forEach(function(c){Ui(n,i[c])}),l.forEach(function(c){Fi(n,a[c])}),this._viewClassNames=a},r.prototype._getAbleViewClassNames=function(){var t=this;return(this.getEnabledAbles().map(function(n){var a;return((a=n.viewClassName)===null||a===void 0?void 0:a.call(n,t))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},r.prototype._getAbleClassName=function(t){var n=this;t===void 0&&(t="");var a=this.getEnabledAbles(),i=this.targetGesto,o=this.controlGesto,s=i!=null&&i.isFlag()?i.getEventData():{},l=o!=null&&o.isFlag()?o.getEventData():{};return a.map(function(c){var u,f,d,p=c.name,v=((u=c.className)===null||u===void 0?void 0:u.call(c,n))||"";return(!((f=s[p])===null||f===void 0)&&f.isEventStart||!((d=l[p])===null||d===void 0)&&d.isEventStart)&&(v+=" ".concat(nt("".concat(p).concat(t,"-dragging")))),v.trim()}).filter(Boolean).join(" ")},r.prototype._updateResizeObserver=function(t){var n,a=this.props,i=a.target,o=_r(this.getControlBoxElement());if(!o.ResizeObserver||!i||!a.useResizeObserver){(n=this._reiszeObserver)===null||n===void 0||n.disconnect();return}if(!(t.target===i&&this._reiszeObserver)){var s=new o.ResizeObserver(this.checkUpdateRect);s.observe(i,{box:"border-box"}),this._reiszeObserver=s}},r.prototype._updateMutationObserver=function(t){var n=this,a,i=this.props,o=i.target,s=_r(this.getControlBoxElement());if(!s.MutationObserver||!o||!i.useMutationObserver){(a=this._mutationObserver)===null||a===void 0||a.disconnect();return}if(!(t.target===o&&this._mutationObserver)){var l=new s.MutationObserver(function(c){var u,f;try{for(var d=Df(c),p=d.next();!p.done;p=d.next()){var v=p.value;v.type==="attributes"&&v.attributeName==="style"&&n.checkUpdateRect()}}catch(h){u={error:h}}finally{try{p&&!p.done&&(f=d.return)&&f.call(d)}finally{if(u)throw u.error}}});l.observe(o,{attributes:!0}),this._mutationObserver=l}},r.defaultProps={dragTargetSelf:!1,target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,warpSelf:!1,svgOrigin:"",dragContainer:null,useResizeObserver:!1,useMutationObserver:!1,preventDefault:!0,linePadding:0,controlPadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,dragFocusedInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:ds,firstRenderState:null,persistData:null,viewContainer:null,requestStyles:[],useAccuratePosition:!1},r}(_.PureComponent),Va={name:"groupable",props:["defaultGroupRotate","useDefaultGroupRotate","defaultGroupOrigin","groupable","groupableProps","targetGroups","hideChildMoveableDefaultLines"],events:[],render:function(e,r){var t,n=e.props,a=n.targets||[],i=e.getState(),o=i.left,s=i.top,l=i.isPersisted,c=n.zoom||1,u=e.renderGroupRects,f=((t=n.persistData)===null||t===void 0?void 0:t.children)||[];l?a=f.map(function(){return null}):f=[];var d=er(e,"parentPosition",[o,s],function(v){return v.join(",")}),p=er(e,"requestStyles",e.getRequestChildStyles(),function(v){return v.join(",")});return e.moveables=e.moveables.slice(0,a.length),W(W([],M(a.map(function(v,h){return r.createElement(ur,{key:"moveable"+h,ref:qi(e,"moveables",h),target:v,origin:!1,requestStyles:p,cssStyled:n.cssStyled,customStyledMap:n.customStyledMap,useResizeObserver:n.useResizeObserver,useMutationObserver:n.useMutationObserver,hideChildMoveableDefaultLines:n.hideChildMoveableDefaultLines,parentMoveable:e,parentPosition:[o,s],persistData:f[h],zoom:c})})),!1),M(Ds(u.map(function(v,h){var g=v.pos1,m=v.pos2,x=v.pos3,b=v.pos4,S=[g,m,x,b];return[[0,1],[1,3],[3,2],[2,0]].map(function(D,y){var E=M(D,2),w=E[0],T=E[1];return Gr(r,"",it(S[w],d),it(S[T],d),c,"group-rect-".concat(h,"-").concat(y))})}))),!1)}},Fp=Wr("clickable",{props:["clickable"],events:["click","clickGroup"],always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(e,r){r.datas.inputTarget=r.inputEvent&&r.inputEvent.target},dragEnd:function(e,r){var t=e.props.target,n=r.inputEvent,a=r.inputTarget,i=e.isMoveableElement(a),o=!i&&e.controlBox.contains(a);if(!(!n||!a||r.isDrag||e.isMoveableElement(a)||o)){var s=t.contains(a);K(e,"onClick",dt(e,r,{isDouble:r.isDouble,inputTarget:a,isTarget:t===a,moveableTarget:e.props.target,containsTarget:s}))}},dragGroupEnd:function(e,r){var t=r.inputEvent,n=r.inputTarget;if(!(!t||!n||r.isDrag||e.isMoveableElement(n)||r.datas.inputTarget===n)){var a=e.props.targets,i=a.indexOf(n),o=i>-1,s=!1;i===-1&&(i=zr(a,function(l){return l.contains(n)}),s=i>-1),K(e,"onClickGroup",dt(e,r,{isDouble:r.isDouble,targets:a,inputTarget:n,targetIndex:i,isTarget:o,containsTarget:s,moveableTarget:a[i]}))}},dragControlEnd:function(e,r){this.dragEnd(e,r)},dragGroupControlEnd:function(e,r){this.dragEnd(e,r)}});function Ke(e){var r=e.originalDatas.draggable;return r||(e.originalDatas.draggable={},r=e.originalDatas.draggable),R(R({},e),{datas:r})}var Wp=Wr("edgeDraggable",{css:[`.edge.edgeDraggable.line {
cursor: move;
}`],render:function(e,r){var t=e.props,n=t.edgeDraggable;return n?Uo(r,"edgeDraggable",n,e.getState().renderPoses,t.zoom):[]},dragCondition:function(e,r){var t,n=e.props,a=(t=r.inputEvent)===null||t===void 0?void 0:t.target;return!n.edgeDraggable||!a?!1:!n.draggable&&It(a,nt("direction"))&&It(a,nt("edge"))&&It(a,nt("edgeDraggable"))},dragStart:function(e,r){return jt.dragStart(e,Ke(r))},drag:function(e,r){return jt.drag(e,Ke(r))},dragEnd:function(e,r){return jt.dragEnd(e,Ke(r))},dragGroupCondition:function(e,r){var t,n=e.props,a=(t=r.inputEvent)===null||t===void 0?void 0:t.target;return!n.edgeDraggable||!a?!1:!n.draggable&&It(a,nt("direction"))&&It(a,nt("line"))},dragGroupStart:function(e,r){return jt.dragGroupStart(e,Ke(r))},dragGroup:function(e,r){return jt.dragGroup(e,Ke(r))},dragGroupEnd:function(e,r){return jt.dragGroupEnd(e,Ke(r))},unset:function(e){return jt.unset(e)}}),Gs={name:"individualGroupable",props:["individualGroupable","individualGroupableProps"],events:[]},qp=[Ls,zs,Ud,pp,jt,Wp,Jn,vp,gp,zd,Cp,Sp,yp,kp,Bp,Gp,Va,Gs,Fp,Is,_s];function Ii(e,r){var t=M(e,3),n=t[0],a=t[1],i=t[2];return(n*r[0]+a*r[1]+i)/Math.sqrt(n*n+a*a)}function an(e,r){var t=M(e,2),n=t[0],a=t[1];return-n*r[0]-a*r[1]}function zi(e,r){return Math.max.apply(Math,W([],M(e.map(function(t){var n=M(t,4),a=n[0],i=n[1],o=n[2],s=n[3];return Math.max(a[r],i[r],o[r],s[r])})),!1))}function Pi(e,r){return Math.min.apply(Math,W([],M(e.map(function(t){var n=M(t,4),a=n[0],i=n[1],o=n[2],s=n[3];return Math.min(a[r],i[r],o[r],s[r])})),!1))}function Yp(e,r){var t,n,a,i=[0,0],o=[0,0],s=[0,0],l=[0,0],c=0,u=0;if(!e.length)return{pos1:i,pos2:o,pos3:s,pos4:l,minX:0,minY:0,maxX:0,maxY:0,width:c,height:u,rotation:r};var f=mt(r,Vt);if(f%90){var d=f/180*Math.PI,p=Math.tan(d),v=-1/p,h=[Xn,ri],g=[[0,0],[0,0]],m=[Xn,ri],x=[[0,0],[0,0]];e.forEach(function(J){J.forEach(function(Y){var X=Ii([-p,1,0],Y),q=Ii([-v,1,0],Y);h[0]>X&&(g[0]=Y,h[0]=X),h[1]<X&&(g[1]=Y,h[1]=X),m[0]>q&&(x[0]=Y,m[0]=q),m[1]<q&&(x[1]=Y,m[1]=q)})});var b=M(g,2),S=b[0],D=b[1],y=M(x,2),E=y[0],w=y[1],T=[-p,1,an([-p,1],S)],O=[-p,1,an([-p,1],D)],P=[-v,1,an([-v,1],E)],z=[-v,1,an([-v,1],w)];t=M([[T,P],[T,z],[O,P],[O,z]].map(function(J){var Y=M(J,2),X=Y[0],q=Y[1];return $l(X,q)[0]}),4),i=t[0],o=t[1],s=t[2],l=t[3],c=m[1]-m[0],u=h[1]-h[0]}else{var I=Pi(e,0),k=Pi(e,1),B=zi(e,0),V=zi(e,1);if(i=[I,k],o=[B,k],s=[I,V],l=[B,V],c=B-I,u=V-k,f%180){var H=[s,i,l,o];n=M(H,4),i=n[0],o=n[1],s=n[2],l=n[3],c=V-k,u=B-I}}if(f%360>180){var H=[l,s,o,i];a=M(H,4),i=a[0],o=a[1],s=a[2],l=a[3]}var G=Lr([i,o,s,l]),L=G.minX,F=G.minY,A=G.maxX,Z=G.maxY;return{pos1:i,pos2:o,pos3:s,pos4:l,width:c,height:u,minX:L,minY:F,maxX:A,maxY:Z,rotation:r}}function As(e,r){var t=r.map(function(n){if(Gt(n)){var a=As(e,n),i=a.length;return i>1?a:i===1?a[0]:null}else{var o=Re(e,function(s){var l=s.manager;return l.props.target===n});return o?(o.finded=!0,o.manager):null}}).filter(Boolean);return t.length===1&&Gt(t[0])?t[0]:t}var Xp=function(e){Fr(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.differ=new Yi,t.moveables=[],t.transformOrigin="50% 50%",t.renderGroupRects=[],t._targetGroups=[],t._hasFirstTargets=!1,t}return r.prototype.componentDidMount=function(){e.prototype.componentDidMount.call(this)},r.prototype.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},r.prototype.getTargets=function(){return this.props.targets},r.prototype.updateRect=function(t,n,a){var i;a===void 0&&(a=!0);var o=this.state;if(!this.controlBox||o.isPersisted)return;sr(!0),this.moveables.forEach(function(et){et.updateRect(t,!1,!1)});var s=this.props,l=this.moveables,c=o.target||s.target,u=l.map(function(et){return{finded:!1,manager:et}}),f=this.props.targetGroups||[],d=As(u,f),p=s.useDefaultGroupRotate;d.push.apply(d,W([],M(u.filter(function(et){var ot=et.finded;return!ot}).map(function(et){var ot=et.manager;return ot})),!1));var v=[],h=!n||t!==""&&s.updateGroup,g=s.defaultGroupRotate||0;if(!this._hasFirstTargets){var m=(i=s.persistData)===null||i===void 0?void 0:i.rotation;m!=null&&(g=m)}function x(et,ot,at){var Q=et.map(function(vt){if(Gt(vt)){var lt=x(vt,ot),ht=[lt.pos1,lt.pos2,lt.pos3,lt.pos4];return v.push(lt),{poses:ht,rotation:lt.rotation}}else return{poses:te(vt.state),rotation:vt.getRotation()}}),tt=Q.map(function(vt){var lt=vt.rotation;return lt}),gt=0,ct=tt[0],ut=tt.every(function(vt){return Math.abs(ct-vt)<.1});h?gt=!p&&ut?ct:g:gt=!p&&!at&&ut?ct:ot;var st=Q.map(function(vt){var lt=vt.poses;return lt}),bt=Yp(st,gt);return bt}var b=x(d,this.rotation,!0);h&&(this.rotation=b.rotation,this.transformOrigin=s.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=f,this.renderGroupRects=v;var S=this.transformOrigin,D=this.rotation,y=this.scale,E=b.width,w=b.height,T=b.minX,O=b.minY,P=dp([[0,0],[E,0],[0,w],[E,w]],Ga(S,E,w),this.rotation/180*Math.PI),z=Lr(P.result),I=z.minX,k=z.minY,B=" rotate(".concat(D,"deg)")+" scale(".concat(Jt(y[0]),", ").concat(Jt(y[1]),")"),V="translate(".concat(-I,"px, ").concat(-k,"px)").concat(B);this.controlBox.style.transform="translate3d(".concat(T,"px, ").concat(O,"px, ").concat(this.props.translateZ||0,")"),c.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(S,";")+"width:".concat(E,"px;height:").concat(w,"px;")+"transform: ".concat(V),o.width=E,o.height=w;var H=this.getContainer(),G=ia(this.controlBox,c,this.controlBox,this.getContainer(),this._rootContainer||H,[]),L=[G.left,G.top],F=M(te(G),4),A=F[0],Z=F[1],J=F[2],Y=F[3],X=Lr([A,Z,J,Y]),q=[X.minX,X.minY],$=Jt(y[0]*y[1]);G.pos1=it(A,q),G.pos2=it(Z,q),G.pos3=it(J,q),G.pos4=it(Y,q),G.left=T-G.left+q[0],G.top=O-G.top+q[1],G.origin=it(xt(L,G.origin),q),G.beforeOrigin=it(xt(L,G.beforeOrigin),q),G.originalBeforeOrigin=xt(L,G.originalBeforeOrigin),G.transformOrigin=it(xt(L,G.transformOrigin),q),c.style.transform="translate(".concat(-I-q[0],"px, ").concat(-k-q[1],"px)")+B,sr(),this.updateState(R(R({},G),{posDelta:q,direction:$,beforeDirection:$}),a)},r.prototype.getRect=function(){return R(R({},e.prototype.getRect.call(this)),{children:this.moveables.map(function(t){return t.getRect()})})},r.prototype.triggerEvent=function(t,n,a){if(a||t.indexOf("Group")>-1)return e.prototype.triggerEvent.call(this,t,n);this._emitter.trigger(t,n)},r.prototype.getRequestChildStyles=function(){var t=this.getEnabledAbles().reduce(function(n,a){var i,o,s=(o=(i=a.requestChildStyle)===null||i===void 0?void 0:i.call(a))!==null&&o!==void 0?o:[];return W(W([],M(n),!1),M(s),!1)},[]);return t},r.prototype.getMoveables=function(){return W([],M(this.moveables),!1)},r.prototype.updateAbles=function(){e.prototype.updateAbles.call(this,W(W([],M(this.props.ables),!1),[Va],!1),"Group")},r.prototype._updateTargets=function(){e.prototype._updateTargets.call(this),this._originalDragTarget=this.props.dragTarget||this.areaElement,this._dragTarget=de(this._originalDragTarget,!0)},r.prototype._updateEvents=function(){var t=this.state,n=this.props,a=this._prevDragTarget,i=n.dragTarget||this.areaElement,o=n.targets,s=this.differ.update(o),l=s.added,c=s.changed,u=s.removed,f=l.length||u.length;(f||this._prevOriginalDragTarget!==this._originalDragTarget)&&(tr(this,!1),tr(this,!0),this.updateState({gestos:{}})),a!==i&&(t.target=null),t.target||(t.target=this.areaElement,this.controlBox.style.display="block"),t.target&&(this.targetGesto||(this.targetGesto=Ns(this,this._dragTarget,"Group")),this.controlGesto||(this.controlGesto=Ha(this,this.controlBox,"controlAbles","GroupControl")));var d=!ra(t.container,n.container);d&&(t.container=n.container),(d||f||this.transformOrigin!==(n.defaultGroupOrigin||"50% 50%")||c.length||o.length&&!Ms(this._targetGroups,n.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!f},r.prototype._updateObserver=function(){},r.defaultProps=R(R({},ur.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),r}(ur),Up=function(e){Fr(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.moveables=[],t}return r.prototype.render=function(){var t=this,n,a=this.props,i=a.cspNonce,o=a.cssStyled,s=a.persistData,l=a.targets||[],c=l.length,u=this.isUnmounted||!c,f=(n=s==null?void 0:s.children)!==null&&n!==void 0?n:[];return u&&!c&&f.length?l=f.map(function(){return null}):u||(f=[]),_.createElement(o,{cspNonce:i,ref:we(this,"controlBox"),className:nt("control-box")},l.map(function(d,p){var v,h,g=(h=(v=a.individualGroupableProps)===null||v===void 0?void 0:v.call(a,d,p))!==null&&h!==void 0?h:{};return _.createElement(ur,R({key:"moveable"+p,ref:qi(t,"moveables",p)},a,g,{target:d,wrapperMoveable:t,isWrapperMounted:t.isMoveableMounted,persistData:f[p]}))}))},r.prototype.componentDidMount=function(){},r.prototype.componentDidUpdate=function(){},r.prototype.getTargets=function(){return this.props.targets},r.prototype.updateRect=function(t,n,a){a===void 0&&(a=!0),sr(!0),this.moveables.forEach(function(i){i.updateRect(t,n,a)}),sr()},r.prototype.getRect=function(){return R(R({},e.prototype.getRect.call(this)),{children:this.moveables.map(function(t){return t.getRect()})})},r.prototype.request=function(t,n,a){n===void 0&&(n={});var i=this.moveables.map(function(l){return l.request(t,R(R({},n),{isInstant:!1}),!1)}),o=a||n.isInstant,s={request:function(l){return i.forEach(function(c){return c.request(l)}),this},requestEnd:function(){return i.forEach(function(l){return l.requestEnd()}),this}};return o?s.request(n).requestEnd():s},r.prototype.dragStart=function(t){var n=t.target,a=Re(this.moveables,function(i){var o=i.getTargets()[0],s=i.getControlBoxElement(),l=i.getDragElement();return!o||!l?!1:l===n||l.contains(n)||l!==o&&o===n||o.contains(n)||s===n||s.contains(n)});return a&&a.dragStart(t),this},r.prototype.hitTest=function(){return 0},r.prototype.isInside=function(){return!1},r.prototype.isDragging=function(){return!1},r.prototype.getDragElement=function(){return null},r.prototype.getMoveables=function(){return W([],M(this.moveables),!1)},r.prototype.updateRenderPoses=function(){},r.prototype.checkUpdate=function(){},r.prototype.triggerEvent=function(){},r.prototype.updateAbles=function(){},r.prototype._updateEvents=function(){},r.prototype._updateObserver=function(){},r}(ur);function js(e,r){var t=[];return e.forEach(function(n){if(n){if(Ye(n)){r[n]&&t.push.apply(t,W([],M(r[n]),!1));return}Gt(n)?t.push.apply(t,W([],M(js(n,r)),!1)):t.push(n)}}),t}function Hs(e,r){var t=[];return e.forEach(function(n){if(n){if(Ye(n)){r[n]&&t.push.apply(t,W([],M(r[n]),!1));return}Gt(n)?t.push(Hs(n,r)):t.push(n)}}),t}function Vs(e,r){return e.length!==r.length||e.some(function(t,n){var a=r[n];return!t&&!a?!1:t!=a?Gt(t)&&Gt(a)?Vs(t,a):!0:!1})}var $p=function(e){Fr(r,e);function r(){var t=e!==null&&e.apply(this,arguments)||this;return t.refTargets=[],t.selectorMap={},t._differ=new Yi,t._elementTargets=[],t._tmpRefTargets=[],t._tmpSelectorMap={},t._onChangeTargets=null,t}return r.makeStyled=function(){var t={},n=this.getTotalAbles();n.forEach(function(i){var o=i.css;o&&o.forEach(function(s){t[s]=!0})});var a=fr(t).join(`
`);this.defaultStyled=Bo("div",Bl(Sa,kf+a))},r.getTotalAbles=function(){return W([zs,Va,Gs,Is],M(this.defaultAbles),!1)},r.prototype.render=function(){var t,n=this.constructor;n.defaultStyled||n.makeStyled();var a=this.props,i=a.ables,o=a.props,s=Cf(a,["ables","props"]),l=M(this._updateRefs(!0),2),c=l[0],u=l[1],f=js(c,u),d=f.length>1,p=n.getTotalAbles(),v=W(W([],M(p),!1),M(i||[]),!1),h=R(R(R({},s),o||{}),{ables:v,cssStyled:n.defaultStyled,customStyledMap:n.customStyledMap});this._elementTargets=f;var g=null,m=this.moveable,x=s.persistData;if(x!=null&&x.children&&(d=!0),s.individualGroupable)return _.createElement(Up,R({key:"individual-group",ref:we(this,"moveable")},h,{target:null,targets:f}));if(d){var b=Hs(c,u);if(m&&!m.props.groupable&&!m.props.individualGroupable){var S=m.props.target;S&&f.indexOf(S)>-1&&(g=R({},m.state))}return _.createElement(Xp,R({key:"group",ref:we(this,"moveable")},h,(t=s.groupableProps)!==null&&t!==void 0?t:{},{target:null,targets:f,targetGroups:b,firstRenderState:g}))}else{var D=f[0];if(m&&(m.props.groupable||m.props.individualGroupable)){var y=m.moveables||[],E=Re(y,function(w){return w.props.target===D});E&&(g=R({},E.state))}return _.createElement(ur,R({key:"single",ref:we(this,"moveable")},h,{target:D,firstRenderState:g}))}},r.prototype.componentDidMount=function(){this._checkChangeTargets()},r.prototype.componentDidUpdate=function(){this._checkChangeTargets()},r.prototype.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},r.prototype.getTargets=function(){var t,n;return(n=(t=this.moveable)===null||t===void 0?void 0:t.getTargets())!==null&&n!==void 0?n:[]},r.prototype.updateSelectors=function(){this.selectorMap={},this._updateRefs()},r.prototype.waitToChangeTarget=function(){var t=this,n;return this._onChangeTargets=function(){t._onChangeTargets=null,n()},new Promise(function(a){n=a})},r.prototype.waitToChangeTargets=function(){return this.waitToChangeTarget()},r.prototype.getManager=function(){return this.moveable},r.prototype.getMoveables=function(){return this.moveable.getMoveables()},r.prototype.getDragElement=function(){return this.moveable.getDragElement()},r.prototype._updateRefs=function(t){var n=this.refTargets,a=Na(this.props.target||this.props.targets),i=typeof document<"u",o=Vs(n,a),s=this.selectorMap,l={};return this.refTargets.forEach(function c(u){if(Ye(u)){var f=s[u];f?l[u]=s[u]:i&&(o=!0,l[u]=[].slice.call(document.querySelectorAll(u)))}else Gt(u)&&u.forEach(c)}),this._tmpRefTargets=a,this._tmpSelectorMap=l,[a,l,!t&&o]},r.prototype._checkChangeTargets=function(){var t,n,a;this.refTargets=this._tmpRefTargets,this.selectorMap=this._tmpSelectorMap;var i=this._differ.update(this._elementTargets),o=i.added,s=i.removed,l=o.length||s.length;l&&((n=(t=this.props).onChangeTargets)===null||n===void 0||n.call(t,{moveable:this.moveable,targets:this._elementTargets}),(a=this._onChangeTargets)===null||a===void 0||a.call(this));var c=M(this._updateRefs(),3),u=c[0],f=c[1],d=c[2];this.refTargets=u,this.selectorMap=f,d&&this.forceUpdate()},r.defaultAbles=[],r.customStyledMap={},r.defaultStyled=null,Sf([kl(Nf)],r.prototype,"moveable",void 0),r}(_.PureComponent),Fs=function(e){Fr(r,e);function r(){return e!==null&&e.apply(this,arguments)||this}return r.defaultAbles=qp,r}($p);const Te=()=>{const{bpLines:e}=pt;Kp(Object.values(e))},Kp=e=>{const{downCtx:r,canvasOffset:t,nodeContainerRef:n}=pt,{width:a,height:i}=n==null?void 0:n.getBoundingClientRect();e.forEach(o=>{const{startAnchorId:s,endAnchorId:l}=o,c=document.getElementById(s),u=document.getElementById(l),{x:f,y:d,width:p,height:v}=c.getBoundingClientRect(),{x:h,y:g,width:m,height:x}=u.getBoundingClientRect();o.startPoint={x:f+p/2-t.x,y:d+v/2-t.y},o.endPoint={x:h+m/2-t.x,y:g+x/2-t.y};const b=zt.calculateControlPoint(o.startPoint,o.endPoint);o.firstCP=b.firstCP,o.secondCP=b.secondCP}),r.clearRect(0,0,a,i),zt.drawBezierCurves(r,e)},Bi=(e,r)=>{const{bpNodeControllerInsMap:t,bpAPLineMap:n,bpLines:a,updLinePos:i,updBpNodeLayout:o,canvasOffset:s}=pt;o({id:e,position:{x:r.x,y:r.y}});const l=t[e],{input:c=[],output:u=[]}=l.getConfig(),f=[...c,...u];f&&f.forEach(d=>{const p=n[d.id];p&&p.forEach(v=>{const h=a[v];if(h){const{startAnchorId:g,endAnchorId:m}=h,x=document.getElementById(g),b=document.getElementById(m),{x:S,y:D,width:y,height:E}=x.getBoundingClientRect(),{x:w,y:T,width:O,height:P}=b.getBoundingClientRect();i({id:v,startPoint:{x:S+y/2-s.x,y:D+E/2-s.y},endPoint:{x:w+O/2-s.x,y:T+P/2-s.y}})}})})},Jp=Et(e=>{const{children:r}=e,t=ae.createRef();_.useEffect(()=>{const{setBpMovableRef:c}=pt;c(t.current)});const n=c=>{const{target:u,beforeTranslate:f}=c;u.style.transform=`translate(${f[0]}px, ${f[1]}px)`,Te()},a=c=>{const{inputEvent:{target:u}}=c;if(u.classList.contains("ap-circle"))return!1},i=c=>{const{target:u,lastEvent:f}=c;if(!f)return;const{beforeTranslate:d}=f,p=u.id.split(":")[1];Bi(p,{x:d[0],y:d[1]}),zt.updSegmentSamplingPoint()},o=c=>{c.events.forEach(u=>u.target.style.transform=u.transform),Te()},s=c=>{c.events.forEach(u=>{const{target:f,lastEvent:d}=u;if(d){const p=f.id.split(":")[1],{beforeTranslate:v}=d;Bi(p,{x:v[0],y:v[1]})}}),zt.updSegmentSamplingPoint()},{selectedNodes:l}=pt;return C.jsxs(C.Fragment,{children:[r,C.jsx(Fs,{ref:t,target:l,draggable:!0,origin:!1,hideDefaultLines:!0,onDragStart:a,onDrag:n,onDragEnd:i,onDragGroup:o,onDragGroupEnd:s})]})}),Zp=e=>{const{children:r}=e,t=ae.createRef();_.useEffect(()=>{const{setBpSelectRef:i}=pt;i(t.current)});const n=i=>{const{bpMovableRef:o,selectedNodes:s}=pt,l=i.inputEvent.target;(o.isMoveableElement(l)||s.some(c=>c===l||c.contains(l)))&&i.stop()},a=i=>{let{selected:o}=i;const{bpMovableRef:s,setSelectedNodes:l}=pt;if(o=o.filter(c=>c.classList.contains("bp-node-container")),l(o),o.length!==0&&i.isDragStart){i.inputEvent.preventDefault();const c=setTimeout(()=>{s.dragStart(i.inputEvent),clearTimeout(c)})}};return C.jsxs(C.Fragment,{children:[r,C.jsx(Jl,{ref:t,dragContainer:".blue-print-canvas",selectableTargets:[".bp-node-container"],hitRate:0,ratio:0,selectByClick:!0,selectFromInside:!1,toggleContinueSelect:["ctrl"],onDragStart:n,onSelectEnd:a})]})};class Qp{constructor(){N(this,"max",3);N(this,"min",.05);N(this,"scale",1);N(this,"ratio",1);N(this,"compute",r=>{let t=1.2;r===0&&(t=1/1.2);let n=this.scale*t;n>this.max?(t=this.max/this.scale,n=this.max):n<this.min&&(t=this.min/this.scale,n=this.min),this.scale=n,this.ratio=t})}}class Ws{constructor(r){N(this,"container",null);N(this,"content",null);N(this,"position",{x:0,y:0});N(this,"dragCallback");N(this,"scaleCallback");N(this,"dragStartCallback");N(this,"dragEndCallback");N(this,"scaleCore",new Qp);N(this,"contextMenu",r=>r.preventDefault());N(this,"onDragStart",()=>{var r;return(r=this.container)==null?void 0:r.addEventListener("pointerdown",this.pointerDown)});N(this,"onDragMove",r=>{if(r.buttons===2&&(this.position.x+=r.movementX,this.position.y+=r.movementY,this.content.style.transform="translate3d("+this.position.x+"px, "+this.position.y+"px, 0) scale("+this.scaleCore.scale+")",this.dragCallback)){const{scale:t,ratio:n}=this.scaleCore;this.dragCallback({scale:t,ratio:n,position:this.position},r)}});N(this,"onDragEnd",()=>{var r;return(r=this.container)==null?void 0:r.addEventListener("pointerup",this.pointerUp)});N(this,"pointerDown",r=>{var t,n;if(r.button===2&&((t=this.container)==null||t.setPointerCapture(r.pointerId),(n=this.container)==null||n.addEventListener("pointermove",this.onDragMove),this.dragStartCallback)){const{scale:a,ratio:i}=this.scaleCore;this.dragStartCallback({scale:a,ratio:i,position:this.position},r)}});N(this,"pointerUp",r=>{var t,n;if(r.button===2&&((t=this.container)==null||t.releasePointerCapture(r.pointerId),(n=this.container)==null||n.removeEventListener("pointermove",this.onDragMove),this.dragEndCallback)){const{scale:a,ratio:i}=this.scaleCore;this.dragEndCallback({scale:a,ratio:i,position:this.position},r)}});N(this,"registerScale",()=>{var r;return(r=this.container)==null?void 0:r.addEventListener("wheel",this.doWheel)});N(this,"doWheel",r=>{var t;if(r.altKey&&r.buttons!==2){this.scaleCore.compute(r.deltaY>0?0:1);const{x:n,y:a}=this.container.getBoundingClientRect(),{width:i,height:o}=(t=this.content)==null?void 0:t.style;if(this.position.x=this.position.x-(this.scaleCore.ratio-1)*(r.clientX-n-this.position.x-parseFloat(i)*.5),this.position.y=this.position.y-(this.scaleCore.ratio-1)*(r.clientY-a-this.position.y-parseFloat(o)*.5),this.content.style.transform="translate3d("+this.position.x+"px, "+this.position.y+"px, 0) scale("+this.scaleCore.scale+")",this.scaleCallback){const{scale:s,ratio:l}=this.scaleCore;this.scaleCallback({scale:s,ratio:l,position:this.position},r)}}});const{container:t,content:n,position:a,dragCallback:i,scaleCallback:o,dragStartCallback:s,dragEndCallback:l}=r;this.container=t,this.content=n,a&&(this.position=a),i&&(this.dragCallback=i),o&&(this.scaleCallback=o),s&&(this.dragStartCallback=s),l&&(this.dragEndCallback=l),this.registerDrag(),this.registerScale()}destroy(){var r,t,n,a;(r=this.container)==null||r.removeEventListener("pointerdown",this.pointerDown),(t=this.container)==null||t.removeEventListener("pointerup",this.pointerUp),(n=this.container)==null||n.removeEventListener("wheel",this.doWheel),(a=this.container)==null||a.removeEventListener("contextmenu",this.contextMenu),this.container=null,this.content=null}registerDrag(){var r;this.content.style.transform="translate3d("+this.position.x+"px, "+this.position.y+"px, 0) scale("+this.scaleCore.scale+")",(r=this.container)==null||r.addEventListener("contextmenu",this.contextMenu),this.onDragStart(),this.onDragEnd()}}const tv=e=>{const{children:r}=e,t=ae.useRef(null),n=ae.useRef(null);return _.useEffect(()=>{const{setCanvasTranslate:a,setCanvasScale:i,setBpDragContentRef:o}=pt,s=t.current,l=n.current;if(o(l),s&&l){const c=new Ws({container:s,content:l,dragCallback:u=>{const{position:f}=u;a(f),Te()},dragEndCallback:()=>{zt.updSegmentSamplingPoint()},scaleCallback:u=>{const{position:f,scale:d}=u;i(d),a(f),Te(),zt.updSegmentSamplingPoint()}});return()=>{c.destroy()}}},[]),C.jsx("div",{className:"bp-ds-container",id:"bp-ds-container",ref:t,style:{overflow:"hidden",width:"100%",height:"100%"},children:C.jsx("div",{ref:n,style:{width:0,height:0},children:r})})},ev=ae.memo(({layout:e})=>{const r=_.useRef(null),t=i=>{const{setActiveNode:o}=wo;o(i)};_.useEffect(()=>{const i=Zl.get(e.type);if(!i)return;const o=new i;if(!o)return;const{bpNodeControllerInsMap:s,bpNodeConfigMap:l}=pt;let c=l[e.id];c||(c=o.getNodeInfo(e.id)),o.create(r.current,c),s[e.id]=o},[e.id,e.type]);const{position:n,id:a}=e;return C.jsx("div",{ref:r,className:"bp-node-container",id:`bpnode:${a}`,onDoubleClick:()=>t(a),style:{transform:"translate("+n.x+"px,"+n.y+"px)"}})}),rv=Et(()=>{const{bpNodeLayoutMap:e}=pt,r=_.useRef(null);return _.useEffect(()=>{const{setNodeContainerRef:t}=pt;t(r.current)},[]),C.jsx("div",{id:"bp-node-container",style:{position:"relative",width:"100%",height:"100%"},ref:r,children:C.jsx(Zp,{children:C.jsx(tv,{children:C.jsx(Jp,{children:Object.values(e).map(t=>C.jsx(ev,{layout:t},t.id))})})})})}),ki=e=>{const{clientX:r,clientY:t,shiftKey:n}=e,{selectedLines:a,setSelectedLines:i,downCtx:o}=pt;if(a.length>0&&(a.forEach(d=>{d.lineWidth=1,d.color="#a2a2a2",Te(),zt.updSegmentSamplingPoint()}),i([])),!n)return;const{bpLines:s,canvasOffset:l}=pt,c=[],u={x:r-l.x,y:t-l.y};if(Object.values(s).forEach(d=>{zt.isMouseInRectangle(u,d.startPoint,d.endPoint)&&c.push(d)}),c.length===0)return;const f=[];for(let d=0;d<c.length;d++){const p=c[d],{samplePoints:v}=p;if(zt.isMouseOnLine(u,v,5)){p.lineWidth=2,p.color="#d9d9d9",f.push(p),zt.drawBezierCurves(o,[p]),zt.updSegmentSamplingPoint();break}}i(f)},nv=()=>(_.useEffect(()=>{const e=setTimeout(()=>{Te(),zt.updSegmentSamplingPoint(),clearTimeout(e)},50),{nodeContainerRef:r}=pt;return r==null||r.addEventListener("click",ki),()=>r==null?void 0:r.removeEventListener("click",ki)},[]),C.jsxs("div",{className:"blue-print-canvas",style:{overflow:"hidden",width:"100%",height:"100%"},children:[C.jsx(vf,{}),C.jsx(rv,{})]})),qs=e=>{const{header:r,footer:t,left:n,right:a,content:i}=e;return C.jsxs("div",{className:"frame-layout",children:[C.jsx("div",{className:"fl-header",children:r}),C.jsxs("div",{className:"fl-body",children:[C.jsx("div",{className:"fl-left",children:n}),C.jsxs("div",{className:"fl-crf-box",children:[C.jsxs("div",{className:"fl-cr-box",children:[C.jsx("div",{className:"fl-content",children:i}),C.jsx("div",{className:"fl-right",children:a})]}),C.jsx("div",{className:"fl-footer",children:t})]})]})]})},av=()=>C.jsx(qs,{header:C.jsx(Zu,{}),footer:C.jsx(Qu,{}),left:C.jsx(tf,{}),right:C.jsx(pf,{}),content:C.jsx(nv,{})}),iv=()=>Sl.createPortal(C.jsx("div",{style:{position:"relative",top:-window.innerHeight,zIndex:2,width:"100%",height:"100%",backgroundColor:"#151515"},children:C.jsx(av,{})}),document.body);class Ce{}class ov extends Ce{redo(r){if(!r)return;const{movableRef:t,setBackoff:n,setTargetIds:a}=rt,{next:i}=r,o=i;a(o.ids),n(!0),Promise.resolve().then(()=>{t==null||t.request("draggable",{x:o.x,y:o.y},!0)})}undo(r){if(!r)return;const{movableRef:t,setBackoff:n,setTargetIds:a}=rt,{prev:i}=r,o=i;a(o.ids),n(!0),Promise.resolve().then(()=>{t==null||t.request("draggable",{x:o.x,y:o.y},!0)})}}const sv=new ov;class lv extends Ce{redo(r){if(!r)return;const{movableRef:t,setBackoff:n,setTargetIds:a}=rt,{next:i}=r,o=i;a(o.ids),n(!0),Promise.resolve().then(()=>{t==null||t.request("resizable",{offsetWidth:o.width,offsetHeight:o.height,direction:o.direction},!0)})}undo(r){if(!r)return;const{movableRef:t,setBackoff:n,setTargetIds:a}=rt,{prev:i}=r,o=i;a(o.ids),n(!0),Promise.resolve().then(()=>{t==null||t.request("resizable",{offsetWidth:o.width,offsetHeight:o.height,direction:o.direction},!0)})}}const cv=new lv;class uv extends Ce{redo(r){if(!r)return;const{next:t}=r,{addItem:n}=U;t.forEach(a=>{"id"in a&&n(Nr.cloneDeep(a.layerConfig)),"layerHeader"in a&&(U.layerHeader=a.layerHeader),"layerTail"in a&&(U.layerTail=a.layerTail)})}undo(r){if(!r)return;const{setTargetIds:t,focusDesignerCanvas:n}=rt,{prev:a,next:i}=r,{delItem:o}=U,s=[];i&&i.forEach(f=>s.push(f.id)),o(s),a&&a.forEach(f=>{"layerHeader"in f&&(U.layerHeader=f.layerHeader),"layerTail"in f&&(U.layerTail=f.layerTail)}),t([]);const{setContentVisible:l,activeConfig:c,activeElem:u}=ue;s.includes(u.id)&&(l(!1),c(null,"")),n()}}const fv=new uv;class dv extends Ce{redo(r){if(!r)return;const{prev:t,next:n}=r,a=[];t.forEach(c=>{"id"in c&&a.push(c)});const{delItem:i}=U,o=[];a.forEach(c=>o.push(c.id)),i(o),n&&n.forEach(c=>{"layerHeader"in c&&(U.layerHeader=c.layerHeader),"layerTail"in c&&(U.layerTail=c.layerTail)});const{setTargetIds:s,focusDesignerCanvas:l}=rt;s([]),l(),console.log("del redo",qa(U.layerConfigs),U.layerHeader,U.layerTail)}undo(r){if(!r)return;const{setTargetIds:t}=rt,{prev:n}=r,a=[],i=[];n.forEach(c=>{"id"in c?a.push(c):i.push(c)});const{addItem:o,elemConfigs:s}=U,l=[];a.forEach(c=>{o(Nr.cloneDeep(c.layerConfig)),s[c.id]=c.elemConfig,l.push(c.id)}),i.forEach(c=>{"layerHeader"in c&&(U.layerHeader=c.layerHeader),"layerTail"in c&&(U.layerTail=c.layerTail)}),Promise.resolve().then(()=>t(l)),console.log("del undo",qa(U.layerConfigs),U.layerHeader,U.layerTail)}}const pv=new dv;class vv extends Ce{redo(r){const{next:t}=r;if(t){const{id:n,data:a}=t,{compController:i}=U,o=i[n];o&&o.update(a);const{visible:s,setContentVisible:l}=ue;if(s){l(!1);const c=setTimeout(()=>{l(!0),clearTimeout(c)},1)}}}undo(r){const{prev:t}=r;if(t){const{id:n,data:a}=t,{compController:i}=U,o=i[n];o&&o.update(a);const{visible:s,setContentVisible:l}=ue;if(s){l(!1);const c=setTimeout(()=>{l(!0),clearTimeout(c)},1)}}}}const hv=new vv;class gv extends Ce{redo(r){if(!r)return;const{next:t}=r,{updateLayer:n}=U;t&&n(t);const{layerInstances:a}=nr,{menu:i}=ie;i==="layer-list"&&(t==null||t.forEach(o=>{const{id:s,hide:l}=o;a[s].setState({hide:l})}))}undo(r){if(!r)return;const{prev:t}=r,{updateLayer:n}=U;t&&n(t);const{layerInstances:a}=nr,{menu:i}=ie;i==="layer-list"&&(t==null||t.forEach(o=>{const{id:s,hide:l}=o;a[s].setState({hide:l})}))}}const mv=new gv;class xv extends Ce{redo(r){const{next:t}=r,{updateLayer:n}=U;t&&n(t);const{layerInstances:a}=nr,{menu:i}=ie;i==="layer-list"&&(t==null||t.forEach(o=>{const{id:s,lock:l}=o;a[s].setState({lock:l})}))}undo(r){const{prev:t}=r,{updateLayer:n}=U;t&&n(t);const{layerInstances:a}=nr,{menu:i}=ie;i==="layer-list"&&(t==null||t.forEach(o=>{const{id:s,lock:l}=o;a[s].setState({lock:l})}))}}const yv=new xv;class bv extends Ce{redo(r){const{next:t}=r,{updateLayer:n}=U;t&&n(t)}undo(r){const{prev:t}=r,{updateLayer:n}=U;t&&n(t)}}const Cv=new bv;class Sv extends Ce{redo(r){const{next:t}=r;if(t){const n=[];t.forEach(i=>{"id"in i&&n.push(Nr.cloneDeep(i)),"layerHeader"in i&&(U.layerHeader=i.layerHeader),"layerTail"in i&&(U.layerTail=i.layerTail)});const{updateLayer:a}=U;a(n)}}undo(r){const{prev:t}=r;if(t){const n=[];t.forEach(i=>{"id"in i&&n.push(Nr.cloneDeep(i)),"layerHeader"in i&&(U.layerHeader=i.layerHeader),"layerTail"in i&&(U.layerTail=i.layerTail)});const{updateLayer:a}=U;a(n)}}}const Dv=new Sv,oe=new Map;oe.set(be.DRAG,sv);oe.set(be.RESIZE,cv);oe.set(be.ADD,fv);oe.set(be.DEL,pv);oe.set(be.UPD_STYLE,hv);oe.set(be.HIDE,mv);oe.set(be.LOCK,yv);oe.set(be.ORDER,Cv);oe.set(be.UPDATE_LAYER,Dv);const Ev=()=>{var a;const{layerConfigs:e}=U,{setTargetIds:r,calculateGroupCoordinate:t}=rt,n=Object.values(e).map(i=>{if(!i.lock&&!i.hide)return i.id});r(n),n.length>0&&t((a=n.map(i=>document.getElementById(i)))==null?void 0:a.filter(i=>!!i))},Ys=()=>{const{targetIds:e,setTargetIds:r}=rt;if(!e||e.length===0)return;const{copyItem:t}=U,n=t(e),a=setTimeout(()=>{r(n),clearTimeout(a)},10)},Xs=()=>{const{targetIds:e,setTargetIds:r}=rt;if(!e||e.length===0)return;const{layerConfigs:t}=U,n=[];for(const a of e){const i=t[a];n.push({...i,lock:!0})}Nt.doLockUpd(n),r([])},Us=()=>{const{setTargetIds:e,targetIds:r}=rt;if(!r||r.length===0)return;const{layerConfigs:t}=U,n=[];r.filter(a=>t[a].lock).forEach(a=>{n.push({id:a,lock:!1})}),Nt.doLockUpd(n),e([])},$s=()=>{Nt.doLayerToTop()},Ks=()=>{Nt.doLayerToBottom()},wv=()=>{Nt.doLayerMoveUp()},Rv=()=>{Nt.doLayerMoveDown()},Fa=()=>{const{targetIds:e}=rt;if(e&&e.length>0){const{delNode:r,bpNodeLayoutMap:t}=pt,n=[];e.forEach(a=>{t[a]&&n.push(a)}),n.length>0&&r(n)}Nt.doDelete()},Js=Nr.throttle(()=>new Promise(()=>{const{saveType:e,id:r}=Ir.parseUrlParams(),t=U.getData(),{bpAPMap:n,bpLines:a,bpAPLineMap:i,getAllNodeConfig:o,bpNodeLayoutMap:s}=pt;t.bpAPMap=n,t.bpLines=a,t.bpAPLineMap=i,t.bpNodeConfigMap=o(),t.bpNodeLayoutMap=s;const l={id:r,dataJson:JSON.stringify(t)};ln[e].updateProject(l)}),5e3),Zs=()=>{const{targetIds:e,setTargetIds:r}=rt;if(!e||e.length===0)return;const{layerConfigs:t}=U,n=[];e.forEach(a=>{const i=t[a];n.push({...i,hide:!0})}),Nt.doHideUpd(n),r([])},Qs=()=>{Nt.doGrouping()},tl=()=>{let{targetIds:e}=rt;const r=new Set;if(Ve.findTopGroupLayer(e,!1).forEach(t=>r.add(t)),e=Array.from(r),e&&e.length>0){const{delNode:t,bpNodeLayoutMap:n}=pt,a=[];e.forEach(i=>{n[i]&&a.push(i)}),a.length>0&&t(a)}Nt.doUnGrouping()},el=()=>{Nt.doRemoveFromGroup()},rl=()=>{const{targets:e,movableRef:r,groupCoordinate:t}=rt;if(!e||e.length===0)return;const{layerConfigs:n,canvasConfig:{dragStep:a=1}}=U;let i;if(e.length===1){const o=e[0].id;i=(n[o].y||0)-a}else i=((t==null?void 0:t.minY)||0)-a;r==null||r.request("draggable",{y:i},!0)},nl=()=>{const{targets:e,movableRef:r,groupCoordinate:t}=rt;if(!e||e.length===0)return;const{layerConfigs:n,canvasConfig:{dragStep:a=1}}=U;if(e.length===1){const i=e[0].id,o=n[i].y+a;r==null||r.request("draggable",{y:o},!0)}else{const i=(t==null?void 0:t.minY)+a;r==null||r.request("draggable",{y:i},!0)}},Mv=()=>{const{targets:e,movableRef:r,groupCoordinate:t}=rt;if(!e||e.length===0)return;const{layerConfigs:n,canvasConfig:{dragStep:a=1}}=U;if(e.length===1){const i=e[0].id,o=n[i].x;r==null||r.request("draggable",{x:o-a},!0)}else{const i=(t==null?void 0:t.minX)-a;r==null||r.request("draggable",{x:i},!0)}},Ov=()=>{const{targets:e,movableRef:r,groupCoordinate:t}=rt;if(!e||e.length===0)return;const{layerConfigs:n,canvasConfig:{dragStep:a=1}}=U;if(e.length===1){const i=e[0].id,o=n[i].x;r==null||r.request("draggable",{x:o+a},!0)}else{const i=(t==null?void 0:t.minX)+a;r==null||r.request("draggable",{x:i},!0)}},Tv=()=>{const{targets:e,movableRef:r,groupCoordinate:t}=rt;if(!e||e.length===0)return;const{layerConfigs:n,canvasConfig:{resizeStep:a=1}}=U;let i;if(e.length===1){const o=e[0].id;i=n[o].height+a}else i=t.groupHeight+a;r==null||r.request("resizable",{offsetHeight:i,direction:[1,-1]},!0)},Iv=()=>{const{targets:e,movableRef:r,groupCoordinate:t}=rt;if(!e||e.length===0)return;const{layerConfigs:n,canvasConfig:{resizeStep:a=1}}=U;let i;if(e.length===1){const o=e[0].id;i=n[o].height+a}else i=t.groupHeight+a;r==null||r.request("resizable",{offsetHeight:i,direction:[1,1]},!0)},zv=()=>{const{targets:e,movableRef:r,groupCoordinate:t}=rt;if(!e||e.length===0)return;const{layerConfigs:n,canvasConfig:{resizeStep:a=1}}=U;let i;if(e.length===1){const o=e[0].id;i=n[o].width+a}else i=t.groupWidth+a;r==null||r.request("resizable",{offsetWidth:i,direction:[-1,1]},!0)},Pv=()=>{const{targets:e,movableRef:r,groupCoordinate:t}=rt;if(!e||e.length===0)return;const{layerConfigs:n,canvasConfig:{resizeStep:a=1}}=U;let i;if(e.length===1){const o=e[0].id;i=n[o].width+a}else i=t.groupWidth+a;r==null||r.request("resizable",{offsetWidth:i,direction:[1,1]},!0)},Bv=()=>{const{targets:e,movableRef:r,groupCoordinate:t}=rt;if(!e||e.length===0)return;const{layerConfigs:n,canvasConfig:{resizeStep:a=1}}=U;let i;e.length===1?i=n[e[0].id].height-a:i=t.groupHeight-a,r==null||r.request("resizable",{offsetHeight:i,direction:[1,-1]},!0)},kv=()=>{const{targets:e,movableRef:r,groupCoordinate:t}=rt;if(!e||e.length===0)return;const{layerConfigs:n,canvasConfig:{resizeStep:a=1}}=U;let i;if(e.length===1){const o=e[0].id;i=n[o].height-a}else i=t.groupHeight-a;r==null||r.request("resizable",{offsetHeight:i,direction:[1,1]},!0)},Lv=()=>{const{targets:e,movableRef:r,groupCoordinate:t}=rt;if(!e||e.length===0)return;const{layerConfigs:n,canvasConfig:{resizeStep:a=1}}=U;let i;if(e.length===1){const o=e[0].id;i=n[o].width-a}else i=t.groupWidth-a;r==null||r.request("resizable",{offsetWidth:i,direction:[-1,1]},!0)},_v=()=>{const{targets:e,movableRef:r,groupCoordinate:t}=rt;if(!e||e.length===0)return;const{layerConfigs:n,canvasConfig:{resizeStep:a=1}}=U;let i;if(e.length===1){const o=e[0].id;i=n[o].width-a}else i=t.groupWidth-a;r==null||r.request("resizable",{offsetWidth:i,direction:[1,1]},!0)},Nv=()=>{const e=$i.backoff();if(!e)return;const{actions:r}=e;r.forEach(t=>{var a;const{type:n}=t;(a=oe.get(n))==null||a.undo(t)})},Gv=()=>{const e=$i.forward();if(!e)return;const{actions:r}=e;r.forEach(t=>{var a;const{type:n}=t;(a=oe.get(n))==null||a.redo(t)})},Av=()=>{const{auxiliaryBorder:e,setAuxiliaryBorder:r}=ic;if(!e){const n=document.getElementsByClassName("lc-comp-item");n&&Array.from(n).forEach(a=>{a.style.border="1px solid #65eafc"})}else{const n=document.getElementsByClassName("lc-comp-item");n&&Array.from(n).forEach(a=>{a.style.border="none"})}r(!e)},jv=()=>{const{projectVisible:e,setProjectVisible:r}=fe;console.log(e),r(!e)},Hv=()=>{const{canvasVisible:e,setCanvasVisible:r}=fe;r(!e)},Vv=()=>{const{themeVisible:e,setThemeVisible:r}=fe;r(!e)},Fv=()=>{const{hotKeyVisible:e,setHotKeyVisible:r}=on;r(!e)},al=()=>{const{bluePrintVisible:e}=fe;if(!e)return;const{selectedNodes:r,delNode:t}=pt;if(r.length===0)return;const n=r.map(o=>o.id.split(":")[1]);t(n);const{setUsedLayerNodes:a,usedLayerNodes:i}=ar;n.forEach(o=>{o in i&&a(o,!1)}),Te()},il=()=>{const{bluePrintVisible:e}=fe;if(!e)return;const{selectedLines:r,delLine:t}=pt;if(r.length===0)return;const n=r.map(a=>a.id);t(n),Te()},Wv=ae.lazy(()=>ca(()=>import("./ProjectHdItemImpl-Px9f5Ol3.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39]))),qv=ae.lazy(()=>ca(()=>import("./CanvasHdConfigImpl-O64FdWhD.js"),__vite__mapDeps([40,1,2,4,3,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,41,42,35,36,37,38,43]))),Yv=ae.lazy(()=>ca(()=>import("./ThemeHdItemImpl--evHAs44.js"),__vite__mapDeps([44,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,35,36,37,38,45]))),Xv=[{icon:mu,name:"蓝图",key:"blue-print",onClick:()=>{const{setBluePrintVisible:e}=fe,{setTargetIds:r}=rt;r([]),e(!0)}},{icon:Fc,name:"画布",key:"canvas",onClick:()=>{const{setCanvasVisible:e}=fe;e(!0)}},{icon:kc,name:"主题",key:"theme",onClick:()=>{const{setThemeVisible:e}=fe;e(!0)}}],Uv=[{icon:bu,name:"保存",key:"save",onClick:()=>Js()},{icon:Uc,name:"预览",key:"preview",onClick:()=>{const{saveType:e,id:r}=Ir.parseUrlParams();window.open(`/light-chaser-app/#/view?id=${r}&saveType=${e}&mode=${Ql.VIEW}`,"_blank")}}],$v=Et(()=>{const e=i=>{const o=[];for(let s=0;s<i.length;s++){const{icon:l,name:c,key:u,onClick:f}=i[s];o.push(C.jsxs("div",{className:"header-item",onClick:f,children:[C.jsx(l,{}),C.jsx("span",{className:"item-span",children:c})]},u))}return o},{canvasVisible:r,projectVisible:t,themeVisible:n,bluePrintVisible:a}=fe;return C.jsx(C.Fragment,{children:C.jsxs("div",{className:"designer-header",children:[C.jsx("div",{className:"header-left",children:C.jsx("div",{className:"header-title",children:"LIGHT CHASER"})}),C.jsx("div",{className:"header-center",children:e(Xv)}),C.jsx("div",{className:"header-right",children:e(Uv)}),r&&C.jsx(_.Suspense,{fallback:C.jsx(Je,{}),children:C.jsx(qv,{})}),t&&C.jsx(_.Suspense,{fallback:C.jsx(Je,{}),children:C.jsx(Wv,{})}),n&&C.jsx(_.Suspense,{fallback:C.jsx(Je,{}),children:C.jsx(Yv,{})}),a&&C.jsx(_.Suspense,{fallback:C.jsx(Je,{}),children:C.jsx(iv,{})})]})})});var oa=function(e,r){return oa=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a])},oa(e,r)};function Kv(e,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");oa(e,r);function t(){this.constructor=e}e.prototype=r===null?Object.create(r):(t.prototype=r.prototype,new t)}var Jv=function(e){Kv(r,e);function r(){var n=e!==null&&e.apply(this,arguments)||this;return n.state={scrollPos:0},n.width=0,n.height=0,n._zoom=0,n._rulerScale=0,n._observer=null,n._checkResize=function(){n.resize()},n}var t=r.prototype;return t.render=function(){var n=this.props;return this._zoom=n.zoom,_.createElement("canvas",{ref:we(this,"canvasElement"),style:this.props.style})},t.componentDidMount=function(){var n=this.props;this.state.scrollPos=n.defaultScrollPos||0;var a=this.canvasElement,i=a.getContext("2d",{alpha:!1});this.canvasContext=i,n.useResizeObserver?(this._observer=new ResizeObserver(this._checkResize),this._observer.observe(a,{box:"border-box"})):this.resize()},t.componentDidUpdate=function(){this.resize()},t.componentWillUnmount=function(){var n;this.state.scrollPos=0,(n=this._observer)===null||n===void 0||n.disconnect()},t.getScrollPos=function(){return this.state.scrollPos},t.scroll=function(n,a){this.draw(n,a)},t.resize=function(n){var a=this.canvasElement,i=this.props,o=i.width,s=i.height,l=i.scrollPos,c=this._getRulerScale();this.width=o||a.offsetWidth,this.height=s||a.offsetHeight,a.width=this.width*c,a.height=this.height*c,this.draw(l,n)},t.draw=function(n,a){n===void 0&&(n=this.state.scrollPos),a===void 0&&(a=this._zoom),this._zoom=a;var i=this.props,o=i,s=o.unit,l=o.type,c=o.backgroundColor,u=o.lineColor,f=o.textColor,d=o.textBackgroundColor,p=o.direction,v=o.negativeRuler,h=v===void 0?!0:v,g=o.segment,m=g===void 0?10:g,x=o.textFormat,b=o.range,S=b===void 0?[-1/0,1/0]:b,D=o.rangeBackgroundColor,y=o.selectedRanges,E=o.selectedBackgroundColor,w=o.lineWidth,T=w===void 0?1:w,O=o.selectedRangesText,P=o.selectedRangesTextColor,z=P===void 0?"#44aaff":P,I=o.selectedRangesTextOffset,k=I===void 0?[0,0]:I,B=this._getRulerScale(),V=this.width,H=this.height,G=this.state;G.scrollPos=n;var L=this.canvasContext,F=l==="horizontal",A=h!==!1,Z=i.font||"10px sans-serif",J=i.textAlign||"left",Y=i.textOffset||[0,0],X=F?H:V,q=Ct("".concat(i.mainLineSize||"100%"),X),$=Ct("".concat(i.longLineSize||10),X),et=Ct("".concat(i.shortLineSize||7),X),ot=i.lineOffset||[0,0];switch(c==="transparent"?L.clearRect(0,0,V*B,H*B):(L.rect(0,0,V*B,H*B),L.fillStyle=c,L.fill()),L.save(),L.scale(B,B),L.strokeStyle=u,L.lineWidth=T,L.font=Z,L.fillStyle=f,L.textAlign=J,p){case"start":L.textBaseline="top";break;case"center":L.textBaseline="middle";break;case"end":L.textBaseline="bottom";break}L.translate(.5,0),L.beginPath();for(var at=F?V:H,Q=a*s,tt=Math.floor(n*a/Q),gt=Math.ceil((n*a+at)/Q),ct=gt-tt,ut=Math.max(["left","center","right"].indexOf(J)-1,-1),st=F?H:V,bt=[],vt=0;vt<=ct;++vt){var lt=(vt+tt)*s,ht="".concat(lt);x&&(ht=x(lt));var Ot=L.measureText(ht).width;bt.push({color:f,offset:Y,backgroundColor:d,value:lt,text:ht,textSize:Ot})}if(E!=="transparent"&&(y!=null&&y.length)&&y.forEach(function(Ut){var he=Math.max(Ut[0],S[0],h?-1/0:0),$t=Math.min(Ut[1],S[1]),yt=(he-n)*a,Mt=($t-he)*a;O&&Ut.forEach(function(se){var ee="".concat(se);x&&(ee=x(se));var ge=L.measureText(ee).width,Kt=se*a,Xr=Kt+ge;tc(bt,function($e,yr){var Le=$e.value,fl=$e.textSize,Wa=Le*a,dl=Wa+fl;Wa<=Xr&&Kt<=dl&&bt.splice(yr,1)}),bt.push({value:se,color:z,offset:k,text:ee,textSize:ge})}),!(Mt<=0)&&(L.save(),L.fillStyle=E,F?L.fillRect(yt,0,Mt,st):L.fillRect(0,yt,st,Mt),L.restore())}),D!=="transparent"&&S[0]!==-1/0&&S[1]!==1/0){var Lt=(S[0]-n)*a,Tt=(S[1]-S[0])*a;L.save(),L.fillStyle=D,F?L.fillRect(Lt,0,Tt,st):L.fillRect(0,Lt,st,Tt),L.restore()}for(var vt=0;vt<=ct;++vt){var lt=vt+tt;if(!(!A&&lt<0))for(var St=lt*s,Rt=(St-n)*a,At=0;At<m;++At){var Wt=Rt+At/m*Q,hr=St+At/m*s;if(!(Wt<0||Wt>=at||hr<S[0]||hr>S[1])){var ze=At===0?q:At%2===0?$:et,Pe=0;switch(p){case"start":Pe=0;break;case"center":Pe=st/2-ze/2;break;case"end":Pe=st-ze;break}var Be=F?[Wt+ot[0],Pe+ot[1]]:[Pe+ot[0],Wt+ot[1]],ke=Be[0],gr=Be[1],mr=F?[ke,gr+ze]:[ke+ze,gr],xr=mr[0],In=mr[1];L.moveTo(ke+ot[0],gr+ot[1]),L.lineTo(xr+ot[0],In+ot[1])}}}L.stroke(),bt.forEach(function(Ut){var he=Ut.value,$t=Ut.offset,yt=Ut.backgroundColor,Mt=Ut.color,se=Ut.text,ee=Ut.textSize;if(!(!A&&he<0)){var ge=(he-n)*a;if(!(ge<-Q||ge>=at+s*a||he<S[0]||he>S[1])){var Kt=0;switch(p){case"start":Kt=17;break;case"center":Kt=st/2;break;case"end":Kt=st-17;break}var Xr=F?[ge+ut*-3,Kt]:[Kt,ge+ut*3],$e=Xr[0],yr=Xr[1];if(yt){var Le=0;switch(J){case"left":Le=0;break;case"center":Le=-ee/2;break;case"right":Le=-ee;break}L.save(),L.fillStyle=yt,F?L.fillRect($e+$t[0]+Le,0,ee,q):(L.translate(0,yr+$t[1]),L.rotate(-Math.PI/2),L.fillRect(Le,0,ee,q)),L.restore()}L.save(),L.fillStyle=Mt,F?L.fillText(se,$e+$t[0],yr+$t[1]):(L.translate($e+$t[0],yr+$t[1]),L.rotate(-Math.PI/2),L.fillText(se,0,0)),L.restore()}}}),L.restore()},t._getRulerScale=function(){var n=this.props.defaultPixelScale||2;if(!this._rulerScale){var a=window.devicePixelRatio>1;if(!a&&window.matchMedia){var i=window.matchMedia("only screen and (min--moz-device-pixel-ratio: 1.3), only screen and (-o-min-device-pixel-ratio: 2.6/2), only screen and (-webkit-min-device-pixel-ratio: 1.3), only screen  and (min-device-pixel-ratio: 1.3), only screen and (min-resolution: 1.3dppx)");a=i&&i.matches}this._rulerScale=a?3:n}return this._rulerScale},r.defaultProps={type:"horizontal",zoom:1,width:0,height:0,unit:50,negativeRuler:!0,mainLineSize:"100%",longLineSize:10,shortLineSize:7,segment:10,direction:"end",style:{width:"100%",height:"100%"},backgroundColor:"#333333",font:"10px sans-serif",textColor:"#ffffff",textBackgroundColor:"transparent",lineColor:"#777777",range:[-1/0,1/0],rangeBackgroundColor:"transparent",lineWidth:1,selectedBackgroundColor:"#555555",defaultScrollPos:0},r}(_.PureComponent);const Li=Jv;class Zv extends _.PureComponent{constructor(){super(...arguments);N(this,"state",{render:0});N(this,"rulerX",null);N(this,"rulerY",null);N(this,"unit",50);N(this,"scrollPos",{x:0,y:0});N(this,"baseOffset",20);N(this,"ruleWheel",()=>{const{scale:t}=rt,{dsContentRef:n}=rt,{designerLeftRef:a}=ie,{x:i,y:o}=n==null?void 0:n.getBoundingClientRect(),{width:s}=a==null?void 0:a.getBoundingClientRect();this.scrollPos.x=-(i-s-20)/t,this.scrollPos.y=-(o-70)/t,this.unit=Math.floor(50/t),this.setState({render:this.state.render+1})});N(this,"ruleDrag",()=>{const{dsContentRef:t,scale:n}=rt,{designerLeftRef:a}=ie,{x:i,y:o}=t==null?void 0:t.getBoundingClientRect(),{width:s}=a==null?void 0:a.getBoundingClientRect();this.scrollPos.x=-(i-s-20)/n,this.scrollPos.y=-(o-70)/n,this.rulerX&&this.rulerX.scroll(this.scrollPos.x),this.rulerY&&this.rulerY.scroll(this.scrollPos.y)})}componentDidMount(){const{setRuleRef:t}=rt;t(this)}componentWillUnmount(){const{setRuleRef:t}=rt;t(null)}render(){const{scale:t}=rt;return C.jsxs("div",{className:"lc-ruler",style:{position:"relative"},children:[C.jsx("div",{style:{position:"absolute",width:20,height:20,color:"#838383",textAlign:"center",fontSize:12,top:-1},children:"px"}),C.jsx("div",{className:"lc-ruler-horizontal",style:{height:this.baseOffset,width:`calc(100% - ${this.baseOffset}px)`,position:"relative",left:this.baseOffset},children:C.jsx(Li,{ref:n=>this.rulerX=n,scrollPos:this.scrollPos.x,zoom:t,lineColor:"#444b4d",textColor:"#a6a6a6",segment:2,negativeRuler:!0,textOffset:[0,10],backgroundColor:"#1f1f1f",unit:this.unit})}),C.jsx("div",{className:"lc-ruler-vertical",style:{width:this.baseOffset,height:window.innerHeight-this.baseOffset-90,position:"relative",overflow:"hidden"},children:C.jsx(Li,{ref:n=>this.rulerY=n,type:"vertical",scrollPos:this.scrollPos.y,lineColor:"#444b4d",textColor:"#a6a6a6",zoom:t,segment:2,negativeRuler:!0,textOffset:[10,0],backgroundColor:"#1f1f1f",unit:this.unit})}),C.jsx("div",{className:"lc-ruler-content",style:{position:"absolute",overflow:"hidden",top:this.baseOffset,left:this.baseOffset},children:this.props.children})]})}}class Qv extends _.Component{render(){return C.jsx("div",{style:{outline:"none"},className:"lc-event-container",children:this.props.children})}}class th extends _.Component{constructor(t){super(t);N(this,"movableRef",_.createRef());N(this,"onDragStart",t=>{const{target:n,inputEvent:a}=t,{layerConfigs:i}=U,{lock:o}=i[n.id];if(o)return!1;a&&a.shiftKey&&this.setState({throttleDragRotate:90})});N(this,"onDrag",t=>{const{target:n,beforeTranslate:a}=t;n.style.transform=`translate(${a[0]}px, ${a[1]}px)`});N(this,"onDragEnd",t=>{const{updateLayer:n}=U,{backoff:a,setBackoff:i}=rt,{lastEvent:o,target:s}=t;if(o){const{beforeTranslate:c}=o,u=[{id:s.id,width:s.offsetWidth,height:s.offsetHeight,type:s.dataset.type,x:c[0],y:c[1]}];a?(n(u,!1),i(!1)):Nt.doDrag(u);const{updateBaseConfig:f}=Ur;f(u[0])}const{throttleDragRotate:l}=this.state;l!==0&&this.setState({throttleDragRotate:0})});N(this,"onDragGroupStart",t=>{const{inputEvent:n}=t;n&&n.shiftKey&&this.setState({throttleDragRotate:90})});N(this,"onDragGroup",t=>{const{targets:n}=t,{layerConfigs:a}=U;if(a[n[0].id].lock)return!1;t.events.forEach(o=>o.target.style.transform=o.transform)});N(this,"onDragGroupEnd",t=>{var x;const{targets:n}=t,{updateLayer:a,layerConfigs:i}=U;if(i[n[0].id].lock)return!1;const{backoff:s,setBackoff:l,setGroupCoordinate:c,groupCoordinate:u,targetIds:f}=rt,d=[];t.events.forEach(b=>{const{target:S,lastEvent:D}=b;if(D){const{beforeTranslate:y}=D;d.push({id:S.id,width:S.offsetWidth,height:S.offsetHeight,type:S.dataset.type,x:y[0],y:y[1]})}});const p=((x=t==null?void 0:t.lastEvent)==null?void 0:x.beforeTranslate)||[0,0],v=u.minX+p[0],h=u.minY+p[1];c({minX:v,minY:h}),d.length>0&&(s?(a(d,!1),l(!1)):Nt.doDrag(d));const{throttleDragRotate:g}=this.state;g!==0&&this.setState({throttleDragRotate:0});const m=Ve.findTopGroupLayer(f,!0);if(m.length===1){const{updateBaseConfig:b}=Ur;b({id:m[0],x:Math.round(v),y:Math.round(h)})}});N(this,"onResizeStart",t=>{const{target:n,inputEvent:a}=t,{layerConfigs:i}=U,{lock:o}=i[n.id];if(o)return!1;a&&a.ctrlKey&&this.setState({keepRatio:!0})});N(this,"onResize",t=>{const{target:n,width:a,height:i,drag:o}=t;n.style.width=`${a}px`,n.style.height=`${i}px`,n.style.transform=`translate(${o.beforeTranslate[0]}px, ${o.beforeTranslate[1]}px)`});N(this,"onResizeEnd",t=>{const{updateLayer:n}=U,{backoff:a,setBackoff:i}=rt,{target:o,lastEvent:s}=t;if(s){const{width:c,height:u,drag:{translate:f},direction:d}=s,p=[{id:o.id,width:c,height:u,type:o.dataset.type,x:f[0],y:f[1]}];a?(n(p,!1),i(!1)):Nt.doResize(p,d);const{updateBaseConfig:v}=Ur;v(p[0])}const{keepRatio:l}=this.state;l&&this.setState({keepRatio:!1})});N(this,"onResizeGroupStart",t=>{const{targets:n,inputEvent:a}=t,{layerConfigs:i}=U;if(i[n[0].id].lock)return!1;a&&a.ctrlKey&&this.setState({keepRatio:!0})});N(this,"onResizeGroup",t=>{t.events.forEach(n=>{n.target.style.width=`${n.width}px`,n.target.style.height=`${n.height}px`,n.target.style.transform=n.drag.transform})});N(this,"onResizeGroupEnd",t=>{const{updateLayer:n}=U,{backoff:a,setBackoff:i,targetIds:o}=rt,s=[];if(t.events.forEach(f=>{const{target:d,lastEvent:p}=f;if(p){const{drag:{translate:v}}=p;s.push({id:d.id,width:d.offsetWidth,height:d.offsetHeight,type:d.dataset.type,x:v[0],y:v[1]})}}),!t.lastEvent)return;const{dist:l,direction:c}=t.lastEvent;if(s.length>0){a?(n(s,!1),i(!1)):Nt.doResize(s,c);const{setGroupCoordinate:f,groupCoordinate:d}=rt;c[0]===-1||c[1]===-1?f({minX:d.minX-l[0],minY:d.minY-l[1],groupWidth:d.groupWidth+l[0],groupHeight:d.groupHeight+l[1]}):f({groupWidth:d.groupWidth+l[0],groupHeight:d.groupHeight+l[1]});const p=Ve.findTopGroupLayer(o,!0);if(p.length===1){const{updateBaseConfig:v}=Ur;v({id:p[0],x:Math.round(d.minX),y:Math.round(d.minY),width:Math.round(d.groupWidth),height:Math.round(d.groupHeight)})}}const{keepRatio:u}=this.state;u&&this.setState({keepRatio:!1})});this.state={throttleDragRotate:0,keepRatio:!1}}componentDidMount(){const{setMovableRef:t}=rt;t(this.movableRef.current)}render(){const{throttleDragRotate:t,keepRatio:n}=this.state,{selectorRef:a,targets:i}=rt,{canvasConfig:{rasterize:o,dragStep:s,resizeStep:l}}=U,c=Array.from(document.getElementsByClassName("lc-comp-item")).filter(u=>!i.includes(u));return C.jsxs(C.Fragment,{children:[this.props.children,C.jsx(Fs,{ref:this.movableRef,target:i,draggable:!0,resizable:!0,keepRatio:n,throttleDragRotate:t,hideChildMoveableDefaultLines:!0,maxSnapElementGuidelineDistance:200,isDisplaySnapDigit:!0,snappable:!0,snapGap:!1,snapThreshold:5,snapDirections:{top:!0,right:!0,bottom:!0,left:!0,center:!0,middle:!0},elementSnapDirections:{top:!0,right:!0,bottom:!0,left:!0,center:!0,middle:!0},verticalGuidelines:["0","100%"],horizontalGuidelines:["0","100%"],isDisplayInnerSnapDigit:!0,elementGuidelines:Array.from(c),ables:[rh],dimensionViewable:!0,throttleDrag:o?s:1,throttleResize:o?l:1,onClickGroup:u=>a==null?void 0:a.clickTarget(u.inputEvent,u.inputTarget),onDrag:this.onDrag,onDragStart:this.onDragStart,onDragEnd:this.onDragEnd,onDragGroupStart:this.onDragGroupStart,onDragGroup:this.onDragGroup,onDragGroupEnd:this.onDragGroupEnd,onResizeStart:this.onResizeStart,onResize:this.onResize,onResizeEnd:this.onResizeEnd,onResizeGroupStart:this.onResizeGroupStart,onResizeGroup:this.onResizeGroup,onResizeGroupEnd:this.onResizeGroupEnd})]})}}const eh=Et(th),rh={name:"dimensionViewable",props:{dimensionViewable:Boolean},events:{},render(e){const r=e.getRect();return C.jsx("div",{className:"moveable-dimension",style:{left:"-125px",top:"-60px",color:"#cacacaff",fontSize:"14px",position:"absolute",boxSizing:"content-box",borderRadius:"5px",padding:"5px",pointerEvents:"none"},children:C.jsxs("div",{children:[C.jsxs("p",{children:["位置: ",Math.round(r.left)," x ",Math.round(r.top)]}),C.jsxs("p",{children:["尺寸: ",Math.round(r.offsetWidth)," x ",Math.round(r.offsetHeight)]})]})},"dimension-viewer")}};class nh extends _.Component{constructor(){super(...arguments);N(this,"menuList",[{name:"复制",icon:Wc,onClick:Ys},{name:"上移",icon:Cu,onClick:rl},{name:"下移",icon:Yc,onClick:nl},{name:"置顶",icon:wu,onClick:$s},{name:"置底",icon:Eu,onClick:Ks},{name:"删除",icon:qc,onClick:Fa},{name:"隐藏",icon:Xc,onClick:Zs}]);N(this,"calculateMenus",()=>{var l;const t=[...this.menuList],{targetIds:n}=rt;if(n.length===0)return t;const{layerConfigs:a}=U;!!((l=a[n[0]])!=null&&l.lock)?t.push({name:"解锁",icon:ei,onClick:Us}):t.push({name:"锁定",icon:ei,onClick:Xs}),n.length>1&&!Ve.hasSameGroup(n)&&t.push({name:"编组",icon:nu,onClick:Qs});let o=Ve.findTopGroupLayer(n,!0);return o=o.filter(c=>a[c].type==="group"),o.length>0&&t.push({name:"解组",icon:ec,onClick:tl}),n.some(c=>!a[c].pid)||t.push({name:"移出分组",icon:du,onClick:el}),t});N(this,"buildMenuList",()=>{const t=[],n=this.calculateMenus();for(let a=0;a<n.length;a++){const i=n[a],o=i.icon;t.push(C.jsxs("div",{className:"menu-item",onClick:i.onClick,children:[C.jsx("label",{children:C.jsx(o,{})}),C.jsx("span",{children:i.name})]},a+""))}return t})}render(){const{visible:t,position:n=[0,0]}=Vr;return C.jsx(C.Fragment,{children:t&&C.jsx("div",{className:"context-menu",style:{position:"fixed",top:n[1],left:n[0]},children:this.buildMenuList()})})}}const ah=Et(nh);var qt=(e=>(e[e.SINGLE=0]="SINGLE",e[e.COILED=1]="COILED",e))(qt||{});const ih=["control + s","alt","control + l","control + shift + l","control + h","control + k","control + 1","control + 2","control + 3","control + 4","control + 5","control + g","control + shift + g"];class oh extends _.Component{constructor(t){super(t);N(this,"handlerMapping",{});N(this,"currHotKey",[]);N(this,"existHandlerKey","");N(this,"specialDomCache",{});N(this,"getSpecialDomCache",t=>{const n=this.specialDomCache[t];if(n)return n;{const a=document.querySelector(t);return a?(this.specialDomCache[t]=a,a):null}});N(this,"doHandler",(t,n)=>{const{handler:a,triggerType:i=0,range:o}=this.handlerMapping[n]||{};if(a&&(i===0&&this.existHandlerKey!==n||i===1)){const{pointerTarget:s}=rt;if(o){const l=this.getSpecialDomCache(o);if(!l||!l.contains(s))return}Array.isArray(a)?a.forEach(l=>l(t)):a(t),this.existHandlerKey=n}});N(this,"keyDown",t=>{const n=t.key.toLowerCase();this.currHotKey.some(i=>i===n)||this.currHotKey.push(n);const a=this.currHotKey.join(" + ");ih.some(i=>i===a)&&t.preventDefault(),this.doHandler(t,a)});N(this,"keyUp",t=>{const n=t.key.toLowerCase();this.currHotKey.some(a=>a===n)&&(this.currHotKey=this.currHotKey.filter(a=>a!==n),this.existHandlerKey="")});N(this,"onBlur",()=>{this.currHotKey=[],this.existHandlerKey=""});this.handlerMapping=t.handlerMapping}componentDidMount(){document.addEventListener("keydown",this.keyDown),document.addEventListener("keyup",this.keyUp),window.onblur=this.onBlur}componentWillUnmount(){document.removeEventListener("keydown",this.keyDown),document.removeEventListener("keyup",this.keyUp),window.onblur=null}render(){return null}}const ol={"control + a":{handler:Ev,range:".lc-ruler-content"},"control + v":{handler:Ys,range:".lc-ruler-content"},"control + l":{handler:Xs},"control + shift + l":{handler:Us},"control + h":{handler:Zs},"control + arrowup":{handler:$s},"control + arrowdown":{handler:Ks},"alt + arrowup":{handler:wv},"alt + arrowdown":{handler:Rv},"control + s":{handler:Js},"control + z":{handler:Nv,range:".lc-ruler-content"},"control + shift + z":{handler:Gv,range:".lc-ruler-content"},"control + k":{handler:Av},"control + 1":{handler:jv},"control + 2":{handler:Hv},"control + 3":{handler:Vv},"control + 4":{handler:Fv},arrowup:{handler:rl,triggerType:qt.COILED,range:".lc-ruler-content"},arrowdown:{handler:nl,triggerType:qt.COILED,range:".lc-ruler-content"},arrowleft:{handler:Mv,triggerType:qt.COILED,range:".lc-ruler-content"},arrowright:{handler:Ov,triggerType:qt.COILED,range:".lc-ruler-content"},"control + shift + arrowup":{handler:Tv,triggerType:qt.COILED,range:".lc-ruler-content"},"control + shift + arrowdown":{handler:Iv,triggerType:qt.COILED,range:".lc-ruler-content"},"control + shift + arrowleft":{handler:zv,triggerType:qt.COILED,range:".lc-ruler-content"},"control + shift + arrowright":{handler:Pv,triggerType:qt.COILED,range:".lc-ruler-content"},"control + alt + arrowup":{handler:Bv,triggerType:qt.COILED,range:".lc-ruler-content"},"control + alt + arrowdown":{handler:kv,triggerType:qt.COILED,range:".lc-ruler-content"},"control + alt + arrowleft":{handler:Lv,triggerType:qt.COILED,range:".lc-ruler-content"},"control + alt + arrowright":{handler:_v,triggerType:qt.COILED,range:".lc-ruler-content"},"control + g":{handler:Qs},"control + shift + g":{handler:tl},"alt + shift + g":{handler:el}},sh=/macintosh|mac os x/i.test(navigator.userAgent),lh={delete:{handler:[il,al,Fa]},...ol},ch={"meta + backspace":{handler:[il,al,Fa]},...ol},uh=sh?ch:lh,fh=Et(e=>{const{children:r,onDoubleClick:t}=e,n=ae.useRef(null),a=ae.useRef(null),{canvasConfig:i}=U;return _.useEffect(()=>{const o=n.current,s=a.current;if(o&&s){const{setDsContentRef:l}=rt;l(s);const c=new Ws({container:o,content:s,scaleCallback:u=>{const{scale:f,ratio:d}=u,{setScale:p,setRatio:v,rulerRef:h}=rt;p(f),v(d),h==null||h.ruleWheel()},dragCallback:()=>{const{rulerRef:u}=rt;u==null||u.ruleDrag()}});return()=>{c.destroy()}}},[]),C.jsx("div",{className:"designer-ds-container",ref:n,style:{overflow:"hidden",height:window.innerHeight-110,width:window.innerWidth-115,backgroundColor:"#434343",position:"relative"},children:C.jsx("div",{className:"designer-ds-content lc-drag-scale-provider",id:"designer-ds-content",ref:a,onDoubleClick:t,style:{width:i==null?void 0:i.width,height:i==null?void 0:i.height,background:"#1c1c1c",position:"absolute"},children:r})})});class dh extends _.PureComponent{constructor(){super(...arguments);N(this,"updateActive",t=>{let{targetIds:n}=rt;const{activeElem:a,activeConfig:i}=ue;if(n.length===0){i(null,"");return}if(t.shiftKey||(n=Ve.findTopGroupLayer(n,!0)),n.length!==1)return;const o=n[0],{layerConfigs:s}=U,l=s[o];o!==a.id&&i(o,l.type)})}render(){const{layerConfigs:t}=U;return C.jsxs(C.Fragment,{children:[C.jsx(Qv,{children:C.jsx(rc,{children:C.jsx(Zv,{children:C.jsx(fh,{onDoubleClick:this.updateActive,children:C.jsx(eh,{children:jn.buildCanvasComponents(t)})})})})}),C.jsx(ah,{}),C.jsx(oh,{handlerMapping:uh})]})}}const ph=Et(dh);class vh extends _.Component{componentDidMount(){yn.getLoader().load(),gh()}componentWillUnmount(){mh()}render(){const{loaded:r}=U;return r?C.jsx("div",{style:{backgroundColor:"#1f1f1f"},children:C.jsx(qs,{header:C.jsx($v,{}),left:C.jsx(Gu,{}),content:C.jsx(ph,{}),right:C.jsx(Wu,{}),footer:C.jsx(Ku,{})})}):C.jsx(Je,{})}}const hh=Et(vh);function gh(){document.addEventListener("click",sl),document.addEventListener("contextmenu",ll),document.addEventListener("pointerdown",cl),document.addEventListener("pointerup",ul)}function mh(){document.removeEventListener("click",sl),document.removeEventListener("contextmenu",ll),document.removeEventListener("pointerdown",cl),document.removeEventListener("pointerup",ul)}const sl=e=>{const{visible:r,updateVisible:t}=Vr;if(r&&e.button===0){const n=setTimeout(()=>{t(!1),clearTimeout(n)})}},ll=e=>{e.preventDefault();const{mouseDownTime:r,mouseUpTime:t,setPosition:n,updateVisible:a}=Vr,{targetIds:i}=rt,o=["lc-comp-item","moveable-area","layer-item","layer-name","group-header","group-left","group-icon","group-name"];i&&i.length>0&&o.some(s=>{var l;return(l=e.target)==null?void 0:l.classList.contains(s)})&&t-r<200?(a&&a(!0),n([e.clientX,e.clientY])):a&&a(!1)},cl=()=>{const{setMouseDownTime:e}=Vr;e(Date.now())},ul=e=>{const{setMouseUpTime:r}=Vr;r(Date.now());const{setPointerTarget:t}=rt;t(e.target)},Ph=Object.freeze(Object.defineProperty({__proto__:null,default:hh},Symbol.toStringTag,{value:"Module"}));export{Ph as D,fe as h};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/ProjectHdItemImpl-Px9f5Ol3.js","assets/index-xvHtpy0-.js","assets/index-k5NwcpoD.css","assets/EventOperateStore-IQvFHd5q.js","assets/mobxreact.esm-bhbgzqYc.js","assets/ObjectUtil-chSHfPRu.js","assets/AntdIcon-4A_YrOev.js","assets/MonacoEditor-tUSWqGwb.js","assets/MonacoEditor-prUb3zzj.css","assets/LCGUI-SNiMvEtY.js","assets/Accordion-8bf0R7L0.js","assets/Switch-Ejz7uFg-.js","assets/UIContainer-1y1wcmMZ.js","assets/index-s96thRN1.js","assets/QuestionCircleOutlined-ABMv3OQq.js","assets/UIContainer-2wM5o6qv.css","assets/Switch-sX9zyvHK.css","assets/RightOutlined-9Q6vRlBe.js","assets/Accordion-i35kZnIZ.css","assets/Radio-AHrpdyKb.js","assets/Radio-scZDuxp-.css","assets/ColorPicker--GVXJx_9.js","assets/Overflow-dWkOYbs3.js","assets/ColorPicker-V9ASUd98.css","assets/CardPanel-tTg3SYyz.js","assets/CardPanel-8U9SL0-G.css","assets/Input-LFSkQmW6.js","assets/Input-kjLITG7W.css","assets/Grid-l48sKNap.js","assets/Grid-p4FjUlc6.css","assets/Button-8dQiU8Jj.js","assets/Button-Vi-JaWc8.css","assets/EventOperateStore-wNbCYnz3.css","assets/Select-aUrIKbLt.js","assets/Select-fufuxCpP.css","assets/LayerBuilder-WWn-hhWF.js","assets/EyeFilled-KWMdmC8V.js","assets/PlusOutlined-Zd548fDu.js","assets/PlusOutlined-VdblB-UP.js","assets/ProjectHdItemImpl-FjPOEH1V.css","assets/CanvasHdConfigImpl-O64FdWhD.js","assets/NumberInput-VuHpC1rF.js","assets/NumberInput-A_zfvH9I.css","assets/CanvasHdConfigImpl-a6I4G143.css","assets/ThemeHdItemImpl--evHAs44.js","assets/ThemeHdItemImpl-Z3GLakDl.css"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}