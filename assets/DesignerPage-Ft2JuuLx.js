var Gs=Object.defineProperty;var ks=(t,r,e)=>r in t?Gs(t,r,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[r]=e;var at=(t,r,e)=>(ks(t,typeof r!="symbol"?r+"":r,e),e);import{r as A,j as D,_ as lr,L as Zr,b as js,c as As}from"./index-Vy1Yw5o7.js";import{b as tr,e as it,D as Zn,a as rn,f as Ns,g as Ls,L as de,h as Wr,l as Z,i as Ar,r as Jt,j as Bt,U as en,o as Di,O as cr,s as Hs,p as Vs,m as et,k as Jn,n as pe,q as wt,t as Ot,u as dt,v as pt,w as Aa,x as Br,y as ve,z as rr,A as Ei,B as zt,C as Mr,E as wi,F as Ht,G as qr,H as Ce,I as Jr,J as Fs,K as xt,M as ge,N as Ri,P as or,Q as It,R as Mt,S as Or,T as Mi,V as Oi,W as Ws,X as Tr,Y as he,Z as Ti,_ as Ii,$ as qs,a0 as xr,a1 as Ys,a2 as Xs,a3 as Cr,a4 as Qn,a5 as zi,a6 as De,a7 as Us,a8 as We,a9 as Ir,aa as ee,ab as ta,ac as $s,ad as Ks,ae as Zs,af as Js,ag as Pi,ah as Qs,ai as Na,aj as me,ak as ra,al as tl,am as rl,an as La,ao as el,ap as nl,aq as al,ar as il,as as xe,at as ea,au as ar,av as Sr,aw as na,ax as aa,ay as ol,az as Ha,aA as sl,aB as ll,aC as Va,aD as er,aE as cl,aF as He,aG as ul,d as _i,aH as Bi,c as Dt,aI as nn,aJ as fl,aK as dl,aL as pl,aM as Te}from"./LayerManager-GjyFNgYQ.js";import{B as Gi,c as ki,u as vl,E as gl,o as Pt,m as an,a as hr,b as mr,D as zr,L as hl,O as ml,l as ye,t as In}from"./Dialog-Zv92ba_c.js";import{u as xl,c as yl,A as Kt,_ as St,T as bl}from"./AntdIcon-H26mUnTY.js";import qe from"./Input-cgMnXtOp.js";import{l as zn,r as Sl,c as on}from"./LayerBuilder-rtyoD02E.js";import{Grid as ia}from"./Grid-0zq_maPI.js";import{M as Cl}from"./MonacoEditor-mflYtji2.js";import sr from"./Button-TSqYfOPg.js";import{P as ji,A as Dl}from"./PlusOutlined-waRpC5HH.js";import{E as Ai,I as El,g as Sn}from"./GlobalMessage-xEmdGiIb.js";import{u as wl,C as oa,d as Rl,c as sa}from"./MainRouter-JVC0j7bk.js";import{g as Ml,K as Ol}from"./useZIndex-j0u8NYY7.js";import{o as Tl}from"./Overflow-kXLebS6p.js";import{g as Fa,P as Il,a as zl}from"./ColorPicker-EgERoCQ7.js";import{Q as Pl}from"./QuestionCircleOutlined-QjJiUeOP.js";import _l from"./Switch-JT6W9IDW.js";import Ie from"./NumberInput-HmxZMZSP.js";import Bl from"./Radio-WoN3Ah2C.js";import Gl from"./Select-XD-y743g.js";function Wa(t){return!!(t&&t.then)}const kl=t=>{const{type:r,children:e,prefixCls:n,buttonProps:a,close:i,autoFocus:o,emitEvent:s,isSilent:l,quitOnNullishReturnValue:c,actionFn:u}=t,f=A.useRef(!1),d=A.useRef(null),[p,v]=wl(!1),g=function(){i==null||i.apply(void 0,arguments)};A.useEffect(()=>{let x=null;return o&&(x=setTimeout(()=>{var y;(y=d.current)===null||y===void 0||y.focus()})),()=>{x&&clearTimeout(x)}},[]);const h=x=>{Wa(x)&&(v(!0),x.then(function(){v(!1,!0),g.apply(void 0,arguments),f.current=!1},y=>{if(v(!1,!0),f.current=!1,!(l!=null&&l()))return Promise.reject(y)}))},m=x=>{if(f.current)return;if(f.current=!0,!u){g();return}let y;if(s){if(y=u(x),c&&!Wa(y)){f.current=!1,g(x);return}}else if(u.length)y=u(i),f.current=!1;else if(y=u(),!y){g();return}h(y)};return A.createElement(Gi,Object.assign({},ki(r),{onClick:m,loading:p,prefixCls:n},a,{ref:d}),e)},jl=kl,Al=t=>{const{componentCls:r,iconCls:e,antCls:n,zIndexPopup:a,colorText:i,colorWarning:o,marginXXS:s,marginXS:l,fontSize:c,fontWeightStrong:u,colorTextHeading:f}=t;return{[r]:{zIndex:a,[`&${n}-popover`]:{fontSize:c},[`${r}-message`]:{marginBottom:l,display:"flex",flexWrap:"nowrap",alignItems:"start",[`> ${r}-message-icon ${e}`]:{color:o,fontSize:c,lineHeight:1,marginInlineEnd:l},[`${r}-title`]:{fontWeight:u,color:f,"&:only-child":{fontWeight:"normal"}},[`${r}-description`]:{marginTop:s,color:i}},[`${r}-buttons`]:{textAlign:"end",whiteSpace:"nowrap",button:{marginInlineStart:l}}}}},Nl=t=>{const{zIndexPopupBase:r}=t;return{zIndexPopup:r+60}},Ni=Ml("Popconfirm",t=>Al(t),Nl,{resetStyle:!1});var Ll=function(t,r){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(e[n[a]]=t[n[a]]);return e};const Li=t=>{const{prefixCls:r,okButtonProps:e,cancelButtonProps:n,title:a,description:i,cancelText:o,okText:s,okType:l="primary",icon:c=A.createElement(Ai,null),showCancel:u=!0,close:f,onConfirm:d,onCancel:p,onPopupClick:v}=t,{getPrefixCls:g}=A.useContext(oa),[h]=vl("Popconfirm",Rl.Popconfirm),m=Fa(a),x=Fa(i);return A.createElement("div",{className:`${r}-inner-content`,onClick:v},A.createElement("div",{className:`${r}-message`},c&&A.createElement("span",{className:`${r}-message-icon`},c),A.createElement("div",{className:`${r}-message-text`},m&&A.createElement("div",{className:sa(`${r}-title`)},m),x&&A.createElement("div",{className:`${r}-description`},x))),A.createElement("div",{className:`${r}-buttons`},u&&A.createElement(Gi,Object.assign({onClick:p,size:"small"},n),o??(h==null?void 0:h.cancelText)),A.createElement(jl,{buttonProps:Object.assign(Object.assign({size:"small"},ki(l)),e),actionFn:d,close:f,prefixCls:g("btn"),quitOnNullishReturnValue:!0,emitEvent:!0},s??(h==null?void 0:h.okText))))},Hl=t=>{const{prefixCls:r,placement:e,className:n,style:a}=t,i=Ll(t,["prefixCls","placement","className","style"]),{getPrefixCls:o}=A.useContext(oa),s=o("popconfirm",r),[l]=Ni(s);return l(A.createElement(Il,{placement:e,className:sa(s,n),style:a,content:A.createElement(Li,Object.assign({prefixCls:s},i))}))},Vl=Hl;var Fl=function(t,r){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(e[n[a]]=t[n[a]]);return e};const Hi=A.forwardRef((t,r)=>{var e,n;const{prefixCls:a,placement:i="top",trigger:o="click",okType:s="primary",icon:l=A.createElement(Ai,null),children:c,overlayClassName:u,onOpenChange:f,onVisibleChange:d}=t,p=Fl(t,["prefixCls","placement","trigger","okType","icon","children","overlayClassName","onOpenChange","onVisibleChange"]),{getPrefixCls:v}=A.useContext(oa),[g,h]=xl(!1,{value:(e=t.open)!==null&&e!==void 0?e:t.visible,defaultValue:(n=t.defaultOpen)!==null&&n!==void 0?n:t.defaultVisible}),m=(O,P)=>{h(O,!0),d==null||d(O),f==null||f(O,P)},x=O=>{m(!1,O)},y=O=>{var P;return(P=t.onConfirm)===null||P===void 0?void 0:P.call(void 0,O)},S=O=>{var P;m(!1,O),(P=t.onCancel)===null||P===void 0||P.call(void 0,O)},E=O=>{O.keyCode===Ol.ESC&&g&&m(!1,O)},b=O=>{const{disabled:P=!1}=t;P||m(O)},C=v("popconfirm",a),w=sa(C,u),[T]=Ni(C);return T(A.createElement(zl,Object.assign({},Tl(p,["title"]),{trigger:o,placement:i,onOpenChange:b,open:g,ref:r,overlayClassName:w,content:A.createElement(Li,Object.assign({okType:s,icon:l},t,{prefixCls:C,close:x,onConfirm:y,onCancel:S})),"data-popover-inject":!0}),yl(c,{onKeyDown:O=>{var P,z;A.isValidElement(c)&&((z=c==null?void 0:(P=c.props).onKeyDown)===null||z===void 0||z.call(P,O)),E(O)}})))});Hi._InternalPanelDoNotUseOrYouWillBeFired=Vl;const Wl=Hi;var ql={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M193 796c0 17.7 14.3 32 32 32h574c17.7 0 32-14.3 32-32V563c0-176.2-142.8-319-319-319S193 386.8 193 563v233zm72-233c0-136.4 110.6-247 247-247s247 110.6 247 247v193H404V585c0-5.5-4.5-10-10-10h-44c-5.5 0-10 4.5-10 10v171h-75V563zm-48.1-252.5l39.6-39.6c3.1-3.1 3.1-8.2 0-11.3l-67.9-67.9a8.03 8.03 0 00-11.3 0l-39.6 39.6a8.03 8.03 0 000 11.3l67.9 67.9c3.1 3.1 8.1 3.1 11.3 0zm669.6-79.2l-39.6-39.6a8.03 8.03 0 00-11.3 0l-67.9 67.9a8.03 8.03 0 000 11.3l39.6 39.6c3.1 3.1 8.2 3.1 11.3 0l67.9-67.9c3.1-3.2 3.1-8.2 0-11.3zM832 892H192c-17.7 0-32 14.3-32 32v24c0 4.4 3.6 8 8 8h688c4.4 0 8-3.6 8-8v-24c0-17.7-14.3-32-32-32zM484 180h56c4.4 0 8-3.6 8-8V76c0-4.4-3.6-8-8-8h-56c-4.4 0-8 3.6-8 8v96c0 4.4 3.6 8 8 8z"}}]},name:"alert",theme:"outlined"};const Yl=ql;var Vi=function(r,e){return A.createElement(Kt,St(St({},r),{},{ref:e,icon:Yl}))};Vi.displayName="AlertOutlined";const Xl=A.forwardRef(Vi);var Ul={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M864 248H728l-32.4-90.8a32.07 32.07 0 00-30.2-21.2H358.6c-13.5 0-25.6 8.5-30.1 21.2L296 248H160c-44.2 0-80 35.8-80 80v456c0 44.2 35.8 80 80 80h704c44.2 0 80-35.8 80-80V328c0-44.2-35.8-80-80-80zm8 536c0 4.4-3.6 8-8 8H160c-4.4 0-8-3.6-8-8V328c0-4.4 3.6-8 8-8h186.7l17.1-47.8 22.9-64.2h250.5l22.9 64.2 17.1 47.8H864c4.4 0 8 3.6 8 8v456zM512 384c-88.4 0-160 71.6-160 160s71.6 160 160 160 160-71.6 160-160-71.6-160-160-160zm0 256c-53 0-96-43-96-96s43-96 96-96 96 43 96 96-43 96-96 96z"}}]},name:"camera",theme:"outlined"};const $l=Ul;var Fi=function(r,e){return A.createElement(Kt,St(St({},r),{},{ref:e,icon:$l}))};Fi.displayName="CameraOutlined";const Kl=A.forwardRef(Fi);var Zl={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M326 664H104c-8.8 0-16 7.2-16 16v48c0 8.8 7.2 16 16 16h174v176c0 8.8 7.2 16 16 16h48c8.8 0 16-7.2 16-16V696c0-17.7-14.3-32-32-32zm16-576h-48c-8.8 0-16 7.2-16 16v176H104c-8.8 0-16 7.2-16 16v48c0 8.8 7.2 16 16 16h222c17.7 0 32-14.3 32-32V104c0-8.8-7.2-16-16-16zm578 576H698c-17.7 0-32 14.3-32 32v224c0 8.8 7.2 16 16 16h48c8.8 0 16-7.2 16-16V744h174c8.8 0 16-7.2 16-16v-48c0-8.8-7.2-16-16-16zm0-384H746V104c0-8.8-7.2-16-16-16h-48c-8.8 0-16 7.2-16 16v224c0 17.7 14.3 32 32 32h222c8.8 0 16-7.2 16-16v-48c0-8.8-7.2-16-16-16z"}}]},name:"compress",theme:"outlined"};const Jl=Zl;var Wi=function(r,e){return A.createElement(Kt,St(St({},r),{},{ref:e,icon:Jl}))};Wi.displayName="CompressOutlined";const Ql=A.forwardRef(Wi);var qi=function(r,e){return A.createElement(Kt,St(St({},r),{},{ref:e,icon:gl}))};qi.displayName="EyeOutlined";const tc=A.forwardRef(qi);var rc={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM429 481.2c-1.9-4.4-6.2-7.2-11-7.2h-35c-6.6 0-12 5.4-12 12v272c0 6.6 5.4 12 12 12h27.1c6.6 0 12-5.4 12-12V582.1l66.8 150.2a12 12 0 0011 7.1H524c4.7 0 9-2.8 11-7.1l66.8-150.6V758c0 6.6 5.4 12 12 12H641c6.6 0 12-5.4 12-12V486c0-6.6-5.4-12-12-12h-34.7c-4.8 0-9.1 2.8-11 7.2l-83.1 191-83.2-191z"}}]},name:"file-markdown",theme:"outlined"};const ec=rc;var Yi=function(r,e){return A.createElement(Kt,St(St({},r),{},{ref:e,icon:ec}))};Yi.displayName="FileMarkdownOutlined";const nc=A.forwardRef(Yi);var ac={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M511.6 76.3C264.3 76.2 64 276.4 64 523.5 64 718.9 189.3 885 363.8 946c23.5 5.9 19.9-10.8 19.9-22.2v-77.5c-135.7 15.9-141.2-73.9-150.3-88.9C215 726 171.5 718 184.5 703c30.9-15.9 62.4 4 98.9 57.9 26.4 39.1 77.9 32.5 104 26 5.7-23.5 17.9-44.5 34.7-60.8-140.6-25.2-199.2-111-199.2-213 0-49.5 16.3-95 48.3-131.7-20.4-60.5 1.9-112.3 4.9-120 58.1-5.2 118.5 41.6 123.2 45.3 33-8.9 70.7-13.6 112.9-13.6 42.4 0 80.2 4.9 113.5 13.9 11.3-8.6 67.3-48.8 121.3-43.9 2.9 7.7 24.7 58.3 5.5 118 32.4 36.8 48.9 82.7 48.9 132.3 0 102.2-59 188.1-200 212.9a127.5 127.5 0 0138.1 91v112.5c.8 9 0 17.9 15 17.9 177.1-59.7 304.6-227 304.6-424.1 0-247.2-200.4-447.3-447.5-447.3z"}}]},name:"github",theme:"outlined"};const ic=ac;var Xi=function(r,e){return A.createElement(Kt,St(St({},r),{},{ref:e,icon:ic}))};Xi.displayName="GithubOutlined";const oc=A.forwardRef(Xi);var Ui=function(r,e){return A.createElement(Kt,St(St({},r),{},{ref:e,icon:El}))};Ui.displayName="InfoCircleFilled";const sc=A.forwardRef(Ui);var lc={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M956.9 845.1L896.4 632V168c0-17.7-14.3-32-32-32h-704c-17.7 0-32 14.3-32 32v464L67.9 845.1C60.4 866 75.8 888 98 888h828.8c22.2 0 37.6-22 30.1-42.9zM200.4 208h624v395h-624V208zm228.3 608l8.1-37h150.3l8.1 37H428.7zm224 0l-19.1-86.7c-.8-3.7-4.1-6.3-7.8-6.3H398.2c-3.8 0-7 2.6-7.8 6.3L371.3 816H151l42.3-149h638.2l42.3 149H652.7z"}}]},name:"laptop",theme:"outlined"};const cc=lc;var $i=function(r,e){return A.createElement(Kt,St(St({},r),{},{ref:e,icon:cc}))};$i.displayName="LaptopOutlined";const uc=A.forwardRef($i);var fc={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M872 474H152c-4.4 0-8 3.6-8 8v60c0 4.4 3.6 8 8 8h720c4.4 0 8-3.6 8-8v-60c0-4.4-3.6-8-8-8z"}}]},name:"minus",theme:"outlined"};const dc=fc;var Ki=function(r,e){return A.createElement(Kt,St(St({},r),{},{ref:e,icon:dc}))};Ki.displayName="MinusOutlined";const la=A.forwardRef(Ki);var pc={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"defs",attrs:{},children:[{tag:"style",attrs:{}}]},{tag:"path",attrs:{d:"M640.6 429.8h257.1c7.9 0 14.3-6.4 14.3-14.3V158.3c0-7.9-6.4-14.3-14.3-14.3H640.6c-7.9 0-14.3 6.4-14.3 14.3v92.9H490.6c-3.9 0-7.1 3.2-7.1 7.1v221.5h-85.7v-96.5c0-7.9-6.4-14.3-14.3-14.3H126.3c-7.9 0-14.3 6.4-14.3 14.3v257.2c0 7.9 6.4 14.3 14.3 14.3h257.1c7.9 0 14.3-6.4 14.3-14.3V544h85.7v221.5c0 3.9 3.2 7.1 7.1 7.1h135.7v92.9c0 7.9 6.4 14.3 14.3 14.3h257.1c7.9 0 14.3-6.4 14.3-14.3v-257c0-7.9-6.4-14.3-14.3-14.3h-257c-7.9 0-14.3 6.4-14.3 14.3v100h-78.6v-393h78.6v100c0 7.9 6.4 14.3 14.3 14.3zm53.5-217.9h150V362h-150V211.9zM329.9 587h-150V437h150v150zm364.2 75.1h150v150.1h-150V662.1z"}}]},name:"partition",theme:"outlined"};const vc=pc;var Zi=function(r,e){return A.createElement(Kt,St(St({},r),{},{ref:e,icon:vc}))};Zi.displayName="PartitionOutlined";const gc=A.forwardRef(Zi);var hc={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M893.3 293.3L730.7 130.7c-7.5-7.5-16.7-13-26.7-16V112H144c-17.7 0-32 14.3-32 32v736c0 17.7 14.3 32 32 32h736c17.7 0 32-14.3 32-32V338.5c0-17-6.7-33.2-18.7-45.2zM384 184h256v104H384V184zm456 656H184V184h136v136c0 17.7 14.3 32 32 32h320c17.7 0 32-14.3 32-32V205.8l136 136V840zM512 442c-79.5 0-144 64.5-144 144s64.5 144 144 144 144-64.5 144-144-64.5-144-144-144zm0 224c-44.2 0-80-35.8-80-80s35.8-80 80-80 80 35.8 80 80-35.8 80-80 80z"}}]},name:"save",theme:"outlined"};const mc=hc;var Ji=function(r,e){return A.createElement(Kt,St(St({},r),{},{ref:e,icon:mc}))};Ji.displayName="SaveOutlined";const xc=A.forwardRef(Ji),yc=()=>{const t=e=>{if(!e||e==="")return;const{setMenu:n}=tr;n(e);const{rulerRef:a}=it;a&&a.ruleWheel()},r=()=>{const{menus:e,menu:n}=tr,a=[];for(let i=0;i<e.length;i++){const{icon:o,name:s,key:l}=e[i];a.push(D.jsxs("div",{className:`menu-item ${l===n?"menu-item-active":""}`,onClick:()=>t(l),children:[D.jsx("div",{className:"menu-item-icon",children:D.jsx(o,{})}),D.jsx("span",{className:"menu-item-content",children:s})]},i+""))}return a};return D.jsx("div",{className:"designer-left-menus",style:{overflowY:"scroll"},children:r()})},bc=Pt(yc);class Sc{constructor(){at(this,"compInfoArr",[]);at(this,"categories","all");at(this,"subCategories","all");at(this,"search","");at(this,"setCategories",r=>this.categories=r);at(this,"setSubCategories",r=>this.subCategories=r);at(this,"setSearch",r=>this.search=r);at(this,"doInit",()=>{const r=[],{definitionMap:e}=Zn.getLoader(rn.EDIT);e&&Object.keys(e).forEach(n=>{const a=e[n].getBaseInfo();a.compKey!=="group"&&r.push(a)}),this.compInfoArr=r});an(this,{categories:hr,subCategories:hr,search:hr,setCategories:mr,setSubCategories:mr,setSearch:mr})}}const Qi=new Sc,Cc=A.lazy(()=>lr(()=>import("./CompList-ihkCQbjq.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44]))),Dc=Pt(()=>{const{categories:t,setCategories:r,setSubCategories:e}=Qi;return D.jsx(D.Fragment,{children:Ns.map((n,a)=>{const{icon:i,name:o,key:s}=n,l=i;return D.jsx(bl,{className:`clo-item ${t===s?"clo-item-active":""}`,placement:"right",title:o,children:D.jsx(l,{onClick:()=>{r(s),e("all")}})},a)})})}),Ec=Pt(()=>{const{categories:t,subCategories:r,setSubCategories:e}=Qi;return D.jsx(D.Fragment,{children:Ls.map((n,a)=>{const{name:i,key:o,parentKey:s}=n;if(t==="all"||o==="all"||s===t)return D.jsx("div",{onClick:()=>e(o),className:`clt-item ${r===o?"clt-item-active":""}`,children:i},a)})})}),wc=()=>D.jsxs("div",{className:"dl-component-list",children:[D.jsxs("div",{className:"dl-cl-header",children:[D.jsx("div",{className:"dl-cl-header-title",children:"组件列表"}),D.jsx("div",{className:"dl-cl-header-operate",children:D.jsx(la,{onClick:()=>{const{setMenu:t}=tr;t("");const{rulerRef:r}=it;r==null||r.ruleWheel()}})})]}),D.jsx("div",{className:"dl-cl-body",children:D.jsxs(A.Suspense,{fallback:D.jsx(Zr,{}),children:[D.jsx("div",{className:"main-categories",children:D.jsx(Dc,{})}),D.jsx("div",{className:"sub-categories",children:D.jsx(Ec,{})}),D.jsx("div",{className:"component-list",children:D.jsx(Cc,{})})]})})]});class Rc extends A.Component{constructor(){super(...arguments);at(this,"layerListRef",null);at(this,"layerItemsContainerRef",null);at(this,"cancelSelected",e=>{var n;if(this.layerListRef&&this.layerListRef.contains(e.target)&&!((n=this.layerItemsContainerRef)!=null&&n.contains(e.target))){const{setTargetIds:a,targetIds:i}=it;i.length>0&&a([])}});at(this,"searchLayer",e=>{const{setContent:n}=Wr;n&&n(e)});at(this,"buildLayerList",()=>{const{layerConfigs:e}=Z,{searchContent:n}=Wr;if(!n||n==="")return zn.buildLayerList(e);const a={};return n===":hide"?Object.values(e).forEach(o=>{o.hide&&o.type!=="group"&&(a[o.id]=o)}):n===":lock"?Object.values(e).forEach(o=>{o.lock&&o.type!=="group"&&(a[o.id]=o)}):Object.values(e).forEach(o=>{var s;(s=o.name)!=null&&s.includes(n)&&o.type!=="group"&&(a[o.id]=o)}),de.findPathGroupLayer(Object.keys(a)).forEach(o=>{a[o]=e[o]}),zn.buildLayerList(a)})}componentDidMount(){var e;(e=this.layerListRef)==null||e.addEventListener("click",this.cancelSelected)}componentWillUnmount(){var e;(e=this.layerListRef)==null||e.removeEventListener("click",this.cancelSelected)}render(){return D.jsxs("div",{className:"layer-list",ref:e=>this.layerListRef=e,children:[D.jsxs("div",{className:"dl-ll-header",children:[D.jsx("div",{className:"dl-ll-header-title",children:"图层列表"}),D.jsx("div",{className:"dl-ll-header-operate",children:D.jsx(la,{onClick:()=>{const{setMenu:e}=tr;e("");const{rulerRef:n}=it;n==null||n.ruleWheel()}})})]}),D.jsx("div",{className:"list-search",children:D.jsx(qe,{placeholder:"搜索图层",onChange:this.searchLayer})}),D.jsx("div",{className:"layer-items",children:D.jsx("div",{ref:e=>this.layerItemsContainerRef=e,children:this.buildLayerList()})})]})}}const Mc=Pt(Rc),Oc=A.lazy(()=>lr(()=>import("./ImageSource-JSPBJJzA.js"),__vite__mapDeps([45,1,2,11,3,4,5,6,7,8,9,10,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,46])));function Tc(){return D.jsxs("div",{className:"source-library",children:[D.jsx("div",{className:"source-categorize",children:D.jsx("div",{className:"categorize-item",children:"图片"})}),D.jsx("div",{className:"source-library-content",children:D.jsx(A.Suspense,{fallback:D.jsx(Zr,{}),children:D.jsx(Oc,{})})})]})}const Ic=Pt(()=>{const{setVisibility:t,addFilter:r,updateFilter:e}=Ar,n=A.useRef(Ar.editFilter),a=()=>{n.current.id?e(n.current):r(n.current),t(!1)};return D.jsxs(zr,{title:"新增过滤器",visible:!0,width:600,className:"add-filter-dialog",onClose:()=>Ar.setVisibility(!1),children:[D.jsxs(ia,{children:[D.jsx(qe,{label:"名称",defaultValue:n.current.name,onChange:i=>n.current.name=i}),D.jsxs("code",{className:"code-start",children:[D.jsx("span",{style:{color:"#569cd6"},children:"function"})," filter",D.jsx("span",{style:{color:"#ffd700"},children:"("}),D.jsx("span",{style:{color:"#8c8c8c"},children:"data"}),D.jsxs("span",{style:{color:"#ffd700"},children:[") ","{"]})]}),D.jsx(Cl,{defaultValue:n.current.func,language:"javascript",onChange:i=>n.current.func=i,height:400}),D.jsx("code",{style:{color:"#ffd700"},children:"}"})]}),D.jsxs("div",{className:"add-filter-dialog-footer",children:[D.jsx(sr,{onClick:a,children:"保存"}),"  ",D.jsx(sr,{onClick:()=>Ar.setVisibility(!1),children:"取消"})]})]})}),zc=Pt(()=>{const{filters:t,setEditFilter:r,delFilter:e,setVisibility:n}=Ar;return D.jsxs(D.Fragment,{children:[D.jsxs("div",{className:"dl-filter-list",children:[D.jsxs("div",{className:"dl-fl-header",children:[D.jsx("div",{children:"全局过滤器"}),D.jsxs("div",{children:[D.jsx(ji,{onClick:()=>n(!0)}),"  ",D.jsx(la,{onClick:()=>{const{setMenu:a}=tr;a("");const{rulerRef:i}=it;i==null||i.ruleWheel()}})]})]}),D.jsx("div",{className:"dl-fl-body",children:Object.values(t).map(a=>D.jsxs("div",{className:"filter-item",children:[D.jsx("div",{className:"filter-name",children:a.name}),D.jsxs("div",{className:"filter-operate",children:[D.jsx("span",{onClick:()=>{r(a),n(!0)},children:"编辑"}),"  ",D.jsx(Wl,{title:"提示信息",icon:D.jsx(Pl,{style:{color:"red"}}),description:"删除后无法撤销，确认删除嘛？",onConfirm:()=>e(a.id),okText:"是",cancelText:"否",children:D.jsx("span",{children:"删除"})})]})]},a.id))})]}),Ar.visible&&D.jsx(Ic,{})]})}),Pc=Pt(()=>{const{menu:t,setDesignerLeftRef:r}=tr,e=A.useRef(null);return A.useEffect(()=>{r(e.current)},[]),D.jsxs("div",{className:"designer-left",ref:e,children:[D.jsx(bc,{}),t==="components"&&D.jsx(wc,{}),t==="layer-list"&&D.jsx(Mc,{}),t==="source-list"&&D.jsx(Tc,{}),t==="filter-list"&&D.jsx(zc,{})]})});class _c extends A.Component{constructor(){super(...arguments);at(this,"menuChange",e=>{const{setActiveMenu:n,setContentVisible:a}=Jt;n&&n(e.currentTarget.id),a&&a(!0)});at(this,"buildMenuList",()=>{const{menus:e,activeMenu:n}=Jt;return e.length===0?D.jsxs("div",{style:{writingMode:"vertical-rl",color:"#bababa",letterSpacing:"8px",padding:7,fontSize:12},children:[D.jsx(sc,{style:{fontSize:15,position:"relative",left:2,marginBottom:7}}),"双击组件激活..."]}):e.map(a=>{const i=a.icon;return D.jsxs("div",{className:`menu-item ${n===a.key?"menu-item-active":""}`,id:a.key,onClick:this.menuChange,children:[D.jsx("div",{className:"item-icon",children:D.jsx(i,{})}),D.jsx("div",{className:"item-content",children:a.name})]},a.key)})})}render(){return D.jsx("div",{className:"lc-config-menu",children:D.jsx("div",{className:"menu-list",children:this.buildMenuList()})})}}const Bc=Pt(_c),Gc=()=>{const t=o=>new Proxy(o,{get(s,l){const c=s[l];return typeof c=="function"&&c.name==="update"?new Proxy(c,{apply(u,f,d){const p=d[0],v=ml.getOriginValue(f.config,d[0]);return Bt.doStyleUpd(p,v),u.apply(f,d)}}):c}}),r=()=>{const{compController:o}=Z,{activeMenu:s,activeElem:l}=Jt,c=Zn.getLoader(rn.EDIT).definitionMap[l.type+""];if(!c)return;const f=c.getMenuToConfigContentMap()[s],d=t(o[l.id+""]);if(f)return D.jsx(A.Suspense,{fallback:D.jsx(Zr,{}),children:D.jsx(f,{controller:d})})},e=()=>{const{setContentVisible:o,setActiveMenu:s}=Jt;o&&o(!1),s&&s("")},{activeMenu:n,menus:a}=Jt;let i="";for(let o=0;o<a.length;o++)if(a[o].key===n){i=a[o].name;break}return D.jsxs("div",{className:"lc-config-panel",children:[D.jsxs("div",{className:"lc-panel-top",children:[D.jsx("div",{className:"panel-title",children:D.jsx("span",{children:i})}),D.jsx("div",{className:"panel-operate",onClick:e,children:D.jsx(hl,{})})]}),D.jsx("div",{className:"lc-panel-content",children:r()})]})},kc=Pt(Gc),jc=Pt(()=>{const{visible:t}=Jt;return D.jsxs(D.Fragment,{children:[D.jsx(Bc,{}),t&&D.jsx(kc,{})]})}),Ac=[{name:"保存项目",windows:"ctrl + s",mac:"ctrl + s"},{name:"复制组件",windows:"ctrl + v",mac:"ctrl + v"},{name:"锁定组件",windows:"ctrl + l",mac:"ctrl + l"},{name:"解锁组件",windows:"ctrl + shift + l",mac:"ctrl + shift + l"},{name:"隐藏组件",windows:"ctrl + h",mac:"ctrl + h"},{name:"开/关辅助边框",windows:"ctrl + k",mac:"ctrl + k"},{name:"图层置顶",windows:"ctrl + up-arrow(方向上键)",mac:"ctrl + up-arrow(方向上键)"},{name:"图层置底",windows:"ctrl + down-arrow(方向下键)",mac:"ctrl + down-arrow(方向下键)"},{name:"图层上移",windows:"alt + up-arrow(方向上键)",mac:"options + up-arrow(方向上键)"},{name:"图层下移",windows:"alt + down-arrow(方向下键)",mac:"options + down-arrow(方向下键)"},{name:"删除组件",windows:"delete",mac:"command + backspace"},{name:"缩放画布",windows:"alt + wheel(鼠标滑轮)",mac:"options + wheel(鼠标滑轮)"},{name:"拖拽画布",windows:"长按鼠标右键",mac:"长按鼠标右键"},{name:"组件上移",windows:"方向上键",mac:"方向上键"},{name:"组件下移",windows:"方向下键",mac:"方向下键"},{name:"组件左移",windows:"方向左键",mac:"方向左键"},{name:"组件右移",windows:"方向右键",mac:"方向右键"},{name:"组件上扩大",windows:"ctrl + shift + 方向上键",mac:"ctrl + shift + 方向上键"},{name:"组件下扩大",windows:"ctrl + shift + 方向下键",mac:"ctrl + shift + 方向下键"},{name:"组件左扩大",windows:"ctrl + shift + 方向左键",mac:"ctrl + shift + 方向左键"},{name:"组件右扩大",windows:"ctrl + shift + 方向右键",mac:"ctrl + shift + 方向右键"},{name:"组件上缩小",windows:"ctrl + alt + 方向上键",mac:"ctrl + options + 方向上键"},{name:"组件下缩小",windows:"ctrl + alt + 方向下键",mac:"ctrl + options + 方向下键"},{name:"组件左缩小",windows:"ctrl + alt + 方向左键",mac:"ctrl + options + 方向左键"},{name:"组件右缩小",windows:"ctrl + alt + 方向右键",mac:"ctrl + options + 方向右键"},{name:"撤销",windows:"ctrl + z",mac:"ctrl + z"},{name:"重做",windows:"ctrl + shift + z",mac:"ctrl + shift + z"},{name:"打开/关闭项目设置",windows:"ctrl + 1",mac:"ctrl + 1"},{name:"打开/关闭画布设置",windows:"ctrl + 2",mac:"ctrl + 2"},{name:"打开/关闭全局主题设置",windows:"ctrl + 3",mac:"ctrl + 3"},{name:"打开/关闭快捷键说明",windows:"ctrl + 4",mac:"ctrl + 4"},{name:"编组",windows:"ctrl + g",mac:"ctrl + g"},{name:"解除编组",windows:"ctrl + shift + g",mac:"ctrl + shift + g"},{name:"从分组中移除",windows:"alt + shift + g",mac:"options + shift + g"}],Nc=t=>{const{onClose:r}=t;return D.jsx(zr,{title:"快捷键说明",visible:!0,width:800,onClose:r,children:D.jsx("div",{className:"lc-hotkey-des",style:{color:"white"},children:D.jsxs("table",{className:"hotkey-des-table",children:[D.jsx("thead",{children:D.jsxs("tr",{children:[D.jsx("th",{style:{width:"10%"},children:"编号"}),D.jsx("th",{style:{textAlign:"left"},children:"功能"}),D.jsx("th",{style:{textAlign:"left"},children:"Windows"}),D.jsx("th",{style:{textAlign:"left"},children:"Mac"})]})}),D.jsx("tbody",{children:Ac.map((e,n)=>D.jsxs("tr",{children:[D.jsx("td",{children:n+1}),D.jsx("td",{style:{textAlign:"left"},children:e.name}),D.jsx("td",{style:{textAlign:"left"},children:e.windows}),D.jsx("td",{style:{textAlign:"left"},children:e.mac})]},n))})]})})})};class Lc{constructor(){at(this,"hotKeyVisible",!1);at(this,"snapShotVisible",!1);at(this,"setHotKeyVisible",r=>this.hotKeyVisible=r);at(this,"setSnapShotVisible",r=>this.snapShotVisible=r);an(this,{hotKeyVisible:hr,snapShotVisible:hr,setHotKeyVisible:mr,setSnapShotVisible:mr})}}const Ve=new Lc,Hc=t=>{const{onClose:r}=t,e=A.useRef(null),n=A.useRef(null),a={uid:"-1",name:"image.png",status:"done"},[i,o]=A.useState([]),s=()=>{var f;if(!n.current){(f=Sn.messageApi)==null||f.warning("请先上传封面");return}const{saveType:u}=en.parseUrlParams();Di[u].uploadCover(n.current).then(d=>{var p,v;d?(p=Sn.messageApi)==null||p.info("封面生成成功！"):(v=Sn.messageApi)==null||v.error("封面生成失败！")})},l=()=>{e.current&&(URL.revokeObjectURL(e.current),n.current=null),r()},c=u=>{n.current=u;const f=new FileReader;return f.onload=async d=>{const p=new Blob([d.target.result],{type:u.type}),v=URL.createObjectURL(p);e.current=v,o([{...a,url:v}])},f.readAsArrayBuffer(u),!1};return D.jsx(zr,{title:"封面",className:"cover-config",visible:!0,width:500,onClose:l,children:D.jsxs("div",{className:"cover-content",children:[D.jsx("div",{className:"cover-left",children:D.jsx(Dl,{name:"file",beforeUpload:c,listType:"picture-card",fileList:i,accept:"image/*",onRemove:()=>o([]),onPreview:()=>window.open(i[0].url),children:i.length>0?null:D.jsxs("div",{className:"upload-btn",children:[D.jsx(ji,{}),D.jsx("div",{style:{marginTop:8},children:"Upload"})]})})}),D.jsx("div",{className:"cover-right",children:D.jsx(sr,{onClick:s,children:"保存"})})]})})},Vc=()=>{const t=()=>{const{hotKeyVisible:o,setHotKeyVisible:s}=Ve;s(!o)},r=()=>{const{snapShotVisible:o,setSnapShotVisible:s}=Ve;s(!o)},{layerConfigs:e}=Z,{hotKeyVisible:n,snapShotVisible:a}=Ve,{scale:i}=it;return D.jsxs("div",{className:"lc-designer-footer",children:[D.jsxs("div",{className:"footer-left",children:[D.jsxs("div",{className:"footer-item",onClick:t,children:[D.jsx(uc,{}),D.jsx("span",{children:"快捷键"})]}),D.jsxs("div",{className:"footer-item",onClick:r,children:[D.jsx(Kl,{}),D.jsx("span",{children:"封面"})]}),D.jsxs("div",{className:"footer-item",onClick:()=>window.open("https://xiaopujun.github.io/light-chaser-doc"),children:[D.jsx(nc,{}),D.jsx("span",{children:"文档"})]}),D.jsxs("div",{className:"footer-item",onClick:()=>window.open("https://github.com/xiaopujun/light-chaser"),children:[D.jsx(oc,{}),D.jsx("span",{children:"GitHub"})]})]}),D.jsxs("div",{className:"footer-right",children:[D.jsxs("div",{className:"right-info-item",children:["缩放 : ",(i*100).toFixed(0),"%"]}),D.jsxs("div",{className:"right-info-item",children:["图层 : ",Object.keys(e).length]})]}),n&&D.jsx(Nc,{onClose:t}),a&&D.jsx(Hc,{onClose:r})]})},Fc=Pt(Vc);class ur{}class Wc extends ur{redo(r){if(!r)return;const{movableRef:e,setBackoff:n,setTargetIds:a}=it,{next:i}=r,o=i;a(o.ids),n(!0),Promise.resolve().then(()=>{e==null||e.request("draggable",{x:o.x,y:o.y},!0)})}undo(r){if(!r)return;const{movableRef:e,setBackoff:n,setTargetIds:a}=it,{prev:i}=r,o=i;a(o.ids),n(!0),Promise.resolve().then(()=>{e==null||e.request("draggable",{x:o.x,y:o.y},!0)})}}const qc=new Wc;class Yc extends ur{redo(r){if(!r)return;const{movableRef:e,setBackoff:n,setTargetIds:a}=it,{next:i}=r,o=i;a(o.ids),n(!0),Promise.resolve().then(()=>{e==null||e.request("resizable",{offsetWidth:o.width,offsetHeight:o.height,direction:o.direction},!0)})}undo(r){if(!r)return;const{movableRef:e,setBackoff:n,setTargetIds:a}=it,{prev:i}=r,o=i;a(o.ids),n(!0),Promise.resolve().then(()=>{e==null||e.request("resizable",{offsetWidth:o.width,offsetHeight:o.height,direction:o.direction},!0)})}}const Xc=new Yc;class Uc extends ur{redo(r){if(!r)return;const{next:e}=r,{addItem:n}=Z;e.forEach(a=>{"id"in a&&n(ye.cloneDeep(a.layerConfig)),"layerHeader"in a&&(Z.layerHeader=a.layerHeader),"layerTail"in a&&(Z.layerTail=a.layerTail)})}undo(r){if(!r)return;const{setTargetIds:e,focusDesignerCanvas:n}=it,{prev:a,next:i}=r,{delItem:o}=Z,s=[];i&&i.forEach(f=>s.push(f.id)),o(s),a&&a.forEach(f=>{"layerHeader"in f&&(Z.layerHeader=f.layerHeader),"layerTail"in f&&(Z.layerTail=f.layerTail)}),e([]);const{setContentVisible:l,activeConfig:c,activeElem:u}=Jt;s.includes(u.id)&&(l(!1),c(null,"")),n()}}const $c=new Uc;class Kc extends ur{redo(r){if(!r)return;const{prev:e,next:n}=r,a=[];e.forEach(c=>{"id"in c&&a.push(c)});const{delItem:i}=Z,o=[];a.forEach(c=>o.push(c.id)),i(o),n&&n.forEach(c=>{"layerHeader"in c&&(Z.layerHeader=c.layerHeader),"layerTail"in c&&(Z.layerTail=c.layerTail)});const{setTargetIds:s,focusDesignerCanvas:l}=it;s([]),l(),console.log("del redo",In(Z.layerConfigs),Z.layerHeader,Z.layerTail)}undo(r){if(!r)return;const{setTargetIds:e}=it,{prev:n}=r,a=[],i=[];n.forEach(c=>{"id"in c?a.push(c):i.push(c)});const{addItem:o,elemConfigs:s}=Z,l=[];a.forEach(c=>{o(ye.cloneDeep(c.layerConfig)),s[c.id]=c.elemConfig,l.push(c.id)}),i.forEach(c=>{"layerHeader"in c&&(Z.layerHeader=c.layerHeader),"layerTail"in c&&(Z.layerTail=c.layerTail)}),Promise.resolve().then(()=>e(l)),console.log("del undo",In(Z.layerConfigs),Z.layerHeader,Z.layerTail)}}const Zc=new Kc;class Jc extends ur{redo(r){const{next:e}=r;if(e){const{id:n,data:a}=e,{compController:i}=Z,o=i[n];o&&o.update(a);const{visible:s,setContentVisible:l}=Jt;if(s){l(!1);const c=setTimeout(()=>{l(!0),clearTimeout(c)},1)}}}undo(r){const{prev:e}=r;if(e){const{id:n,data:a}=e,{compController:i}=Z,o=i[n];o&&o.update(a);const{visible:s,setContentVisible:l}=Jt;if(s){l(!1);const c=setTimeout(()=>{l(!0),clearTimeout(c)},1)}}}}const Qc=new Jc;class tu extends ur{redo(r){if(!r)return;const{next:e}=r,{updateLayer:n}=Z;e&&n(e);const{layerInstances:a}=Wr,{menu:i}=tr;i==="layer-list"&&(e==null||e.forEach(o=>{const{id:s,hide:l}=o;a[s].setState({hide:l})}))}undo(r){if(!r)return;const{prev:e}=r,{updateLayer:n}=Z;e&&n(e);const{layerInstances:a}=Wr,{menu:i}=tr;i==="layer-list"&&(e==null||e.forEach(o=>{const{id:s,hide:l}=o;a[s].setState({hide:l})}))}}const ru=new tu;class eu extends ur{redo(r){const{next:e}=r,{updateLayer:n}=Z;e&&n(e);const{layerInstances:a}=Wr,{menu:i}=tr;i==="layer-list"&&(e==null||e.forEach(o=>{const{id:s,lock:l}=o;a[s].setState({lock:l})}))}undo(r){const{prev:e}=r,{updateLayer:n}=Z;e&&n(e);const{layerInstances:a}=Wr,{menu:i}=tr;i==="layer-list"&&(e==null||e.forEach(o=>{const{id:s,lock:l}=o;a[s].setState({lock:l})}))}}const nu=new eu;class au extends ur{redo(r){const{next:e}=r,{updateLayer:n}=Z;e&&n(e)}undo(r){const{prev:e}=r,{updateLayer:n}=Z;e&&n(e)}}const iu=new au;class ou extends ur{redo(r){const{next:e}=r;if(e){const n=[];e.forEach(i=>{"id"in i&&n.push(ye.cloneDeep(i)),"layerHeader"in i&&(Z.layerHeader=i.layerHeader),"layerTail"in i&&(Z.layerTail=i.layerTail)});const{updateLayer:a}=Z;a(n)}}undo(r){const{prev:e}=r;if(e){const n=[];e.forEach(i=>{"id"in i&&n.push(ye.cloneDeep(i)),"layerHeader"in i&&(Z.layerHeader=i.layerHeader),"layerTail"in i&&(Z.layerTail=i.layerTail)});const{updateLayer:a}=Z;a(n)}}}const su=new ou,Zt=new Map;Zt.set(cr.DRAG,qc);Zt.set(cr.RESIZE,Xc);Zt.set(cr.ADD,$c);Zt.set(cr.DEL,Zc);Zt.set(cr.UPD_STYLE,Qc);Zt.set(cr.HIDE,ru);Zt.set(cr.LOCK,nu);Zt.set(cr.ORDER,iu);Zt.set(cr.UPDATE_LAYER,su);function ca(t,r){for(var e=t.length,n=0;n<e;++n)if(r(t[n],n))return!0;return!1}function to(t,r){for(var e=t.length,n=0;n<e;++n)if(r(t[n],n))return t[n];return null}function ro(t){var r=t;if(typeof r>"u"){if(typeof navigator>"u"||!navigator)return"";r=navigator.userAgent||""}return r.toLowerCase()}function ua(t,r){try{return new RegExp(t,"g").exec(r)}catch{return null}}function lu(){if(typeof navigator>"u"||!navigator||!navigator.userAgentData)return!1;var t=navigator.userAgentData,r=t.brands||t.uaList;return!!(r&&r.length)}function cu(t,r){var e=ua("("+t+")((?:\\/|\\s|:)([0-9|\\.|_]+))",r);return e?e[3]:""}function Pn(t){return t.replace(/_/g,".")}function ae(t,r){var e=null,n="-1";return ca(t,function(a){var i=ua("("+a.test+")((?:\\/|\\s|:)([0-9|\\.|_]+))?",r);return!i||a.brand?!1:(e=a,n=i[3]||"-1",a.versionAlias?n=a.versionAlias:a.versionTest&&(n=cu(a.versionTest.toLowerCase(),r)||n),n=Pn(n),!0)}),{preset:e,version:n}}function ne(t,r){var e={brand:"",version:"-1"};return ca(t,function(n){var a=eo(r,n);return a?(e.brand=n.id,e.version=n.versionAlias||a.version,e.version!=="-1"):!1}),e}function eo(t,r){return to(t,function(e){var n=e.brand;return ua(""+r.test,n.toLowerCase())})}var _n=[{test:"phantomjs",id:"phantomjs"},{test:"whale",id:"whale"},{test:"edgios|edge|edg",id:"edge"},{test:"msie|trident|windows phone",id:"ie",versionTest:"iemobile|msie|rv"},{test:"miuibrowser",id:"miui browser"},{test:"samsungbrowser",id:"samsung internet"},{test:"samsung",id:"samsung internet",versionTest:"version"},{test:"chrome|crios",id:"chrome"},{test:"firefox|fxios",id:"firefox"},{test:"android",id:"android browser",versionTest:"version"},{test:"safari|iphone|ipad|ipod",id:"safari",versionTest:"version"}],no=[{test:"(?=.*applewebkit/(53[0-7]|5[0-2]|[0-4]))(?=.*\\schrome)",id:"chrome",versionTest:"chrome"},{test:"chromium",id:"chrome"},{test:"whale",id:"chrome",versionAlias:"-1",brand:!0}],Bn=[{test:"applewebkit",id:"webkit",versionTest:"applewebkit|safari"}],ao=[{test:"(?=(iphone|ipad))(?!(.*version))",id:"webview"},{test:"(?=(android|iphone|ipad))(?=.*(naver|daum|; wv))",id:"webview"},{test:"webview",id:"webview"}],io=[{test:"windows phone",id:"windows phone"},{test:"windows 2000",id:"window",versionAlias:"5.0"},{test:"windows nt",id:"window"},{test:"win32|windows",id:"window"},{test:"iphone|ipad|ipod",id:"ios",versionTest:"iphone os|cpu os"},{test:"macos|macintel|mac os x",id:"mac"},{test:"android|linux armv81",id:"android"},{test:"tizen",id:"tizen"},{test:"webos|web0s",id:"webos"}];function oo(t){return!!ae(ao,t).preset}function uu(t){var r=ro(t),e=!!/mobi/g.exec(r),n={name:"unknown",version:"-1",majorVersion:-1,webview:oo(r),chromium:!1,chromiumVersion:"-1",webkit:!1,webkitVersion:"-1"},a={name:"unknown",version:"-1",majorVersion:-1},i=ae(_n,r),o=i.preset,s=i.version,l=ae(io,r),c=l.preset,u=l.version,f=ae(no,r);if(n.chromium=!!f.preset,n.chromiumVersion=f.version,!n.chromium){var d=ae(Bn,r);n.webkit=!!d.preset,n.webkitVersion=d.version}return c&&(a.name=c.id,a.version=u,a.majorVersion=parseInt(u,10)),o&&(n.name=o.id,n.version=s,n.webview&&a.name==="ios"&&n.name!=="safari"&&(n.webview=!1)),n.majorVersion=parseInt(n.version,10),{browser:n,os:a,isMobile:e,isHints:!1}}function fu(t){var r=navigator.userAgentData,e=(r.uaList||r.brands).slice(),n=t&&t.fullVersionList,a=r.mobile||!1,i=e[0],o=(t&&t.platform||r.platform||navigator.platform).toLowerCase(),s={name:i.brand,version:i.version,majorVersion:-1,webkit:!1,webkitVersion:"-1",chromium:!1,chromiumVersion:"-1",webview:!!ne(ao,e).brand||oo(ro())},l={name:"unknown",version:"-1",majorVersion:-1};s.webkit=!s.chromium&&ca(Bn,function(v){return eo(e,v)});var c=ne(no,e);if(s.chromium=!!c.brand,s.chromiumVersion=c.version,!s.chromium){var u=ne(Bn,e);s.webkit=!!u.brand,s.webkitVersion=u.version}var f=to(io,function(v){return new RegExp(""+v.test,"g").exec(o)});if(l.name=f?f.id:"",t&&(l.version=t.platformVersion),n&&n.length){var d=ne(_n,n);s.name=d.brand||s.name,s.version=d.version||s.version}else{var p=ne(_n,e);s.name=p.brand||s.name,s.version=p.brand&&t?t.uaFullVersion:p.version}return s.webkit&&(l.name=a?"ios":"mac"),l.name==="ios"&&s.webview&&(s.version="-1"),l.version=Pn(l.version),s.version=Pn(s.version),l.majorVersion=parseInt(l.version,10),s.majorVersion=parseInt(s.version,10),{browser:s,os:l,isMobile:a,isHints:!0}}function du(t){return typeof t>"u"&&lu()?fu():uu(t)}var Gn=function(){return Gn=Object.assign||function(r){for(var e,n=1,a=arguments.length;n<a;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},Gn.apply(this,arguments)};function pu(t,r){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(e[n[a]]=t[n[a]]);return e}function so(t,r){var e=Hs(r),n=e.className;return A.forwardRef(function(a,i){var o=a.className,s=o===void 0?"":o;a.cspNonce;var l=pu(a,["className","cspNonce"]),c=A.useRef();return A.useImperativeHandle(i,function(){return c.current},[]),A.useEffect(function(){var u=e.inject(c.current,{nonce:a.cspNonce});return function(){u.destroy()}},[]),A.createElement(t,Gn({ref:c,"data-styled-id":n,className:"".concat(s," ").concat(n)},l))})}var kn=function(t,r){return kn=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])},kn(t,r)};function Ee(t,r){if(typeof r!="function"&&r!==null)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");kn(t,r);function e(){this.constructor=t}t.prototype=r===null?Object.create(r):(e.prototype=r.prototype,new e)}var R=function(){return R=Object.assign||function(r){for(var e,n=1,a=arguments.length;n<a;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},R.apply(this,arguments)};function vu(t,r){var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&r.indexOf(n)<0&&(e[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var a=0,n=Object.getOwnPropertySymbols(t);a<n.length;a++)r.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(t,n[a])&&(e[n[a]]=t[n[a]]);return e}function gu(t,r,e,n){var a=arguments.length,i=a<3?r:n===null?n=Object.getOwnPropertyDescriptor(r,e):n,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(t,r,e,n);else for(var s=t.length-1;s>=0;s--)(o=t[s])&&(i=(a<3?o(i):a>3?o(r,e,i):o(r,e))||i);return a>3&&i&&Object.defineProperty(r,e,i),i}function hu(t){var r=typeof Symbol=="function"&&Symbol.iterator,e=r&&t[r],n=0;if(e)return e.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw new TypeError(r?"Object is not iterable.":"Symbol.iterator is not defined.")}function M(t,r){var e=typeof Symbol=="function"&&t[Symbol.iterator];if(!e)return t;var n=e.call(t),a,i=[],o;try{for(;(r===void 0||r-- >0)&&!(a=n.next()).done;)i.push(a.value)}catch(s){o={error:s}}finally{try{a&&!a.done&&(e=n.return)&&e.call(n)}finally{if(o)throw o.error}}return i}function L(t,r,e){if(e||arguments.length===2)for(var n=0,a=r.length,i;n<a;n++)(i||!(n in r))&&(i||(i=Array.prototype.slice.call(r,0,n)),i[n]=r[n]);return t.concat(i||Array.prototype.slice.call(r))}function we(t,r){return R({events:[],props:[],name:t},r)}var mu=["n","w","s","e"],fa=["n","w","s","e","nw","ne","sw","se"];function xu(t,r){return'data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="'.concat(32*t,'px" height="').concat(32*t,'px" viewBox="0 0 32 32" ><path d="M 16,5 L 12,10 L 14.5,10 L 14.5,22 L 12,22 L 16,27 L 20,22 L 17.5,22 L 17.5,10 L 20, 10 L 16,5 Z" stroke-linejoin="round" stroke-width="1.2" fill="black" stroke="white" style="transform:rotate(').concat(r,'deg);transform-origin: 16px 16px"></path></svg>')}function yu(t){var r=xu(1,t),e=Math.round(t/45)*45%180,n="ns-resize";return e===135?n="nwse-resize":e===45?n="nesw-resize":e===90&&(n="ew-resize"),"cursor:".concat(n,";cursor: url('").concat(r,"') 16 16, ").concat(n,";")}var Qr=du(),lo=Qr.browser.webkit,co=lo&&function(){var t=typeof window>"u"?{userAgent:""}:window.navigator,r=/applewebkit\/([^\s]+)/g.exec(t.userAgent.toLowerCase());return r?parseFloat(r[1])<605:!1}(),uo=Qr.browser.name,fo=parseInt(Qr.browser.version,10),bu=uo==="chrome",Su=Qr.browser.chromium,Cu=parseInt(Qr.browser.chromiumVersion,10)||0,Du=bu&&fo>=109||Su&&Cu>=109,Eu=uo==="firefox",wu=parseInt(Qr.browser.webkitVersion,10)>=612||fo>=15,da="moveable-",Ru=fa.map(function(t){var r="",e="",n="center",a="center",i="calc(var(--moveable-control-padding, 20) * -1px)";return t.indexOf("n")>-1&&(r="top: ".concat(i,";"),a="bottom"),t.indexOf("s")>-1&&(r="top: 0px;",a="top"),t.indexOf("w")>-1&&(e="left: ".concat(i,";"),n="right"),t.indexOf("e")>-1&&(e="left: 0px;",n="left"),'.around-control[data-direction*="'.concat(t,`"] {
        `).concat(e).concat(r,`
        transform-origin: `).concat(n," ").concat(a,`;
    }`)}).join(`
`),Mu=`
{
position: absolute;
width: 1px;
height: 1px;
left: 0;
top: 0;
z-index: 3000;
--moveable-color: #4af;
--zoom: 1;
--zoompx: 1px;
--moveable-line-padding: 0;
--moveable-control-padding: 0;
will-change: transform;
outline: 1px solid transparent;
}
.control-box {
z-index: 0;
}
.line, .control {
position: absolute;
left: 0;
top: 0;
will-change: transform;
}
.control {
width: 14px;
height: 14px;
border-radius: 50%;
border: 2px solid #fff;
box-sizing: border-box;
background: #4af;
background: var(--moveable-color);
margin-top: -7px;
margin-left: -7px;
border: 2px solid #fff;
z-index: 10;
}
.around-control {
position: absolute;
will-change: transform;
width: calc(var(--moveable-control-padding, 20) * 1px);
height: calc(var(--moveable-control-padding, 20) * 1px);
left: calc(var(--moveable-control-padding, 20) * -0.5px);
top: calc(var(--moveable-control-padding, 20) * -0.5px);
box-sizing: border-box;
background: transparent;
z-index: 8;
cursor: alias;
transform-origin: center center;
}
`.concat(Ru,`
.padding {
position: absolute;
top: 0px;
left: 0px;
width: 100px;
height: 100px;
transform-origin: 0 0;
}
.line {
width: 1px;
height: 1px;
background: #4af;
background: var(--moveable-color);
transform-origin: 0px 50%;
}
.line.edge {
z-index: 1;
background: transparent;
}
.line.dashed {
box-sizing: border-box;
background: transparent;
}
.line.dashed.horizontal {
border-top: 1px dashed #4af;
border-top-color: #4af;
border-top-color: var(--moveable-color);
}
.line.dashed.vertical {
border-left: 1px dashed #4af;
border-left-color: #4af;
border-left-color: var(--moveable-color);
}
.line.vertical {
transform: translateX(-50%);
}
.line.horizontal {
transform: translateY(-50%);
}
.line.vertical.bold {
width: 2px;
}
.line.horizontal.bold {
height: 2px;
}

.control.origin {
border-color: #f55;
background: #fff;
width: 12px;
height: 12px;
margin-top: -6px;
margin-left: -6px;
pointer-events: none;
}
`).concat([0,15,30,45,60,75,90,105,120,135,150,165].map(function(t){return`
.direction[data-rotation="`.concat(t,'"], :global .view-control-rotation').concat(t,` {
`).concat(yu(t),`
}
`)}).join(`
`),`

.line.direction:before {
content: "";
position: absolute;
width: 100%;
height: calc(var(--moveable-line-padding, 0) * 1px);
bottom: 0;
left: 0;
}
.group {
z-index: -1;
}
.area {
position: absolute;
}
.area-pieces {
position: absolute;
top: 0;
left: 0;
display: none;
}
.area.avoid, .area.pass {
pointer-events: none;
}
.area.avoid+.area-pieces {
display: block;
}
.area-piece {
position: absolute;
}

`).concat(co?`:global svg *:before {
content:"";
transform-origin: inherit;
}`:"",`
`),Ou=[[0,1,2],[1,0,3],[2,0,3],[3,1,2]],jn=1e-4,Nt=1e-7,ze=1e-9,An=Math.pow(10,10),qa=-An,Tu={n:[0,-1],e:[1,0],s:[0,1],w:[-1,0],nw:[-1,-1],ne:[1,-1],sw:[-1,1],se:[1,1]},pa={n:[0,1],e:[1,3],s:[3,2],w:[2,0],nw:[0],ne:[1],sw:[2],se:[3]},po={n:0,s:180,w:270,e:90,nw:315,ne:45,sw:225,se:135},Iu=["isMoveableElement","updateRect","updateTarget","destroy","dragStart","isInside","hitTest","setState","getRect","request","isDragging","getManager","forceUpdate","waitToChangeTarget","updateSelectors","getTargets","stopDrag","getControlBoxElement","getMoveables","getDragElement"];function Re(t,r,e,n,a,i){var o,s;i===void 0&&(i="draggable");var l=(s=(o=r.gestos[i])===null||o===void 0?void 0:o.move(e,t.inputEvent))!==null&&s!==void 0?s:{},c=l.originalDatas||l.datas,u=c[i]||(c[i]={});return R(R({},a?Qo(r,l):l),{isPinch:!!n,parentEvent:!0,datas:u,originalDatas:t.originalDatas})}var Yr=function(){function t(r){var e;r===void 0&&(r="draggable"),this.ableName=r,this.prevX=0,this.prevY=0,this.startX=0,this.startY=0,this.isDrag=!1,this.isFlag=!1,this.datas={draggable:{}},this.datas=(e={},e[r]={},e)}return t.prototype.dragStart=function(r,e){this.isDrag=!1,this.isFlag=!1;var n=e.originalDatas;return this.datas=n,n[this.ableName]||(n[this.ableName]={}),R(R({},this.move(r,e.inputEvent)),{type:"dragstart"})},t.prototype.drag=function(r,e){return this.move([r[0]-this.prevX,r[1]-this.prevY],e)},t.prototype.move=function(r,e){var n,a,i=!1;if(!this.isFlag)this.prevX=r[0],this.prevY=r[1],this.startX=r[0],this.startY=r[1],n=r[0],a=r[1],this.isFlag=!0;else{var o=this.isDrag;n=this.prevX+r[0],a=this.prevY+r[1],(r[0]||r[1])&&(this.isDrag=!0),!o&&this.isDrag&&(i=!0)}return this.prevX=n,this.prevY=a,{type:"drag",clientX:n,clientY:a,inputEvent:e,isFirstDrag:i,isDrag:this.isDrag,distX:n-this.startX,distY:a-this.startY,deltaX:r[0],deltaY:r[1],datas:this.datas[this.ableName],originalDatas:this.datas,parentEvent:!0,parentGesto:this}},t}();function Fr(t,r,e,n){var a=t.length===16,i=a?4:3,o=kr(t,e,n,i),s=M(o,4),l=M(s[0],2),c=l[0],u=l[1],f=M(s[1],2),d=f[0],p=f[1],v=M(s[2],2),g=v[0],h=v[1],m=M(s[3],2),x=m[0],y=m[1],S=M(bt(t,r,i),2),E=S[0],b=S[1],C=Math.min(c,d,g,x),w=Math.min(u,p,h,y),T=Math.max(c,d,g,x),O=Math.max(u,p,h,y);c=c-C||0,d=d-C||0,g=g-C||0,x=x-C||0,u=u-w||0,p=p-w||0,h=h-w||0,y=y-w||0,E=E-C||0,b=b-w||0;var P=t[0],z=t[i+1],I=Wt(P*z);return{left:C,top:w,right:T,bottom:O,origin:[E,b],pos1:[c,u],pos2:[d,p],pos3:[g,h],pos4:[x,y],direction:I}}function vo(t,r){var e=r.clientX,n=r.clientY,a=r.datas,i=t.state,o=i.moveableClientRect,s=i.rootMatrix,l=i.is3d,c=i.pos1,u=o.left,f=o.top,d=l?4:3,p=M(et($r(s,[e-u,n-f],d),c),2),v=p[0],g=p[1],h=M(nr({datas:a,distX:v,distY:g}),2),m=h[0],x=h[1];return[m,x]}function Gr(t,r){var e=r.datas,n=t.state,a=n.allMatrix,i=n.beforeMatrix,o=n.is3d,s=n.left,l=n.top,c=n.origin,u=n.offsetMatrix,f=n.targetMatrix,d=n.transformOrigin,p=o?4:3;e.is3d=o,e.matrix=a,e.targetMatrix=f,e.beforeMatrix=i,e.offsetMatrix=u,e.transformOrigin=d,e.inverseMatrix=or(a,p),e.inverseBeforeMatrix=or(i,p),e.absoluteOrigin=qr(pt([s,l],c),p),e.startDragBeforeDist=Ht(e.inverseBeforeMatrix,e.absoluteOrigin,p),e.startDragDist=Ht(e.inverseMatrix,e.absoluteOrigin,p)}function zu(t){return Fr(t.datas.beforeTransform,[50,50],100,100).direction}function sn(t,r,e){var n=r.datas,a=r.originalDatas.beforeRenderable,i=n.transformIndex,o=a.nextTransforms,s=o.length,l=a.nextTransformAppendedIndexes,c=-1;i===-1?(e==="translate"?c=0:e==="rotate"&&(c=pe(o,function(p){return p.match(/scale\(/g)})),c===-1&&(c=o.length),n.transformIndex=c):xr(l,function(p){return p.index===i&&p.functionName===e})?c=i:c=i+l.filter(function(p){return p.index<i}).length;var u=nd(o,t.state,c),f=u.targetFunction,d=e==="rotate"?"rotateZ":e;n.beforeFunctionTexts=u.beforeFunctionTexts,n.afterFunctionTexts=u.afterFunctionTexts,n.beforeTransform=u.beforeFunctionMatrix,n.beforeTransform2=u.beforeFunctionMatrix2,n.targetTansform=u.targetFunctionMatrix,n.afterTransform=u.afterFunctionMatrix,n.afterTransform2=u.afterFunctionMatrix2,n.targetAllTransform=u.allFunctionMatrix,f.functionName===d?(n.afterFunctionTexts.splice(0,1),n.isAppendTransform=!1):s>c&&(n.isAppendTransform=!0,a.nextTransformAppendedIndexes=L(L([],M(l),!1),[{functionName:e,index:c,isAppend:!0}],!1))}function ln(t,r,e){return"".concat(t.beforeFunctionTexts.join(" ")," ").concat(t.isAppendTransform?e:r," ").concat(t.afterFunctionTexts.join(" "))}function Pu(t){var r=t.datas,e=t.distX,n=t.distY,a=M(ho({datas:r,distX:e,distY:n}),2),i=a[0],o=a[1],s=go(r,Xs([i,o],4));return Ht(s,qr([0,0,0],4),4)}function go(t,r,e){var n=t.beforeTransform,a=t.afterTransform,i=t.beforeTransform2,o=t.afterTransform2,s=t.targetAllTransform,l=e?Mt(s,r,4):Mt(r,s,4),c=Mt(or(e?i:n,4),l,4),u=Mt(c,or(e?o:a,4),4);return u}function ho(t){var r=t.datas,e=t.distX,n=t.distY,a=r.inverseBeforeMatrix,i=r.is3d,o=r.startDragBeforeDist,s=r.absoluteOrigin,l=i?4:3;return et(Ht(a,pt(s,[e,n]),l),o)}function nr(t,r){var e=t.datas,n=t.distX,a=t.distY,i=e.inverseBeforeMatrix,o=e.inverseMatrix,s=e.is3d,l=e.startDragBeforeDist,c=e.startDragDist,u=e.absoluteOrigin,f=s?4:3;return et(Ht(r?i:o,pt(u,[n,a]),f),r?l:c)}function _u(t,r){var e=t.datas,n=t.distX,a=t.distY,i=e.beforeMatrix,o=e.matrix,s=e.is3d,l=e.startDragBeforeDist,c=e.startDragDist,u=e.absoluteOrigin,f=s?4:3;return et(Ht(r?i:o,pt(r?l:c,[n,a]),f),u)}function Bu(t,r,e,n,a,i){return n===void 0&&(n=r),a===void 0&&(a=e),i===void 0&&(i=[0,0]),t?t.map(function(o,s){var l=ra(o),c=l.value,u=l.unit,f=s?a:n,d=s?e:r;if(o==="%"||isNaN(c)){var p=f?i[s]/f:0;return d*p}else if(u!=="%")return c;return d*c/100}):i}function mo(t){var r=[];return t[1]>=0&&(t[0]>=0&&r.push(3),t[0]<=0&&r.push(2)),t[1]<=0&&(t[0]>=0&&r.push(1),t[0]<=0&&r.push(0)),r}function Gu(t,r){return mo(r).map(function(e){return t[e]})}function Rt(t,r){var e=(r[0]+1)/2,n=(r[1]+1)/2,a=[Cr(t[0][0],t[1][0],e,1-e),Cr(t[0][1],t[1][1],e,1-e)],i=[Cr(t[2][0],t[3][0],e,1-e),Cr(t[2][1],t[3][1],e,1-e)];return[Cr(a[0],i[0],n,1-n),Cr(a[1],i[1],n,1-n)]}function ku(t,r,e,n,a,i){var o=kr(r,e,n,a),s=Rt(o,i),l=t[0]-s[0],c=t[1]-s[1];return[l,c]}function Me(t,r,e,n){return Mt(t,le(r,n,e),n)}function ju(t,r,e,n){var a=t.transformOrigin,i=t.offsetMatrix,o=t.is3d,s=o?4:3,l;if(Br(e)){var c=r.beforeTransform,u=r.afterTransform;n?l=rr(ve(e),4,s):l=rr(Mt(Mt(c,ve([e]),4),u,4),4,s)}else l=e;return Me(i,l,a,s)}function Au(t,r){var e=t.transformOrigin,n=t.offsetMatrix,a=t.is3d,i=t.targetMatrix,o=t.targetAllTransform,s=a?4:3;return Me(n,Mt(o||i,ea(r,s),s),e,s)}function cn(t,r){var e=te(r);return{setTransform:function(n,a){a===void 0&&(a=-1),e.startTransforms=zt(n)?n:Tr(n),Nn(t,r,a)},setTransformIndex:function(n){Nn(t,r,n)}}}function un(t,r,e){var n=te(r),a=n.startTransforms;Nn(t,r,pe(a,function(i){return i.indexOf("".concat(e,"("))===0}))}function Nn(t,r,e){var n=te(r),a=r.datas;if(a.transformIndex=e,e!==-1){var i=n.startTransforms[e];if(i){var o=t.state,s=he([i],{"x%":function(l){return l/100*o.offsetWidth},"y%":function(l){return l/100*o.offsetHeight}});a.startValue=s[0].functionValue}}}function va(t,r){var e=te(t);e.nextTransforms=Tr(r)}function te(t){return t.originalDatas.beforeRenderable}function Ye(t){var r=t.originalDatas.beforeRenderable;return r.nextTransforms}function Pe(t){return(Ye(t)||[]).join(" ")}function _e(t){return te(t).nextStyle}function xo(t,r,e,n,a){va(a,r);var i=jt.drag(t,Re(a,t.state,e,n,!1)),o=i?i.transform:r;return R(R({transform:r,drag:i},At({transform:o},a)),{afterTransform:o})}function ga(t,r,e,n,a,i){var o=ju(t.state,a,r,i),s=Hu(t,e,n,o);return s}function yo(t,r,e,n,a,i,o){var s=ga(t,r,e,a,i,o),l=t.state,c=l.left,u=l.top,f=t.props.groupable,d=f?c:0,p=f?u:0,v=et(n,s);return et(v,[d,p])}function Nu(t,r,e,n,a,i,o){var s=yo(t,r,e,n,a,i,o);return s}function Lu(t,r,e){return[r?-1+t[0]/(r/2):0,e?-1+t[1]/(e/2):0]}function Hu(t,r,e,n){n===void 0&&(n=t.state.allMatrix);var a=t.state,i=a.width,o=a.height,s=a.is3d,l=s?4:3,c=[i/2*(1+r[0])+e[0],o/2*(1+r[1])+e[1]];return bt(n,c,l)}function Vu(t,r,e){var n=e.fixedDirection,a=e.fixedPosition,i=e.fixedOffset;return yo(t,"rotate(".concat(r,"deg)"),n,a,i,e)}function Fu(t,r,e,n,a,i){var o=t.props.groupable,s=t.state,l=s.transformOrigin,c=s.offsetMatrix,u=s.is3d,f=s.width,d=s.height,p=s.left,v=s.top,g=i.fixedDirection,h=i.nextTargetMatrix||s.targetMatrix,m=u?4:3,x=Bu(a,r,e,f,d,l),y=o?p:0,S=o?v:0,E=Me(c,h,x,m),b=ku(n,E,r,e,m,g);return et(b,[y,S])}function Wu(t,r){return Rt(Xt(t.state),r)}function qu(t,r){var e=t.targetGesto,n=t.controlGesto,a;return e!=null&&e.isFlag()&&(a=e.getEventData()[r]),!a&&(n!=null&&n.isFlag())&&(a=n.getEventData()[r]),a||{}}function Yu(t){if(t&&t.getRootNode){var r=t.getRootNode();if(r.nodeType===11)return r}}function Xu(t){var r=t("scale"),e=t("rotate"),n=t("translate"),a=[];return n&&n!=="0px"&&n!=="none"&&a.push("translate(".concat(n.split(/\s+/).join(","),")")),e&&e!=="1"&&e!=="none"&&a.push("rotate(".concat(e,")")),r&&r!=="1"&&r!=="none"&&a.push("scale(".concat(r.split(/\s+/).join(","),")")),a}function bo(t,r,e){for(var n=t,a=[],i=na(t)||Sr(t),o=!e&&t===r||t===i,s=o,l=!1,c=3,u,f,d,p=!1,v=Se(r,r,!0).offsetParent,g=1;n&&!s;){s=o;var h=Vt(n),m=h("position"),x=Vo(n),y=m==="fixed",S=Xu(h),E=ll(Wf(x)),b=void 0,C=!1,w=!1,T=0,O=0,P=0,z=0,I={hasTransform:!1,fixedContainer:null};y&&(p=!0,I=$f(n),v=I.fixedContainer);var B=E.length;!l&&(B===16||S.length)&&(l=!0,c=4,qn(a),d&&(d=rr(d,3,4))),l&&B===9&&(E=rr(E,3,4));var _=Uf(n,t),H=_.tagName,N=_.hasOffset,G=_.isSVG,q=_.origin,V=_.targetOrigin,j=_.offset,$=M(j,2),K=$[0],W=$[1];H==="svg"&&d&&(a.push({type:"target",target:n,matrix:Kf(n,c)}),a.push({type:"offset",target:n,matrix:It(c)}));var Y=parseFloat(h("zoom"))||1;if(y)b=I.fixedContainer,C=!0;else{var F=Se(n,r,!1,!0,h),U=F.offsetZoom;if(b=F.offsetParent,C=F.isEnd,w=F.isStatic,g*=U,(F.isCustomElement||U!==1)&&w)K-=b.offsetLeft,W-=b.offsetTop;else if(Eu||Du){var tt=F.parentSlotElement;if(tt){for(var ot=b,nt=0,Q=0;ot&&Yu(ot);)nt+=ot.offsetLeft,Q+=ot.offsetTop,ot=ot.offsetParent;K-=nt,W-=Q}}}if(lo&&!wu&&N&&!G&&w&&(m==="relative"||m==="static")&&(K-=b.offsetLeft,W-=b.offsetTop,o=o||C),y)N&&I.hasTransform&&(P=b.clientLeft,z=b.clientTop);else if(N&&v!==b&&(T=b.clientLeft,O=b.clientTop),N&&b===i){var J=Fo(n,!1);K+=J[0],W+=J[1]}if(a.push({type:"target",target:n,matrix:le(E,c,q)}),S.length&&(a.push({type:"offset",target:n,matrix:It(c)}),a.push({type:"target",target:n,matrix:le(ve(S),c,q)})),N){var vt=n===t,lt=vt?0:n.scrollLeft,ct=vt?0:n.scrollTop;a.push({type:"offset",target:n,matrix:Ir([K-lt+T-P,W-ct+O-z],c)})}else a.push({type:"offset",target:n,origin:q});if(Y!==1&&a.push({type:"zoom",target:n,matrix:le(ea([Y,Y],c),c,[0,0])}),d||(d=E),u||(u=q),f||(f=V),s||y)break;n=b,o=C,(!e||n===i)&&(s=o)}return d||(d=It(c)),u||(u=[0,0]),f||(f=[0,0]),{zoom:g,offsetContainer:v,matrixes:a,targetMatrix:d,transformOrigin:u,targetOrigin:f,is3d:l,hasFixed:p}}var Dr=null,Er=null,Nr=null;function Xr(t){t?(window.Map&&(Dr=new Map,Er=new Map),Nr=[]):(Dr=null,Nr=null,Er=null)}function Uu(t){var r=Er==null?void 0:Er.get(t);if(r)return r;var e=ce(t,!0);return Er&&Er.set(t,e),e}function $u(t,r){if(Nr){var e=xr(Nr,function(a){return a[0][0]==t&&a[0][1]==r});if(e)return e[1]}var n=bo(t,r,!0);return Nr&&Nr.push([[t,r],n]),n}function Vt(t){var r=Dr==null?void 0:Dr.get(t);if(!r){var e=xe(t).getComputedStyle(t);if(!Dr)return function(i){return e[i]};r={style:e,cached:{}},Dr.set(t,r)}var n=r.cached,a=r.style;return function(i){return i in n||(n[i]=a[i]),n[i]}}function $t(t,r,e){var n=e.originalDatas;n.groupable=n.groupable||{};var a=n.groupable;a.childDatas=a.childDatas||[];var i=a.childDatas;return t.moveables.map(function(o,s){return i[s]=i[s]||{},i[s][r]=i[s][r]||{},R(R({},e),{isRequestChild:!0,datas:i[s][r],originalDatas:i[s]})})}function Cn(t,r,e,n,a,i,o){var s=!!e.match(/Start$/g),l=!!e.match(/End$/g),c=a.isPinch,u=a.datas,f=$t(t,r.name,a),d=t.moveables,p=f.map(function(v,g){var h=d[g],m=h.state,x=m.gestos,y=v;if(s)y=new Yr(o).dragStart(n,v);else{if(x[o]||(x[o]=u.childGestos[g]),!x[o])return;y=Re(v,m,n,c,i,o)}var S=r[e](h,R(R({},y),{parentFlag:!0}));return l&&(x[o]=null),S});return s&&(u.childGestos=d.map(function(v){return v.state.gestos[o]})),p}function ir(t,r,e,n,a,i){a===void 0&&(a=function(u,f){return f});var o=!!e.match(/End$/g),s=$t(t,r.name,n),l=t.moveables,c=s.map(function(u,f){var d=l[f],p=u;p=a(d,u);var v=r[e](d,R(R({},p),{parentFlag:!0}));return v&&i&&i(d,u,v,f),o&&(d.state.gestos={}),v});return c}function Xe(t,r,e,n){var a=e.fixedDirection,i=e.fixedPosition,o=n.datas.startPositions||Xt(r.state),s=Rt(o,a),l=M(Ht(Qn(-t.rotation/180*Math.PI,3),[s[0]-i[0],s[1]-i[1],1],3),2),c=l[0],u=l[1];return n.datas.originalX=c,n.datas.originalY=u,n}function So(t,r,e,n){var a=t.getState(),i=a.renderPoses,o=a.rotation,s=a.direction,l=Pr(t.props,r).zoom,c=se(o/Math.PI*180),u={},f=t.renderState;f.renderDirectionMap||(f.renderDirectionMap={});var d=f.renderDirectionMap;e.forEach(function(v){var g=v.dir;u[g]=!0});var p=Wt(s);return e.map(function(v){var g=v.data,h=v.classNames,m=v.dir,x=pa[m];if(!x||!u[m])return null;d[m]=!0;var y=(dt(c,15)+p*po[m]+720)%180,S={};return Jr(g).forEach(function(E){S["data-".concat(E)]=g[E]}),n.createElement("div",R({className:rt.apply(void 0,L(["control","direction",m,r],M(h),!1)),"data-rotation":y,"data-direction":m},S,{key:"direction-".concat(m),style:Ze.apply(void 0,L([o,l],M(x.map(function(E){return i[E]})),!1))}))})}function Co(t,r,e,n){var a=Pr(t.props,e),i=a.renderDirections,o=i===void 0?r:i,s=a.displayAroundControls;if(!o)return[];var l=o===!0?fa:o;return L(L([],M(s?Ro(t,n,e,l):[]),!1),M(So(t,e,l.map(function(c){return{data:{},classNames:[],dir:c}}),n)),!1)}function be(t,r,e,n,a,i){for(var o=[],s=6;s<arguments.length;s++)o[s-6]=arguments[s];var l=Ot(e,n),c=r?dt(l/Math.PI*180,15)%180:-1;return t.createElement("div",{key:"line-".concat(i),className:rt.apply(void 0,L(["line","direction",r?"edge":"",r],M(o),!1)),"data-rotation":c,"data-line-key":i,"data-direction":r,style:oe(e,n,a,l)})}function Do(t,r,e,n,a){var i=e===!0?mu:e;return i.map(function(o,s){var l=M(pa[o],2),c=l[0],u=l[1];if(u!=null)return be(t,o,n[c],n[u],a,"".concat(r,"Edge").concat(s),r)}).filter(Boolean)}function Eo(t){return function(r,e){var n=Pr(r.props,t).edge;return n&&(n===!0||n.length)?L(L([],M(Do(e,t,n,r.getState().renderPoses,r.props.zoom)),!1),M(Ku(r,t,e)),!1):wo(r,t,e)}}function wo(t,r,e){return Co(t,fa,r,e)}function Ku(t,r,e){return Co(t,["nw","ne","sw","se"],r,e)}function Ro(t,r,e,n){var a=t.renderState;a.renderDirectionMap||(a.renderDirectionMap={});var i=t.getState(),o=i.renderPoses,s=i.rotation,l=i.direction,c=a.renderDirectionMap,u=t.props.zoom,f=Wt(l),d=s/Math.PI*180;return(n||Jr(c)).map(function(p){var v=pa[p];if(!v)return null;var g=(dt(d,15)+f*po[p]+720)%180,h=["around-control"];return e&&h.push("direction",e),r.createElement("div",{className:rt.apply(void 0,L([],M(h),!1)),"data-rotation":g,"data-direction":p,key:"direction-around-".concat(p),style:Ze.apply(void 0,L([s,u],M(v.map(function(m){return o[m]})),!1))})})}function ha(t,r,e){var n=t||{},a=n.position,i=a===void 0?"client":a,o=n.left,s=o===void 0?-1/0:o,l=n.top,c=l===void 0?-1/0:l,u=n.right,f=u===void 0?1/0:u,d=n.bottom,p=d===void 0?1/0:d,v={position:i,left:s,top:c,right:f,bottom:p};return{vertical:Ya(v,r,!0),horizontal:Ya(v,e,!1)}}function fn(t,r){var e=t.state,n=e.containerClientRect,a=n.clientHeight,i=n.clientWidth,o=n.clientLeft,s=n.clientTop,l=e.snapOffset,c=l.left,u=l.top,f=l.right,d=l.bottom,p=r||t.props.bounds||{},v=p.position||"client",g=v==="css",h=p.left,m=h===void 0?-1/0:h,x=p.top,y=x===void 0?-1/0:x,S=p.right,E=S===void 0?g?-1/0:1/0:S,b=p.bottom,C=b===void 0?g?-1/0:1/0:b;return g&&(E=i+f-c-E,C=a+d-u-C),{left:m+c-o,right:E+c-o,top:y+u-s,bottom:C+u-s}}function Zu(t,r,e){var n=fn(t),a=n.left,i=n.top,o=n.right,s=n.bottom,l=M(e,2),c=l[0],u=l[1],f=M(et(e,r),2),d=f[0],p=f[1];k(d)<Nt&&(d=0),k(p)<Nt&&(p=0);var v=p>0,g=d>0,h={isBound:!1,offset:0,pos:0},m={isBound:!1,offset:0,pos:0};if(d===0&&p===0)return{vertical:h,horizontal:m};if(d===0)v?s<u&&(m.pos=s,m.offset=u-s):i>u&&(m.pos=i,m.offset=u-i);else if(p===0)g?o<c&&(h.pos=o,h.offset=c-o):a>c&&(h.pos=a,h.offset=c-a);else{var x=p/d,y=e[1]-x*c,S=0,E=0,b=!1;g&&o<=c?(S=x*o+y,E=o,b=!0):!g&&c<=a&&(S=x*a+y,E=a,b=!0),b&&(S<i||S>s)&&(b=!1),b||(v&&s<=u?(S=s,E=(S-y)/x,b=!0):!v&&u<=i&&(S=i,E=(S-y)/x,b=!0)),b&&(h.isBound=!0,h.pos=E,h.offset=c-E,m.isBound=!0,m.pos=S,m.offset=u-S)}return{vertical:h,horizontal:m}}function Ya(t,r,e){var n=t[e?"left":"top"],a=t[e?"right":"bottom"],i=Math.min.apply(Math,L([],M(r),!1)),o=Math.max.apply(Math,L([],M(r),!1)),s=[];return n+1>i&&s.push({direction:"start",isBound:!0,offset:i-n,pos:n}),a-1<o&&s.push({direction:"end",isBound:!0,offset:o-a,pos:a}),s.length||s.push({isBound:!1,offset:0,pos:0}),s.sort(function(l,c){return k(c.offset)-k(l.offset)})}function Xa(t,r,e){var n=e?t.map(function(a){return De(a,e)}):t;return n.some(function(a){return a[0]<r.left&&k(a[0]-r.left)>.1||a[0]>r.right&&k(a[0]-r.right)>.1||a[1]<r.top&&k(a[1]-r.top)>.1||a[1]>r.bottom&&k(a[1]-r.bottom)>.1})}function Ju(t,r,e){var n=Yt(t),a=Math.sqrt(n*n-r*r)||0;return[a,-a].sort(function(i,o){return k(i-t[e?0:1])-k(o-t[e?0:1])}).map(function(i){return Ot([0,0],e?[i,r]:[r,i])})}function Qu(t,r,e,n,a){if(!t.props.bounds)return[];var i=a*Math.PI/180,o=fn(t),s=o.left,l=o.top,c=o.right,u=o.bottom,f=s-n[0],d=c-n[0],p=l-n[1],v=u-n[1],g={left:f,top:p,right:d,bottom:v};if(!Xa(e,g,0))return[];var h=[];return[[f,0],[d,0],[p,1],[v,1]].forEach(function(m){var x=M(m,2),y=x[0],S=x[1];e.forEach(function(E){var b=Ot([0,0],E);h.push.apply(h,L([],M(Ju(E,y,S).map(function(C){return i+C-b}).filter(function(C){return!Xa(r,g,C)}).map(function(C){return dt(C*180/Math.PI,Nt)})),!1))})}),h}var tf=["left","right","center"],rf=["top","bottom","middle"],Ua={left:"start",right:"end",center:"center",top:"start",bottom:"end",middle:"center"},yr={start:"left",end:"right",center:"center"},br={start:"top",end:"bottom",center:"middle"};function Lr(){return{left:!1,top:!1,right:!1,bottom:!1}}function re(t,r){var e=t.props,n=e.snappable,a=e.bounds,i=e.innerBounds,o=e.verticalGuidelines,s=e.horizontalGuidelines,l=e.snapGridWidth,c=e.snapGridHeight,u=t.state,f=u.guidelines,d=u.enableSnap;return!n||!d||r&&n!==!0&&n.indexOf(r)<0?!1:!!(l||c||a||i||f&&f.length||o&&o.length||s&&s.length)}function ma(t){return t===!1?{}:t===!0||!t?{left:!0,right:!0,top:!0,bottom:!0}:t}function ef(t,r){var e=ma(t),n={};for(var a in e)a in r&&e[a]&&(n[a]=r[a]);return n}function xa(t,r){var e=ef(t,r),n=rf.filter(function(i){return i in e}),a=tf.filter(function(i){return i in e});return{horizontalNames:n,verticalNames:a,horizontal:n.map(function(i){return e[i]}),vertical:a.map(function(i){return e[i]})}}function nf(t,r,e){var n=bt(t,[r.clientLeft,r.clientTop],e);return[r.left+n[0],r.top+n[1]]}function af(t){var r=M(t,2),e=r[0],n=r[1],a=n[0]-e[0],i=n[1]-e[1];Math.abs(a)<ar&&(a=0),Math.abs(i)<ar&&(i=0);var o=0,s=0,l=0;return a?i?(o=-i/a,s=1,l=o*e[0]-e[1]):(s=1,l=-e[1]):(o=-1,l=e[0]),[o,s,l].map(function(c){return dt(c,ar)})}function dn(t,r,e,n,a,i){n===void 0&&(n=[]),a===void 0&&(a=[]);var o=t.props,s=rd(i,o.snapThreshold,5);return Mo(t.state.guidelines,r,e,n,a,s)}function Mo(t,r,e,n,a,i){return{vertical:Ka(t,"vertical",r,i,n),horizontal:Ka(t,"horizontal",e,i,a)}}function of(t,r,e){var n=M(e,2),a=n[0],i=n[1],o=M(r,2),s=o[0],l=o[1],c=M(et(e,r),2),u=c[0],f=c[1],d=f>0,p=u>0;u=Je(u),f=Je(f);var v={isSnap:!1,offset:0,pos:0},g={isSnap:!1,offset:0,pos:0};if(u===0&&f===0)return{vertical:v,horizontal:g};var h=dn(t,u?[a]:[],f?[i]:[]),m=h.vertical,x=h.horizontal;m.posInfos.filter(function(H){var N=H.pos;return p?N>=s:N<=s}),x.posInfos.filter(function(H){var N=H.pos;return d?N>=l:N<=l}),m.isSnap=m.posInfos.length>0,x.isSnap=x.posInfos.length>0;var y=Ln(m),S=y.isSnap,E=y.guideline,b=Ln(x),C=b.isSnap,w=b.guideline,T=C?w.pos[1]:0,O=S?E.pos[0]:0;if(u===0)C&&(g.isSnap=!0,g.pos=w.pos[1],g.offset=i-g.pos);else if(f===0)S&&(v.isSnap=!0,v.pos=O,v.offset=a-O);else{var P=f/u,z=e[1]-P*a,I=0,B=0,_=!1;S?(B=O,I=P*B+z,_=!0):C&&(I=T,B=(I-z)/P,_=!0),_&&(v.isSnap=!0,v.pos=B,v.offset=a-B,g.isSnap=!0,g.pos=I,g.offset=i-I)}return{vertical:v,horizontal:g}}function vr(t){var r="";return t===-1||t==="top"||t==="left"?r="start":t===0||t==="center"||t==="middle"?r="center":(t===1||t==="right"||t==="bottom")&&(r="end"),r}function $a(t,r,e){var n=xa(t.props.snapDirections,r),a=dn(t,n.vertical,n.horizontal,n.verticalNames.map(function(s){return vr(s)}),n.horizontalNames.map(function(s){return vr(s)}),e),i=vr(n.horizontalNames[a.horizontal.index]),o=vr(n.verticalNames[a.vertical.index]);return{vertical:R(R({},a.vertical),{direction:o}),horizontal:R(R({},a.horizontal),{direction:i})}}function Ln(t){var r=t.isSnap;if(!r)return{isSnap:!1,offset:0,dist:-1,pos:0,guideline:null};var e=t.posInfos[0],n=e.guidelineInfos[0],a=n.offset,i=n.dist,o=n.guideline;return{isSnap:r,offset:a,dist:i,pos:e.pos,guideline:o}}function Ka(t,r,e,n,a){var i,o;if(a===void 0&&(a=[]),!t||!t.length)return{isSnap:!1,index:-1,direction:"",posInfos:[]};var s=r==="vertical",l=s?0:1,c=e.map(function(f,d){var p=a[d]||"",v=t.map(function(g){var h=g.pos,m=f-h[l];return{offset:m,dist:k(m),guideline:g,direction:p}}).filter(function(g){var h=g.guideline,m=g.dist,x=h.type;return!(x!==r||m>n)}).sort(function(g,h){return g.dist-h.dist});return{pos:f,index:d,guidelineInfos:v,direction:p}}).filter(function(f){return f.guidelineInfos.length>0}).sort(function(f,d){return f.guidelineInfos[0].dist-d.guidelineInfos[0].dist}),u=c.length>0;return{isSnap:u,index:u?c[0].index:-1,direction:(o=(i=c[0])===null||i===void 0?void 0:i.direction)!==null&&o!==void 0?o:"",posInfos:c}}function sf(t,r,e,n){n===void 0&&(n=1);var a=[];e[0]&&e[1]?a=[e,[-e[0],e[1]],[e[0],-e[1]]]:!e[0]&&!e[1]?[[-1,-1],[1,-1],[1,1],[-1,1]].forEach(function(f,d,p){var v=p[d+1]||p[0];a.push(f),a.push([(f[0]+v[0])/2,(f[1]+v[1])/2])}):t.props.keepRatio?a.push([-1,-1],[-1,1],[1,-1],[1,1],e):(a.push.apply(a,L([],M(Gu([[-1,-1],[1,-1],[-1,-1],[1,1]],e)),!1)),a.length>1&&a.push([(a[0][0]+a[1][0])/2,(a[0][1]+a[1][1])/2]));var i=a.map(function(f){return Rt(r,f)}),o=i.map(function(f){return f[0]}),s=i.map(function(f){return f[1]}),l=dn(t,o,s,a.map(function(f){return vr(f[0])}),a.map(function(f){return vr(f[1])}),n),c=vr(a.map(function(f){return f[0]})[l.vertical.index]),u=vr(a.map(function(f){return f[1]})[l.horizontal.index]);return{vertical:R(R({},l.vertical),{direction:c}),horizontal:R(R({},l.horizontal),{direction:u})}}function Oo(t,r){var e=k(t.offset),n=k(r.offset);return t.isBound&&r.isBound?n-e:t.isBound?-1:r.isBound?1:t.isSnap&&r.isSnap?n-e:t.isSnap?-1:r.isSnap||e<Nt?1:n<Nt?-1:e-n}function Ue(t,r){return t.slice().sort(function(e,n){var a=e.sign[r],i=n.sign[r],o=e.offset[r],s=n.offset[r];if(a){if(!i)return-1}else return 1;return Oo({isBound:e.isBound,isSnap:e.isSnap,offset:o},{isBound:n.isBound,isSnap:n.isSnap,offset:s})})[0]}function lf(t,r,e){var n=[];if(e)k(r[0])!==1||k(r[1])!==1?n.push([r,[-1,-1]],[r,[-1,1]],[r,[1,-1]],[r,[1,1]]):n.push([r,[t[0],-t[1]]],[r,[-t[0],t[1]]]),n.push([r,t]);else if(t[0]&&t[1]||!t[0]&&!t[1]){var a=t[0]?t:[1,1];[1,-1].forEach(function(o){[1,-1].forEach(function(s){var l=[o*a[0],s*a[1]];r[0]===l[0]&&r[1]===l[1]||n.push([r,l])})})}else if(t[0]){var i=k(r[0])===1?[1]:[1,-1];i.forEach(function(o){n.push([[r[0],-1],[o*t[0],-1]],[[r[0],0],[o*t[0],0]],[[r[0],1],[o*t[0],1]])})}else if(t[1]){var i=k(r[1])===1?[1]:[1,-1];i.forEach(function(s){n.push([[-1,r[1]],[-1,s*t[1]]],[[0,r[1]],[0,s*t[1]]],[[1,r[1]],[1,s*t[1]]])})}return n}function To(t,r){var e=Ha([r[0][0],r[1][0]]),n=Ha([r[0][1],r[1][1]]);return{vertical:e<=t[0],horizontal:n<=t[1]}}function ya(t,r){var e=M(r,2),n=e[0],a=e[1],i=a[0]-n[0],o=a[1]-n[1];k(i)<Nt&&(i=0),k(o)<Nt&&(o=0);var s,l;if(!i)s=n[0],l=t[0];else if(!o)s=n[1],l=t[1];else{var c=o/i;s=c*(t[0]-n[0])+n[1],l=t[1]}return s-l}function Io(t,r,e,n){return n===void 0&&(n=Nt),t.every(function(a){var i=ya(a,r),o=i<=0;return o===e||k(i)<=n})}function Za(t,r,e,n,a){return a===void 0&&(a=0),n&&r-a<=t||!n&&t<=e+a?{isBound:!0,offset:n?r-t:e-t}:{isBound:!1,offset:0}}function cf(t,r){var e=r.line,n=r.centerSign,a=r.verticalSign,i=r.horizontalSign,o=r.lineConstants,s=t.props.innerBounds;if(!s)return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var l=s.left,c=s.top,u=s.width,f=s.height,d=[[l,c],[l,c+f]],p=[[l,c],[l+u,c]],v=[[l+u,c],[l+u,c+f]],g=[[l,c+f],[l+u,c+f]];if(Io([[l,c],[l+u,c],[l,c+f],[l+u,c+f]],e,n))return{isAllBound:!1,isBound:!1,isVerticalBound:!1,isHorizontalBound:!1,offset:[0,0]};var h=gr(e,o,p,a),m=gr(e,o,g,a),x=gr(e,o,d,i),y=gr(e,o,v,i),S=h.isBound&&m.isBound,E=h.isBound||m.isBound,b=x.isBound&&y.isBound,C=x.isBound||y.isBound,w=Ur(h.offset,m.offset),T=Ur(x.offset,y.offset),O=[0,0],P=!1,z=!1;return k(T)<k(w)?(O=[w,0],P=E,z=S):(O=[0,T],P=C,z=b),{isAllBound:z,isVerticalBound:E,isHorizontalBound:C,isBound:P,offset:O}}function gr(t,r,e,n,a,i){var o=M(r,2),s=o[0],l=o[1],c=t[0],u=e[0],f=e[1],d=Je(f[1]-u[1]),p=Je(f[0]-u[0]),v=l,g=s,h=-s/l;if(p){if(!d){if(i&&!v)return{isBound:!1,offset:0};if(g){var S=(u[1]-c[1])/h+c[0];return Za(S,u[0],f[0],n,a)}else{var x=u[1]-c[1],y=k(x)<=(a||0);return{isBound:y,offset:y?x:0}}}}else{if(i&&!g)return{isBound:!1,offset:0};if(v){var m=h*(u[0]-c[0])+c[1];return Za(m,u[1],f[1],n,a)}else{var x=u[0]-c[0],y=k(x)<=(a||0);return{isBound:y,offset:y?x:0}}}return{isBound:!1,offset:0}}function zo(t,r,e){return r.map(function(n){var a=cf(t,n),i=a.isBound,o=a.offset,s=a.isVerticalBound,l=a.isHorizontalBound,c=n.multiple,u=nr({datas:e,distX:o[0],distY:o[1]}).map(function(f,d){return f*(c[d]?2/c[d]:0)});return{sign:c,isBound:i,isVerticalBound:s,isHorizontalBound:l,isSnap:!1,offset:u}})}function uf(t,r,e){var n,a=ba(t,r,[0,0],!1).map(function(d){return R(R({},d),{multiple:d.multiple.map(function(p){return k(p)*2})})}),i=zo(t,a,e),o=Ue(i,0),s=Ue(i,1),l=0,c=0,u=o.isVerticalBound||s.isVerticalBound,f=o.isHorizontalBound||s.isHorizontalBound;return(u||f)&&(n=M(_u({datas:e,distX:-o.offset[0],distY:-s.offset[1]}),2),l=n[0],c=n[1]),{vertical:{isBound:u,offset:l},horizontal:{isBound:f,offset:c}}}function ff(t,r){var e=[],n=t[0],a=t[1];return n&&a?e.push([[0,a*2],t,[-n,a]],[[n*2,0],t,[n,-a]]):n?(e.push([[n*2,0],[n,1],[n,-1]]),r&&e.push([[0,-1],[n,-1],[-n,-1]],[[0,1],[n,1],[-n,1]])):a?(e.push([[0,a*2],[1,a],[-1,a]]),r&&e.push([[-1,0],[-1,a],[-1,-a]],[[1,0],[1,a],[1,-a]])):e.push([[-1,0],[-1,-1],[-1,1]],[[1,0],[1,-1],[1,1]],[[0,-1],[-1,-1],[1,-1]],[[0,1],[-1,1],[1,1]]),e}function ba(t,r,e,n){var a=t.state,i=a.allMatrix,o=a.is3d,s=kr(i,100,100,o?4:3),l=Rt(s,[0,0]);return ff(e,n).map(function(c){var u=M(c,3),f=u[0],d=u[1],p=u[2],v=[Rt(s,d),Rt(s,p)],g=af(v),h=To(l,v),m=h.vertical,x=h.horizontal,y=ya(l,v)<=0;return{multiple:f,centerSign:y,verticalSign:m,horizontalSign:x,lineConstants:g,line:[Rt(r,d),Rt(r,p)]}})}function Ja(t,r,e,n){var a=n?t.map(function(i){return De(i,n)}):t;return[[a[0],a[1]],[a[1],a[3]],[a[3],a[2]],[a[2],a[0]]].some(function(i){var o=ya(e,i)<=0;return!Io(r,i,o)})}function df(t){var r=M(t,2),e=r[0],n=r[1],a=n[0]-e[0],i=n[1]-e[1];if(!a)return k(e[0]);if(!i)return k(e[1]);var o=i/a;return k((-o*e[0]+e[1])/Math.sqrt(Math.pow(o,2)+1))}function pf(t){var r=M(t,2),e=r[0],n=r[1],a=n[0]-e[0],i=n[1]-e[1];if(!a)return[e[0],0];if(!i)return[0,e[1]];var o=i/a,s=-o*e[0]+e[1];return[-s/(o+1/o),s/(o*o+1)]}function vf(t,r,e,n,a){var i=t.props.innerBounds,o=a*Math.PI/180;if(!i)return[];var s=i.left,l=i.top,c=i.width,u=i.height,f=s-n[0],d=s+c-n[0],p=l-n[1],v=l+u-n[1],g=[[f,p],[d,p],[f,v],[d,v]],h=Rt(e,[0,0]);if(!Ja(e,g,h,0))return[];var m=[],x=g.map(function(y){return[Yt(y),Ot([0,0],y)]});return[[e[0],e[1]],[e[1],e[3]],[e[3],e[2]],[e[2],e[0]]].forEach(function(y){var S=Ot([0,0],pf(y)),E=df(y);m.push.apply(m,L([],M(x.filter(function(b){var C=M(b,1),w=C[0];return w&&E<=w}).map(function(b){var C=M(b,2),w=C[0],T=C[1],O=Math.acos(w?E/w:0),P=T+O,z=T-O;return[o+P-S,o+z-S]}).reduce(function(b,C){return b.push.apply(b,L([],M(C),!1)),b},[]).filter(function(b){return!Ja(r,g,h,b)}).map(function(b){return dt(b*180/Math.PI,Nt)})),!1))}),m}function gf(t){var r=t.props.innerBounds,e=Lr();if(!r)return{boundMap:e,vertical:[],horizontal:[]};var n=t.getRect(),a=n.pos1,i=n.pos2,o=n.pos3,s=n.pos4,l=[a,i,o,s],c=Rt(l,[0,0]),u=r.left,f=r.top,d=r.width,p=r.height,v=[[u,f],[u,f+p]],g=[[u,f],[u+d,f]],h=[[u+d,f],[u+d,f+p]],m=[[u,f+p],[u+d,f+p]],x=ba(t,l,[0,0],!1),y=[],S=[];return x.forEach(function(E){var b=E.line,C=E.lineConstants,w=To(c,b),T=w.horizontal,O=w.vertical,P=gr(b,C,g,O,1,!0),z=gr(b,C,m,O,1,!0),I=gr(b,C,v,T,1,!0),B=gr(b,C,h,T,1,!0);P.isBound&&!e.top&&(y.push(f),e.top=!0),z.isBound&&!e.bottom&&(y.push(f+p),e.bottom=!0),I.isBound&&!e.left&&(S.push(u),e.left=!0),B.isBound&&!e.right&&(S.push(u+d),e.right=!0)}),{boundMap:e,horizontal:y,vertical:S}}function hf(t,r,e,n){var a=r[0]-t[0],i=r[1]-t[1];if(k(a)<ar&&(a=0),k(i)<ar&&(i=0),!a)return n?[0,0]:[0,e];if(!i)return n?[e,0]:[0,0];var o=i/a,s=t[1]-o*t[0];if(n){var l=o*(r[0]+e)+s;return[e,l-r[1]]}else{var c=(r[1]+e-s)/o;return[c-r[0],e]}}function Hn(t,r,e,n,a){var i=hf(t,r,e,n);if(!i)return{isOutside:!1,offset:[0,0]};var o=Mr(t,r),s=Mr(i,t),l=Mr(i,r),c=s>o||l>o,u=M(nr({datas:a,distX:i[0],distY:i[1]}),2),f=u[0],d=u[1];return{offset:[f,d],isOutside:c}}function $e(t,r){return t.isBound?t.offset:r.isSnap?Ln(r).offset:0}function mf(t,r,e,n,a){var i=M(r,2),o=i[0],s=i[1],l=M(e,2),c=l[0],u=l[1],f=M(n,2),d=f[0],p=f[1],v=M(a,2),g=v[0],h=v[1],m=-g,x=-h;if(t&&o&&s){m=0,x=0;var y=[];if(c&&u?y.push([0,h],[g,0]):c?y.push([g,0]):u?y.push([0,h]):d&&p?y.push([0,h],[g,0]):d?y.push([g,0]):p&&y.push([0,h]),y.length){y.sort(function(C,w){return Yt(et([o,s],C))-Yt(et([o,s],w))});var S=y[0];if(S[0]&&k(o)>ar)m=-S[0],x=s*k(o+m)/k(o)-s;else if(S[1]&&k(s)>ar){var E=s;x=-S[1],m=o*k(s+x)/k(E)-o}if(t&&u&&c)if(k(m)>ar&&k(m)<k(g)){var b=k(g)/k(m);m*=b,x*=b}else if(k(x)>ar&&k(x)<k(h)){var b=k(h)/k(x);m*=b,x*=b}else m=Ur(-g,m),x=Ur(-h,x)}}else m=o||c?-g:0,x=s||u?-h:0;return[m,x]}function xf(t,r,e,n,a,i){if(!re(t,"draggable"))return[{isSnap:!1,isBound:!1,offset:0},{isSnap:!1,isBound:!1,offset:0}];var o=Da(i.absolutePoses,[r,e]),s=qt(o),l=s.left,c=s.right,u=s.top,f=s.bottom,d={horizontal:o.map(function(B){return B[1]}),vertical:o.map(function(B){return B[0]})},p=ma(t.props.snapDirections),v=xa(p,{left:l,right:c,top:u,bottom:f,center:(l+c)/2,middle:(u+f)/2}),g=pn(t,a,v,d),h=g.vertical,m=g.horizontal,x=uf(t,o,i),y=x.vertical,S=x.horizontal,E=h.isSnap,b=m.isSnap,C=h.isBound||y.isBound,w=m.isBound||S.isBound,T=Ur(h.offset,y.offset),O=Ur(m.offset,S.offset),P=M(mf(n,[r,e],[C,w],[E,b],[T,O]),2),z=P[0],I=P[1];return[{isBound:C,isSnap:E,offset:z},{isBound:w,isSnap:b,offset:I}]}function pn(t,r,e,n){n===void 0&&(n=e);var a=ha(fn(t),n.vertical,n.horizontal),i=a.horizontal,o=a.vertical,s=r?{horizontal:{isSnap:!1,index:-1},vertical:{isSnap:!1,index:-1}}:dn(t,e.vertical,e.horizontal),l=s.horizontal,c=s.vertical,u=$e(i[0],l),f=$e(o[0],c),d=k(u),p=k(f);return{horizontal:{isBound:i[0].isBound,isSnap:l.isSnap,snapIndex:l.index,offset:u,dist:d,bounds:i,snap:l},vertical:{isBound:o[0].isBound,isSnap:c.isSnap,snapIndex:c.index,offset:f,dist:p,bounds:o,snap:c}}}function Qa(t,r,e,n,a){var i=ha(r,e,n),o=i.horizontal,s=i.vertical,l=Mo(t,e,n,[],[],a),c=l.horizontal,u=l.vertical,f=$e(o[0],c),d=$e(s[0],u),p=k(f),v=k(d);return{horizontal:{isBound:o[0].isBound,isSnap:c.isSnap,snapIndex:c.index,offset:f,dist:p,bounds:o,snap:c},vertical:{isBound:s[0].isBound,isSnap:u.isSnap,snapIndex:u.index,offset:d,dist:v,bounds:s,snap:u}}}function yf(t,r,e,n){var a=Ot(t,r)/Math.PI*180,i=e.vertical,o=i.isBound,s=i.isSnap,l=i.dist,c=e.horizontal,u=c.isBound,f=c.isSnap,d=c.dist,p=a%180,v=p<3||p>177,g=p>87&&p<93;return d<l&&(o||s&&!g&&(!n||!v))?"vertical":u||f&&!v&&(!n||!g)?"horizontal":""}function bf(t,r,e,n,a,i){return e.map(function(o){var s=M(o,2),l=s[0],c=s[1],u=Rt(r,l),f=Rt(r,c),d=n?Sf(t,u,f,a):pn(t,a,{vertical:[f[0]],horizontal:[f[1]]}),p=d.horizontal,v=p.offset,g=p.isBound,h=p.isSnap,m=d.vertical,x=m.offset,y=m.isBound,S=m.isSnap,E=et(c,l);if(!x&&!v)return{isBound:y||g,isSnap:S||h,sign:E,offset:[0,0]};var b=yf(u,f,d,n);if(!b)return{sign:E,isBound:!1,isSnap:!1,offset:[0,0]};var C=b==="vertical",w=[0,0];return!n&&k(c[0])===1&&k(c[1])===1&&l[0]!==c[0]&&l[1]!==c[1]?w=nr({datas:i,distX:-x,distY:-v}):w=Hn(u,f,-(C?x:v),C,i).offset,w=w.map(function(T,O){return T*(E[O]?2/E[O]:0)}),{sign:E,isBound:C?y:g,isSnap:C?S:h,offset:w}})}function ti(t,r){return t.isBound?t.offset:r.isSnap?r.offset:0}function Sf(t,r,e,n){var a=Zu(t,r,e),i=a.horizontal,o=a.vertical,s=n?{horizontal:{isSnap:!1},vertical:{isSnap:!1}}:of(t,r,e),l=s.horizontal,c=s.vertical,u=ti(i,l),f=ti(o,c),d=k(u),p=k(f);return{horizontal:{isBound:i.isBound,isSnap:l.isSnap,offset:u,dist:d},vertical:{isBound:o.isBound,isSnap:c.isSnap,offset:f,dist:p}}}function Cf(t,r,e,n,a){var i=[-e[0],-e[1]],o=t.state,s=o.width,l=o.height,c=t.props.bounds,u=1/0,f=1/0;if(c){var d=[[e[0],-e[1]],[-e[0],e[1]]],p=c.left,v=p===void 0?-1/0:p,g=c.top,h=g===void 0?-1/0:g,m=c.right,x=m===void 0?1/0:m,y=c.bottom,S=y===void 0?1/0:y;d.forEach(function(E){var b=E[0]!==i[0],C=E[1]!==i[1],w=Rt(r,E),T=Ot(n,w)*360/Math.PI;if(C){var O=w.slice();(k(T-360)<2||k(T-180)<2)&&(O[1]=n[1]);var P=Hn(n,O,(n[1]<w[1]?S:h)-w[1],!1,a),z=M(P.offset,2),I=z[1],B=P.isOutside;isNaN(I)||(f=l+(B?1:-1)*k(I))}if(b){var O=w.slice();(k(T-90)<2||k(T-270)<2)&&(O[0]=n[0]);var _=Hn(n,O,(n[0]<w[0]?x:v)-w[0],!0,a),H=M(_.offset,1),N=H[0],G=_.isOutside;isNaN(N)||(u=s+(G?1:-1)*k(N))}})}return{maxWidth:u,maxHeight:f}}var jt={name:"draggable",props:["draggable","throttleDrag","throttleDragRotate","hideThrottleDragRotateLine","startDragRotate","edgeDraggable"],events:["dragStart","drag","dragEnd","dragGroupStart","dragGroup","dragGroupEnd"],requestStyle:function(){return["left","top","right","bottom"]},requestChildStyle:function(){return["left","top","right","bottom"]},render:function(t,r){var e=t.props,n=e.hideThrottleDragRotateLine,a=e.throttleDragRotate,i=e.zoom,o=t.getState(),s=o.dragInfo,l=o.beforeOrigin;if(n||!a||!s)return[];var c=s.dist;if(!c[0]&&!c[1])return[];var u=Yt(c),f=Ot(c,[0,0]);return[r.createElement("div",{className:rt("line","horizontal","dragline","dashed"),key:"dragRotateGuideline",style:{width:"".concat(u,"px"),transform:"translate(".concat(l[0],"px, ").concat(l[1],"px) rotate(").concat(f,"rad) scaleY(").concat(i,")")}})]},dragStart:function(t,r){var e=r.datas,n=r.parentEvent,a=r.parentGesto,i=t.state,o=i.gestos,s=i.style;if(o.draggable)return!1;o.draggable=a||t.targetGesto,e.datas={},e.left=parseFloat(s.left||"")||0,e.top=parseFloat(s.top||"")||0,e.bottom=parseFloat(s.bottom||"")||0,e.right=parseFloat(s.right||"")||0,e.startValue=[0,0],Gr(t,r),un(t,r,"translate"),Lf(t,e),e.prevDist=[0,0],e.prevBeforeDist=[0,0],e.isDrag=!1,e.deltaOffset=[0,0];var l=st(t,r,R({set:function(u){e.startValue=u}},cn(t,r))),c=n||X(t,"onDragStart",l);return c!==!1?(e.isDrag=!0,t.state.dragInfo={startRect:t.getRect(),dist:[0,0]}):(o.draggable=null,e.isPinch=!1),e.isDrag?l:!1},drag:function(t,r){if(r){sn(t,r,"translate");var e=r.datas,n=r.parentEvent,a=r.parentFlag,i=r.isPinch,o=r.deltaOffset,s=r.useSnap,l=r.isRequest,c=r.distX,u=r.distY,f=e.isDrag,d=e.prevDist,p=e.prevBeforeDist,v=e.startValue;if(f){o&&(c+=o[0],u+=o[1]);var g=t.props,h=g.parentMoveable,m=n?0:g.throttleDrag||0,x=n?0:g.throttleDragRotate||0,y=0,S=!1,E=!1,b=!1,C=!1;if(!n&&x>0&&(c||u)){var w=g.startDragRotate||0,T=dt(w+Ot([0,0],[c,u])*180/Math.PI,x)-w,O=u*Math.abs(Math.cos((T-90)/180*Math.PI)),P=c*Math.abs(Math.cos(T/180*Math.PI)),z=Yt([P,O]);y=T*Math.PI/180,c=z*Math.cos(y),u=z*Math.sin(y)}if(!i&&!n&&!a){var I=M(xf(t,c,u,x,!s&&l||o,e),2),B=I[0],_=I[1];S=B.isSnap,E=B.isBound,b=_.isSnap,C=_.isBound;var H=B.offset,N=_.offset;c+=H,u+=N}var G=pt(ho({datas:e,distX:c,distY:u}),v),q=pt(Pu({datas:e,distX:c,distY:u}),v);Aa(q,Nt),Aa(G,Nt),x||(!S&&!E&&(q[0]=dt(q[0],m),G[0]=dt(G[0],m)),!b&&!C&&(q[1]=dt(q[1],m),G[1]=dt(G[1],m)));var V=et(G,v),j=et(q,v),$=et(j,d),K=et(V,p);e.prevDist=j,e.prevBeforeDist=V,e.passDelta=$,e.passDist=j;var W=e.left+V[0],Y=e.top+V[1],F=e.right-V[0],U=e.bottom-V[1],tt=ln(e,"translate(".concat(q[0],"px, ").concat(q[1],"px)"),"translate(".concat(j[0],"px, ").concat(j[1],"px)"));if(va(r,tt),t.state.dragInfo.dist=n?[0,0]:j,!(!n&&!h&&$.every(function(vt){return!vt})&&K.some(function(vt){return!vt}))){var ot=t.state,nt=ot.width,Q=ot.height,J=st(t,r,R({transform:tt,dist:j,delta:$,translate:q,beforeDist:V,beforeDelta:K,beforeTranslate:G,left:W,top:Y,right:F,bottom:U,width:nt,height:Q,isPinch:i},At({transform:tt},r)));return!n&&X(t,"onDrag",J),J}}}},dragAfter:function(t,r){var e=r.datas,n=e.deltaOffset;return n[0]||n[1]?(e.deltaOffset=[0,0],this.drag(t,R(R({},r),{deltaOffset:n}))):!1},dragEnd:function(t,r){var e=r.parentEvent,n=r.datas;if(t.state.dragInfo=null,!!n.isDrag){n.isDrag=!1;var a=Ft(t,r,{});return!e&&X(t,"onDragEnd",a),a}},dragGroupStart:function(t,r){var e=r.datas,n=r.clientX,a=r.clientY,i=this.dragStart(t,r);if(!i)return!1;var o=Cn(t,this,"dragStart",[n||0,a||0],r,!1,"draggable"),s=R(R({},i),{targets:t.props.targets,events:o}),l=X(t,"onDragGroupStart",s);return e.isDrag=l!==!1,e.isDrag?i:!1},dragGroup:function(t,r){var e=r.datas;if(e.isDrag){var n=this.drag(t,r),a=r.datas.passDelta,i=Cn(t,this,"drag",a,r,!1,"draggable");if(n){var o=R({targets:t.props.targets,events:i},n);return X(t,"onDragGroup",o),o}}},dragGroupEnd:function(t,r){var e=r.isDrag,n=r.datas;if(n.isDrag){this.dragEnd(t,r);var a=Cn(t,this,"dragEnd",[0,0],r,!1,"draggable");return X(t,"onDragGroupEnd",Ft(t,r,{targets:t.props.targets,events:a})),e}},request:function(t){var r={},e=t.getRect(),n=0,a=0,i=!1;return{isControl:!1,requestStart:function(o){return i=o.useSnap,{datas:r,useSnap:i}},request:function(o){return"x"in o?n=o.x-e.left:"deltaX"in o&&(n+=o.deltaX),"y"in o?a=o.y-e.top:"deltaY"in o&&(a+=o.deltaY),{datas:r,distX:n,distY:a,useSnap:i}},requestEnd:function(){return{datas:r,isDrag:!0,useSnap:i}}}},unset:function(t){t.state.gestos.draggable=null,t.state.dragInfo=null}};function Po(t,r){var e=Rt(t,r),n=[0,0];return{fixedPosition:e,fixedDirection:r,fixedOffset:n}}function Df(t,r){var e=t.allMatrix,n=t.is3d,a=t.width,i=t.height,o=n?4:3,s=[a/2*(1+r[0]),i/2*(1+r[1])],l=bt(e,s,o),c=[0,0];return{fixedPosition:l,fixedDirection:r,fixedOffset:c}}function _o(t,r){var e=t.allMatrix,n=t.is3d,a=t.width,i=t.height,o=n?4:3,s=Lu(r,a,i),l=bt(e,r,o),c=[a?0:r[0],i?0:r[1]];return{fixedPosition:l,fixedDirection:s,fixedOffset:c}}var ri=Ra("resizable"),Vn={name:"resizable",ableGroup:"size",canPinch:!0,props:["resizable","throttleResize","renderDirections","displayAroundControls","keepRatio","resizeFormat","keepRatioFinally","edge","checkResizableError"],events:["resizeStart","beforeResize","resize","resizeEnd","resizeGroupStart","beforeResizeGroup","resizeGroup","resizeGroupEnd"],render:Eo("resizable"),dragControlCondition:ri,viewClassName:wa("resizable"),dragControlStart:function(t,r){var e,n=r.inputEvent,a=r.isPinch,i=r.isGroup,o=r.parentDirection,s=r.parentGesto,l=r.datas,c=r.parentFixedDirection,u=r.parentEvent,f=Uo(o,a,n,l),d=t.state,p=d.target,v=d.width,g=d.height,h=d.gestos;if(!f||!p||h.resizable)return!1;h.resizable=s||t.controlGesto,!a&&Gr(t,r),l.datas={},l.direction=f,l.startOffsetWidth=v,l.startOffsetHeight=g,l.prevWidth=0,l.prevHeight=0,l.minSize=[0,0],l.startWidth=d.inlineCSSWidth||d.cssWidth,l.startHeight=d.inlineCSSHeight||d.cssHeight,l.maxSize=[1/0,1/0],i||(l.minSize=[d.minOffsetWidth,d.minOffsetHeight],l.maxSize=[d.maxOffsetWidth,d.maxOffsetHeight]);var m=t.props.transformOrigin||"% %";l.transformOrigin=m&&Br(m)?m.split(" "):m,l.startOffsetMatrix=d.offsetMatrix,l.startTransformOrigin=d.transformOrigin,l.isWidth=(e=r==null?void 0:r.parentIsWidth)!==null&&e!==void 0?e:!f[0]&&!f[1]||f[0]||!f[1];function x(T){l.ratio=T&&isFinite(T)?T:0}l.startPositions=Xt(t.state);function y(T){var O=Po(l.startPositions,T);l.fixedDirection=O.fixedDirection,l.fixedPosition=O.fixedPosition,l.fixedOffset=O.fixedOffset}function S(T){var O=_o(t.state,T);l.fixedDirection=O.fixedDirection,l.fixedPosition=O.fixedPosition,l.fixedOffset=O.fixedOffset}function E(T){l.minSize=[xt("".concat(T[0]),0)||0,xt("".concat(T[1]),0)||0]}function b(T){var O=[T[0]||1/0,T[1]||1/0];(!ge(O[0])||isFinite(O[0]))&&(O[0]=xt("".concat(O[0]),0)||1/0),(!ge(O[1])||isFinite(O[1]))&&(O[1]=xt("".concat(O[1]),0)||1/0),l.maxSize=O}x(v/g),y(c||[-f[0],-f[1]]),l.setFixedDirection=y,l.setFixedPosition=S,l.setMin=E,l.setMax=b;var C=st(t,r,{direction:f,startRatio:l.ratio,set:function(T){var O=M(T,2),P=O[0],z=O[1];l.startWidth=P,l.startHeight=z},setMin:E,setMax:b,setRatio:x,setFixedDirection:y,setFixedPosition:S,setOrigin:function(T){l.transformOrigin=T},dragStart:jt.dragStart(t,new Yr().dragStart([0,0],r))}),w=u||X(t,"onResizeStart",C);return l.startFixedDirection=l.fixedDirection,l.startFixedPosition=l.fixedPosition,w!==!1&&(l.isResize=!0,t.state.snapRenderInfo={request:r.isRequest,direction:f}),l.isResize?C:!1},dragControl:function(t,r){var e,n=r.datas,a=r.parentFlag,i=r.isPinch,o=r.parentKeepRatio,s=r.dragClient,l=r.parentDist,c=r.useSnap,u=r.isRequest,f=r.isGroup,d=r.parentEvent,p=r.resolveMatrix,v=n.isResize,g=n.transformOrigin,h=n.startWidth,m=n.startHeight,x=n.prevWidth,y=n.prevHeight,S=n.minSize,E=n.maxSize,b=n.ratio,C=n.startOffsetWidth,w=n.startOffsetHeight,T=n.isWidth;if(!v)return;if(p){var O=t.state.is3d,P=n.startOffsetMatrix,z=n.startTransformOrigin,I=O?4:3,B=ve(Ye(r)),_=Math.sqrt(B.length);I!==_&&(B=rr(B,_,I));var H=Me(P,B,z,I),N=kr(H,C,w,I);n.startPositions=N,n.nextTargetMatrix=B,n.nextAllMatrix=H}var G=Pr(t.props,"resizable"),q=G.resizeFormat,V=G.throttleResize,j=V===void 0?a?0:1:V,$=G.parentMoveable,K=G.keepRatioFinally,W=n.direction,Y=W,F=0,U=0;!W[0]&&!W[1]&&(Y=[1,1]);var tt=b&&(o??G.keepRatio)||!1;function ot(){var Ct=n.fixedDirection,Et=rs(Y,tt,n,r);F=Et.distWidth,U=Et.distHeight;var fr=Y[0]-Ct[0]||tt?Math.max(C+F,Nt):C,dr=Y[1]-Ct[1]||tt?Math.max(w+U,Nt):w;return tt&&C&&w&&(T?dr=fr/b:fr=dr*b),[fr,dr]}var nt=M(ot(),2),Q=nt[0],J=nt[1];d||(n.setFixedDirection(n.fixedDirection),X(t,"onBeforeResize",st(t,r,{startFixedDirection:n.startFixedDirection,startFixedPosition:n.startFixedPosition,setFixedDirection:function(Ct){var Et;return n.setFixedDirection(Ct),Et=M(ot(),2),Q=Et[0],J=Et[1],[Q,J]},setFixedPosition:function(Ct){var Et;return n.setFixedPosition(Ct),Et=M(ot(),2),Q=Et[0],J=Et[1],[Q,J]},boundingWidth:Q,boundingHeight:J,setSize:function(Ct){var Et;Et=M(Ct,2),Q=Et[0],J=Et[1]}},!0)));var vt=s;s||(!a&&i?vt=Wu(t,[0,0]):vt=n.fixedPosition);var lt=[0,0];i||(lt=Af(t,Q,J,W,vt,!c&&u,n)),l&&(!l[0]&&(lt[0]=0),!l[1]&&(lt[1]=0));function ct(){var Ct;q&&(Ct=M(q([Q,J]),2),Q=Ct[0],J=Ct[1]),Q=dt(Q,j),J=dt(J,j)}if(tt){Y[0]&&Y[1]&&lt[0]&&lt[1]&&(k(lt[0])>k(lt[1])?lt[1]=0:lt[0]=0);var ft=!lt[0]&&!lt[1];ft&&ct(),Y[0]&&!Y[1]||lt[0]&&!lt[1]||ft&&T?(Q+=lt[0],J=Q/b):(!Y[0]&&Y[1]||!lt[0]&&lt[1]||ft&&!T)&&(J+=lt[1],Q=J*b)}else Q+=lt[0],J+=lt[1],Q=Math.max(0,Q),J=Math.max(0,J);e=M(Ei([Q,J],S,E,tt?b:!1),2),Q=e[0],J=e[1],ct(),tt&&(f||K)&&(T?J=Q/b:Q=J*b),F=Q-C,U=J-w;var yt=[F-x,U-y];n.prevWidth=F,n.prevHeight=U;var ht=Fu(t,Q,J,vt,g,n);if(!(!$&&yt.every(function(Ct){return!Ct})&&ht.every(function(Ct){return!Ct}))){var ut=jt.drag(t,Re(r,t.state,ht,!!i,!1,"draggable")),gt=ut.transform,Tt=h+F,Gt=m+U,_t=st(t,r,R({width:Tt,height:Gt,offsetWidth:Math.round(Q),offsetHeight:Math.round(J),startRatio:b,boundingWidth:Q,boundingHeight:J,direction:W,dist:[F,U],delta:yt,isPinch:!!i,drag:ut},Ko({style:{width:"".concat(Tt,"px"),height:"".concat(Gt,"px")},transform:gt},ut,r)));return!d&&X(t,"onResize",_t),_t}},dragControlAfter:function(t,r){var e=r.datas,n=e.isResize,a=e.startOffsetWidth,i=e.startOffsetHeight,o=e.prevWidth,s=e.prevHeight;if(!(!n||t.props.checkResizableError===!1)){var l=t.state,c=l.width,u=l.height,f=c-(a+o),d=u-(i+s),p=k(f)>3,v=k(d)>3;if(p&&(e.startWidth+=f,e.startOffsetWidth+=f,e.prevWidth+=f),v&&(e.startHeight+=d,e.startOffsetHeight+=d,e.prevHeight+=d),p||v)return this.dragControl(t,r)}},dragControlEnd:function(t,r){var e=r.datas,n=r.parentEvent;if(e.isResize){e.isResize=!1;var a=Ft(t,r,{});return!n&&X(t,"onResizeEnd",a),a}},dragGroupControlCondition:ri,dragGroupControlStart:function(t,r){var e=r.datas,n=this.dragControlStart(t,R(R({},r),{isGroup:!0}));if(!n)return!1;var a=$t(t,"resizable",r),i=e.startOffsetWidth,o=e.startOffsetHeight;function s(){var p=e.minSize;a.forEach(function(v){var g=v.datas,h=g.minSize,m=g.startOffsetWidth,x=g.startOffsetHeight,y=i*(m?h[0]/m:0),S=o*(x?h[1]/x:0);p[0]=Math.max(p[0],y),p[1]=Math.max(p[1],S)})}function l(){var p=e.maxSize;a.forEach(function(v){var g=v.datas,h=g.maxSize,m=g.startOffsetWidth,x=g.startOffsetHeight,y=i*(m?h[0]/m:0),S=o*(x?h[1]/x:0);p[0]=Math.min(p[0],y),p[1]=Math.min(p[1],S)})}var c=ir(t,this,"dragControlStart",r,function(p,v){return Xe(t,p,e,v)});s(),l();var u=function(p){n.setFixedDirection(p),c.forEach(function(v,g){v.setFixedDirection(p),Xe(t,v.moveable,e,a[g])})};e.setFixedDirection=u;var f=R(R({},n),{targets:t.props.targets,events:c.map(function(p){return R(R({},p),{setMin:function(v){p.setMin(v),s()},setMax:function(v){p.setMax(v),l()}})}),setFixedDirection:u,setMin:function(p){n.setMin(p),s()},setMax:function(p){n.setMax(p),l()}}),d=X(t,"onResizeGroupStart",f);return e.isResize=d!==!1,e.isResize?n:!1},dragGroupControl:function(t,r){var e=r.datas;if(e.isResize){var n=Pr(t.props,"resizable");gn(t,"onBeforeResize",function(p){X(t,"onBeforeResizeGroup",st(t,r,R(R({},p),{targets:n.targets}),!0))});var a=this.dragControl(t,R(R({},r),{isGroup:!0}));if(a){var i=a.boundingWidth,o=a.boundingHeight,s=a.dist,l=n.keepRatio,c=[i/(i-s[0]),o/(o-s[1])],u=e.fixedPosition,f=ir(t,this,"dragControl",r,function(p,v){var g=M(Ht(Qn(t.rotation/180*Math.PI,3),[v.datas.originalX*c[0],v.datas.originalY*c[1],1],3),2),h=g[0],m=g[1];return R(R({},v),{parentDist:null,parentScale:c,dragClient:pt(u,[h,m]),parentKeepRatio:l})}),d=R({targets:n.targets,events:f},a);return X(t,"onResizeGroup",d),d}}},dragGroupControlEnd:function(t,r){var e=r.isDrag,n=r.datas;if(n.isResize){this.dragControlEnd(t,r);var a=ir(t,this,"dragControlEnd",r),i=Ft(t,r,{targets:t.props.targets,events:a});return X(t,"onResizeGroupEnd",i),e}},request:function(t){var r={},e=0,n=0,a=!1,i=t.getRect();return{isControl:!0,requestStart:function(o){var s;return a=o.useSnap,{datas:r,parentDirection:o.direction||[1,1],parentIsWidth:(s=o==null?void 0:o.horizontal)!==null&&s!==void 0?s:!0,useSnap:a}},request:function(o){return"offsetWidth"in o?e=o.offsetWidth-i.offsetWidth:"deltaWidth"in o&&(e+=o.deltaWidth),"offsetHeight"in o?n=o.offsetHeight-i.offsetHeight:"deltaHeight"in o&&(n+=o.deltaHeight),{datas:r,parentDist:[e,n],parentKeepRatio:o.keepRatio,useSnap:a}},requestEnd:function(){return{datas:r,isDrag:!0,useSnap:a}}}},unset:function(t){t.state.gestos.resizable=null}};function Dn(t,r,e,n,a){var i=t.props.groupable,o=t.state,s=o.is3d?4:3,l=r.origin,c=bt(t.state.rootMatrix,et([l[0],l[1]],i?[0,0]:[o.left,o.top]),s),u=pt([a.left,a.top],c);r.startAbsoluteOrigin=u,r.prevDeg=Ot(u,[e,n])/Math.PI*180,r.defaultDeg=r.prevDeg,r.prevSnapDeg=0,r.loop=0,r.startDist=Mr(u,[e,n])}function Fe(t,r,e){var n=e.defaultDeg,a=e.prevDeg,i=a%360,o=Math.floor(a/360);i<0&&(i+=360),i>t&&i>270&&t<90?++o:i<t&&i<90&&t>270&&--o;var s=r*(o*360+t-n);return e.prevDeg=n+s,s}function En(t,r,e,n){return Fe(Ot(n.startAbsoluteOrigin,[t,r])/Math.PI*180,e,n)}function wn(t,r,e,n,a,i){var o=t.props.throttleRotate,s=o===void 0?0:o,l=e.prevSnapDeg,c=0,u=!1;if(i){var f=jf(t,r,n,a+n);u=f.isSnap,c=a+f.dist}u||(c=dt(a+n,s));var d=c-a;return e.prevSnapDeg=d,[d-l,d,c]}function Bo(t,r,e){var n=M(r,4),a=n[0],i=n[1],o=n[2],s=n[3];if(t==="none")return[];if(zt(t))return t.map(function(h){return Bo(h,[a,i,o,s],e)[0]});var l=M((t||"top").split("-"),2),c=l[0],u=l[1],f=[a,i];c==="left"?f=[o,a]:c==="right"?f=[i,s]:c==="bottom"&&(f=[s,o]);var d=[(f[0][0]+f[1][0])/2,(f[0][1]+f[1][1])/2],p=Yo(f,e);if(u){var v=u==="top"||u==="left",g=c==="bottom"||c==="left";d=f[v&&!g||!v&&g?0:1]}return[[d,p]]}function Fn(t,r){if(r.isRequest)return r.requestAble==="rotatable";var e=r.inputEvent.target;if(wt(e,rt("rotation-control"))||t.props.rotateAroundControls&&wt(e,rt("around-control"))||wt(e,rt("control"))&&wt(e,rt("rotatable")))return!0;var n=t.props.rotationTarget;return n?Ma(n,!0).some(function(a){return a?e===a||e.contains(a):!1}):!1}var Ef=`.rotation {
position: absolute;
height: 40px;
width: 1px;
transform-origin: 50% 100%;
height: calc(40px * var(--zoom));
top: auto;
left: 0;
bottom: 100%;
will-change: transform;
}
.rotation .rotation-line {
display: block;
width: 100%;
height: 100%;
transform-origin: 50% 50%;
}
.rotation .rotation-control {
border-color: #4af;
border-color: var(--moveable-color);
background:#fff;
cursor: alias;
}
:global .view-rotation-dragging, .rotatable.direction.control {
cursor: alias;
}
.rotatable.direction.control.move {
cursor: move;
}
`,wf={name:"rotatable",canPinch:!0,props:["rotatable","rotationPosition","throttleRotate","renderDirections","rotationTarget","rotateAroundControls","edge","resolveAblesWithRotatable","displayAroundControls"],events:["rotateStart","beforeRotate","rotate","rotateEnd","rotateGroupStart","beforeRotateGroup","rotateGroup","rotateGroupEnd"],css:[Ef],viewClassName:function(t){return t.isDragging("rotatable")?rt("view-rotation-dragging"):""},render:function(t,r){var e=Pr(t.props,"rotatable"),n=e.rotatable,a=e.rotationPosition,i=e.zoom,o=e.renderDirections,s=e.rotateAroundControls,l=e.resolveAblesWithRotatable,c=t.getState(),u=c.renderPoses,f=c.direction;if(!n)return null;var d=Bo(a,u,f),p=[];if(d.forEach(function(m,x){var y=M(m,2),S=y[0],E=y[1];p.push(r.createElement("div",{key:"rotation".concat(x),className:rt("rotation"),style:{transform:"translate(-50%) translate(".concat(S[0],"px, ").concat(S[1],"px) rotate(").concat(E,"rad)")}},r.createElement("div",{className:rt("line rotation-line"),style:{transform:"scaleX(".concat(i,")")}}),r.createElement("div",{className:rt("control rotation-control"),style:{transform:"translate(0.5px) scale(".concat(i,")")}})))}),o){var v=Jr(l||{}),g={};v.forEach(function(m){l[m].forEach(function(x){g[x]=m})});var h=[];zt(o)&&(h=o.map(function(m){var x=g[m];return{data:x?{resolve:x}:{},classNames:x?["move"]:[],dir:m}})),p.push.apply(p,L([],M(So(t,"rotatable",h,r)),!1))}return s&&p.push.apply(p,L([],M(Ro(t,r)),!1)),p},dragControlCondition:Fn,dragControlStart:function(t,r){var e,n,a=r.datas,i=r.clientX,o=r.clientY,s=r.parentRotate,l=r.parentFlag,c=r.isPinch,u=r.isRequest,f=t.state,d=f.target,p=f.left,v=f.top,g=f.direction,h=f.beforeDirection,m=f.targetTransform,x=f.moveableClientRect,y=f.offsetMatrix,S=f.targetMatrix,E=f.allMatrix,b=f.width,C=f.height;if(!u&&!d)return!1;var w=t.getRect();a.rect=w,a.transform=m,a.left=p,a.top=v;var T=function(Y){var F=_o(t.state,Y);a.fixedDirection=F.fixedDirection,a.fixedOffset=F.fixedOffset,a.fixedPosition=F.fixedPosition,j&&j.setFixedPosition(Y)},O=function(Y){var F=Df(t.state,Y);a.fixedDirection=F.fixedDirection,a.fixedOffset=F.fixedOffset,a.fixedPosition=F.fixedPosition,j&&j.setFixedDirection(Y)},P=i,z=o;if(u||c||l){var I=s||0;a.beforeInfo={origin:w.beforeOrigin,prevDeg:I,defaultDeg:I,prevSnapDeg:0,startDist:0},a.afterInfo=R(R({},a.beforeInfo),{origin:w.origin}),a.absoluteInfo=R(R({},a.beforeInfo),{origin:w.origin,startValue:I})}else{var B=(n=r.inputEvent)===null||n===void 0?void 0:n.target;if(B){var _=B.getAttribute("data-direction")||"",H=Tu[_];if(H){a.isControl=!0,a.isAroundControl=wt(B,rt("around-control")),a.controlDirection=H;var N=B.getAttribute("data-resolve");N&&(a.resolveAble=N);var G=Qf(f.rootMatrix,f.renderPoses,x);e=M(Rt(G,H),2),P=e[0],z=e[1]}}a.beforeInfo={origin:w.beforeOrigin},a.afterInfo={origin:w.origin},a.absoluteInfo={origin:w.origin,startValue:w.rotation};var q=T;T=function(Y){var F=f.is3d?4:3,U=M(pt(zi(S,F),Y),2),tt=U[0],ot=U[1],nt=Ht(y,qr([tt,ot],F)),Q=Ht(E,qr([Y[0],Y[1]],F));q(Y);var J=f.posDelta;a.beforeInfo.origin=et(nt,J),a.afterInfo.origin=et(Q,J),a.absoluteInfo.origin=et(Q,J),Dn(t,a.beforeInfo,P,z,x),Dn(t,a.afterInfo,P,z,x),Dn(t,a.absoluteInfo,P,z,x)},O=function(Y){var F=Rt([[0,0],[b,0],[0,C],[b,C]],Y);T(F)}}a.startClientX=P,a.startClientY=z,a.direction=g,a.beforeDirection=h,a.startValue=0,a.datas={},un(t,r,"rotate");var V=!1,j=!1;if(a.isControl&&a.resolveAble){var $=a.resolveAble;$==="resizable"&&(j=Vn.dragControlStart(t,R(R({},new Yr("resizable").dragStart([0,0],r)),{parentPosition:a.controlPosition,parentFixedPosition:a.fixedPosition})))}j||(V=jt.dragStart(t,new Yr().dragStart([0,0],r))),T(td(t));var K=st(t,r,R(R({set:function(Y){a.startValue=Y*Math.PI/180},setFixedDirection:O,setFixedPosition:T},cn(t,r)),{dragStart:V,resizeStart:j})),W=X(t,"onRotateStart",K);return a.isRotate=W!==!1,f.snapRenderInfo={request:r.isRequest},a.isRotate?K:!1},dragControl:function(t,r){var e,n,a,i=r.datas,o=r.clientDistX,s=r.clientDistY,l=r.parentRotate,c=r.parentFlag,u=r.isPinch,f=r.groupDelta,d=r.resolveMatrix,p=i.beforeDirection,v=i.beforeInfo,g=i.afterInfo,h=i.absoluteInfo,m=i.isRotate,x=i.startValue,y=i.rect,S=i.startClientX,E=i.startClientY;if(m){sn(t,r,"rotate");var b=zu(r),C=p*b,w=t.props.parentMoveable,T=0,O,P,z=0,I,B,_=0,H,N,G=180/Math.PI*x,q=h.startValue,V=!1,j=S+o,$=E+s;if(!c&&"parentDist"in r){var K=r.parentDist;O=K,I=K,H=K}else u||c?(O=Fe(l,p,v),I=Fe(l,C,g),H=Fe(l,C,h)):(O=En(j,$,p,v),I=En(j,$,C,g),H=En(j,$,C,h),V=!0);if(P=G+O,B=G+I,N=q+H,X(t,"onBeforeRotate",st(t,r,{beforeRotation:P,rotation:B,absoluteRotation:N,setRotation:function(vt){I=vt-G,O=I,H=I}},!0)),e=M(wn(t,y,v,O,G,V),3),T=e[0],O=e[1],P=e[2],n=M(wn(t,y,g,I,G,V),3),z=n[0],I=n[1],B=n[2],a=M(wn(t,y,h,H,q,V),3),_=a[0],H=a[1],N=a[2],!(!_&&!z&&!T&&!w&&!d)){var W=ln(i,"rotate(".concat(B,"deg)"),"rotate(".concat(I,"deg)"));d&&(i.fixedPosition=ga(t,i.targetAllTransform,i.fixedDirection,i.fixedOffset,i));var Y=Vu(t,I,i),F=et(pt(f||[0,0],Y),i.prevInverseDist||[0,0]);i.prevInverseDist=Y,i.requestValue=null;var U=xo(t,W,F,u,r),tt=U,ot=Mr([j,$],h.startAbsoluteOrigin)-h.startDist,nt=void 0;if(i.resolveAble==="resizable"){var Q=Vn.dragControl(t,R(R({},Re(r,t.state,[r.deltaX,r.deltaY],!!u,!1,"resizable")),{resolveMatrix:!0,parentDistance:ot}));Q&&(nt=Q,tt=Ko(tt,Q,r))}var J=st(t,r,R(R({delta:z,dist:I,rotate:B,rotation:B,beforeDist:O,beforeDelta:T,beforeRotate:P,beforeRotation:P,absoluteDist:H,absoluteDelta:_,absoluteRotate:N,absoluteRotation:N,isPinch:!!u,resize:nt},U),tt));return X(t,"onRotate",J),J}}},dragControlEnd:function(t,r){var e=r.datas;if(e.isRotate){e.isRotate=!1;var n=Ft(t,r,{});return X(t,"onRotateEnd",n),n}},dragGroupControlCondition:Fn,dragGroupControlStart:function(t,r){var e=r.datas,n=t.state,a=n.left,i=n.top,o=n.beforeOrigin,s=this.dragControlStart(t,r);if(!s)return!1;s.set(e.beforeDirection*t.rotation);var l=ir(t,this,"dragControlStart",r,function(f,d){var p=f.state,v=p.left,g=p.top,h=p.beforeOrigin,m=pt(et([v,g],[a,i]),et(h,o));return d.datas.startGroupClient=m,d.datas.groupClient=m,R(R({},d),{parentRotate:0})}),c=R(R({},s),{targets:t.props.targets,events:l}),u=X(t,"onRotateGroupStart",c);return e.isRotate=u!==!1,e.isRotate?s:!1},dragGroupControl:function(t,r){var e=r.datas;if(e.isRotate){gn(t,"onBeforeRotate",function(c){X(t,"onBeforeRotateGroup",st(t,r,R(R({},c),{targets:t.props.targets}),!0))});var n=this.dragControl(t,r);if(n){var a=e.beforeDirection,i=n.beforeDist,o=i/180*Math.PI,s=ir(t,this,"dragControl",r,function(c,u){var f=u.datas.startGroupClient,d=M(u.datas.groupClient,2),p=d[0],v=d[1],g=M(De(f,o*a),2),h=g[0],m=g[1],x=[h-p,m-v];return u.datas.groupClient=[h,m],R(R({},u),{parentRotate:i,groupDelta:x})});t.rotation=a*n.beforeRotation;var l=R({targets:t.props.targets,events:s,set:function(c){t.rotation=c},setGroupRotation:function(c){t.rotation=c}},n);return X(t,"onRotateGroup",l),l}}},dragGroupControlEnd:function(t,r){var e=r.isDrag,n=r.datas;if(n.isRotate){this.dragControlEnd(t,r);var a=ir(t,this,"dragControlEnd",r),i=Ft(t,r,{targets:t.props.targets,events:a});return X(t,"onRotateGroupEnd",i),e}},request:function(t){var r={},e=0,n=t.getRotation();return{isControl:!0,requestStart:function(){return{datas:r}},request:function(a){return"deltaRotate"in a?e+=a.deltaRotate:"rotate"in a&&(e=a.rotate-n),{datas:r,parentDist:e}},requestEnd:function(){return{datas:r,isDrag:!0}}}}};function Rf(t,r){var e,n=t.direction,a=t.classNames,i=t.size,o=t.pos,s=t.zoom,l=t.key,c=n==="horizontal",u=c?"Y":"X";return r.createElement("div",{key:l,className:a.join(" "),style:(e={},e[c?"width":"height"]="".concat(i),e.transform="translate(".concat(o[0],", ").concat(o[1],") translate").concat(u,"(-50%) scale").concat(u,"(").concat(s,")"),e)})}function Sa(t,r){return Rf(R(R({},t),{classNames:L([rt("line","guideline",t.direction)],M(t.classNames),!1).filter(function(e){return e}),size:t.size||"".concat(t.sizeValue,"px"),pos:t.pos||t.posValue.map(function(e){return"".concat(dt(e,.1),"px")})}),r)}function ei(t,r,e,n,a,i,o,s){var l=t.props.zoom;return e.map(function(c,u){var f=c.type,d=c.pos,p=[0,0];return p[o]=n,p[o?0:1]=-a+d,Sa({key:"".concat(r,"TargetGuideline").concat(u),classNames:[rt("target","bold",f)],posValue:p,sizeValue:i,zoom:l,direction:r},s)})}function ni(t,r,e,n,a,i){var o=t.props,s=o.zoom,l=o.isDisplayInnerSnapDigit,c=r==="horizontal"?yr:br,u=a[c.start],f=a[c.end];return e.filter(function(d){var p=d.hide,v=d.elementRect;if(p)return!1;if(l&&v){var g=v.rect;if(g[c.start]<=u&&f<=g[c.end])return!1}return!0}).map(function(d,p){var v=d.pos,g=d.size,h=d.element,m=d.className,x=[-n[0]+v[0],-n[1]+v[1]];return Sa({key:"".concat(r,"-default-guideline-").concat(p),classNames:h?[rt("bold"),m]:[rt("normal"),m],direction:r,posValue:x,sizeValue:g,zoom:s},i)})}function ie(t,r,e,n,a,i,o,s){var l,c=t.props,u=c.snapDigit,f=u===void 0?0:u,d=c.isDisplaySnapDigit,p=d===void 0?!0:d,v=c.snapDistFormat,g=v===void 0?function(E,b){return E}:v,h=c.zoom,m=r==="horizontal"?"X":"Y",x=r==="vertical"?"height":"width",y=Math.abs(a),S=p?parseFloat(y.toFixed(f)):0;return s.createElement("div",{key:"".concat(r,"-").concat(e,"-guideline-").concat(n),className:rt("guideline-group",r),style:(l={left:"".concat(i[0],"px"),top:"".concat(i[1],"px")},l[x]="".concat(y,"px"),l)},Sa({direction:r,classNames:[rt(e),o],size:"100%",posValue:[0,0],sizeValue:y,zoom:h},s),s.createElement("div",{className:rt("size-value","gap"),style:{transform:"translate".concat(m,"(-50%) scale(").concat(h,")")}},S>0?g(S,r):""))}function Mf(t,r,e,n){var a=t==="vertical"?0:1,i=t==="vertical"?1:0,o=a?yr:br,s=e[o.start],l=e[o.end];return Zo(r,function(c){return c.pos[a]}).map(function(c){var u=[],f=[],d=[];return c.forEach(function(p){var v,g,h=p.element,m=p.elementRect.rect;if(m[o.end]<s)u.push(p);else if(l<m[o.start])f.push(p);else if(m[o.start]<=s&&l<=m[o.end]&&n){var x=p.pos,y={element:h,rect:R(R({},m),(v={},v[o.end]=m[o.start],v))},S={element:h,rect:R(R({},m),(g={},g[o.start]=m[o.end],g))},E=[0,0],b=[0,0];E[a]=x[a],E[i]=x[i],b[a]=x[a],b[i]=x[i]+p.size,u.push({type:t,pos:E,size:0,elementRect:y,direction:"",elementDirection:"end"}),f.push({type:t,pos:b,size:0,elementRect:S,direction:"",elementDirection:"start"})}}),u.sort(function(p,v){return v.pos[i]-p.pos[i]}),f.sort(function(p,v){return p.pos[i]-v.pos[i]}),{total:c,start:u,end:f,inner:d}})}function Of(t,r,e,n,a){var i=t.props.isDisplayInnerSnapDigit,o=[];return["vertical","horizontal"].forEach(function(s){var l=r.filter(function(h){return h.type===s}),c=s==="vertical"?1:0,u=c?0:1,f=Mf(s,l,n,i),d=c?br:yr,p=c?yr:br,v=n[d.start],g=n[d.end];f.forEach(function(h){var m=h.total,x=h.start,y=h.end,S=h.inner,E=e[u]+m[0].pos[u]-n[p.start],b=n;x.forEach(function(C){var w=C.elementRect.rect,T=b[d.start]-w[d.end];if(T>0){var O=[0,0];O[c]=e[c]+b[d.start]-v-T,O[u]=E,o.push(ie(t,s,"dashed",o.length,T,O,C.className,a))}b=w}),b=n,y.forEach(function(C){var w=C.elementRect.rect,T=w[d.start]-b[d.end];if(T>0){var O=[0,0];O[c]=e[c]+b[d.end]-v,O[u]=E,o.push(ie(t,s,"dashed",o.length,T,O,C.className,a))}b=w}),S.forEach(function(C){var w=C.elementRect.rect,T=v-w[d.start],O=w[d.end]-g,P=[0,0],z=[0,0];P[c]=e[c]-T,P[u]=E,z[c]=e[c]+g-v,z[u]=E,o.push(ie(t,s,"dashed",o.length,T,P,C.className,a)),o.push(ie(t,s,"dashed",o.length,O,z,C.className,a))})})}),o}function Tf(t,r,e,n,a){var i=[];return["horizontal","vertical"].forEach(function(o){var s=r.filter(function(h){return h.type===o}).slice(0,1),l=o==="vertical"?0:1,c=l?0:1,u=l?br:yr,f=l?yr:br,d=n[u.start],p=n[u.end],v=n[f.start],g=n[f.end];s.forEach(function(h){var m=h.gap,x=h.gapRects,y=Math.max.apply(Math,L([v],M(x.map(function(b){var C=b.rect;return C[f.start]})),!1)),S=Math.min.apply(Math,L([g],M(x.map(function(b){var C=b.rect;return C[f.end]})),!1)),E=(y+S)/2;y===S||E===(v+g)/2||x.forEach(function(b){var C=b.rect,w=b.className,T=[e[0],e[1]];if(C[u.end]<d)T[l]+=C[u.end]-d;else if(p<C[u.start])T[l]+=C[u.start]-d-m;else return;T[c]+=E-v,i.push(ie(t,l?"vertical":"horizontal","gap",i.length,m,T,w,a))})})}),i}function Wn(t){var r=t.state,e=r.containerClientRect,n=r.hasFixed,a=e.overflow,i=e.scrollHeight,o=e.scrollWidth,s=e.clientHeight,l=e.clientWidth,c=e.clientLeft,u=e.clientTop,f=t.props,d=f.snapGap,p=d===void 0?!0:d,v=f.verticalGuidelines,g=f.horizontalGuidelines,h=f.snapThreshold,m=h===void 0?5:h,x=f.snapGridWidth,y=x===void 0?0:x,S=f.snapGridHeight,E=S===void 0?0:S,b=f.maxSnapElementGuidelineDistance,C=b===void 0?1/0:b,w=f.isDisplayGridGuidelines,T=qt(Xt(t.state)),O=T.top,P=T.left,z=T.bottom,I=T.right,B={top:O,left:P,bottom:z,right:I,center:(P+I)/2,middle:(O+z)/2},_=Pf(t),H=L([],M(_),!1);p&&H.push.apply(H,L([],M(If(t,B,m)),!1));var N=R({},r.snapOffset||{left:0,top:0,bottom:0,right:0});if(H.push.apply(H,L([],M(zf(y,E,a?o:l,a?i:s,c,u,N,w)),!1)),n){var G=e.left,q=e.top;N.left+=G,N.top+=q,N.right+=G,N.bottom+=q}return H.push.apply(H,L([],M(ko(g||!1,v||!1,a?o:l,a?i:s,c,u,N)),!1)),H=H.filter(function(V){var j=V.element,$=V.elementRect,K=V.type;if(!j||!$)return!0;var W=$.rect;return Go(B,W,K,C)}),H}function If(t,r,e){var n=t.props,a=n.maxSnapElementGuidelineDistance,i=a===void 0?1/0:a,o=n.maxSnapElementGapDistance,s=o===void 0?1/0:o,l=t.state.elementRects,c=[];return[["vertical",yr,br],["horizontal",br,yr]].forEach(function(u){var f=M(u,3),d=f[0],p=f[1],v=f[2],g=r[p.start],h=r[p.end],m=r[p.center],x=r[v.start],y=r[v.end];function S(C){var w=C.rect;return w[p.end]<g+e?g-w[p.end]:h-e<w[p.start]?w[p.start]-h:-1}var E=l.filter(function(C){var w=C.rect;return w[v.start]>y||w[v.end]<x?!1:S(C)>0}).sort(function(C,w){return S(C)-S(w)}),b=[];E.forEach(function(C){E.forEach(function(w){if(C!==w){var T=C.rect,O=w.rect,P=T[v.start],z=T[v.end],I=O[v.start],B=O[v.end];P>B||I>z||b.push([C,w])}})}),b.forEach(function(C){var w=M(C,2),T=w[0],O=w[1],P=T.rect,z=O.rect,I=P[p.start],B=P[p.end],_=z[p.start],H=z[p.end],N=0,G=0,q=!1,V=!1,j=!1;if(B<=g&&h<=_){if(V=!0,N=(_-B-(h-g))/2,G=B+N+(h-g)/2,k(G-m)>e)return}else if(B<_&&H<g+e){if(q=!0,N=_-B,G=H+N,k(G-g)>e)return}else if(B<_&&h-e<I){if(j=!0,N=_-B,G=I-N,k(G-h)>e)return}else return;N&&Go(r,z,d,i)&&(N>s||c.push({type:d,pos:d==="vertical"?[G,0]:[0,G],element:O.element,size:0,className:O.className,isStart:q,isCenter:V,isEnd:j,gap:N,hide:!0,gapRects:[T,O],direction:"",elementDirection:""}))})}),c}function zf(t,r,e,n,a,i,o,s){a===void 0&&(a=0),i===void 0&&(i=0);var l=[],c=o.left,u=o.top;if(r)for(var f=0;f<=n;f+=r)l.push({type:"horizontal",pos:[c,dt(f-i+u,.1)],className:rt("grid-guideline"),size:e,hide:!s,direction:""});if(t)for(var f=0;f<=e;f+=t)l.push({type:"vertical",pos:[dt(f-a+c,.1),u],className:rt("grid-guideline"),size:n,hide:!s,direction:""});return l}function Go(t,r,e,n){return e==="horizontal"?k(t.right-r.left)<=n||k(t.left-r.right)<=n||t.left<=r.right&&r.left<=t.right:e==="vertical"?k(t.bottom-r.top)<=n||k(t.top-r.bottom)<=n||t.top<=r.bottom&&r.top<=t.bottom:!0}function Pf(t){var r=t.state,e=t.props.elementGuidelines,n=e===void 0?[]:e;if(!n.length)return r.elementRects=[],[];var a=(r.elementRects||[]).filter(function(d){return!d.refresh}),i=n.map(function(d){return Ce(d)&&"element"in d?R(R({},d),{element:Qt(d.element,!0)}):{element:Qt(d,!0)}}).filter(function(d){return d.element}),o=Us(a.map(function(d){return d.element}),i.map(function(d){return d.element})),s=o.maintained,l=o.added,c=[];s.forEach(function(d){var p=M(d,2),v=p[0],g=p[1];c[g]=a[v]}),_f(t,l.map(function(d){return i[d]})).map(function(d,p){c[l[p]]=d}),r.elementRects=c;var u=ma(t.props.elementSnapDirections),f=[];return c.forEach(function(d){var p=d.element,v=d.top,g=v===void 0?u.top:v,h=d.left,m=h===void 0?u.left:h,x=d.right,y=x===void 0?u.right:x,S=d.bottom,E=S===void 0?u.bottom:S,b=d.center,C=b===void 0?u.center:b,w=d.middle,T=w===void 0?u.middle:w,O=d.className,P=d.rect,z=xa({top:g,right:y,left:m,bottom:E,center:C,middle:T},P),I=z.horizontal,B=z.vertical,_=z.horizontalNames,H=z.verticalNames,N=P.top,G=P.left,q=P.right-G,V=P.bottom-N,j=[q,V];B.forEach(function($,K){f.push({type:"vertical",element:p,pos:[dt($,.1),N],size:V,sizes:j,className:O,elementRect:d,elementDirection:Ua[H[K]]||H[K],direction:""})}),I.forEach(function($,K){f.push({type:"horizontal",element:p,pos:[G,dt($,.1)],size:q,sizes:j,className:O,elementRect:d,elementDirection:Ua[_[K]]||_[K],direction:""})})}),f}function ai(t,r){return t?t.map(function(e){var n=Ce(e)?e:{pos:e},a=n.pos;return ge(a)?n:R(R({},n),{pos:xt(a,r)})}):[]}function ko(t,r,e,n,a,i,o){a===void 0&&(a=0),i===void 0&&(i=0),o===void 0&&(o={left:0,top:0,right:0,bottom:0});var s=[],l=o.left,c=o.top,u=o.bottom,f=o.right,d=e+f-l,p=n+u-c;return ai(t,p).forEach(function(v){s.push({type:"horizontal",pos:[l,dt(v.pos-i+c,.1)],size:d,className:v.className,direction:""})}),ai(r,d).forEach(function(v){s.push({type:"vertical",pos:[dt(v.pos-a+l,.1),c],size:p,className:v.className,direction:""})}),s}function _f(t,r){if(!r.length)return[];var e=t.props.groupable,n=t.state,a=n.containerClientRect,i=n.rootMatrix,o=n.is3d,s=n.offsetDelta,l=o?4:3,c=M(nf(i,a,l),2),u=c[0],f=c[1],d=e?0:s[0],p=e?0:s[1];return r.map(function(v){var g=v.element.getBoundingClientRect(),h=g.left-u-d,m=g.top-f-p,x=m+g.height,y=h+g.width,S=M($r(i,[h,m],l),2),E=S[0],b=S[1],C=M($r(i,[y,x],l),2),w=C[0],T=C[1];return R(R({},v),{rect:{left:E,right:w,top:b,bottom:T,center:(E+w)/2,middle:(b+T)/2}})})}function Be(t){var r=t.state,e=r.container,n=t.props.snapContainer||e;if(r.snapContainer===n&&r.guidelines&&r.guidelines.length)return!1;var a=r.containerClientRect,i={left:0,top:0,bottom:0,right:0};if(e!==n){var o=Qt(n,!0);if(o){var s=ce(o),l=ci(r,[s.left-a.left,s.top-a.top]),c=ci(r,[s.right-a.right,s.bottom-a.bottom]);i.left=dt(l[0],1e-5),i.top=dt(l[1],1e-5),i.right=dt(c[0],1e-5),i.bottom=dt(c[1],1e-5)}}return r.snapContainer=n,r.snapOffset=i,r.guidelines=Wn(t),r.enableSnap=!0,!0}function jo(t,r,e,n,a,i){var o=kr(t,r,e,i?4:3),s=Rt(o,n);return Da(o,et(a,s))}function ii(t){return t?t/k(t):0}function Bf(t,r,e,n,a,i){var o=i.fixedDirection,s=lf(e,o,n),l=ba(t,r,e,n),c=L(L([],M(bf(t,r,s,n,a,i)),!1),M(zo(t,l,i)),!1),u=Ue(c,0),f=Ue(c,1);return{width:{isBound:u.isBound,offset:u.offset[0]},height:{isBound:f.isBound,offset:f.offset[1]}}}function Gf(t,r,e,n,a,i,o,s,l){var c=Rt(r,o),u=pn(t,s,{vertical:[c[0]],horizontal:[c[1]]}),f=u.horizontal.offset,d=u.vertical.offset;if(dt(d,jn)||dt(f,jn)){var p=M(nr({datas:l,distX:-d,distY:-f}),2),v=p[0],g=p[1],h=Math.min(a||1/0,e+o[0]*v),m=Math.min(i||1/0,n+o[1]*g);return[h-e,m-n]}return[0,0]}function Ao(t,r,e,n,a,i,o,s){for(var l=Xt(t.state),c=t.props.keepRatio,u=0,f=0,d=0;d<2;++d){var p=r(u,f),v=Bf(t,p,a,c,o,s),g=v.width,h=v.height,m=g.isBound,x=h.isBound,y=g.offset,S=h.offset;if(d===1&&(m||(y=0),x||(S=0)),d===0&&o&&!m&&!x)return[0,0];if(c){var E=k(y)*(e?1/e:1),b=k(S)*(n?1/n:1),C=m&&x?E<b:x||!m&&E<b;C?y=e*S/n:S=n*y/e}u+=y,f+=S}if(!c&&a[0]&&a[1]){var w=Cf(t,l,a,i,s),T=w.maxWidth,O=w.maxHeight,P=M(Gf(t,r(u,f).map(function(B){return B.map(function(_){return dt(_,jn)})}),e+u,n+f,T,O,a,o,s),2),y=P[0],S=P[1];u+=y,f+=S}return[u,f]}function se(t){return t<0&&(t=t%360+360),t%=360,t}function kf(t,r){r=se(r);var e=Math.floor(t/360),n=e*360+360-r,a=e*360+r;return k(t-n)<k(t-a)?n:a}function Rn(t,r){t=se(t),r=se(r);var e=se(t-r);return Math.min(e,360-e)}function jf(t,r,e,n){var a,i=t.props,o=(a=i[No])!==null&&a!==void 0?a:5,s=i[Lo];if(re(t,"rotatable")){var l=r.pos1,c=r.pos2,u=r.pos3,f=r.pos4,d=r.origin,p=e*Math.PI/180,v=[l,c,u,f].map(function(S){return et(S,d)}),g=v.map(function(S){return De(S,p)}),h=L(L([],M(Qu(t,v,g,d,e)),!1),M(vf(t,v,g,d,e)),!1);h.sort(function(S,E){return k(S-e)-k(E-e)});var m=h.length>0;if(m)return{isSnap:m,dist:m?h[0]:e}}if(s!=null&&s.length&&o){var x=s.slice().sort(function(S,E){return Rn(S,n)-Rn(E,n)}),y=x[0];if(Rn(y,n)<=o)return{isSnap:!0,dist:e+kf(n,y)-n}}return{isSnap:!1,dist:e}}function Af(t,r,e,n,a,i,o){if(!re(t,"resizable"))return[0,0];var s=o.fixedDirection,l=o.nextAllMatrix,c=t.state,u=c.allMatrix,f=c.is3d;return Ao(t,function(d,p){return jo(l||u,r+d,e+p,s,a,f)},r,e,n,a,i,o)}function Nf(t,r,e,n,a){if(!re(t,"scalable"))return[0,0];var i=a.startOffsetWidth,o=a.startOffsetHeight,s=a.fixedPosition,l=a.fixedDirection,c=a.is3d,u=Ao(t,function(f,d){return jo(Au(a,pt(r,[f/i,d/o])),i,o,l,s,c)},i,o,e,s,n,a);return[u[0]/i,u[1]/o]}function Lf(t,r){r.absolutePoses=Xt(t.state)}function oi(t){var r=[];return t.forEach(function(e){e.guidelineInfos.forEach(function(n){var a=n.guideline;xr(r,function(i){return i.guideline===a})||(a.direction="",r.push({guideline:a,posInfo:e}))})}),r.map(function(e){var n=e.guideline,a=e.posInfo;return R(R({},n),{direction:a.direction})})}function si(t,r,e,n,a,i){var o=ha(fn(t,i),r,e),s=o.vertical,l=o.horizontal,c=Lr();s.forEach(function(v){v.isBound&&(v.direction==="start"&&(c.left=!0),v.direction==="end"&&(c.right=!0),n.push({type:"bounds",pos:v.pos}))}),l.forEach(function(v){v.isBound&&(v.direction==="start"&&(c.top=!0),v.direction==="end"&&(c.bottom=!0),a.push({type:"bounds",pos:v.pos}))});var u=gf(t),f=u.boundMap,d=u.vertical,p=u.horizontal;return d.forEach(function(v){pe(n,function(g){var h=g.type,m=g.pos;return h==="bounds"&&m===v})>=0||n.push({type:"bounds",pos:v})}),p.forEach(function(v){pe(a,function(g){var h=g.type,m=g.pos;return h==="bounds"&&m===v})>=0||a.push({type:"bounds",pos:v})}),{boundMap:c,innerBoundMap:f}}var Hf=Ra("",["resizable","scalable"]),No="snapRotationThreshold",Lo="snapRotationDegrees",Vf={name:"snappable",dragRelation:"strong",props:["snappable","snapContainer","snapDirections","elementSnapDirections","snapGap","snapGridWidth","snapGridHeight","isDisplaySnapDigit","isDisplayInnerSnapDigit","isDisplayGridGuidelines","snapDigit","snapThreshold","snapRenderThreshold",No,Lo,"horizontalGuidelines","verticalGuidelines","elementGuidelines","bounds","innerBounds","snapDistFormat","maxSnapElementGuidelineDistance","maxSnapElementGapDistance"],events:["snap","bound"],css:[`:host {
--bounds-color: #d66;
}
.guideline {
pointer-events: none;
z-index: 2;
}
.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}
.guideline-group {
position: absolute;
top: 0;
left: 0;
}
.guideline-group .size-value {
position: absolute;
color: #f55;
font-size: 12px;
font-size: calc(12px * var(--zoom));
font-weight: bold;
}
.guideline-group.horizontal .size-value {
transform-origin: 50% 100%;
transform: translateX(-50%);
left: 50%;
bottom: 5px;
bottom: calc(2px + 3px * var(--zoom));
}
.guideline-group.vertical .size-value {
transform-origin: 0% 50%;
top: 50%;
transform: translateY(-50%);
left: 5px;
left: calc(2px + 3px * var(--zoom));
}
.guideline.gap {
background: #f55;
}
.size-value.gap {
color: #f55;
}
`],render:function(t,r){var e=t.state,n=e.top,a=e.left,i=e.pos1,o=e.pos2,s=e.pos3,l=e.pos4,c=e.snapRenderInfo,u=t.props.snapRenderThreshold,f=u===void 0?1:u;if(!c||!c.render||!re(t,""))return Vr(t,"boundMap",Lr(),function(W){return JSON.stringify(W)}),Vr(t,"innerBoundMap",Lr(),function(W){return JSON.stringify(W)}),[];e.guidelines=Wn(t);var d=Math.min(i[0],o[0],s[0],l[0]),p=Math.min(i[1],o[1],s[1],l[1]),v=c.externalPoses||[],g=Xt(t.state),h=[],m=[],x=[],y=[],S=[],E=qt(g),b=E.width,C=E.height,w=E.top,T=E.left,O=E.bottom,P=E.right,z={left:T,right:P,top:w,bottom:O,center:(T+P)/2,middle:(w+O)/2},I=v.length>0,B=I?qt(v):{};if(!c.request){if(c.direction&&S.push(sf(t,g,c.direction,f)),c.snap){var _=qt(g);c.center&&(_.middle=(_.top+_.bottom)/2,_.center=(_.left+_.right)/2),S.push($a(t,_,f))}I&&(c.center&&(B.middle=(B.top+B.bottom)/2,B.center=(B.left+B.right)/2),S.push($a(t,B,f))),S.forEach(function(W){var Y=W.vertical.posInfos,F=W.horizontal.posInfos;h.push.apply(h,L([],M(Y.filter(function(U){var tt=U.guidelineInfos;return tt.some(function(ot){var nt=ot.guideline;return!nt.hide})}).map(function(U){return{type:"snap",pos:U.pos}})),!1)),m.push.apply(m,L([],M(F.filter(function(U){var tt=U.guidelineInfos;return tt.some(function(ot){var nt=ot.guideline;return!nt.hide})}).map(function(U){return{type:"snap",pos:U.pos}})),!1)),x.push.apply(x,L([],M(oi(Y)),!1)),y.push.apply(y,L([],M(oi(F)),!1))})}var H=si(t,[T,P],[w,O],h,m),N=H.boundMap,G=H.innerBoundMap;I&&si(t,[B.left,B.right],[B.top,B.bottom],h,m,c.externalBounds);var q=L(L([],M(x),!1),M(y),!1),V=q.filter(function(W){return W.element&&!W.gapRects}),j=q.filter(function(W){return W.gapRects}).sort(function(W,Y){return W.gap-Y.gap});X(t,"onSnap",{guidelines:q.filter(function(W){var Y=W.element;return!Y}),elements:V,gaps:j},!0);var $=Vr(t,"boundMap",N,function(W){return JSON.stringify(W)},Lr()),K=Vr(t,"innerBoundMap",G,function(W){return JSON.stringify(W)},Lr());return(N===$||G===K)&&X(t,"onBound",{bounds:N,innerBounds:G},!0),L(L(L(L(L(L([],M(Of(t,V,[d,p],z,r)),!1),M(Tf(t,j,[d,p],z,r)),!1),M(ni(t,"horizontal",y,[a,n],z,r)),!1),M(ni(t,"vertical",x,[a,n],z,r)),!1),M(ei(t,"horizontal",m,d,n,b,0,r)),!1),M(ei(t,"vertical",h,p,a,C,1,r)),!1)},dragStart:function(t,r){t.state.snapRenderInfo={request:r.isRequest,snap:!0,center:!0},Be(t)},drag:function(t){var r=t.state;Be(t)||(r.guidelines=Wn(t)),r.snapRenderInfo&&(r.snapRenderInfo.render=!0)},pinchStart:function(t){this.unset(t)},dragEnd:function(t){this.unset(t)},dragControlCondition:function(t,r){if(Hf(t,r)||Fn(t,r))return!0;if(!r.isRequest&&r.inputEvent)return wt(r.inputEvent.target,rt("snap-control"))},dragControlStart:function(t){t.state.snapRenderInfo=null,Be(t)},dragControl:function(t){this.drag(t)},dragControlEnd:function(t){this.unset(t)},dragGroupStart:function(t,r){this.dragStart(t,r)},dragGroup:function(t){this.drag(t)},dragGroupEnd:function(t){this.unset(t)},dragGroupControlStart:function(t){t.state.snapRenderInfo=null,Be(t)},dragGroupControl:function(t){this.drag(t)},dragGroupControlEnd:function(t){this.unset(t)},unset:function(t){var r=t.state;r.enableSnap=!1,r.guidelines=[],r.snapRenderInfo=null,r.elementRects=[]}};function Ff(t,r){return[t[0]*r[0],t[1]*r[1]]}function rt(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return Vs.apply(void 0,L([da],M(t),!1))}function Ho(t){t()}function Wf(t){return!t||t==="none"?[1,0,0,1,0,0]:Ce(t)?t:ve(t)}function le(t,r,e){return We(r,Ir(e,r),t,Ir(e.map(function(n){return-n}),r))}function qf(t,r,e){if(r==="%"){var n=Ca(t.ownerSVGElement);return n[e?"width":"height"]/100}return 1}function Yf(t){var r=Xf(Ea(t,":before"));return r.map(function(e,n){var a=ra(e),i=a.value,o=a.unit;return i*qf(t,o,n===0)})}function Ke(t){return t?t.split(" "):["0","0"]}function Xf(t){return Ke(t.transformOrigin)}function Vo(t){var r=Vt(t),e=r("transform");if(e&&e!=="none")return e;if("transform"in t){var n=t.transform,a=n.baseVal;if(!a)return"";var i=a.length;if(!i)return"";for(var o=[],s=function(c){var u=a[c].matrix;o.push("matrix(".concat(["a","b","c","d","e","f"].map(function(f){return u[f]}).join(", "),")"))},l=0;l<i;++l)s(l);return o.join(" ")}return""}function Se(t,r,e,n,a){var i,o,s=na(t)||Sr(t),l=!1,c,u;if(!t||e)c=t;else{var f=(i=t==null?void 0:t.assignedSlot)===null||i===void 0?void 0:i.parentElement,d=t.parentElement;f?(l=!0,u=d,c=f):c=d}for(var p=!1,v=t===r||c===r,g="relative",h=1,m=parseFloat(a==null?void 0:a("zoom"))||1,x=a==null?void 0:a("position");c&&c!==s;){r===c&&(v=!0);var y=Vt(c),S=c.tagName.toLowerCase(),E=Vo(c),b=y("willChange"),C=parseFloat(y("zoom"))||1;if(g=y("position"),n&&C!==1){h=C;break}if(!e&&n&&m!==1&&x&&x!=="absolute"||S==="svg"||g!=="static"||E&&E!=="none"||b==="transform")break;var w=(o=t==null?void 0:t.assignedSlot)===null||o===void 0?void 0:o.parentNode,T=c.parentNode;w&&(l=!0,u=T);var O=T;if(O&&O.nodeType===11){c=O.host,p=!0,g=Vt(c)("position");break}c=O,g="relative"}return{offsetZoom:h,hasSlot:l,parentSlotElement:u,isCustomElement:p,isStatic:g==="static",isEnd:v||!c||c===s,offsetParent:c||s}}function Uf(t,r){var e,n=t.tagName.toLowerCase(),a=t.offsetLeft,i=t.offsetTop,o=Vt(t),s=aa(a),l=!s,c,u;return!l&&n!=="svg"?(c=co?Yf(t):Ke(o("transformOrigin")).map(function(f){return parseFloat(f)}),u=c.slice(),l=!0,e=M(Zf(t,c,t===r&&r.tagName.toLowerCase()==="g"),4),a=e[0],i=e[1],c[0]=e[2],c[1]=e[3]):(c=Ke(o("transformOrigin")).map(function(f){return parseFloat(f)}),u=c.slice()),{tagName:n,isSVG:s,hasOffset:l,offset:[a||0,i||0],origin:c,targetOrigin:u}}function Fo(t,r){var e=Vt(t),n=Vt(Sr(t)),a=n("position");if(!r&&(!a||a==="static"))return[0,0];var i=parseInt(n("marginLeft"),10),o=parseInt(n("marginTop"),10);return e("position")==="absolute"&&((e("top")!=="auto"||e("bottom")!=="auto")&&(o=0),(e("left")!=="auto"||e("right")!=="auto")&&(i=0)),[i,o]}function qn(t){t.forEach(function(r){var e=r.matrix;e&&(r.matrix=rr(e,3,4))})}function $f(t){for(var r=t.parentElement,e=!1,n=Sr(t);r;){var a=Ea(r).transform;if(a&&a!=="none"){e=!0;break}if(r===n)break;r=r.parentElement}return{fixedContainer:r||n,hasTransform:e}}function vn(t,r){return r===void 0&&(r=t.length>9),"".concat(r?"matrix3d":"matrix","(").concat(wi(t,!r).join(","),")")}function Ca(t){var r=t.clientWidth,e=t.clientHeight;if(!t)return{x:0,y:0,width:0,height:0,clientWidth:r,clientHeight:e};var n=t.viewBox,a=n&&n.baseVal||{x:0,y:0,width:0,height:0};return{x:a.x,y:a.y,width:a.width||r,height:a.height||e,clientWidth:r,clientHeight:e}}function Kf(t,r){var e,n=Ca(t),a=n.width,i=n.height,o=n.clientWidth,s=n.clientHeight,l=o/a,c=s/i,u=t.preserveAspectRatio.baseVal,f=u.align,d=u.meetOrSlice,p=[0,0],v=[l,c],g=[0,0];if(f!==1){var h=(f-2)%3,m=Math.floor((f-2)/3);p[0]=a*h/2,p[1]=i*m/2;var x=d===2?Math.max(c,l):Math.min(l,c);v[0]=x,v[1]=x,g[0]=(o-a)/2*h,g[1]=(s-i)/2*m}var y=ea(v,r);return e=M(g,2),y[r*(r-1)]=e[0],y[r*(r-1)+1]=e[1],le(y,r,p)}function Zf(t,r,e){if(!t.getBBox||!e&&t.tagName.toLowerCase()==="g")return[0,0,0,0];var n=t.getBBox(),a=Ca(t.ownerSVGElement),i=n.x-a.x,o=n.y-a.y;return[i,o,r[0]-i,r[1]-o]}function bt(t,r,e){return Ht(t,qr(r,e),e)}function kr(t,r,e,n){return[[0,0],[r,0],[0,e],[r,e]].map(function(a){return bt(t,a,n)})}function qt(t){var r=t.map(function(c){return c[0]}),e=t.map(function(c){return c[1]}),n=Math.min.apply(Math,L([],M(r),!1)),a=Math.min.apply(Math,L([],M(e),!1)),i=Math.max.apply(Math,L([],M(r),!1)),o=Math.max.apply(Math,L([],M(e),!1)),s=i-n,l=o-a;return{left:n,top:a,right:i,bottom:o,width:s,height:l}}function li(t,r,e,n){var a=kr(t,r,e,n);return qt(a)}function Jf(t,r,e,n,a){var i,o=t.target,s=t.origin,l=r.matrix,c=qo(o),u=c.offsetWidth,f=c.offsetHeight,d=e.getBoundingClientRect(),p=[0,0];e===Sr(e)&&(p=Fo(o,!0));for(var v=o.getBoundingClientRect(),g=v.left-d.left+e.scrollLeft-(e.clientLeft||0)+p[0],h=v.top-d.top+e.scrollTop-(e.clientTop||0)+p[1],m=v.width,x=v.height,y=We(n,a,l),S=li(y,u,f,n),E=S.left,b=S.top,C=S.width,w=S.height,T=bt(y,s,n),O=et(T,[E,b]),P=[g+O[0]*m/C,h+O[1]*x/w],z=[0,0],I=0;++I<10;){var B=or(a,n);i=M(et(bt(B,P,n),bt(B,T,n)),2),z[0]=i[0],z[1]=i[1];var _=We(n,a,Ir(z,n),l),H=li(_,u,f,n),N=H.left,G=H.top,q=N-g,V=G-h;if(k(q)<2&&k(V)<2)break;P[0]-=q,P[1]-=V}return z.map(function(j){return Math.round(j)})}function Qf(t,r,e){var n=t.length===16,a=n?4:3,i=r.map(function(l){return bt(t,l,a)}),o=e.left,s=e.top;return i.map(function(l){return[l[0]+o,l[1]+s]})}function Yt(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1])}function Wo(t,r){return Yt([r[0]-t[0],r[1]-t[1]])}function oe(t,r,e,n){e===void 0&&(e=1),n===void 0&&(n=Ot(t,r));var a=Wo(t,r);return{transform:"translateY(-50%) translate(".concat(t[0],"px, ").concat(t[1],"px) rotate(").concat(n,"rad) scaleY(").concat(e,")"),width:"".concat(a,"px")}}function Ze(t,r){for(var e=[],n=2;n<arguments.length;n++)e[n-2]=arguments[n];var a=e.length,i=e.reduce(function(s,l){return s+l[0]},0)/a,o=e.reduce(function(s,l){return s+l[1]},0)/a;return{transform:"translateZ(0px) translate(".concat(i,"px, ").concat(o,"px) rotate(").concat(t,"rad) scale(").concat(r,")")}}function Pr(t,r){var e=t[r];return Ce(e)?R(R({},t),e):t}function qo(t){var r=t&&!aa(t.offsetWidth),e=0,n=0,a=0,i=0,o=0,s=0,l=0,c=0,u=0,f=0,d=0,p=0,v=1/0,g=1/0,h=1/0,m=1/0,x=0,y=0,S=!1;if(t)if(!r&&t.tagName.toLowerCase()!=="svg"){var E=t.getBBox();S=!0,e=E.width,n=E.height,o=e,s=n,l=e,c=n,a=e,i=n}else{var b=Vt(t),C=t.style,w=b("boxSizing")==="border-box",T=parseFloat(b("borderLeftWidth"))||0,O=parseFloat(b("borderRightWidth"))||0,P=parseFloat(b("borderTopWidth"))||0,z=parseFloat(b("borderBottomWidth"))||0,I=parseFloat(b("paddingLeft"))||0,B=parseFloat(b("paddingRight"))||0,_=parseFloat(b("paddingTop"))||0,H=parseFloat(b("paddingBottom"))||0,N=I+B,G=_+H,q=T+O,V=P+z,j=N+q,$=G+V,K=b("position"),W=0,Y=0;if("clientLeft"in t){var F=null;if(K==="absolute"){var U=Se(t,Sr(t));F=U.offsetParent}else F=t.parentElement;if(F){var tt=Vt(F);W=parseFloat(tt("width")),Y=parseFloat(tt("height"))}}u=Math.max(N,xt(b("minWidth"),W)||0),f=Math.max(G,xt(b("minHeight"),Y)||0),v=xt(b("maxWidth"),W),g=xt(b("maxHeight"),Y),isNaN(v)&&(v=1/0),isNaN(g)&&(g=1/0),x=xt(C.width,0)||0,y=xt(C.height,0)||0,o=parseFloat(b("width"))||0,s=parseFloat(b("height"))||0,l=k(o-x)<1?Va(u,x||o,v):o,c=k(s-y)<1?Va(f,y||s,g):s,e=l,n=c,a=l,i=c,w?(h=v,m=g,d=u,p=f,l=e-j,c=n-$):(h=v+j,m=g+$,d=u+j,p=f+$,e=l+j,n=c+$),a=l+N,i=c+G}return{svg:S,offsetWidth:e,offsetHeight:n,clientWidth:a,clientHeight:i,contentWidth:l,contentHeight:c,inlineCSSWidth:x,inlineCSSHeight:y,cssWidth:o,cssHeight:s,minWidth:u,minHeight:f,maxWidth:v,maxHeight:g,minOffsetWidth:d,minOffsetHeight:p,maxOffsetWidth:h,maxOffsetHeight:m}}function Yo(t,r){return Ot(r>0?t[0]:t[1],r>0?t[1]:t[0])}function Ge(){return{left:0,top:0,width:0,height:0,right:0,bottom:0,clientLeft:0,clientTop:0,clientWidth:0,clientHeight:0,scrollWidth:0,scrollHeight:0}}function Xo(t,r){var e=t===Sr(t)||t===na(t),n={clientLeft:t.clientLeft,clientTop:t.clientTop,clientWidth:t.clientWidth,clientHeight:t.clientHeight,scrollWidth:t.scrollWidth,scrollHeight:t.scrollHeight,overflow:!1};return e&&(n.clientHeight=Math.max(r.height,n.clientHeight),n.scrollHeight=Math.max(r.height,n.scrollHeight)),n.overflow=Vt(t)("overflow")!=="visible",R(R({},r),n)}function Mn(t,r,e,n){var a=t.left,i=t.right,o=t.top,s=t.bottom,l=r.top,c=r.left,u={left:c+a,top:l+o,right:c+i,bottom:l+s,width:i-a,height:s-o};return e&&n?Xo(e,u):u}function ce(t,r){var e=0,n=0,a=0,i=0;if(t){var o=t.getBoundingClientRect();e=o.left,n=o.top,a=o.width,i=o.height}var s={left:e,top:n,width:a,height:i,right:e+a,bottom:n+i};return t&&r?Xo(t,s):s}function td(t){var r=t.props,e=r.groupable,n=r.svgOrigin,a=t.getState(),i=a.offsetWidth,o=a.offsetHeight,s=a.svg,l=a.transformOrigin;return!e&&s&&n?Oa(n,i,o):l}function Uo(t,r,e,n){var a;if(t)a=t;else if(r)a=[0,0];else{var i=e.target;a=$o(i,n)}return a}function $o(t,r){if(t){var e=t.getAttribute("data-rotation")||"",n=t.getAttribute("data-direction");if(r.deg=e,!!n){var a=[0,0];return n.indexOf("w")>-1&&(a[0]=-1),n.indexOf("e")>-1&&(a[0]=1),n.indexOf("n")>-1&&(a[1]=-1),n.indexOf("s")>-1&&(a[1]=1),a}}}function Da(t,r){return[pt(r,t[0]),pt(r,t[1]),pt(r,t[2]),pt(r,t[3])]}function Xt(t){var r=t.left,e=t.top,n=t.pos1,a=t.pos2,i=t.pos3,o=t.pos4;return Da([n,a,i,o],[r,e])}function Yn(t,r){t[r?"controlAbles":"targetAbles"].forEach(function(e){e.unset&&e.unset(t)})}function Hr(t,r){var e=r?"controlGesto":"targetGesto",n=t[e];(n==null?void 0:n.isIdle())===!1&&Yn(t,r),n==null||n.unset(),t[e]=null}function At(t,r){if(r){var e=te(r);e.nextStyle=R(R({},e.nextStyle),t)}return{style:t,cssText:Jr(t).map(function(n){return"".concat(Fs(n,"-"),": ").concat(t[n],";")}).join("")}}function Ko(t,r,e){var n=r.afterTransform||r.transform;return R(R({},At(R(R(R({},t.style),r.style),{transform:n}),e)),{afterTransform:n,transform:t.transform})}function st(t,r,e,n){var a=r.datas;a.datas||(a.datas={});var i=R(R({},e),{target:t.state.target,clientX:r.clientX,clientY:r.clientY,inputEvent:r.inputEvent,currentTarget:t,moveable:t,datas:a.datas,isRequest:r.isRequest,isRequestChild:r.isRequestChild,isFirstDrag:!!r.isFirstDrag,isTrusted:r.isTrusted!==!1,stopAble:function(){a.isEventStart=!1},stopDrag:function(){var o;(o=r.stop)===null||o===void 0||o.call(r)}});return a.isStartEvent?n||(a.lastEvent=i):a.isStartEvent=!0,i}function Ft(t,r,e){var n=r.datas,a="isDrag"in e?e.isDrag:r.isDrag;return n.datas||(n.datas={}),R(R({isDrag:a},e),{moveable:t,target:t.state.target,clientX:r.clientX,clientY:r.clientY,inputEvent:r.inputEvent,currentTarget:t,lastEvent:n.lastEvent,isDouble:r.isDouble,datas:n.datas,isFirstDrag:!!r.isFirstDrag})}function gn(t,r,e){t._emitter.on(r,e)}function X(t,r,e,n,a){return t.triggerEvent(r,e,n,a)}function Ea(t,r){return xe(t).getComputedStyle(t,r)}function ke(t,r,e){var n={},a={};return t.filter(function(i){var o=i.name;if(n[o]||!r.some(function(s){return i[s]}))return!1;if(!e&&i.ableGroup){if(a[i.ableGroup])return!1;a[i.ableGroup]=!0}return n[o]=!0,!0})}function Xn(t,r){return t===r||t==null&&r==null}function rd(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];for(var e=t.length-1,n=0;n<e;++n){var a=t[n];if(!aa(a))return a}return t[e]}function Zo(t,r){var e=[],n=[];return t.forEach(function(a,i){var o=r(a,i,t),s=n.indexOf(o),l=e[s]||[];s===-1&&(n.push(o),e.push(l)),l.push(a)}),e}function ed(t,r){var e=[],n={};return t.forEach(function(a,i){var o=r(a,i,t),s=n[o];s||(s=[],n[o]=s,e.push(s)),s.push(a)}),e}function Jo(t){return t.reduce(function(r,e){return r.concat(e)},[])}function Ur(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return t.sort(function(e,n){return k(n)-k(e)}),t[0]}function $r(t,r,e){return Ht(or(t,e),qr(r,e),e)}function Qo(t,r){var e,n=t.is3d,a=t.rootMatrix,i=n?4:3;return e=M($r(a,[r.distX,r.distY],i),2),r.distX=e[0],r.distY=e[1],r}function je(t,r,e,n){if(!e[0]&&!e[1])return r;var a=bt(t,[ii(e[0]),0],n),i=bt(t,[0,ii(e[1])],n),o=bt(t,[e[0]/Yt(a),e[1]/Yt(i)],n);return pt(r,o)}function Ut(t,r,e){return e?"".concat(t/r*100,"%"):"".concat(t,"px")}function Je(t){return k(t)<=Nt?0:t}function wa(t){return function(r){if(!r.isDragging(t))return"";var e=qu(r,t),n=e.deg;return n?rt("view-control-rotation".concat(n)):""}}function Ra(t,r){return r===void 0&&(r=[t]),function(e,n){if(n.isRequest)return r.some(function(i){return n.requestAble===i})?n.parentDirection:!1;var a=n.inputEvent.target;return wt(a,rt("direction"))&&(!t||wt(a,rt(t)))}}function nd(t,r,e){var n,a=he(t,{"x%":function(E){return E/100*r.offsetWidth},"y%":function(E){return E/100*r.offsetHeight}}),i=t.slice(0,e<0?void 0:e),o=t.slice(0,e<0?void 0:e+1),s=t[e]||"",l=e<0?[]:t.slice(e),c=e<0?[]:t.slice(e+1),u=a.slice(0,e<0?void 0:e),f=a.slice(0,e<0?void 0:e+1),d=(n=a[e])!==null&&n!==void 0?n:he([""])[0],p=e<0?[]:a.slice(e),v=e<0?[]:a.slice(e+1),g=d?[d]:[],h=ee(u),m=ee(f),x=ee(p),y=ee(v),S=Mt(h,x,4);return{transforms:t,beforeFunctionMatrix:h,beforeFunctionMatrix2:m,targetFunctionMatrix:ee(g),afterFunctionMatrix:x,afterFunctionMatrix2:y,allFunctionMatrix:S,beforeFunctions:u,beforeFunctions2:f,targetFunction:g[0],afterFunctions:p,afterFunctions2:v,beforeFunctionTexts:i,beforeFunctionTexts2:o,targetFunctionText:s,afterFunctionTexts:l,afterFunctionTexts2:c}}function ad(t){return!t||!Ce(t)||ta(t)?!1:zt(t)||"length"in t}function Qt(t,r){return t?ta(t)?t:Br(t)?r?document.querySelector(t):t:$s(t)?t():Ks(t)?t:"current"in t?t.current:t:null}function Ma(t,r){if(!t)return[];var e=ad(t)?[].slice.call(t):[t];return e.reduce(function(n,a){return Br(a)&&r?L(L([],M(n),!1),M([].slice.call(document.querySelectorAll(a))),!1):(zt(a)?n.push(Ma(a,r)):n.push(Qt(a,r)),n)},[])}function id(t,r,e){var n=Ot(t,r)/Math.PI*180;return n=e>=0?n:180-n,n=n>=0?n:360+n,n}function ci(t,r){var e=t.rootMatrix,n=t.is3d,a=n?4:3,i=or(e,a);return n||(i=rr(i,3,4)),i[12]=0,i[13]=0,i[14]=0,Zs(i,r)}function ts(t,r,e,n,a){var i=M(t,2),o=i[0],s=i[1],l=0,c=0;if(a&&o&&s){var u=Ot([0,0],r),f=Ot([0,0],n),d=Yt(r),p=Math.cos(u-f)*d;if(!n[0])c=p,l=c*e;else if(!n[1])l=p,c=l/e;else{var v=n[0]*o,g=n[1]*s,h=Math.atan2(v+r[0],g+r[1]),m=Math.atan2(v,g);h<0&&(h+=Math.PI*2),m<0&&(m+=Math.PI*2);var x=0;k(h-m)<Math.PI/2||k(h-m)>Math.PI/2*3||(m+=Math.PI),x=h-m,x>Math.PI*2?x-=Math.PI*2:x>Math.PI?x=2*Math.PI-x:x<-Math.PI&&(x=-2*Math.PI-x);var y=Yt([v+r[0],g+r[1]])*Math.cos(x);l=y*Math.sin(m)-v,c=y*Math.cos(m)-g,n[0]<0&&(l*=-1),n[1]<0&&(c*=-1)}}else l=n[0]*r[0],c=n[1]*r[1];return[l,c]}function rs(t,r,e,n){var a,i=e.ratio,o=e.startOffsetWidth,s=e.startOffsetHeight,l=0,c=0,u=n.distX,f=n.distY,d=n.pinchScale,p=n.parentDistance,v=n.parentDist,g=n.parentScale,h=e.fixedDirection,m=[0,1].map(function(C){return k(t[C]-h[C])}),x=[0,1].map(function(C){var w=m[C];return w!==0&&(w=2/w),w});if(v)l=v[0],c=v[1],r&&(l?c||(c=l/i):l=c*i);else if(ge(d))l=(d-1)*o,c=(d-1)*s;else if(g)l=(g[0]-1)*o,c=(g[1]-1)*s;else if(p){var y=o*m[0],S=s*m[1],E=Yt([y,S]);l=p/E*y*x[0],c=p/E*S*x[1]}else{var b=nr({datas:e,distX:u,distY:f});b=x.map(function(C,w){return b[w]*C}),a=M(ts([o,s],b,i,t,r),2),l=a[0],c=a[1]}return{distWidth:l,distHeight:c}}function Un(t,r){if(r){if(t==="left")return{x:"0%",y:"50%"};if(t==="top")return{x:"50%",y:"50%"};if(t==="center")return{x:"50%",y:"50%"};if(t==="right")return{x:"100%",y:"50%"};if(t==="bottom")return{x:"50%",y:"100%"};var e=M(t.split(" "),2),n=e[0],a=e[1],i=Un(n||""),o=Un(a||""),s=R(R({},i),o),l={x:"50%",y:"50%"};return s.x&&(l.x=s.x),s.y&&(l.y=s.y),s.value&&(s.x&&!s.y&&(l.y=s.value),!s.x&&s.y&&(l.x=s.value)),l}return t==="left"?{x:"0%"}:t==="right"?{x:"100%"}:t==="top"?{y:"0%"}:t==="bottom"?{y:"100%"}:t?t==="center"?{value:"50%"}:{value:t}:{}}function Oa(t,r,e){var n=Un(t,!0),a=n.x,i=n.y;return[xt(a,r)||0,xt(i,e)||0]}function od(t,r,e){var n=t.map(function(i){return et(i,r)}),a=n.map(function(i){return De(i,e)});return{prev:n,next:a,result:a.map(function(i){return pt(i,r)})}}function es(t,r){return t.length===r.length&&t.every(function(e,n){var a=r[n],i=zt(e),o=zt(a);return i&&o?es(e,a):!i&&!o?e===a:!1})}function Vr(t,r,e,n,a){var i=t._store,o=i[r];if(!(r in i))if(a!=null)i[r]=a,o=a;else return i[r]=e,e;return o===e||n(o)===n(e)?o:(i[r]=e,e)}function Wt(t){return t>=0?1:-1}function k(t){return Math.abs(t)}function On(t,r){return Js(t).map(function(e){return r(e)})}function ns(t){return ge(t)?{top:t,left:t,right:t,bottom:t}:{left:t.left||0,top:t.top||0,right:t.right||0,bottom:t.bottom||0}}var sd=we("pinchable",{props:["pinchable"],events:["pinchStart","pinch","pinchEnd","pinchGroupStart","pinchGroup","pinchGroupEnd"],dragStart:function(){return!0},pinchStart:function(t,r){var e=r.datas,n=r.targets,a=r.angle,i=r.originalDatas,o=t.props,s=o.pinchable,l=o.ables;if(!s)return!1;var c="onPinch".concat(n?"Group":"","Start"),u="drag".concat(n?"Group":"","ControlStart"),f=(s===!0?t.controlAbles:l.filter(function(g){return s.indexOf(g.name)>-1})).filter(function(g){return g.canPinch&&g[u]}),d=st(t,r,{});n&&(d.targets=n);var p=X(t,c,d);e.isPinch=p!==!1,e.ables=f;var v=e.isPinch;return v?(f.forEach(function(g){if(i[g.name]=i[g.name]||{},!!g[u]){var h=R(R({},r),{datas:i[g.name],parentRotate:a,isPinch:!0});g[u](t,h)}}),t.state.snapRenderInfo={request:r.isRequest,direction:[0,0]},v):!1},pinch:function(t,r){var e=r.datas,n=r.scale,a=r.distance,i=r.originalDatas,o=r.inputEvent,s=r.targets,l=r.angle;if(e.isPinch){var c=a*(1-1/n),u=st(t,r,{});s&&(u.targets=s);var f="onPinch".concat(s?"Group":"");X(t,f,u);var d=e.ables,p="drag".concat(s?"Group":"","Control");return d.forEach(function(v){v[p]&&v[p](t,R(R({},r),{datas:i[v.name],inputEvent:o,resolveMatrix:!0,pinchScale:n,parentDistance:c,parentRotate:l,isPinch:!0}))}),u}},pinchEnd:function(t,r){var e=r.datas,n=r.isPinch,a=r.inputEvent,i=r.targets,o=r.originalDatas;if(e.isPinch){var s="onPinch".concat(i?"Group":"","End"),l=Ft(t,r,{isDrag:n});i&&(l.targets=i),X(t,s,l);var c=e.ables,u="drag".concat(i?"Group":"","ControlEnd");return c.forEach(function(f){f[u]&&f[u](t,R(R({},r),{isDrag:n,datas:o[f.name],inputEvent:a,isPinch:!0}))}),n}},pinchGroupStart:function(t,r){return this.pinchStart(t,R(R({},r),{targets:t.props.targets}))},pinchGroup:function(t,r){return this.pinch(t,R(R({},r),{targets:t.props.targets}))},pinchGroupEnd:function(t,r){return this.pinchEnd(t,R(R({},r),{targets:t.props.targets}))}}),ui=Ra("scalable"),ld={name:"scalable",ableGroup:"size",canPinch:!0,props:["scalable","throttleScale","renderDirections","keepRatio","edge","displayAroundControls"],events:["scaleStart","beforeScale","scale","scaleEnd","scaleGroupStart","beforeScaleGroup","scaleGroup","scaleGroupEnd"],render:Eo("scalable"),dragControlCondition:ui,viewClassName:wa("scalable"),dragControlStart:function(t,r){var e=r.datas,n=r.isPinch,a=r.inputEvent,i=r.parentDirection,o=Uo(i,n,a,e),s=t.state,l=s.width,c=s.height,u=s.targetTransform,f=s.target,d=s.pos1,p=s.pos2,v=s.pos4;if(!o||!f)return!1;n||Gr(t,r),e.datas={},e.transform=u,e.prevDist=[1,1],e.direction=o,e.startOffsetWidth=l,e.startOffsetHeight=c,e.startValue=[1,1];var g=!o[0]&&!o[1]||o[0]||!o[1];un(t,r,"scale"),e.isWidth=g;function h(b){e.ratio=b&&isFinite(b)?b:0}e.startPositions=Xt(t.state);function m(b){var C=Po(e.startPositions,b);e.fixedDirection=C.fixedDirection,e.fixedPosition=C.fixedPosition,e.fixedOffset=C.fixedOffset}e.setFixedDirection=m,h(Mr(d,p)/Mr(p,v)),m([-o[0],-o[1]]);var x=function(b){e.minScaleSize=b},y=function(b){e.maxScaleSize=b};x([-1/0,-1/0]),y([1/0,1/0]);var S=st(t,r,R(R({direction:o,set:function(b){e.startValue=b},setRatio:h,setFixedDirection:m,setMinScaleSize:x,setMaxScaleSize:y},cn(t,r)),{dragStart:jt.dragStart(t,new Yr().dragStart([0,0],r))})),E=X(t,"onScaleStart",S);return e.startFixedDirection=e.fixedDirection,E!==!1&&(e.isScale=!0,t.state.snapRenderInfo={request:r.isRequest,direction:o}),e.isScale?S:!1},dragControl:function(t,r){sn(t,r,"scale");var e=r.datas,n=r.parentKeepRatio,a=r.parentFlag,i=r.isPinch,o=r.dragClient,s=r.isRequest,l=r.useSnap,c=r.resolveMatrix,u=e.prevDist,f=e.direction,d=e.startOffsetWidth,p=e.startOffsetHeight,v=e.isScale,g=e.startValue,h=e.isWidth,m=e.ratio;if(!v)return!1;var x=t.props,y=x.throttleScale,S=x.parentMoveable,E=f;!f[0]&&!f[1]&&(E=[1,1]);var b=m&&(n??x.keepRatio)||!1,C=t.state,w=[g[0],g[1]];function T(){var nt=rs(E,b,e,r),Q=nt.distWidth,J=nt.distHeight,vt=d?(d+Q)/d:1,lt=p?(p+J)/p:1;g[0]||(w[0]=Q/d),g[1]||(w[1]=J/p);var ct=(E[0]||b?vt:1)*w[0],ft=(E[1]||b?lt:1)*w[1];return ct===0&&(ct=Wt(u[0])*ze),ft===0&&(ft=Wt(u[1])*ze),[ct,ft]}var O=T();if(!i&&t.props.groupable){var P=C.snapRenderInfo||{},z=P.direction;zt(z)&&(z[0]||z[1])&&(C.snapRenderInfo={direction:f,request:r.isRequest})}X(t,"onBeforeScale",st(t,r,{scale:O,setFixedDirection:function(nt){return e.setFixedDirection(nt),O=T(),O},startFixedDirection:e.startFixedDirection,setScale:function(nt){O=nt}},!0));var I=[O[0]/w[0],O[1]/w[1]],B=o,_=[0,0],H=!o&&!a&&i;if(H||c?B=ga(t,e.targetAllTransform,[0,0],[0,0],e):o||(B=e.fixedPosition),i||(_=Nf(t,I,f,!l&&s,e)),b){E[0]&&E[1]&&_[0]&&_[1]&&(Math.abs(_[0]*d)>Math.abs(_[1]*p)?_[1]=0:_[0]=0);var N=!_[0]&&!_[1];if(N&&(h?I[0]=dt(I[0]*w[0],y)/w[0]:I[1]=dt(I[1]*w[1],y)/w[1]),E[0]&&!E[1]||_[0]&&!_[1]||N&&h){I[0]+=_[0];var G=d*I[0]*w[0]/m;I[1]=G/p/w[1]}else if(!E[0]&&E[1]||!_[0]&&_[1]||N&&!h){I[1]+=_[1];var q=p*I[1]*w[1]*m;I[0]=q/d/w[0]}}else I[0]+=_[0],I[1]+=_[1],_[0]||(I[0]=dt(I[0]*w[0],y)/w[0]),_[1]||(I[1]=dt(I[1]*w[1],y)/w[1]);I[0]===0&&(I[0]=Wt(u[0])*ze),I[1]===0&&(I[1]=Wt(u[1])*ze),O=Ff(I,[w[0],w[1]]);var V=[d,p],j=[d*O[0],p*O[1]];j=Ei(j,e.minScaleSize,e.maxScaleSize,b?m:!1),O=On(2,function(nt){return V[nt]?j[nt]/V[nt]:j[nt]}),I=On(2,function(nt){return O[nt]/w[nt]});var $=On(2,function(nt){return u[nt]?I[nt]/u[nt]:I[nt]}),K="scale(".concat(I.join(", "),")"),W="scale(".concat(O.join(", "),")"),Y=ln(e,W,K),F=!g[0]||!g[1],U=Nu(t,F?W:K,e.fixedDirection,B,e.fixedOffset,e,F),tt=H?U:et(U,e.prevInverseDist||[0,0]);if(e.prevDist=I,e.prevInverseDist=U,O[0]===u[0]&&O[1]===u[1]&&tt.every(function(nt){return!nt})&&!S&&!H)return!1;var ot=st(t,r,R({offsetWidth:d,offsetHeight:p,direction:f,scale:O,dist:I,delta:$,isPinch:!!i},xo(t,Y,tt,i,r)));return X(t,"onScale",ot),ot},dragControlEnd:function(t,r){var e=r.datas;if(!e.isScale)return!1;e.isScale=!1;var n=Ft(t,r,{});return X(t,"onScaleEnd",n),n},dragGroupControlCondition:ui,dragGroupControlStart:function(t,r){var e=r.datas,n=this.dragControlStart(t,r);if(!n)return!1;var a=$t(t,"resizable",r);e.moveableScale=t.scale;var i=ir(t,this,"dragControlStart",r,function(c,u){return Xe(t,c,e,u)}),o=function(c){n.setFixedDirection(c),i.forEach(function(u,f){u.setFixedDirection(c),Xe(t,u.moveable,e,a[f])})};e.setFixedDirection=o;var s=R(R({},n),{targets:t.props.targets,events:i,setFixedDirection:o}),l=X(t,"onScaleGroupStart",s);return e.isScale=l!==!1,e.isScale?s:!1},dragGroupControl:function(t,r){var e=r.datas;if(e.isScale){gn(t,"onBeforeScale",function(u){X(t,"onBeforeScaleGroup",st(t,r,R(R({},u),{targets:t.props.targets}),!0))});var n=this.dragControl(t,r);if(n){var a=n.dist,i=e.moveableScale;t.scale=[a[0]*i[0],a[1]*i[1]];var o=t.props.keepRatio,s=e.fixedPosition,l=ir(t,this,"dragControl",r,function(u,f){var d=M(Ht(Qn(t.rotation/180*Math.PI,3),[f.datas.originalX*a[0],f.datas.originalY*a[1],1],3),2),p=d[0],v=d[1];return R(R({},f),{parentDist:null,parentScale:a,parentKeepRatio:o,dragClient:pt(s,[p,v])})}),c=R({targets:t.props.targets,events:l},n);return X(t,"onScaleGroup",c),c}}},dragGroupControlEnd:function(t,r){var e=r.isDrag,n=r.datas;if(n.isScale){this.dragControlEnd(t,r);var a=ir(t,this,"dragControlEnd",r),i=Ft(t,r,{targets:t.props.targets,events:a});return X(t,"onScaleGroupEnd",i),e}},request:function(){var t={},r=0,e=0,n=!1;return{isControl:!0,requestStart:function(a){return n=a.useSnap,{datas:t,parentDirection:a.direction||[1,1],useSnap:n}},request:function(a){return r+=a.deltaWidth,e+=a.deltaHeight,{datas:t,parentDist:[r,e],parentKeepRatio:a.keepRatio,useSnap:n}},requestEnd:function(){return{datas:t,isDrag:!0,useSnap:n}}}}};function pr(t,r){return t.map(function(e,n){return Cr(e,r[n],1,2)})}function fi(t,r,e){var n=Ot(t,r),a=Ot(t,e),i=a-n;return i>=0?i:i+2*Math.PI}function cd(t,r){var e=fi(t[0],t[1],t[2]),n=fi(r[0],r[1],r[2]),a=Math.PI;return!(e>=a&&n<=a||e<=a&&n>=a)}var ud={name:"warpable",ableGroup:"size",props:["warpable","renderDirections","edge","displayAroundControls"],events:["warpStart","warp","warpEnd"],viewClassName:wa("warpable"),render:function(t,r){var e=t.props,n=e.resizable,a=e.scalable,i=e.warpable,o=e.zoom;if(n||a||!i)return[];var s=t.state,l=s.pos1,c=s.pos2,u=s.pos3,f=s.pos4,d=pr(l,c),p=pr(c,l),v=pr(l,u),g=pr(u,l),h=pr(u,f),m=pr(f,u),x=pr(c,f),y=pr(f,c);return L([r.createElement("div",{className:rt("line"),key:"middeLine1",style:oe(d,h,o)}),r.createElement("div",{className:rt("line"),key:"middeLine2",style:oe(p,m,o)}),r.createElement("div",{className:rt("line"),key:"middeLine3",style:oe(v,x,o)}),r.createElement("div",{className:rt("line"),key:"middeLine4",style:oe(g,y,o)})],M(wo(t,"warpable",r)),!1)},dragControlCondition:function(t,r){if(r.isRequest)return!1;var e=r.inputEvent.target;return wt(e,rt("direction"))&&wt(e,rt("warpable"))},dragControlStart:function(t,r){var e=r.datas,n=r.inputEvent,a=t.props.target,i=n.target,o=$o(i,e);if(!o||!a)return!1;var s=t.state,l=s.transformOrigin,c=s.is3d,u=s.targetTransform,f=s.targetMatrix,d=s.width,p=s.height,v=s.left,g=s.top;e.datas={},e.targetTransform=u,e.warpTargetMatrix=c?f:rr(f,3,4),e.targetInverseMatrix=Ri(or(e.warpTargetMatrix,4),3,4),e.direction=o,e.left=v,e.top=g,e.poses=[[0,0],[d,0],[0,p],[d,p]].map(function(x){return et(x,l)}),e.nextPoses=e.poses.map(function(x){var y=M(x,2),S=y[0],E=y[1];return Ht(e.warpTargetMatrix,[S,E,0,1],4)}),e.startValue=It(4),e.prevMatrix=It(4),e.absolutePoses=Xt(s),e.posIndexes=mo(o),Gr(t,r),un(t,r,"matrix3d"),s.snapRenderInfo={request:r.isRequest,direction:o};var h=st(t,r,R({set:function(x){e.startValue=x}},cn(t,r))),m=X(t,"onWarpStart",h);return m!==!1&&(e.isWarp=!0),e.isWarp},dragControl:function(t,r){var e=r.datas,n=r.isRequest,a=r.distX,i=r.distY,o=e.targetInverseMatrix,s=e.prevMatrix,l=e.isWarp,c=e.startValue,u=e.poses,f=e.posIndexes,d=e.absolutePoses;if(!l)return!1;if(sn(t,r,"matrix3d"),re(t,"warpable")){var p=f.map(function(T){return d[T]});p.length>1&&p.push([(p[0][0]+p[1][0])/2,(p[0][1]+p[1][1])/2]);var v=pn(t,n,{horizontal:p.map(function(T){return T[1]+i}),vertical:p.map(function(T){return T[0]+a})}),g=v.horizontal,h=v.vertical;i-=g.offset,a-=h.offset}var m=nr({datas:e,distX:a,distY:i},!0),x=e.nextPoses.slice();if(f.forEach(function(T){x[T]=pt(x[T],m)}),!Ou.every(function(T){return cd(T.map(function(O){return u[O]}),T.map(function(O){return x[O]}))}))return!1;var y=Jn(u[0],u[2],u[1],u[3],x[0],x[2],x[1],x[3]);if(!y.length)return!1;var S=Mt(o,y,4),E=go(e,S,!0),b=Mt(or(s,4),E,4);e.prevMatrix=E;var C=Mt(c,E,4),w=ln(e,"matrix3d(".concat(C.join(", "),")"),"matrix3d(".concat(E.join(", "),")"));return va(r,w),X(t,"onWarp",st(t,r,R({delta:b,matrix:C,dist:E,multiply:Mt,transform:w},At({transform:w},r)))),!0},dragControlEnd:function(t,r){var e=r.datas,n=r.isDrag;return e.isWarp?(e.isWarp=!1,X(t,"onWarpEnd",Ft(t,r,{})),n):!1}},fd=rt("area-pieces"),Ae=rt("area-piece"),as=rt("avoid"),dd=rt("view-dragging");function Tn(t){var r=t.areaElement;if(r){var e=t.state,n=e.width,a=e.height;Pi(r,as),r.style.cssText+="left: 0px; top: 0px; width: ".concat(n,"px; height: ").concat(a,"px")}}function di(t){return t.createElement("div",{key:"area_pieces",className:fd},t.createElement("div",{className:Ae}),t.createElement("div",{className:Ae}),t.createElement("div",{className:Ae}),t.createElement("div",{className:Ae}))}var is={name:"dragArea",props:["dragArea","passDragArea"],events:["click","clickGroup"],render:function(t,r){var e=t.props,n=e.target,a=e.dragArea,i=e.groupable,o=e.passDragArea,s=t.getState(),l=s.width,c=s.height,u=s.renderPoses,f=o?rt("area","pass"):rt("area");if(i)return[r.createElement("div",{key:"area",ref:Or(t,"areaElement"),className:f}),di(r)];if(!n||!a)return[];var d=Jn([0,0],[l,0],[0,c],[l,c],u[0],u[1],u[2],u[3]),p=d.length?vn(d,!0):"none";return[r.createElement("div",{key:"area",ref:Or(t,"areaElement"),className:f,style:{top:"0px",left:"0px",width:"".concat(l,"px"),height:"".concat(c,"px"),transformOrigin:"0 0",transform:p}}),di(r)]},dragStart:function(t,r){var e=r.datas,n=r.clientX,a=r.clientY,i=r.inputEvent;if(!i)return!1;e.isDragArea=!1;var o=t.areaElement,s=t.state,l=s.moveableClientRect,c=s.renderPoses,u=s.rootMatrix,f=s.is3d,d=l.left,p=l.top,v=qt(c),g=v.left,h=v.top,m=v.width,x=v.height,y=f?4:3,S=M($r(u,[n-d,a-p],y),2),E=S[0],b=S[1];E-=g,b-=h;var C=[{left:g,top:h,width:m,height:b-10},{left:g,top:h,width:E-10,height:x},{left:g,top:h+b+10,width:m,height:x-b-10},{left:g+E+10,top:h,width:m-E-10,height:x}],w=[].slice.call(o.nextElementSibling.children);C.forEach(function(T,O){w[O].style.cssText="left: ".concat(T.left,"px;top: ").concat(T.top,"px; width: ").concat(T.width,"px; height: ").concat(T.height,"px;")}),Mi(o,as),s.disableNativeEvent=!0},drag:function(t,r){var e=r.datas,n=r.inputEvent;if(this.enableNativeEvent(t),!n)return!1;e.isDragArea||(e.isDragArea=!0,Tn(t))},dragEnd:function(t,r){this.enableNativeEvent(t);var e=r.inputEvent,n=r.datas;if(!e)return!1;n.isDragArea||Tn(t)},dragGroupStart:function(t,r){return this.dragStart(t,r)},dragGroup:function(t,r){return this.drag(t,r)},dragGroupEnd:function(t,r){return this.dragEnd(t,r)},unset:function(t){Tn(t),t.state.disableNativeEvent=!1},enableNativeEvent:function(t){var r=t.state;r.disableNativeEvent&&Oi(function(){r.disableNativeEvent=!1})}},pd=we("origin",{props:["origin","svgOrigin"],render:function(t,r){var e=t.props,n=e.zoom,a=e.svgOrigin,i=e.groupable,o=t.getState(),s=o.beforeOrigin,l=o.rotation,c=o.svg,u=o.allMatrix,f=o.is3d,d=o.left,p=o.top,v=o.offsetWidth,g=o.offsetHeight,h;if(!i&&c&&a){var m=M(Oa(a,v,g),2),x=m[0],y=m[1],S=f?4:3,E=bt(u,[x,y],S);h=Ze(l,n,et(E,[d,p]))}else h=Ze(l,n,s);return[r.createElement("div",{className:rt("control","origin"),style:h,key:"beforeOrigin"})]}});function vd(t){var r=t.scrollContainer;return[r.scrollLeft,r.scrollTop]}var gd={name:"scrollable",canPinch:!0,props:["scrollable","scrollContainer","scrollThreshold","scrollThrottleTime","getScrollPosition","scrollOptions"],events:["scroll","scrollGroup"],dragRelation:"strong",dragStart:function(t,r){var e=t.props,n=e.scrollContainer,a=n===void 0?t.getContainer():n,i=e.scrollOptions,o=new Ws,s=Qt(a,!0);r.datas.dragScroll=o,t.state.dragScroll=o;var l=r.isControl?"controlGesto":"targetGesto",c=r.targets;o.on("scroll",function(u){var f=u.container,d=u.direction,p=st(t,r,{scrollContainer:f,direction:d}),v=c?"onScrollGroup":"onScroll";c&&(p.targets=c),X(t,v,p)}).on("move",function(u){var f=u.offsetX,d=u.offsetY,p=u.inputEvent;t[l].scrollBy(f,d,p.inputEvent,!0)}).on("scrollDrag",function(u){var f=u.next;f(t[l].getCurrentEvent())}),o.dragStart(r,R({container:s},i))},checkScroll:function(t,r){var e=r.datas.dragScroll;if(e){var n=t.props,a=n.scrollContainer,i=a===void 0?t.getContainer():a,o=n.scrollThreshold,s=o===void 0?0:o,l=n.scrollThrottleTime,c=l===void 0?0:l,u=n.getScrollPosition,f=u===void 0?vd:u,d=n.scrollOptions;return e.drag(r,R({container:i,threshold:s,throttleTime:c,getScrollPosition:function(p){return f({scrollContainer:p.container,direction:p.direction})}},d)),!0}},drag:function(t,r){return this.checkScroll(t,r)},dragEnd:function(t,r){r.datas.dragScroll.dragEnd(),r.datas.dragScroll=null},dragControlStart:function(t,r){return this.dragStart(t,R(R({},r),{isControl:!0}))},dragControl:function(t,r){return this.drag(t,r)},dragControlEnd:function(t,r){return this.dragEnd(t,r)},dragGroupStart:function(t,r){return this.dragStart(t,R(R({},r),{targets:t.props.targets}))},dragGroup:function(t,r){return this.drag(t,R(R({},r),{targets:t.props.targets}))},dragGroupEnd:function(t,r){return this.dragEnd(t,R(R({},r),{targets:t.props.targets}))},dragGroupControlStart:function(t,r){return this.dragStart(t,R(R({},r),{targets:t.props.targets,isControl:!0}))},dragGroupControl:function(t,r){return this.drag(t,R(R({},r),{targets:t.props.targets}))},dragGroupControEnd:function(t,r){return this.dragEnd(t,R(R({},r),{targets:t.props.targets}))},unset:function(t){var r,e=t.state;(r=e.dragScroll)===null||r===void 0||r.dragEnd(),e.dragScroll=null}},os={name:"",props:["target","dragTargetSelf","dragTarget","dragContainer","container","warpSelf","rootContainer","useResizeObserver","useMutationObserver","zoom","dragFocusedInput","transformOrigin","ables","className","pinchThreshold","pinchOutside","triggerAblesSimultaneously","checkInput","cspNonce","translateZ","hideDefaultLines","props","flushSync","stopPropagation","preventClickEventOnDrag","preventClickDefault","viewContainer","persistData","useAccuratePosition","firstRenderState","linePadding","controlPadding","preventDefault","requestStyles"],events:["changeTargets"]},hd=we("padding",{props:["padding"],render:function(t,r){var e=t.props;if(e.dragArea)return[];var n=ns(e.padding||{}),a=n.left,i=n.top,o=n.right,s=n.bottom,l=t.getState(),c=l.renderPoses,u=l.pos1,f=l.pos2,d=l.pos3,p=l.pos4,v=[u,f,d,p],g=[];return a>0&&g.push([0,2]),i>0&&g.push([0,1]),o>0&&g.push([1,3]),s>0&&g.push([2,3]),g.map(function(h,m){var x=M(h,2),y=x[0],S=x[1],E=v[y],b=v[S],C=c[y],w=c[S],T=Jn([0,0],[100,0],[0,100],[100,100],E,b,C,w);if(T.length)return r.createElement("div",{key:"padding".concat(m),className:rt("padding"),style:{transform:vn(T,!0)}})})}}),pi=["nw","ne","se","sw"];function Ne(t,r){var e=t[0]+t[1],n=e>r?r/e:1;return t[0]*=n,t[1]=r-t[1]*n,t}var md=[1,2,5,6],xd=[0,3,4,7],wr=[1,-1,-1,1],Rr=[1,1,-1,-1];function Ta(t,r,e,n,a,i,o,s){a===void 0&&(a=0),i===void 0&&(i=0),o===void 0&&(o=e),s===void 0&&(s=n);var l=[],c=!1,u=t.filter(function(d){return!d.virtual}),f=u.map(function(d){var p=d.horizontal,v=d.vertical,g=d.pos;if(v&&!c&&(c=!0,l.push("/")),c){var h=Math.max(0,v===1?g[1]-i:s-g[1]);return l.push(Ut(h,n,r)),h}else{var h=Math.max(0,p===1?g[0]-a:o-g[0]);return l.push(Ut(h,e,r)),h}});return{radiusPoses:u,styles:l,raws:f}}function ss(t){for(var r=[0,0],e=[0,0],n=t.length,a=0;a<n;++a){var i=t[a];i.sub&&(i.horizontal&&(r[1]===0&&(r[0]=a),r[1]=a-r[0]+1,e[0]=a+1),i.vertical&&(e[1]===0&&(e[0]=a),e[1]=a-e[0]+1))}return{horizontalRange:r,verticalRange:e}}function ls(t,r,e,n,a,i,o){var s,l,c,u;i===void 0&&(i=[0,0]),o===void 0&&(o=!1);var f=t.indexOf("/"),d=(f>-1?t.slice(0,f):t).length,p=t.slice(0,d),v=t.slice(d+1),g=p.length,h=v.length,m=h>0,x=M(p,4),y=x[0],S=y===void 0?"0px":y,E=x[1],b=E===void 0?S:E,C=x[2],w=C===void 0?S:C,T=x[3],O=T===void 0?b:T,P=M(v,4),z=P[0],I=z===void 0?S:z,B=P[1],_=B===void 0?m?I:b:B,H=P[2],N=H===void 0?m?I:w:H,G=P[3],q=G===void 0?m?_:O:G,V=[S,b,w,O].map(function(F){return xt(F,r)}),j=[I,_,N,q].map(function(F){return xt(F,e)}),$=V.slice(),K=j.slice();s=M(Ne([$[0],$[1]],r),2),$[0]=s[0],$[1]=s[1],l=M(Ne([$[3],$[2]],r),2),$[3]=l[0],$[2]=l[1],c=M(Ne([K[0],K[3]],e),2),K[0]=c[0],K[3]=c[1],u=M(Ne([K[1],K[2]],e),2),K[1]=u[0],K[2]=u[1];var W=o?$:$.slice(0,Math.max(i[0],g)),Y=o?K:K.slice(0,Math.max(i[1],h));return L(L([],M(W.map(function(F,U){var tt=pi[U];return{virtual:U>=g,horizontal:wr[U],vertical:0,pos:[n+F,a+(Rr[U]===-1?e:0)],sub:!0,raw:V[U],direction:tt}})),!1),M(Y.map(function(F,U){var tt=pi[U];return{virtual:U>=h,horizontal:0,vertical:Rr[U],pos:[n+(wr[U]===-1?r:0),a+F],sub:!0,raw:j[U],direction:tt}})),!1)}function yd(t,r,e,n,a){a===void 0&&(a=r.length);var i=ss(t.slice(n)),o=i.horizontalRange,s=i.verticalRange,l=e-n,c=0;if(l===0)c=a;else if(l>0&&l<o[1])c=o[1]-l;else if(l>=s[0])c=s[0]+s[1]-l;else return;t.splice(e,c),r.splice(e,c)}function bd(t,r,e,n,a,i,o,s,l,c,u){c===void 0&&(c=0),u===void 0&&(u=0);var f=ss(t.slice(e)),d=f.horizontalRange,p=f.verticalRange;if(n>-1)for(var v=wr[n]===1?i-c:s-i,g=d[1];g<=n;++g){var h=Rr[g]===1?u:l,m=0;if(n===g?m=i:g===0?m=c+v:wr[g]===-1&&(m=s-(r[e][0]-c)),t.splice(e+g,0,{horizontal:wr[g],vertical:0,pos:[m,h]}),r.splice(e+g,0,[m,h]),g===0)break}else if(a>-1){var x=Rr[a]===1?o-u:l-o;if(d[1]===0&&p[1]===0){var y=[c+x,u];t.push({horizontal:wr[0],vertical:0,pos:y}),r.push(y)}for(var S=p[0],g=p[1];g<=a;++g){var m=wr[g]===1?c:s,h=0;if(a===g?h=o:g===0?h=u+x:Rr[g]===1?h=r[e+S][1]:Rr[g]===-1&&(h=l-(r[e+S][1]-u)),t.push({horizontal:0,vertical:Rr[g],pos:[m,h]}),r.push([m,h]),g===0)break}}}function Sd(t,r){r===void 0&&(r=t.map(function(a){return a.raw}));var e=t.map(function(a,i){return a.horizontal?r[i]:null}).filter(function(a){return a!=null}),n=t.map(function(a,i){return a.vertical?r[i]:null}).filter(function(a){return a!=null});return{horizontals:e,verticals:n}}var Cd=[[0,-1,"n"],[1,0,"e"]],Dd=[[-1,-1,"nw"],[0,-1,"n"],[1,-1,"ne"],[1,0,"e"],[1,1,"se"],[0,1,"s"],[-1,1,"sw"],[-1,0,"w"]];function Ia(t,r,e){var n=t.props.clipRelative,a=t.state,i=a.width,o=a.height,s=r,l=s.type,c=s.poses,u=l==="rect",f=l==="circle";if(l==="polygon")return e.map(function(b){return"".concat(Ut(b[0],i,n)," ").concat(Ut(b[1],o,n))});if(u||l==="inset"){var d=e[1][1],p=e[3][0],v=e[7][0],g=e[5][1];if(u)return[d,p,g,v].map(function(b){return"".concat(b,"px")});var h=[d,i-p,o-g,v].map(function(b,C){return Ut(b,C%2?i:o,n)});if(e.length>8){var m=M(et(e[4],e[0]),2),x=m[0],y=m[1];h.push.apply(h,L(["round"],M(Ta(c.slice(8).map(function(b,C){return R(R({},b),{pos:e[C]})}),n,x,y,v,d,p,g).styles),!1))}return h}else if(f||l==="ellipse"){var S=e[0],E=Ut(k(e[1][1]-S[1]),f?Math.sqrt((i*i+o*o)/2):o,n),h=f?[E]:[Ut(k(e[2][0]-S[0]),i,n),E];return h.push("at",Ut(S[0],i,n),Ut(S[1],o,n)),h}}function Qe(t,r,e,n){var a=[n,(n+r)/2,r],i=[t,(t+e)/2,e];return Dd.map(function(o){var s=M(o,3),l=s[0],c=s[1],u=s[2],f=a[l+1],d=i[c+1];return{vertical:k(c),horizontal:k(l),direction:u,pos:[f,d]}})}function cs(t){var r=[1/0,-1/0],e=[1/0,-1/0];return t.forEach(function(n){var a=n.pos;r[0]=Math.min(r[0],a[0]),r[1]=Math.max(r[1],a[0]),e[0]=Math.min(e[0],a[1]),e[1]=Math.max(e[1],a[1])}),[k(r[1]-r[0]),k(e[1]-e[0])]}function vi(t,r,e,n,a){var i,o,s,l,c,u,f,d,p;if(t){var v=a;if(!v){var g=Vt(t),h=g("clipPath");v=h!=="none"?h:g("clip")}if(!((!v||v==="none"||v==="auto")&&(v=n,!v))){var m=Qs(v),x=m.prefix,y=x===void 0?v:x,S=m.value,E=S===void 0?"":S,b=y==="circle",C=" ";if(y==="polygon"){var w=Na(E||"0% 0%, 100% 0%, 100% 100%, 0% 100%");C=",";var T=w.map(function(Tt){var Gt=M(Tt.split(" "),2),_t=Gt[0],Ct=Gt[1];return{vertical:1,horizontal:1,pos:[xt(_t,r),xt(Ct,e)]}}),O=me(T.map(function(Tt){return Tt.pos}));return{type:y,clipText:v,poses:T,splitter:C,left:O.minX,right:O.maxX,top:O.minY,bottom:O.maxY}}else if(b||y==="ellipse"){var P="",z="",I=0,B=0,w=Tr(E);if(b){var _="";i=M(w,4),o=i[0],_=o===void 0?"50%":o,s=i[2],P=s===void 0?"50%":s,l=i[3],z=l===void 0?"50%":l,I=xt(_,Math.sqrt((r*r+e*e)/2)),B=I}else{var H="",N="";c=M(w,5),u=c[0],H=u===void 0?"50%":u,f=c[1],N=f===void 0?"50%":f,d=c[3],P=d===void 0?"50%":d,p=c[4],z=p===void 0?"50%":p,I=xt(H,r),B=xt(N,e)}var G=[xt(P,r),xt(z,e)],T=L([{vertical:1,horizontal:1,pos:G,direction:"nesw"}],M(Cd.slice(0,b?1:2).map(function(_t){return{vertical:k(_t[1]),horizontal:_t[0],direction:_t[2],sub:!0,pos:[G[0]+_t[0]*I,G[1]+_t[1]*B]}})),!1);return{type:y,clipText:v,radiusX:I,radiusY:B,left:G[0]-I,top:G[1]-B,right:G[0]+I,bottom:G[1]+B,poses:T,splitter:C}}else if(y==="inset"){var w=Tr(E||"0 0 0 0"),q=w.indexOf("round"),V=(q>-1?w.slice(0,q):w).length,j=w.slice(V+1),$=M(w.slice(0,V),4),K=$[0],W=$[1],Y=W===void 0?K:W,F=$[2],U=F===void 0?K:F,tt=$[3],ot=tt===void 0?Y:tt,nt=M([K,U].map(function(_t){return xt(_t,e)}),2),Q=nt[0],J=nt[1],vt=M([ot,Y].map(function(_t){return xt(_t,r)}),2),lt=vt[0],ct=vt[1],ft=r-ct,yt=e-J,ht=ls(j,ft-lt,yt-Q,lt,Q),T=L(L([],M(Qe(Q,ft,yt,lt)),!1),M(ht),!1);return{type:"inset",clipText:v,poses:T,top:Q,left:lt,right:ft,bottom:yt,radius:j,splitter:C}}else if(y==="rect"){var w=Na(E||"0px, ".concat(r,"px, ").concat(e,"px, 0px"));C=",";var ut=M(w.map(function(fr){var dr=ra(fr).value;return dr}),4),gt=ut[0],ct=ut[1],J=ut[2],lt=ut[3],T=Qe(gt,ct,J,lt);return{type:"rect",clipText:v,poses:T,top:gt,right:ct,bottom:J,left:lt,values:w,splitter:C}}}}}function Ed(t,r,e,n,a){var i=t[r],o=i.direction,s=i.sub,l=t.map(function(){return[0,0]}),c=o?o.split(""):[];if(n&&r<8){var u=c.filter(function(I){return I==="w"||I==="e"}),f=c.filter(function(I){return I==="n"||I==="s"}),d=u[0],p=f[0];l[r]=e;var v=M(cs(t),2),g=v[0],h=v[1],m=g&&h?g/h:0;if(m&&a){var x=(r+4)%8,y=t[x].pos,S=[0,0];o.indexOf("w")>-1?S[0]=-1:o.indexOf("e")>-1&&(S[0]=1),o.indexOf("n")>-1?S[1]=-1:o.indexOf("s")>-1&&(S[1]=1);var E=ts([g,h],e,m,S,!0),b=g+E[0],C=h+E[1],w=y[1],T=y[1],O=y[0],P=y[0];S[0]===-1?O=P-b:S[0]===1?P=O+b:(O=O-b/2,P=P+b/2),S[1]===-1?w=T-C:(S[1]===1||(w=T-C/2),T=w+C);var z=Qe(w,P,T,O);t.forEach(function(I,B){l[B][0]=z[B].pos[0]-I.pos[0],l[B][1]=z[B].pos[1]-I.pos[1]})}else t.forEach(function(I,B){var _=I.direction;_&&(_.indexOf(d)>-1&&(l[B][0]=e[0]),_.indexOf(p)>-1&&(l[B][1]=e[1]))}),d&&(l[1][0]=e[0]/2,l[5][0]=e[0]/2),p&&(l[3][1]=e[1]/2,l[7][1]=e[1]/2)}else o&&!s?c.forEach(function(I){var B=I==="n"||I==="s";t.forEach(function(_,H){var N=_.direction,G=_.horizontal,q=_.vertical;!N||N.indexOf(I)===-1||(l[H]=[B||!G?0:e[0],!B||!q?0:e[1]])})}):l[r]=e;return l}function wd(t,r){var e=M(vo(t,r),2),n=e[0],a=e[1],i=r.datas,o=i.clipPath,s=i.clipIndex,l=o,c=l.type,u=l.poses,f=l.splitter,d=u.map(function(x){return x.pos});if(c==="polygon")d.splice(s,0,[n,a]);else if(c==="inset"){var p=md.indexOf(s),v=xd.indexOf(s),g=u.length;if(bd(u,d,8,p,v,n,a,d[4][0],d[4][1],d[0][0],d[0][1]),g===u.length)return}else return;var h=Ia(t,o,d),m="".concat(c,"(").concat(h.join(f),")");X(t,"onClip",st(t,r,R({clipEventType:"added",clipType:c,poses:d,clipStyles:h,clipStyle:m,distX:0,distY:0},At({clipPath:m},r))))}function Rd(t,r){var e=r.datas,n=e.clipPath,a=e.clipIndex,i=n,o=i.type,s=i.poses,l=i.splitter,c=s.map(function(p){return p.pos}),u=c.length;if(o==="polygon")s.splice(a,1),c.splice(a,1);else if(o==="inset"){if(a<8||(yd(s,c,a,8,u),u===s.length))return}else return;var f=Ia(t,n,c),d="".concat(o,"(").concat(f.join(l),")");X(t,"onClip",st(t,r,R({clipEventType:"removed",clipType:o,poses:c,clipStyles:f,clipStyle:d,distX:0,distY:0},At({clipPath:d},r))))}var Md={name:"clippable",props:["clippable","defaultClipPath","customClipPath","keepRatio","clipRelative","clipArea","dragWithClip","clipTargetBounds","clipVerticalGuidelines","clipHorizontalGuidelines","clipSnapThreshold"],events:["clipStart","clip","clipEnd"],css:[`.control.clip-control {
background: #6d6;
cursor: pointer;
}
.control.clip-control.clip-radius {
background: #d66;
}
.line.clip-line {
background: #6e6;
cursor: move;
z-index: 1;
}
.clip-area {
position: absolute;
top: 0;
left: 0;
}
.clip-ellipse {
position: absolute;
cursor: move;
border: 1px solid #6d6;
border: var(--zoompx) solid #6d6;
border-radius: 50%;
transform-origin: 0px 0px;
}`,`:host {
--bounds-color: #d66;
}`,`.guideline {
pointer-events: none;
z-index: 2;
}`,`.line.guideline.bounds {
background: #d66;
background: var(--bounds-color);
}`],render:function(t,r){var e=t.props,n=e.customClipPath,a=e.defaultClipPath,i=e.clipArea,o=e.zoom,s=e.groupable,l=t.getState(),c=l.target,u=l.width,f=l.height,d=l.allMatrix,p=l.is3d,v=l.left,g=l.top,h=l.pos1,m=l.pos2,x=l.pos3,y=l.pos4,S=l.clipPathState,E=l.snapBoundInfos,b=l.rotation;if(!c||s)return[];var C=vi(c,u,f,a||"inset",S||n);if(!C)return[];var w=p?4:3,T=C.type,O=C.poses,P=O.map(function(ct){var ft=bt(d,ct.pos,w);return[ft[0]-v,ft[1]-g]}),z=[],I=[],B=T==="rect",_=T==="inset",H=T==="polygon";if(B||_||H){var N=_?P.slice(0,8):P;I=N.map(function(ct,ft){var yt=ft===0?N[N.length-1]:N[ft-1],ht=Ot(yt,ct),ut=Wo(yt,ct);return r.createElement("div",{key:"clipLine".concat(ft),className:rt("line","clip-line","snap-control"),"data-clip-index":ft,style:{width:"".concat(ut,"px"),transform:"translate(".concat(yt[0],"px, ").concat(yt[1],"px) rotate(").concat(ht,"rad) scaleY(").concat(o,")")}})})}if(z=P.map(function(ct,ft){return r.createElement("div",{key:"clipControl".concat(ft),className:rt("control","clip-control","snap-control"),"data-clip-index":ft,style:{transform:"translate(".concat(ct[0],"px, ").concat(ct[1],"px) rotate(").concat(b,"rad) scale(").concat(o,")")}})}),_&&z.push.apply(z,L([],M(P.slice(8).map(function(ct,ft){return r.createElement("div",{key:"clipRadiusControl".concat(ft),className:rt("control","clip-control","clip-radius","snap-control"),"data-clip-index":8+ft,style:{transform:"translate(".concat(ct[0],"px, ").concat(ct[1],"px) rotate(").concat(b,"rad) scale(").concat(o,")")}})})),!1)),T==="circle"||T==="ellipse"){var G=C.left,q=C.top,V=C.radiusX,j=C.radiusY,$=M(et(bt(d,[G,q],w),bt(d,[0,0],w)),2),K=$[0],W=$[1],Y="none";if(!i){for(var F=Math.max(10,V/5,j/5),U=[],tt=0;tt<=F;++tt){var ot=Math.PI*2/F*tt;U.push([V+(V-o)*Math.cos(ot),j+(j-o)*Math.sin(ot)])}U.push([V,-2]),U.push([-2,-2]),U.push([-2,j*2+2]),U.push([V*2+2,j*2+2]),U.push([V*2+2,-2]),U.push([V,-2]),Y="polygon(".concat(U.map(function(ct){return"".concat(ct[0],"px ").concat(ct[1],"px")}).join(", "),")")}z.push(r.createElement("div",{key:"clipEllipse",className:rt("clip-ellipse","snap-control"),style:{width:"".concat(V*2,"px"),height:"".concat(j*2,"px"),clipPath:Y,transform:"translate(".concat(-v+K,"px, ").concat(-g+W,"px) ").concat(vn(d))}}))}if(i){var nt=qt(L([h,m,x,y],M(P),!1)),Q=nt.width,J=nt.height,vt=nt.left,lt=nt.top;if(H||B||_){var U=_?P.slice(0,8):P;z.push(r.createElement("div",{key:"clipArea",className:rt("clip-area","snap-control"),style:{width:"".concat(Q,"px"),height:"".concat(J,"px"),transform:"translate(".concat(vt,"px, ").concat(lt,"px)"),clipPath:"polygon(".concat(U.map(function(ft){return"".concat(ft[0]-vt,"px ").concat(ft[1]-lt,"px")}).join(", "),")")}}))}}return E&&["vertical","horizontal"].forEach(function(ct){var ft=E[ct],yt=ct==="horizontal";ft.isSnap&&I.push.apply(I,L([],M(ft.snap.posInfos.map(function(ht,ut){var gt=ht.pos,Tt=et(bt(d,yt?[0,gt]:[gt,0],w),[v,g]),Gt=et(bt(d,yt?[u,gt]:[gt,f],w),[v,g]);return be(r,"",Tt,Gt,o,"clip".concat(ct,"snap").concat(ut),"guideline")})),!1)),ft.isBound&&I.push.apply(I,L([],M(ft.bounds.map(function(ht,ut){var gt=ht.pos,Tt=et(bt(d,yt?[0,gt]:[gt,0],w),[v,g]),Gt=et(bt(d,yt?[u,gt]:[gt,f],w),[v,g]);return be(r,"",Tt,Gt,o,"clip".concat(ct,"bounds").concat(ut),"guideline","bounds","bold")})),!1))}),L(L([],M(z),!1),M(I),!1)},dragControlCondition:function(t,r){return r.inputEvent&&(r.inputEvent.target.getAttribute("class")||"").indexOf("clip")>-1},dragStart:function(t,r){var e=t.props,n=e.dragWithClip,a=n===void 0?!0:n;return a?!1:this.dragControlStart(t,r)},drag:function(t,r){return this.dragControl(t,R(R({},r),{isDragTarget:!0}))},dragEnd:function(t,r){return this.dragControlEnd(t,r)},dragControlStart:function(t,r){var e=t.state,n=t.props,a=n.defaultClipPath,i=n.customClipPath,o=e.target,s=e.width,l=e.height,c=r.inputEvent?r.inputEvent.target:null,u=c&&c.getAttribute("class")||"",f=r.datas,d=vi(o,s,l,a||"inset",i);if(!d)return!1;var p=d.clipText,v=d.type,g=d.poses,h=X(t,"onClipStart",st(t,r,{clipType:v,clipStyle:p,poses:g.map(function(m){return m.pos})}));return h===!1?(f.isClipStart=!1,!1):(f.isControl=u&&u.indexOf("clip-control")>-1,f.isLine=u.indexOf("clip-line")>-1,f.isArea=u.indexOf("clip-area")>-1||u.indexOf("clip-ellipse")>-1,f.clipIndex=c?parseInt(c.getAttribute("data-clip-index"),10):-1,f.clipPath=d,f.isClipStart=!0,e.clipPathState=p,Gr(t,r),!0)},dragControl:function(t,r){var e,n,a,i=r.datas,o=r.originalDatas,s=r.isDragTarget;if(!i.isClipStart)return!1;var l=i,c=l.isControl,u=l.isLine,f=l.isArea,d=l.clipIndex,p=l.clipPath;if(!p)return!1;var v=Pr(t.props,"clippable"),g=v.keepRatio,h=0,m=0,x=o.draggable,y=nr(r);s&&x?(e=M(x.prevBeforeDist,2),h=e[0],m=e[1]):(n=M(y,2),h=n[0],m=n[1]);var S=[h,m],E=t.state,b=E.width,C=E.height,w=!f&&!c&&!u,T=p.type,O=p.poses,P=p.splitter,z=O.map(function(mt){return mt.pos});w&&(h=-h,m=-m);var I=!c||O[d].direction==="nesw",B=T==="inset"||T==="rect",_=O.map(function(){return[0,0]});if(c&&!I){var H=O[d],N=H.horizontal,G=H.vertical,q=[h*k(N),m*k(G)];_=Ed(O,d,q,B,g)}else I&&(_=z.map(function(){return[h,m]}));var V=z.map(function(mt,kt){return pt(mt,_[kt])}),j=L([],M(V),!1);E.snapBoundInfos=null;var $=p.type==="circle",K=p.type==="ellipse";if($||K){var W=qt(V),Y=k(W.bottom-W.top),F=k(K?W.right-W.left:Y),U=V[0][1]+Y,tt=V[0][0]-F,ot=V[0][0]+F;$&&(j.push([ot,W.bottom]),_.push([1,0])),j.push([W.left,U]),_.push([0,1]),j.push([tt,W.bottom]),_.push([1,0])}var nt=ko((v.clipHorizontalGuidelines||[]).map(function(mt){return xt("".concat(mt),C)}),(v.clipVerticalGuidelines||[]).map(function(mt){return xt("".concat(mt),b)}),b,C),Q=[],J=[];if($||K)Q=[j[4][0],j[2][0]],J=[j[1][1],j[3][1]];else if(B){var vt=[j[0],j[2],j[4],j[6]],lt=[_[0],_[2],_[4],_[6]];Q=vt.filter(function(mt,kt){return lt[kt][0]}).map(function(mt){return mt[0]}),J=vt.filter(function(mt,kt){return lt[kt][1]}).map(function(mt){return mt[1]})}else Q=j.filter(function(mt,kt){return _[kt][0]}).map(function(mt){return mt[0]}),J=j.filter(function(mt,kt){return _[kt][1]}).map(function(mt){return mt[1]});var ct=[0,0],ft=Qa(nt,v.clipTargetBounds&&{left:0,top:0,right:b,bottom:C},Q,J,5),yt=ft.horizontal,ht=ft.vertical,ut=yt.offset,gt=ht.offset;if(yt.isBound&&(ct[1]+=ut),ht.isBound&&(ct[0]+=gt),(K||$)&&_[0][0]===0&&_[0][1]===0){var W=qt(V),Tt=W.bottom-W.top,Gt=K?W.right-W.left:Tt,_t=ht.isBound?k(gt):ht.snapIndex===0?-gt:gt,Ct=yt.isBound?k(ut):yt.snapIndex===0?-ut:ut;Gt-=_t,Tt-=Ct,$&&(Tt=Oo(ht,yt)>0?Tt:Gt,Gt=Tt);var Et=j[0];j[1][1]=Et[1]-Tt,j[2][0]=Et[0]+Gt,j[3][1]=Et[1]+Tt,j[4][0]=Et[0]-Gt}else if(B&&g&&c){var fr=M(cs(O),2),dr=fr[0],_a=fr[1],Ba=dr&&_a?dr/_a:0,Ts=O[d],Oe=Ts.direction||"",mn=j[1][1],U=j[5][1],tt=j[7][0],ot=j[3][0];k(ut)<=k(gt)?ut=Wt(ut)*k(gt)/Ba:gt=Wt(gt)*k(ut)*Ba,Oe.indexOf("w")>-1?tt-=gt:Oe.indexOf("e")>-1?ot-=gt:(tt+=gt/2,ot-=gt/2),Oe.indexOf("n")>-1?mn-=ut:Oe.indexOf("s")>-1?U-=ut:(mn+=ut/2,U-=ut/2);var Is=Qe(mn,ot,U,tt);j.forEach(function(ja,Bs){var bn;bn=M(Is[Bs].pos,2),ja[0]=bn[0],ja[1]=bn[1]})}else j.forEach(function(mt,kt){var ka=_[kt];ka[0]&&(mt[0]-=gt),ka[1]&&(mt[1]-=ut)});var Ga=Ia(t,p,V),xn="".concat(T,"(").concat(Ga.join(P),")");if(E.clipPathState=xn,$||K)Q=[j[4][0],j[2][0]],J=[j[1][1],j[3][1]];else if(B){var vt=[j[0],j[2],j[4],j[6]];Q=vt.map(function(kt){return kt[0]}),J=vt.map(function(kt){return kt[1]})}else Q=j.map(function(mt){return mt[0]}),J=j.map(function(mt){return mt[1]});if(E.snapBoundInfos=Qa(nt,v.clipTargetBounds&&{left:0,top:0,right:b,bottom:C},Q,J,1),x){var zs=E.is3d,Ps=E.allMatrix,_s=zs?4:3,yn=ct;s&&(yn=[S[0]+ct[0]-y[0],S[1]+ct[1]-y[1]]),x.deltaOffset=Mt(Ps,[yn[0],yn[1],0,0],_s)}return X(t,"onClip",st(t,r,R({clipEventType:"changed",clipType:T,poses:V,clipStyle:xn,clipStyles:Ga,distX:h,distY:m},At((a={},a[T==="rect"?"clip":"clipPath"]=xn,a),r)))),!0},dragControlEnd:function(t,r){this.unset(t);var e=r.isDrag,n=r.datas,a=r.isDouble,i=n.isLine,o=n.isClipStart,s=n.isControl;return o?(X(t,"onClipEnd",Ft(t,r,{})),a&&(s?Rd(t,r):i&&wd(t,r)),a||e):!1},unset:function(t){t.state.clipPathState="",t.state.snapBoundInfos=null}},Od={name:"originDraggable",props:["originDraggable","originRelative"],events:["dragOriginStart","dragOrigin","dragOriginEnd"],css:[`:host[data-able-origindraggable] .control.origin {
pointer-events: auto;
}`],dragControlCondition:function(t,r){return r.isRequest?r.requestAble==="originDraggable":wt(r.inputEvent.target,rt("origin"))},dragControlStart:function(t,r){var e=r.datas;Gr(t,r);var n=st(t,r,{dragStart:jt.dragStart(t,new Yr().dragStart([0,0],r))}),a=X(t,"onDragOriginStart",n);return e.startOrigin=t.state.transformOrigin,e.startTargetOrigin=t.state.targetOrigin,e.prevOrigin=[0,0],e.isDragOrigin=!0,a===!1?(e.isDragOrigin=!1,!1):n},dragControl:function(t,r){var e=r.datas,n=r.isPinch,a=r.isRequest;if(!e.isDragOrigin)return!1;var i=M(nr(r),2),o=i[0],s=i[1],l=t.state,c=l.width,u=l.height,f=l.offsetMatrix,d=l.targetMatrix,p=l.is3d,v=t.props.originRelative,g=v===void 0?!0:v,h=p?4:3,m=[o,s];if(a){var x=r.distOrigin;(x[0]||x[1])&&(m=x)}var y=pt(e.startOrigin,m),S=pt(e.startTargetOrigin,m),E=et(m,e.prevOrigin),b=Me(f,d,y,h),C=t.getRect(),w=qt(kr(b,c,u,h)),T=[C.left-w.left,C.top-w.top];e.prevOrigin=m;var O=[Ut(S[0],c,g),Ut(S[1],u,g)].join(" "),P=jt.drag(t,Re(r,t.state,T,!!n,!1)),z=st(t,r,R(R({width:c,height:u,origin:y,dist:m,delta:E,transformOrigin:O,drag:P},At({transformOrigin:O,transform:P.transform},r)),{afterTransform:P.transform}));return X(t,"onDragOrigin",z),z},dragControlEnd:function(t,r){var e=r.datas;return e.isDragOrigin?(X(t,"onDragOriginEnd",Ft(t,r,{})),!0):!1},dragGroupControlCondition:function(t,r){return this.dragControlCondition(t,r)},dragGroupControlStart:function(t,r){var e=this.dragControlStart(t,r);return!!e},dragGroupControl:function(t,r){var e=this.dragControl(t,r);return e?(t.transformOrigin=e.transformOrigin,!0):!1},request:function(t){var r={},e=t.getRect(),n=0,a=0,i=e.transformOrigin,o=[0,0];return{isControl:!0,requestStart:function(){return{datas:r}},request:function(s){return"deltaOrigin"in s?(o[0]+=s.deltaOrigin[0],o[1]+=s.deltaOrigin[1]):"origin"in s?(o[0]=s.origin[0]-i[0],o[1]=s.origin[1]-i[1]):("x"in s?n=s.x-e.left:"deltaX"in s&&(n+=s.deltaX),"y"in s?a=s.y-e.top:"deltaY"in s&&(a+=s.deltaY)),{datas:r,distX:n,distY:a,distOrigin:o}},requestEnd:function(){return{datas:r,isDrag:!0}}}}};function Td(t,r,e,n){var a=t.filter(function(l){var c=l.virtual,u=l.horizontal;return u&&!c}).length,i=t.filter(function(l){var c=l.virtual,u=l.vertical;return u&&!c}).length,o=-1;if(r===0&&(a===0?o=0:a===1&&(o=1)),r===2&&(a<=2?o=2:a<=3&&(o=3)),r===3&&(i===0?o=4:i<4&&(o=7)),r===1&&(i<=1?o=5:i<=2&&(o=6)),!(o===-1||!t[o].virtual)){var s=t[o];Id(t,o),o<4?s.pos[0]=e:s.pos[1]=n}}function Id(t,r){r<4?t.slice(0,r+1).forEach(function(e){e.virtual=!1}):(t[0].virtual&&(t[0].virtual=!1),t.slice(4,r+1).forEach(function(e){e.virtual=!1}))}function zd(t,r){r<4?t.slice(r,4).forEach(function(e){e.virtual=!0}):t.slice(r).forEach(function(e){e.virtual=!0})}function gi(t,r,e,n,a){n===void 0&&(n=[0,0]);var i=[];return!t||t==="0px"?i=[]:i=Tr(t),ls(i,r,e,0,0,n,a)}function hi(t,r,e,n,a){var i=t.state,o=i.width,s=i.height,l=Ta(a,t.props.roundRelative,o,s),c=l.raws,u=l.styles,f=l.radiusPoses,d=Sd(f,c),p=d.horizontals,v=d.verticals,g=u.join(" ");i.borderRadiusState=g;var h=st(t,r,R({horizontals:p,verticals:v,borderRadius:g,width:o,height:s,delta:n,dist:e},At({borderRadius:g},r)));return X(t,"onRound",h),h}function mi(t){var r,e,n=t.getState().style,a=n.borderRadius||"";if(!a&&t.props.groupable){var i=t.moveables[0],o=t.getTargets()[0];o&&((i==null?void 0:i.props.target)===o?(a=(e=(r=t.moveables[0])===null||r===void 0?void 0:r.state.style.borderRadius)!==null&&e!==void 0?e:"",n.borderRadius=a):(a=Ea(o).borderRadius,n.borderRadius=a))}return a}var Pd={name:"roundable",props:["roundable","roundRelative","minRoundControls","maxRoundControls","roundClickable","roundPadding","isDisplayShadowRoundControls"],events:["roundStart","round","roundEnd","roundGroupStart","roundGroup","roundGroupEnd"],css:[`.control.border-radius {
background: #d66;
cursor: pointer;
z-index: 3;
}`,`.control.border-radius.vertical {
background: #d6d;
z-index: 2;
}`,`.control.border-radius.virtual {
opacity: 0.5;
z-index: 1;
}`,`:host.round-line-clickable .line.direction {
cursor: pointer;
}`],className:function(t){var r=t.props.roundClickable;return r===!0||r==="line"?rt("round-line-clickable"):""},requestStyle:function(){return["borderRadius"]},requestChildStyle:function(){return["borderRadius"]},render:function(t,r){var e=t.getState(),n=e.target,a=e.width,i=e.height,o=e.allMatrix,s=e.is3d,l=e.left,c=e.top,u=e.borderRadiusState,f=t.props,d=f.minRoundControls,p=d===void 0?[0,0]:d,v=f.maxRoundControls,g=v===void 0?[4,4]:v,h=f.zoom,m=f.roundPadding,x=m===void 0?0:m,y=f.isDisplayShadowRoundControls,S=f.groupable;if(!n)return null;var E=u||mi(t),b=s?4:3,C=gi(E,a,i,p,!0);if(!C)return null;var w=0,T=0,O=S?[0,0]:[l,c];return C.map(function(P,z){var I=P.horizontal,B=P.vertical,_=P.direction||"",H=L([],M(P.pos),!1);T+=Math.abs(I),w+=Math.abs(B),I&&_.indexOf("n")>-1&&(H[1]-=x),B&&_.indexOf("w")>-1&&(H[0]-=x),I&&_.indexOf("s")>-1&&(H[1]+=x),B&&_.indexOf("e")>-1&&(H[0]+=x);var N=et(bt(o,H,b),O),G=P.vertical?w<=g[1]&&(y||!P.virtual):T<=g[0]&&(y||!P.virtual);return r.createElement("div",{key:"borderRadiusControl".concat(z),className:rt("control","border-radius",P.vertical?"vertical":"",P.virtual?"virtual":""),"data-radius-index":z,style:{display:G?"block":"none",transform:"translate(".concat(N[0],"px, ").concat(N[1],"px) scale(").concat(h,")")}})})},dragControlCondition:function(t,r){if(!r.inputEvent||r.isRequest)return!1;var e=r.inputEvent.target.getAttribute("class")||"";return e.indexOf("border-radius")>-1||e.indexOf("moveable-line")>-1&&e.indexOf("moveable-direction")>-1},dragGroupControlCondition:function(t,r){return this.dragControlCondition(t,r)},dragControlStart:function(t,r){var e=r.inputEvent,n=r.datas,a=e.target,i=a.getAttribute("class")||"",o=i.indexOf("border-radius")>-1,s=i.indexOf("moveable-line")>-1&&i.indexOf("moveable-direction")>-1,l=o?parseInt(a.getAttribute("data-radius-index"),10):-1,c=-1;if(s){var u=a.getAttribute("data-line-key")||"";u&&(c=parseInt(u.replace(/render-line-/g,""),10),isNaN(c)&&(c=-1))}if(!o&&!s)return!1;var f=st(t,r,{}),d=X(t,"onRoundStart",f);if(d===!1)return!1;n.lineIndex=c,n.controlIndex=l,n.isControl=o,n.isLine=s,Gr(t,r);var p=t.props,v=p.roundRelative,g=p.minRoundControls,h=g===void 0?[0,0]:g,m=t.state,x=m.width,y=m.height;n.isRound=!0,n.prevDist=[0,0];var S=mi(t),E=gi(S||"",x,y,h,!0)||[];return n.controlPoses=E,m.borderRadiusState=Ta(E,v,x,y).styles.join(" "),f},dragControl:function(t,r){var e=r.datas,n=e.controlPoses;if(!e.isRound||!e.isControl||!n.length)return!1;var a=e.controlIndex,i=M(nr(r),2),o=i[0],s=i[1],l=[o,s],c=et(l,e.prevDist),u=t.props.maxRoundControls,f=u===void 0?[4,4]:u,d=t.state,p=d.width,v=d.height,g=n[a],h=g.vertical,m=g.horizontal,x=n.map(function(S){var E=S.horizontal,b=S.vertical,C=[E*m*l[0],b*h*l[1]];if(E){if(f[0]===1)return C;if(f[0]<4&&E!==m)return C}else{if(f[1]===0)return C[1]=b*m*l[0]/p*v,C;if(h){if(f[1]===1)return C;if(f[1]<4&&b!==h)return C}}return[0,0]});x[a]=l;var y=n.map(function(S,E){return R(R({},S),{pos:pt(S.pos,x[E])})});return a<4?y.slice(0,a+1).forEach(function(S){S.virtual=!1}):y.slice(4,a+1).forEach(function(S){S.virtual=!1}),e.prevDist=[o,s],hi(t,r,l,c,y)},dragControlEnd:function(t,r){var e=t.state;e.borderRadiusState="";var n=r.datas,a=r.isDouble;if(!n.isRound)return!1;var i=n.isControl,o=n.controlIndex,s=n.isLine,l=n.lineIndex,c=n.controlPoses,u=c.filter(function(m){var x=m.virtual;return x}).length,f=t.props.roundClickable,d=f===void 0?!0:f;if(a&&d){if(i&&(d===!0||d==="control"))zd(c,o);else if(s&&(d===!0||d==="line")){var p=M(vo(t,r),2),v=p[0],g=p[1];Td(c,l,v,g)}u!==c.filter(function(m){var x=m.virtual;return x}).length&&hi(t,r,[0,0],[0,0],c)}var h=Ft(t,r,{});return X(t,"onRoundEnd",h),e.borderRadiusState="",h},dragGroupControlStart:function(t,r){var e=this.dragControlStart(t,r);if(!e)return!1;var n=t.moveables,a=t.props.targets,i=$t(t,"roundable",r),o=R({targets:t.props.targets,events:i.map(function(s,l){return R(R({},s),{target:a[l],moveable:n[l],currentTarget:n[l]})})},e);return X(t,"onRoundGroupStart",o),e},dragGroupControl:function(t,r){var e=this.dragControl(t,r);if(!e)return!1;var n=t.moveables,a=t.props.targets,i=$t(t,"roundable",r),o=R({targets:t.props.targets,events:i.map(function(s,l){return R(R(R({},s),{target:a[l],moveable:n[l],currentTarget:n[l]}),At({borderRadius:e.borderRadius},s))})},e);return X(t,"onRoundGroup",o),o},dragGroupControlEnd:function(t,r){var e=t.moveables,n=t.props.targets,a=$t(t,"roundable",r);gn(t,"onRound",function(s){var l=R({targets:t.props.targets,events:a.map(function(c,u){return R(R(R({},c),{target:n[u],moveable:e[u],currentTarget:e[u]}),At({borderRadius:s.borderRadius},c))})},s);X(t,"onRoundGroup",l)});var i=this.dragControlEnd(t,r);if(!i)return!1;var o=R({targets:t.props.targets,events:a.map(function(s,l){var c;return R(R({},s),{target:n[l],moveable:e[l],currentTarget:e[l],lastEvent:(c=s.datas)===null||c===void 0?void 0:c.lastEvent})})},i);return X(t,"onRoundGroupEnd",o),o},unset:function(t){t.state.borderRadiusState=""}};function _d(t,r){var e=r?4:3,n=It(e),a="matrix".concat(r?"3d":"","(").concat(n.join(","),")");return t===a||t==="matrix(1,0,0,1,0,0)"}var us={isPinch:!0,name:"beforeRenderable",props:[],events:["beforeRenderStart","beforeRender","beforeRenderEnd","beforeRenderGroupStart","beforeRenderGroup","beforeRenderGroupEnd"],dragRelation:"weak",setTransform:function(t,r){var e=t.state,n=e.is3d,a=e.targetMatrix,i=e.inlineTransform,o=n?"matrix3d(".concat(a.join(","),")"):"matrix(".concat(wi(a,!0),")"),s=!i||i==="none"?o:i;r.datas.startTransforms=_d(s,n)?[]:Tr(s)},resetStyle:function(t){var r=t.datas;r.nextStyle={},r.nextTransforms=t.datas.startTransforms,r.nextTransformAppendedIndexes=[]},fillDragStartParams:function(t,r){return st(t,r,{setTransform:function(e){r.datas.startTransforms=zt(e)?e:Tr(e)},isPinch:!!r.isPinch})},fillDragParams:function(t,r){return st(t,r,{isPinch:!!r.isPinch})},dragStart:function(t,r){this.setTransform(t,r),this.resetStyle(r),X(t,"onBeforeRenderStart",this.fillDragStartParams(t,r))},drag:function(t,r){r.datas.startTransforms||this.setTransform(t,r),this.resetStyle(r),X(t,"onBeforeRender",st(t,r,{isPinch:!!r.isPinch}))},dragEnd:function(t,r){r.datas.startTransforms||(this.setTransform(t,r),this.resetStyle(r)),X(t,"onBeforeRenderEnd",st(t,r,{isPinch:!!r.isPinch,isDrag:r.isDrag}))},dragGroupStart:function(t,r){var e=this;this.dragStart(t,r);var n=$t(t,"beforeRenderable",r),a=t.moveables,i=n.map(function(o,s){var l=a[s];return e.setTransform(l,o),e.resetStyle(o),e.fillDragStartParams(l,o)});X(t,"onBeforeRenderGroupStart",st(t,r,{isPinch:!!r.isPinch,targets:t.props.targets,setTransform:function(){},events:i}))},dragGroup:function(t,r){var e=this;this.drag(t,r);var n=$t(t,"beforeRenderable",r),a=t.moveables,i=n.map(function(o,s){var l=a[s];return e.resetStyle(o),e.fillDragParams(l,o)});X(t,"onBeforeRenderGroup",st(t,r,{isPinch:!!r.isPinch,targets:t.props.targets,events:i}))},dragGroupEnd:function(t,r){this.dragEnd(t,r),X(t,"onBeforeRenderGroupEnd",st(t,r,{isPinch:!!r.isPinch,isDrag:r.isDrag,targets:t.props.targets}))},dragControlStart:function(t,r){return this.dragStart(t,r)},dragControl:function(t,r){return this.drag(t,r)},dragControlEnd:function(t,r){return this.dragEnd(t,r)},dragGroupControlStart:function(t,r){return this.dragGroupStart(t,r)},dragGroupControl:function(t,r){return this.dragGroup(t,r)},dragGroupControlEnd:function(t,r){return this.dragGroupEnd(t,r)}},fs={name:"renderable",props:[],events:["renderStart","render","renderEnd","renderGroupStart","renderGroup","renderGroupEnd"],dragRelation:"weak",dragStart:function(t,r){X(t,"onRenderStart",st(t,r,{isPinch:!!r.isPinch}))},drag:function(t,r){X(t,"onRender",this.fillDragParams(t,r))},dragAfter:function(t,r){return this.drag(t,r)},dragEnd:function(t,r){X(t,"onRenderEnd",this.fillDragEndParams(t,r))},dragGroupStart:function(t,r){X(t,"onRenderGroupStart",st(t,r,{isPinch:!!r.isPinch,targets:t.props.targets}))},dragGroup:function(t,r){var e=this,n=$t(t,"beforeRenderable",r),a=t.moveables,i=n.map(function(o,s){var l=a[s];return e.fillDragParams(l,o)});X(t,"onRenderGroup",st(t,r,R(R({isPinch:!!r.isPinch,targets:t.props.targets,transform:Pe(r),transformObject:{}},At(_e(r))),{events:i})))},dragGroupEnd:function(t,r){var e=this,n=$t(t,"beforeRenderable",r),a=t.moveables,i=n.map(function(o,s){var l=a[s];return e.fillDragEndParams(l,o)});X(t,"onRenderGroupEnd",st(t,r,R({isPinch:!!r.isPinch,isDrag:r.isDrag,targets:t.props.targets,events:i,transformObject:{},transform:Pe(r)},At(_e(r)))))},dragControlStart:function(t,r){return this.dragStart(t,r)},dragControl:function(t,r){return this.drag(t,r)},dragControlAfter:function(t,r){return this.dragAfter(t,r)},dragControlEnd:function(t,r){return this.dragEnd(t,r)},dragGroupControlStart:function(t,r){return this.dragGroupStart(t,r)},dragGroupControl:function(t,r){return this.dragGroup(t,r)},dragGroupControlEnd:function(t,r){return this.dragGroupEnd(t,r)},fillDragParams:function(t,r){var e={};return he(Ye(r)||[]).forEach(function(n){e[n.name]=n.functionValue}),st(t,r,R({isPinch:!!r.isPinch,transformObject:e,transform:Pe(r)},At(_e(r))))},fillDragEndParams:function(t,r){var e={};return he(Ye(r)||[]).forEach(function(n){e[n.name]=n.functionValue}),st(t,r,R({isPinch:!!r.isPinch,isDrag:r.isDrag,transformObject:e,transform:Pe(r)},At(_e(r))))}};function ue(t,r,e,n,a,i,o){i.clientDistX=i.distX,i.clientDistY=i.distY;var s=a==="Start",l=a==="End",c=a==="After",u=t.state.target,f=i.isRequest,d=n.indexOf("Control")>-1;if(!u||s&&d&&!f&&t.areaElement===i.inputEvent.target)return!1;var p=L([],M(r),!1);if(f){var v=i.requestAble;p.some(function(z){return z.name===v})||p.push.apply(p,L([],M(t.props.ables.filter(function(z){return z.name===v})),!1))}if(!p.length||p.every(function(z){return z.dragRelation}))return!1;var g=i.inputEvent,h;l&&g&&(h=document.elementFromPoint(i.clientX,i.clientY)||g.target);var m=!1,x=function(){var z;m=!0,(z=i.stop)===null||z===void 0||z.call(i)},y=s&&(!t.targetGesto||!t.controlGesto||!t.targetGesto.isFlag()||!t.controlGesto.isFlag());y&&t.updateRect(a,!0,!1);var S=i.datas,E=d?"controlGesto":"targetGesto",b=t[E],C=function(z,I,B){if(!(I in z)||b!==t[E])return!1;var _=z.name,H=S[_]||(S[_]={});if(s&&(H.isEventStart=!B||!z[B]||z[B](t,i)),!H.isEventStart)return!1;var N=z[I](t,R(R({},i),{stop:x,datas:H,originalDatas:S,inputTarget:h}));return t._emitter.off(),s&&N===!1&&(H.isEventStart=!1),N};y&&p.forEach(function(z){z.unset&&z.unset(t)}),C(us,"drag".concat(n).concat(a));var w=0,T=0;e.forEach(function(z){if(m)return!1;var I="".concat(z).concat(n).concat(a),B="".concat(z).concat(n,"Condition");a===""&&!f&&Qo(t.state,i);var _=p.filter(function(G){return G[I]});_=_.filter(function(G,q){return G.name&&_.indexOf(G)===q});var H=_.filter(function(G){return C(G,I,B)}),N=H.length;m&&++w,N&&++T,!m&&s&&_.length&&!N&&(w+=_.filter(function(G){var q=G.name,V=S[q];return V.isEventStart?G.dragRelation!=="strong":!1}).length?1:0)}),(!c||T)&&C(fs,"drag".concat(n).concat(a));var O=b!==t[E]||w===e.length;if((l||m||O)&&(t.state.gestos={},t.moveables&&t.moveables.forEach(function(z){z.state.gestos={}}),p.forEach(function(z){z.unset&&z.unset(t)})),s&&!O&&!f&&T&&t.props.preventDefault&&(i==null||i.preventDefault()),t.isUnmounted||O)return!1;if(!s&&T&&!o||l){var P=t.props.flushSync||Ho;P(function(){t.updateRect(l?a:"",!0,!1),t.forceUpdate()})}return!s&&!l&&!c&&T&&!o&&ue(t,r,e,n,a+"After",i),!0}function $n(t){return function(r){var e,n=r.inputEvent.target,a=t.areaElement,i=t._dragTarget;return!i||!((e=t.controlGesto)===null||e===void 0)&&e.isFlag()?!1:n===i||i.contains(n)||n===a||!t.isMoveableElement(n)&&!t.controlBox.contains(n)||wt(n,"moveable-area")||wt(n,"moveable-padding")||wt(n,"moveable-edgeDraggable")}}function ds(t,r,e){var n=t.controlBox,a=[],i=t.props,o=i.dragArea,s=t.state.target,l=i.dragTarget;return a.push(n),(!o||l)&&a.push(r),!o&&l&&s&&r!==s&&i.dragTargetSelf&&a.push(s),za(t,a,"targetAbles",e,{dragStart:$n(t),pinchStart:$n(t)})}function za(t,r,e,n,a){a===void 0&&(a={});var i=e==="targetAbles",o=t.props,s=o.pinchOutside,l=o.pinchThreshold,c=o.preventClickEventOnDrag,u=o.preventClickDefault,f=o.checkInput,d=o.dragFocusedInput,p=o.preventDefault,v=p===void 0?!0:p,g=o.dragContainer,h=Qt(g,!0),m={preventDefault:v,preventRightClick:!0,preventWheelClick:!0,container:h||xe(t.getControlBoxElement()),pinchThreshold:l,pinchOutside:s,preventClickEventOnDrag:i?c:!1,preventClickEventOnDragStart:i?u:!1,preventClickEventByCondition:i?null:function(S){return t.controlBox.contains(S.target)},checkInput:i?f:!1,dragFocusedInput:d},x=new ol(r,m),y=n==="Control";return["drag","pinch"].forEach(function(S){["Start","","End"].forEach(function(E){x.on("".concat(S).concat(E),function(b){var C,w=b.eventType,T=S==="drag"&&b.isPinch;if(a[w]&&!a[w](b)){b.stop();return}if(!T){var O=S==="drag"?[S]:["drag",S],P=L([],M(t[e]),!1),z=ue(t,P,O,n,E,b);z?(t.props.stopPropagation||E==="Start"&&y)&&((C=b==null?void 0:b.inputEvent)===null||C===void 0||C.stopPropagation()):b.stop()}})})}),x}var Bd=function(){function t(r,e,n){var a=this;this.target=r,this.moveable=e,this.eventName=n,this.ables=[],this._onEvent=function(i){var o=a.eventName,s=a.moveable;s.state.disableNativeEvent||a.ables.forEach(function(l){l[o](s,{inputEvent:i})})},r.addEventListener(n.toLowerCase(),this._onEvent)}return t.prototype.setAbles=function(r){this.ables=r},t.prototype.destroy=function(){this.target.removeEventListener(this.eventName.toLowerCase(),this._onEvent),this.target=null,this.moveable=null},t}();function Gd(t,r,e,n){var a;e===void 0&&(e=r);var i=bo(t,r),o=i.matrixes,s=i.is3d,l=i.targetMatrix,c=i.transformOrigin,u=i.targetOrigin,f=i.offsetContainer,d=i.hasFixed,p=i.zoom,v=$u(f,e),g=v.matrixes,h=v.is3d,m=v.offsetContainer,x=v.zoom,y=n||h||s,S=y?4:3,E=t.tagName.toLowerCase()!=="svg"&&"ownerSVGElement"in t,b=l,C=It(S),w=It(S),T=It(S),O=It(S),P=o.length,z=g.map(function(q){return R(R({},q),{matrix:q.matrix?L([],M(q.matrix),!1):void 0})}).reverse();o.reverse(),!s&&y&&(b=rr(b,3,4),qn(o)),!h&&y&&qn(z),z.forEach(function(q){w=Mt(w,q.matrix,S)});var I=e||Sr(t),B=((a=z[0])===null||a===void 0?void 0:a.target)||Se(I,I,!0).offsetParent,_=z.slice(1).reduce(function(q,V){return Mt(q,V.matrix,S)},It(S));o.forEach(function(q,V){if(P-2===V&&(T=C.slice()),P-1===V&&(O=C.slice()),!q.matrix){var j=o[V+1],$=Jf(q,j,B,S,Mt(_,C,S));q.matrix=Ir($,S)}C=Mt(C,q.matrix,S)});var H=!E&&s;b||(b=It(H?4:3));var N=vn(E&&b.length===16?rr(b,4,3):b,H),G=w;return w=Ri(w,S,S),{hasZoom:p!==1||x!==1,hasFixed:d,matrixes:o,rootMatrix:w,originalRootMatrix:G,beforeMatrix:T,offsetMatrix:O,allMatrix:C,targetMatrix:b,targetTransform:N,inlineTransform:t.style.transform,transformOrigin:c,targetOrigin:u,is3d:y,offsetContainer:f,offsetRootContainer:m}}function kd(t,r,e,n){e===void 0&&(e=r);var a=0,i=0,o=0,s={},l=qo(t);if(t&&(a=l.offsetWidth,i=l.offsetHeight),t){var c=Gd(t,r,e,n),u=Fr(c.allMatrix,c.transformOrigin,a,i);s=R(R({},c),u);var f=Fr(c.allMatrix,[50,50],100,100);o=Yo([f.pos1,f.pos2],f.direction)}var d=n?4:3;return R(R(R({hasZoom:!1,width:a,height:i,rotation:o},l),{originalRootMatrix:It(d),rootMatrix:It(d),beforeMatrix:It(d),offsetMatrix:It(d),allMatrix:It(d),targetMatrix:It(d),targetTransform:"",inlineTransform:"",transformOrigin:[0,0],targetOrigin:[0,0],is3d:!!n,left:0,top:0,right:0,bottom:0,origin:[0,0],pos1:[0,0],pos2:[0,0],pos3:[0,0],pos4:[0,0],direction:1,hasFixed:!1,offsetContainer:null,offsetRootContainer:null,matrixes:[]}),s)}function Kn(t,r,e,n,a,i){i===void 0&&(i=[]);var o=1,s=[0,0],l=Ge(),c=Ge(),u=Ge(),f=Ge(),d=[0,0],p={},v=kd(r,e,a,!0);if(r){var g=Vt(r);i.forEach(function(z){p[z]=g(z)});var h=v.is3d?4:3,m=Fr(v.offsetMatrix,pt(v.transformOrigin,zi(v.targetMatrix,h)),v.width,v.height);o=m.direction,s=pt(m.origin,[m.left-v.left,m.top-v.top]),f=ce(v.offsetRootContainer);var x=Se(n,n,!0).offsetParent||v.offsetRootContainer;if(v.hasZoom){var y=Fr(Mt(v.originalRootMatrix,v.allMatrix),v.transformOrigin,v.width,v.height),S=Fr(v.originalRootMatrix,Ke(Vt(x)("transformOrigin")).map(function(z){return parseFloat(z)}),x.offsetWidth,x.offsetHeight);if(l=Mn(y,f),u=Mn(S,f,x,!0),t){var E=y.left,b=y.top;c=Mn({left:E,top:b,bottom:b,right:b},f)}}else{l=ce(r),u=Uu(x),t&&(c=ce(t));var C=u.left,w=u.top,T=u.clientLeft,O=u.clientTop,P=[l.left-C,l.top-w];d=et($r(v.rootMatrix,P,4),[T+v.left,O+v.top])}}return R({targetClientRect:l,containerClientRect:u,moveableClientRect:c,rootContainerClientRect:f,beforeDirection:o,beforeOrigin:s,originalBeforeOrigin:s,target:r,style:p,offsetDelta:d},v)}function xi(t){var r=t.pos1,e=t.pos2,n=t.pos3,a=t.pos4;if(!r||!e||!n||!a)return null;var i=me([r,e,n,a]),o=[i.minX,i.minY],s=et(t.origin,o);return r=et(r,o),e=et(e,o),n=et(n,o),a=et(a,o),R(R({},t),{left:t.left,top:t.top,posDelta:o,pos1:r,pos2:e,pos3:n,pos4:a,origin:s,beforeOrigin:s,isPersisted:!0})}var Kr=function(t){Ee(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.state=R({container:null,gestos:{},renderPoses:[[0,0],[0,0],[0,0],[0,0]],disableNativeEvent:!1,posDelta:[0,0]},Kn(null)),e.renderState={},e.enabledAbles=[],e.targetAbles=[],e.controlAbles=[],e.rotation=0,e.scale=[1,1],e.isMoveableMounted=!1,e.isUnmounted=!1,e.events={mouseEnter:null,mouseLeave:null},e._emitter=new tl,e._prevOriginalDragTarget=null,e._originalDragTarget=null,e._prevDragTarget=null,e._dragTarget=null,e._prevPropTarget=null,e._propTarget=null,e._prevDragArea=!1,e._isPropTargetChanged=!1,e._hasFirstTarget=!1,e._reiszeObserver=null,e._observerId=0,e._mutationObserver=null,e._rootContainer=null,e._viewContainer=null,e._viewClassNames=[],e._store={},e.checkUpdateRect=function(){if(!e.isDragging()){var n=e.props.parentMoveable;if(n){n.checkUpdateRect();return}rl(e._observerId),e._observerId=Oi(function(){e.isDragging()||e.updateRect()})}},e._onPreventClick=function(n){n.stopPropagation(),n.preventDefault()},e}return r.prototype.render=function(){var e=this.props,n=this.getState(),a=e.parentPosition,i=e.className,o=e.target,s=e.zoom,l=e.cspNonce,c=e.translateZ,u=e.cssStyled,f=e.groupable,d=e.linePadding,p=e.controlPadding;this._checkUpdateRootContainer(),this.checkUpdate(),this.updateRenderPoses();var v=M(a||[0,0],2),g=v[0],h=v[1],m=n.left,x=n.top,y=n.target,S=n.direction,E=n.hasFixed,b=n.offsetDelta,C=e.targets,w=this.isDragging(),T={};this.getEnabledAbles().forEach(function(_){T["data-able-".concat(_.name.toLowerCase())]=!0});var O=this._getAbleClassName(),P=C&&C.length&&(y||f)||o||!this._hasFirstTarget&&this.state.isPersisted,z=this.controlBox||this.props.firstRenderState||this.props.persistData,I=[m-g,x-h];!f&&e.useAccuratePosition&&(I[0]+=b[0],I[1]+=b[1]);var B={position:E?"fixed":"absolute",display:P?"block":"none",visibility:z?"visible":"hidden",transform:"translate3d(".concat(I[0],"px, ").concat(I[1],"px, ").concat(c,")"),"--zoom":s,"--zoompx":"".concat(s,"px")};return d&&(B["--moveable-line-padding"]=d),p&&(B["--moveable-control-padding"]=p),A.createElement(u,R({cspNonce:l,ref:Or(this,"controlBox"),className:"".concat(rt("control-box",S===-1?"reverse":"",w?"dragging":"")," ").concat(O," ").concat(i)},T,{onClick:this._onPreventClick,style:B}),this.renderAbles(),this._renderLines())},r.prototype.componentDidMount=function(){this.isMoveableMounted=!0,this.isUnmounted=!1;var e=this.props,n=e.parentMoveable,a=e.container;this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateTargets(),this._updateNativeEvents(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(this.props),!a&&!n&&!this.state.isPersisted&&(this.updateRect("",!1,!1),this.forceUpdate())},r.prototype.componentDidUpdate=function(e){this._checkUpdateRootContainer(),this._checkUpdateViewContainer(),this._updateNativeEvents(),this._updateTargets(),this._updateEvents(),this.updateCheckInput(),this._updateObserver(e)},r.prototype.componentWillUnmount=function(){var e,n;this.isMoveableMounted=!1,this.isUnmounted=!0,this._emitter.off(),(e=this._reiszeObserver)===null||e===void 0||e.disconnect(),(n=this._mutationObserver)===null||n===void 0||n.disconnect();var a=this._viewContainer;a&&this._changeAbleViewClassNames([]),Hr(this,!1),Hr(this,!0);var i=this.events;for(var o in i){var s=i[o];s&&s.destroy()}},r.prototype.getTargets=function(){var e=this.props.target;return e?[e]:[]},r.prototype.getAble=function(e){var n=this.props.ables||[];return xr(n,function(a){return a.name===e})},r.prototype.getContainer=function(){var e=this.props,n=e.parentMoveable,a=e.wrapperMoveable,i=e.container;return i||a&&a.getContainer()||n&&n.getContainer()||this.controlBox.parentElement},r.prototype.getControlBoxElement=function(){return this.controlBox},r.prototype.getDragElement=function(){return this._dragTarget},r.prototype.isMoveableElement=function(e){var n;return e&&(((n=e.getAttribute)===null||n===void 0?void 0:n.call(e,"class"))||"").indexOf(da)>-1},r.prototype.dragStart=function(e){var n=this.targetGesto,a=this.controlGesto;return n&&$n(this)({inputEvent:e})?n.isFlag()||n.triggerDragStart(e):a&&this.isMoveableElement(e.target)&&(a.isFlag()||a.triggerDragStart(e)),this},r.prototype.hitTest=function(e){var n=this.state,a=n.target,i=n.pos1,o=n.pos2,s=n.pos3,l=n.pos4,c=n.targetClientRect;if(!a)return 0;var u;if(ta(e)){var f=e.getBoundingClientRect();u={left:f.left,top:f.top,width:f.width,height:f.height}}else u=R({width:0,height:0},e);var d=u.left,p=u.top,v=u.width,g=u.height,h=La([i,o,l,s],c),m=el(h,[[d,p],[d+v,p],[d+v,p+g],[d,p+g]]),x=nl(h);return!m||!x?0:Math.min(100,m/x*100)},r.prototype.isInside=function(e,n){var a=this.state,i=a.target,o=a.pos1,s=a.pos2,l=a.pos3,c=a.pos4,u=a.targetClientRect;return i?al([e,n],La([o,s,c,l],u)):!1},r.prototype.updateRect=function(e,n,a){a===void 0&&(a=!0);var i=this.props,o=!i.parentPosition&&!i.wrapperMoveable;o&&Xr(!0);var s=i.parentMoveable,l=this.state,c=l.target||i.target,u=this.getContainer(),f=s?s._rootContainer:this._rootContainer,d=Kn(this.controlBox,c,u,u,f||u,this._getRequestStyles());if(!c&&this._hasFirstTarget&&i.persistData){var p=xi(i.persistData);for(var v in p)d[v]=p[v]}o&&Xr(),this.updateState(d,s?!1:a)},r.prototype.isDragging=function(e){var n,a,i=this.targetGesto,o=this.controlGesto;if(i!=null&&i.isFlag()){if(!e)return!0;var s=i.getEventData();return!!(!((n=s[e])===null||n===void 0)&&n.isEventStart)}if(o!=null&&o.isFlag()){if(!e)return!0;var s=o.getEventData();return!!(!((a=s[e])===null||a===void 0)&&a.isEventStart)}return!1},r.prototype.updateTarget=function(e){this.updateRect(e,!0)},r.prototype.getRect=function(){var e=this.state,n=Xt(this.state),a=M(n,4),i=a[0],o=a[1],s=a[2],l=a[3],c=qt(n),u=e.width,f=e.height,d=c.width,p=c.height,v=c.left,g=c.top,h=[e.left,e.top],m=pt(h,e.origin),x=pt(h,e.beforeOrigin),y=e.transformOrigin;return{width:d,height:p,left:v,top:g,pos1:i,pos2:o,pos3:s,pos4:l,offsetWidth:u,offsetHeight:f,beforeOrigin:x,origin:m,transformOrigin:y,rotation:this.getRotation()}},r.prototype.getManager=function(){return this},r.prototype.stopDrag=function(e){if(!e||e==="target"){var n=this.targetGesto;(n==null?void 0:n.isIdle())===!1&&Yn(this,!1),n==null||n.stop()}if(!e||e==="control"){var n=this.controlGesto;(n==null?void 0:n.isIdle())===!1&&Yn(this,!0),n==null||n.stop()}},r.prototype.getRotation=function(){var e=this.state,n=e.pos1,a=e.pos2,i=e.direction;return id(n,a,i)},r.prototype.request=function(e,n,a){n===void 0&&(n={});var i=this,o=i.props,s=o.parentMoveable||o.wrapperMoveable||i,l=s.props.ables,c=o.groupable,u=xr(l,function(m){return m.name===e});if(this.isDragging()||!u||!u.request)return{request:function(){return this},requestEnd:function(){return this}};var f=u.request(i),d=a||n.isInstant,p=f.isControl?"controlAbles":"targetAbles",v="".concat(c?"Group":"").concat(f.isControl?"Control":""),g=L([],M(s[p]),!1),h={request:function(m){return ue(i,g,["drag"],v,"",R(R({},f.request(m)),{requestAble:e,isRequest:!0}),d),h},requestEnd:function(){return ue(i,g,["drag"],v,"End",R(R({},f.requestEnd()),{requestAble:e,isRequest:!0}),d),h}};return ue(i,g,["drag"],v,"Start",R(R({},f.requestStart(n)),{requestAble:e,isRequest:!0}),d),d?h.request(n).requestEnd():h},r.prototype.getMoveables=function(){return[this]},r.prototype.destroy=function(){this.componentWillUnmount()},r.prototype.updateRenderPoses=function(){var e=this.getState(),n=this.props,a=n.padding,i=e.originalBeforeOrigin,o=e.transformOrigin,s=e.allMatrix,l=e.is3d,c=e.pos1,u=e.pos2,f=e.pos3,d=e.pos4,p=e.left,v=e.top,g=e.isPersisted;if(!a){e.renderPoses=[c,u,f,d];return}var h=ns(a),m=h.left,x=h.top,y=h.bottom,S=h.right,E=l?4:3,b=[];g?b=o:this.controlBox&&n.groupable?b=i:b=pt(i,[p,v]);var C=We(E,Ir(b.map(function(w){return-w}),E),s,Ir(o,E));e.renderPoses=[je(C,c,[-m,-x],E),je(C,u,[S,-x],E),je(C,f,[-m,y],E),je(C,d,[S,y],E)]},r.prototype.checkUpdate=function(){this._isPropTargetChanged=!1;var e=this.props,n=e.target,a=e.container,i=e.parentMoveable,o=this.state,s=o.target,l=o.container;if(!(!s&&!n)){this.updateAbles();var c=!Xn(s,n),u=c||!Xn(l,a);if(u){var f=a||this.controlBox;f&&this.unsetAbles(),this.updateState({target:n,container:a}),!i&&f&&this.updateRect("End",!1,!1),this._isPropTargetChanged=c}}},r.prototype.waitToChangeTarget=function(){return new Promise(function(){})},r.prototype.triggerEvent=function(e,n){var a=this.props;if(this._emitter.trigger(e,n),a.parentMoveable&&n.isRequest&&!n.isRequestChild)return a.parentMoveable.triggerEvent(e,n,!0);var i=a[e];return i&&i(n)},r.prototype.useCSS=function(e,n){var a=this.props.customStyledMap,i=e+n;return a[i]||(a[i]=so(e,n)),a[i]},r.prototype.getState=function(){var e,n=this.props;(n.target||!((e=n.targets)===null||e===void 0)&&e.length)&&(this._hasFirstTarget=!0);var a=this.controlBox,i=n.persistData,o=n.firstRenderState;if(o&&!a)return o;if(!this._hasFirstTarget&&i){var s=xi(i);if(s)return this.updateState(s,!1),this.state}return this.state.isPersisted=!1,this.state},r.prototype.updateSelectors=function(){},r.prototype.unsetAbles=function(){var e=this;this.targetAbles.forEach(function(n){n.unset&&n.unset(e)})},r.prototype.updateAbles=function(e,n){e===void 0&&(e=this.props.ables),n===void 0&&(n="");var a=this.props,i=a.triggerAblesSimultaneously,o=this.getEnabledAbles(e),s="drag".concat(n,"Start"),l="pinch".concat(n,"Start"),c="drag".concat(n,"ControlStart"),u=ke(o,[s,l],i),f=ke(o,[c],i);this.enabledAbles=o,this.targetAbles=u,this.controlAbles=f},r.prototype.updateState=function(e,n){if(n){if(this.isUnmounted)return;this.setState(e)}else{var a=this.state;for(var i in e)a[i]=e[i]}},r.prototype.getEnabledAbles=function(e){e===void 0&&(e=this.props.ables);var n=this.props;return e.filter(function(a){return a&&(a.always&&n[a.name]!==!1||n[a.name])})},r.prototype.renderAbles=function(){var e=this,n=this.props,a=n.triggerAblesSimultaneously,i={createElement:A.createElement};return this.renderState={},ed(Jo(ke(this.getEnabledAbles(),["render"],a).map(function(o){var s=o.render;return s(e,i)||[]})).filter(function(o){return o}),function(o){var s=o.key;return s}).map(function(o){return o[0]})},r.prototype.updateCheckInput=function(){this.targetGesto&&(this.targetGesto.options.checkInput=this.props.checkInput)},r.prototype._getRequestStyles=function(){var e=this.getEnabledAbles().reduce(function(n,a){var i,o,s=(o=(i=a.requestStyle)===null||i===void 0?void 0:i.call(a))!==null&&o!==void 0?o:[];return L(L([],M(n),!1),M(s),!1)},L([],M(this.props.requestStyles||[]),!1));return e},r.prototype._updateObserver=function(e){this._updateResizeObserver(e),this._updateMutationObserver(e)},r.prototype._updateEvents=function(){var e=this.controlBox,n=this.targetAbles.length,a=this.controlAbles.length,i=this._dragTarget,o=!n&&this.targetGesto||this._isTargetChanged(!0);o&&(Hr(this,!1),this.updateState({gestos:{}})),a||Hr(this,!0),i&&n&&!this.targetGesto&&(this.targetGesto=ds(this,i,"")),!this.controlGesto&&a&&(this.controlGesto=za(this,e,"controlAbles","Control"))},r.prototype._updateTargets=function(){var e=this.props;this._prevPropTarget=this._propTarget,this._prevDragTarget=this._dragTarget,this._prevOriginalDragTarget=this._originalDragTarget,this._prevDragArea=e.dragArea,this._propTarget=e.target,this._originalDragTarget=e.dragTarget||e.target,this._dragTarget=Qt(this._originalDragTarget,!0)},r.prototype._renderLines=function(){var e=this.props,n=e,a=n.zoom,i=n.hideDefaultLines,o=n.hideChildMoveableDefaultLines,s=n.parentMoveable;if(i||s&&o)return[];var l=this.getState().renderPoses,c={createElement:A.createElement};return[[0,1],[1,3],[3,2],[2,0]].map(function(u,f){var d=M(u,2),p=d[0],v=d[1];return be(c,"",l[p],l[v],a,"render-line-".concat(f))})},r.prototype._isTargetChanged=function(e){var n=this.props,a=n.dragTarget||n.target,i=this._prevOriginalDragTarget,o=this._prevDragArea,s=n.dragArea,l=!s&&i!==a,c=(e||s)&&o!==s;return l||c||this._prevPropTarget!=this._propTarget},r.prototype._updateNativeEvents=function(){var e=this,n=this.props,a=n.dragArea?this.areaElement:this.state.target,i=this.events,o=Jr(i);if(this._isTargetChanged())for(var s in i){var l=i[s];l&&l.destroy(),i[s]=null}if(a){var c=this.enabledAbles;o.forEach(function(u){var f=ke(c,[u]),d=f.length>0,p=i[u];if(!d){p&&(p.destroy(),i[u]=null);return}p||(p=new Bd(a,e,u),i[u]=p),p.setAbles(f)})}},r.prototype._checkUpdateRootContainer=function(){var e=this.props.rootContainer;!this._rootContainer&&e&&(this._rootContainer=Qt(e,!0))},r.prototype._checkUpdateViewContainer=function(){var e=this.props.viewContainer;!this._viewContainer&&e&&(this._viewContainer=Qt(e,!0));var n=this._viewContainer;n&&this._changeAbleViewClassNames(L(L([],M(this._getAbleViewClassNames()),!1),[this.isDragging()?dd:""],!1))},r.prototype._changeAbleViewClassNames=function(e){var n=this._viewContainer,a=Zo(e.filter(Boolean),function(c){return c}).map(function(c){var u=M(c,1),f=u[0];return f}),i=this._viewClassNames,o=il(i,a),s=o.removed,l=o.added;s.forEach(function(c){Pi(n,i[c])}),l.forEach(function(c){Mi(n,a[c])}),this._viewClassNames=a},r.prototype._getAbleViewClassNames=function(){var e=this;return(this.getEnabledAbles().map(function(n){var a;return((a=n.viewClassName)===null||a===void 0?void 0:a.call(n,e))||""}).join(" ")+" ".concat(this._getAbleClassName("-view"))).split(/\s+/g)},r.prototype._getAbleClassName=function(e){var n=this;e===void 0&&(e="");var a=this.getEnabledAbles(),i=this.targetGesto,o=this.controlGesto,s=i!=null&&i.isFlag()?i.getEventData():{},l=o!=null&&o.isFlag()?o.getEventData():{};return a.map(function(c){var u,f,d,p=c.name,v=((u=c.className)===null||u===void 0?void 0:u.call(c,n))||"";return(!((f=s[p])===null||f===void 0)&&f.isEventStart||!((d=l[p])===null||d===void 0)&&d.isEventStart)&&(v+=" ".concat(rt("".concat(p).concat(e,"-dragging")))),v.trim()}).filter(Boolean).join(" ")},r.prototype._updateResizeObserver=function(e){var n,a=this.props,i=a.target,o=xe(this.getControlBoxElement());if(!o.ResizeObserver||!i||!a.useResizeObserver){(n=this._reiszeObserver)===null||n===void 0||n.disconnect();return}if(!(e.target===i&&this._reiszeObserver)){var s=new o.ResizeObserver(this.checkUpdateRect);s.observe(i,{box:"border-box"}),this._reiszeObserver=s}},r.prototype._updateMutationObserver=function(e){var n=this,a,i=this.props,o=i.target,s=xe(this.getControlBoxElement());if(!s.MutationObserver||!o||!i.useMutationObserver){(a=this._mutationObserver)===null||a===void 0||a.disconnect();return}if(!(e.target===o&&this._mutationObserver)){var l=new s.MutationObserver(function(c){var u,f;try{for(var d=hu(c),p=d.next();!p.done;p=d.next()){var v=p.value;v.type==="attributes"&&v.attributeName==="style"&&n.checkUpdateRect()}}catch(g){u={error:g}}finally{try{p&&!p.done&&(f=d.return)&&f.call(d)}finally{if(u)throw u.error}}});l.observe(o,{attributes:!0}),this._mutationObserver=l}},r.defaultProps={dragTargetSelf:!1,target:null,dragTarget:null,container:null,rootContainer:null,origin:!0,parentMoveable:null,wrapperMoveable:null,isWrapperMounted:!1,parentPosition:null,warpSelf:!1,svgOrigin:"",dragContainer:null,useResizeObserver:!1,useMutationObserver:!1,preventDefault:!0,linePadding:0,controlPadding:0,ables:[],pinchThreshold:20,dragArea:!1,passDragArea:!1,transformOrigin:"",className:"",zoom:1,triggerAblesSimultaneously:!1,padding:{},pinchOutside:!0,checkInput:!1,dragFocusedInput:!1,groupable:!1,hideDefaultLines:!1,cspNonce:"",translateZ:0,cssStyled:null,customStyledMap:{},props:{},stopPropagation:!1,preventClickDefault:!1,preventClickEventOnDrag:!0,flushSync:Ho,firstRenderState:null,persistData:null,viewContainer:null,requestStyles:[],useAccuratePosition:!1},r}(A.PureComponent),Pa={name:"groupable",props:["defaultGroupRotate","useDefaultGroupRotate","defaultGroupOrigin","groupable","groupableProps","targetGroups","hideChildMoveableDefaultLines"],events:[],render:function(t,r){var e,n=t.props,a=n.targets||[],i=t.getState(),o=i.left,s=i.top,l=i.isPersisted,c=n.zoom||1,u=t.renderGroupRects,f=((e=n.persistData)===null||e===void 0?void 0:e.children)||[];l?a=f.map(function(){return null}):f=[];var d=Vr(t,"parentPosition",[o,s],function(v){return v.join(",")}),p=Vr(t,"requestStyles",t.getRequestChildStyles(),function(v){return v.join(",")});return t.moveables=t.moveables.slice(0,a.length),L(L([],M(a.map(function(v,g){return r.createElement(Kr,{key:"moveable"+g,ref:Ti(t,"moveables",g),target:v,origin:!1,requestStyles:p,cssStyled:n.cssStyled,customStyledMap:n.customStyledMap,useResizeObserver:n.useResizeObserver,useMutationObserver:n.useMutationObserver,hideChildMoveableDefaultLines:n.hideChildMoveableDefaultLines,parentMoveable:t,parentPosition:[o,s],persistData:f[g],zoom:c})})),!1),M(Jo(u.map(function(v,g){var h=v.pos1,m=v.pos2,x=v.pos3,y=v.pos4,S=[h,m,x,y];return[[0,1],[1,3],[3,2],[2,0]].map(function(E,b){var C=M(E,2),w=C[0],T=C[1];return be(r,"",et(S[w],d),et(S[T],d),c,"group-rect-".concat(g,"-").concat(b))})}))),!1)}},jd=we("clickable",{props:["clickable"],events:["click","clickGroup"],always:!0,dragRelation:"weak",dragStart:function(){},dragControlStart:function(){},dragGroupStart:function(t,r){r.datas.inputTarget=r.inputEvent&&r.inputEvent.target},dragEnd:function(t,r){var e=t.props.target,n=r.inputEvent,a=r.inputTarget,i=t.isMoveableElement(a),o=!i&&t.controlBox.contains(a);if(!(!n||!a||r.isDrag||t.isMoveableElement(a)||o)){var s=e.contains(a);X(t,"onClick",st(t,r,{isDouble:r.isDouble,inputTarget:a,isTarget:e===a,moveableTarget:t.props.target,containsTarget:s}))}},dragGroupEnd:function(t,r){var e=r.inputEvent,n=r.inputTarget;if(!(!e||!n||r.isDrag||t.isMoveableElement(n)||r.datas.inputTarget===n)){var a=t.props.targets,i=a.indexOf(n),o=i>-1,s=!1;i===-1&&(i=pe(a,function(l){return l.contains(n)}),s=i>-1),X(t,"onClickGroup",st(t,r,{isDouble:r.isDouble,targets:a,inputTarget:n,targetIndex:i,isTarget:o,containsTarget:s,moveableTarget:a[i]}))}},dragControlEnd:function(t,r){this.dragEnd(t,r)},dragGroupControlEnd:function(t,r){this.dragEnd(t,r)}});function jr(t){var r=t.originalDatas.draggable;return r||(t.originalDatas.draggable={},r=t.originalDatas.draggable),R(R({},t),{datas:r})}var Ad=we("edgeDraggable",{css:[`.edge.edgeDraggable.line {
cursor: move;
}`],render:function(t,r){var e=t.props,n=e.edgeDraggable;return n?Do(r,"edgeDraggable",n,t.getState().renderPoses,e.zoom):[]},dragCondition:function(t,r){var e,n=t.props,a=(e=r.inputEvent)===null||e===void 0?void 0:e.target;return!n.edgeDraggable||!a?!1:!n.draggable&&wt(a,rt("direction"))&&wt(a,rt("edge"))&&wt(a,rt("edgeDraggable"))},dragStart:function(t,r){return jt.dragStart(t,jr(r))},drag:function(t,r){return jt.drag(t,jr(r))},dragEnd:function(t,r){return jt.dragEnd(t,jr(r))},dragGroupCondition:function(t,r){var e,n=t.props,a=(e=r.inputEvent)===null||e===void 0?void 0:e.target;return!n.edgeDraggable||!a?!1:!n.draggable&&wt(a,rt("direction"))&&wt(a,rt("line"))},dragGroupStart:function(t,r){return jt.dragGroupStart(t,jr(r))},dragGroup:function(t,r){return jt.dragGroup(t,jr(r))},dragGroupEnd:function(t,r){return jt.dragGroupEnd(t,jr(r))},unset:function(t){return jt.unset(t)}}),ps={name:"individualGroupable",props:["individualGroupable","individualGroupableProps"],events:[]},Nd=[us,os,Vf,sd,jt,Ad,Vn,ld,ud,wf,gd,hd,pd,Od,Md,Pd,Pa,ps,jd,is,fs];function yi(t,r){var e=M(t,3),n=e[0],a=e[1],i=e[2];return(n*r[0]+a*r[1]+i)/Math.sqrt(n*n+a*a)}function Le(t,r){var e=M(t,2),n=e[0],a=e[1];return-n*r[0]-a*r[1]}function bi(t,r){return Math.max.apply(Math,L([],M(t.map(function(e){var n=M(e,4),a=n[0],i=n[1],o=n[2],s=n[3];return Math.max(a[r],i[r],o[r],s[r])})),!1))}function Si(t,r){return Math.min.apply(Math,L([],M(t.map(function(e){var n=M(e,4),a=n[0],i=n[1],o=n[2],s=n[3];return Math.min(a[r],i[r],o[r],s[r])})),!1))}function Ld(t,r){var e,n,a,i=[0,0],o=[0,0],s=[0,0],l=[0,0],c=0,u=0;if(!t.length)return{pos1:i,pos2:o,pos3:s,pos4:l,minX:0,minY:0,maxX:0,maxY:0,width:c,height:u,rotation:r};var f=dt(r,Nt);if(f%90){var d=f/180*Math.PI,p=Math.tan(d),v=-1/p,g=[An,qa],h=[[0,0],[0,0]],m=[An,qa],x=[[0,0],[0,0]];t.forEach(function(K){K.forEach(function(W){var Y=yi([-p,1,0],W),F=yi([-v,1,0],W);g[0]>Y&&(h[0]=W,g[0]=Y),g[1]<Y&&(h[1]=W,g[1]=Y),m[0]>F&&(x[0]=W,m[0]=F),m[1]<F&&(x[1]=W,m[1]=F)})});var y=M(h,2),S=y[0],E=y[1],b=M(x,2),C=b[0],w=b[1],T=[-p,1,Le([-p,1],S)],O=[-p,1,Le([-p,1],E)],P=[-v,1,Le([-v,1],C)],z=[-v,1,Le([-v,1],w)];e=M([[T,P],[T,z],[O,P],[O,z]].map(function(K){var W=M(K,2),Y=W[0],F=W[1];return sl(Y,F)[0]}),4),i=e[0],o=e[1],s=e[2],l=e[3],c=m[1]-m[0],u=g[1]-g[0]}else{var I=Si(t,0),B=Si(t,1),_=bi(t,0),H=bi(t,1);if(i=[I,B],o=[_,B],s=[I,H],l=[_,H],c=_-I,u=H-B,f%180){var N=[s,i,l,o];n=M(N,4),i=n[0],o=n[1],s=n[2],l=n[3],c=H-B,u=_-I}}if(f%360>180){var N=[l,s,o,i];a=M(N,4),i=a[0],o=a[1],s=a[2],l=a[3]}var G=me([i,o,s,l]),q=G.minX,V=G.minY,j=G.maxX,$=G.maxY;return{pos1:i,pos2:o,pos3:s,pos4:l,width:c,height:u,minX:q,minY:V,maxX:j,maxY:$,rotation:r}}function vs(t,r){var e=r.map(function(n){if(zt(n)){var a=vs(t,n),i=a.length;return i>1?a:i===1?a[0]:null}else{var o=xr(t,function(s){var l=s.manager;return l.props.target===n});return o?(o.finded=!0,o.manager):null}}).filter(Boolean);return e.length===1&&zt(e[0])?e[0]:e}var Hd=function(t){Ee(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.differ=new Ii,e.moveables=[],e.transformOrigin="50% 50%",e.renderGroupRects=[],e._targetGroups=[],e._hasFirstTargets=!1,e}return r.prototype.componentDidMount=function(){t.prototype.componentDidMount.call(this)},r.prototype.checkUpdate=function(){this._isPropTargetChanged=!1,this.updateAbles()},r.prototype.getTargets=function(){return this.props.targets},r.prototype.updateRect=function(e,n,a){var i;a===void 0&&(a=!0);var o=this.state;if(!this.controlBox||o.isPersisted)return;Xr(!0),this.moveables.forEach(function(tt){tt.updateRect(e,!1,!1)});var s=this.props,l=this.moveables,c=o.target||s.target,u=l.map(function(tt){return{finded:!1,manager:tt}}),f=this.props.targetGroups||[],d=vs(u,f),p=s.useDefaultGroupRotate;d.push.apply(d,L([],M(u.filter(function(tt){var ot=tt.finded;return!ot}).map(function(tt){var ot=tt.manager;return ot})),!1));var v=[],g=!n||e!==""&&s.updateGroup,h=s.defaultGroupRotate||0;if(!this._hasFirstTargets){var m=(i=s.persistData)===null||i===void 0?void 0:i.rotation;m!=null&&(h=m)}function x(tt,ot,nt){var Q=tt.map(function(ht){if(zt(ht)){var ut=x(ht,ot),gt=[ut.pos1,ut.pos2,ut.pos3,ut.pos4];return v.push(ut),{poses:gt,rotation:ut.rotation}}else return{poses:Xt(ht.state),rotation:ht.getRotation()}}),J=Q.map(function(ht){var ut=ht.rotation;return ut}),vt=0,lt=J[0],ct=J.every(function(ht){return Math.abs(lt-ht)<.1});g?vt=!p&&ct?lt:h:vt=!p&&!nt&&ct?lt:ot;var ft=Q.map(function(ht){var ut=ht.poses;return ut}),yt=Ld(ft,vt);return yt}var y=x(d,this.rotation,!0);g&&(this.rotation=y.rotation,this.transformOrigin=s.defaultGroupOrigin||"50% 50%",this.scale=[1,1]),this._targetGroups=f,this.renderGroupRects=v;var S=this.transformOrigin,E=this.rotation,b=this.scale,C=y.width,w=y.height,T=y.minX,O=y.minY,P=od([[0,0],[C,0],[0,w],[C,w]],Oa(S,C,w),this.rotation/180*Math.PI),z=me(P.result),I=z.minX,B=z.minY,_=" rotate(".concat(E,"deg)")+" scale(".concat(Wt(b[0]),", ").concat(Wt(b[1]),")"),H="translate(".concat(-I,"px, ").concat(-B,"px)").concat(_);this.controlBox.style.transform="translate3d(".concat(T,"px, ").concat(O,"px, ").concat(this.props.translateZ||0,")"),c.style.cssText+="left:0px;top:0px;"+"transform-origin:".concat(S,";")+"width:".concat(C,"px;height:").concat(w,"px;")+"transform: ".concat(H),o.width=C,o.height=w;var N=this.getContainer(),G=Kn(this.controlBox,c,this.controlBox,this.getContainer(),this._rootContainer||N,[]),q=[G.left,G.top],V=M(Xt(G),4),j=V[0],$=V[1],K=V[2],W=V[3],Y=me([j,$,K,W]),F=[Y.minX,Y.minY],U=Wt(b[0]*b[1]);G.pos1=et(j,F),G.pos2=et($,F),G.pos3=et(K,F),G.pos4=et(W,F),G.left=T-G.left+F[0],G.top=O-G.top+F[1],G.origin=et(pt(q,G.origin),F),G.beforeOrigin=et(pt(q,G.beforeOrigin),F),G.originalBeforeOrigin=pt(q,G.originalBeforeOrigin),G.transformOrigin=et(pt(q,G.transformOrigin),F),c.style.transform="translate(".concat(-I-F[0],"px, ").concat(-B-F[1],"px)")+_,Xr(),this.updateState(R(R({},G),{posDelta:F,direction:U,beforeDirection:U}),a)},r.prototype.getRect=function(){return R(R({},t.prototype.getRect.call(this)),{children:this.moveables.map(function(e){return e.getRect()})})},r.prototype.triggerEvent=function(e,n,a){if(a||e.indexOf("Group")>-1)return t.prototype.triggerEvent.call(this,e,n);this._emitter.trigger(e,n)},r.prototype.getRequestChildStyles=function(){var e=this.getEnabledAbles().reduce(function(n,a){var i,o,s=(o=(i=a.requestChildStyle)===null||i===void 0?void 0:i.call(a))!==null&&o!==void 0?o:[];return L(L([],M(n),!1),M(s),!1)},[]);return e},r.prototype.getMoveables=function(){return L([],M(this.moveables),!1)},r.prototype.updateAbles=function(){t.prototype.updateAbles.call(this,L(L([],M(this.props.ables),!1),[Pa],!1),"Group")},r.prototype._updateTargets=function(){t.prototype._updateTargets.call(this),this._originalDragTarget=this.props.dragTarget||this.areaElement,this._dragTarget=Qt(this._originalDragTarget,!0)},r.prototype._updateEvents=function(){var e=this.state,n=this.props,a=this._prevDragTarget,i=n.dragTarget||this.areaElement,o=n.targets,s=this.differ.update(o),l=s.added,c=s.changed,u=s.removed,f=l.length||u.length;(f||this._prevOriginalDragTarget!==this._originalDragTarget)&&(Hr(this,!1),Hr(this,!0),this.updateState({gestos:{}})),a!==i&&(e.target=null),e.target||(e.target=this.areaElement,this.controlBox.style.display="block"),e.target&&(this.targetGesto||(this.targetGesto=ds(this,this._dragTarget,"Group")),this.controlGesto||(this.controlGesto=za(this,this.controlBox,"controlAbles","GroupControl")));var d=!Xn(e.container,n.container);d&&(e.container=n.container),(d||f||this.transformOrigin!==(n.defaultGroupOrigin||"50% 50%")||c.length||o.length&&!es(this._targetGroups,n.targetGroups||[]))&&(this.updateRect(),this._hasFirstTargets=!0),this._isPropTargetChanged=!!f},r.prototype._updateObserver=function(){},r.defaultProps=R(R({},Kr.defaultProps),{transformOrigin:["50%","50%"],groupable:!0,dragArea:!0,keepRatio:!0,targets:[],defaultGroupRotate:0,defaultGroupOrigin:"50% 50%"}),r}(Kr),Vd=function(t){Ee(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.moveables=[],e}return r.prototype.render=function(){var e=this,n,a=this.props,i=a.cspNonce,o=a.cssStyled,s=a.persistData,l=a.targets||[],c=l.length,u=this.isUnmounted||!c,f=(n=s==null?void 0:s.children)!==null&&n!==void 0?n:[];return u&&!c&&f.length?l=f.map(function(){return null}):u||(f=[]),A.createElement(o,{cspNonce:i,ref:Or(this,"controlBox"),className:rt("control-box")},l.map(function(d,p){var v,g,h=(g=(v=a.individualGroupableProps)===null||v===void 0?void 0:v.call(a,d,p))!==null&&g!==void 0?g:{};return A.createElement(Kr,R({key:"moveable"+p,ref:Ti(e,"moveables",p)},a,h,{target:d,wrapperMoveable:e,isWrapperMounted:e.isMoveableMounted,persistData:f[p]}))}))},r.prototype.componentDidMount=function(){},r.prototype.componentDidUpdate=function(){},r.prototype.getTargets=function(){return this.props.targets},r.prototype.updateRect=function(e,n,a){a===void 0&&(a=!0),Xr(!0),this.moveables.forEach(function(i){i.updateRect(e,n,a)}),Xr()},r.prototype.getRect=function(){return R(R({},t.prototype.getRect.call(this)),{children:this.moveables.map(function(e){return e.getRect()})})},r.prototype.request=function(e,n,a){n===void 0&&(n={});var i=this.moveables.map(function(l){return l.request(e,R(R({},n),{isInstant:!1}),!1)}),o=a||n.isInstant,s={request:function(l){return i.forEach(function(c){return c.request(l)}),this},requestEnd:function(){return i.forEach(function(l){return l.requestEnd()}),this}};return o?s.request(n).requestEnd():s},r.prototype.dragStart=function(e){var n=e.target,a=xr(this.moveables,function(i){var o=i.getTargets()[0],s=i.getControlBoxElement(),l=i.getDragElement();return!o||!l?!1:l===n||l.contains(n)||l!==o&&o===n||o.contains(n)||s===n||s.contains(n)});return a&&a.dragStart(e),this},r.prototype.hitTest=function(){return 0},r.prototype.isInside=function(){return!1},r.prototype.isDragging=function(){return!1},r.prototype.getDragElement=function(){return null},r.prototype.getMoveables=function(){return L([],M(this.moveables),!1)},r.prototype.updateRenderPoses=function(){},r.prototype.checkUpdate=function(){},r.prototype.triggerEvent=function(){},r.prototype.updateAbles=function(){},r.prototype._updateEvents=function(){},r.prototype._updateObserver=function(){},r}(Kr);function gs(t,r){var e=[];return t.forEach(function(n){if(n){if(Br(n)){r[n]&&e.push.apply(e,L([],M(r[n]),!1));return}zt(n)?e.push.apply(e,L([],M(gs(n,r)),!1)):e.push(n)}}),e}function hs(t,r){var e=[];return t.forEach(function(n){if(n){if(Br(n)){r[n]&&e.push.apply(e,L([],M(r[n]),!1));return}zt(n)?e.push(hs(n,r)):e.push(n)}}),e}function ms(t,r){return t.length!==r.length||t.some(function(e,n){var a=r[n];return!e&&!a?!1:e!=a?zt(e)&&zt(a)?ms(e,a):!0:!1})}var Fd=function(t){Ee(r,t);function r(){var e=t!==null&&t.apply(this,arguments)||this;return e.refTargets=[],e.selectorMap={},e._differ=new Ii,e._elementTargets=[],e._tmpRefTargets=[],e._tmpSelectorMap={},e._onChangeTargets=null,e}return r.makeStyled=function(){var e={},n=this.getTotalAbles();n.forEach(function(i){var o=i.css;o&&o.forEach(function(s){e[s]=!0})});var a=Jr(e).join(`
`);this.defaultStyled=so("div",qs(da,Mu+a))},r.getTotalAbles=function(){return L([os,Pa,ps,is],M(this.defaultAbles),!1)},r.prototype.render=function(){var e,n=this.constructor;n.defaultStyled||n.makeStyled();var a=this.props,i=a.ables,o=a.props,s=vu(a,["ables","props"]),l=M(this._updateRefs(!0),2),c=l[0],u=l[1],f=gs(c,u),d=f.length>1,p=n.getTotalAbles(),v=L(L([],M(p),!1),M(i||[]),!1),g=R(R(R({},s),o||{}),{ables:v,cssStyled:n.defaultStyled,customStyledMap:n.customStyledMap});this._elementTargets=f;var h=null,m=this.moveable,x=s.persistData;if(x!=null&&x.children&&(d=!0),s.individualGroupable)return A.createElement(Vd,R({key:"individual-group",ref:Or(this,"moveable")},g,{target:null,targets:f}));if(d){var y=hs(c,u);if(m&&!m.props.groupable&&!m.props.individualGroupable){var S=m.props.target;S&&f.indexOf(S)>-1&&(h=R({},m.state))}return A.createElement(Hd,R({key:"group",ref:Or(this,"moveable")},g,(e=s.groupableProps)!==null&&e!==void 0?e:{},{target:null,targets:f,targetGroups:y,firstRenderState:h}))}else{var E=f[0];if(m&&(m.props.groupable||m.props.individualGroupable)){var b=m.moveables||[],C=xr(b,function(w){return w.props.target===E});C&&(h=R({},C.state))}return A.createElement(Kr,R({key:"single",ref:Or(this,"moveable")},g,{target:E,firstRenderState:h}))}},r.prototype.componentDidMount=function(){this._checkChangeTargets()},r.prototype.componentDidUpdate=function(){this._checkChangeTargets()},r.prototype.componentWillUnmount=function(){this.selectorMap={},this.refTargets=[]},r.prototype.getTargets=function(){var e,n;return(n=(e=this.moveable)===null||e===void 0?void 0:e.getTargets())!==null&&n!==void 0?n:[]},r.prototype.updateSelectors=function(){this.selectorMap={},this._updateRefs()},r.prototype.waitToChangeTarget=function(){var e=this,n;return this._onChangeTargets=function(){e._onChangeTargets=null,n()},new Promise(function(a){n=a})},r.prototype.waitToChangeTargets=function(){return this.waitToChangeTarget()},r.prototype.getManager=function(){return this.moveable},r.prototype.getMoveables=function(){return this.moveable.getMoveables()},r.prototype.getDragElement=function(){return this.moveable.getDragElement()},r.prototype._updateRefs=function(e){var n=this.refTargets,a=Ma(this.props.target||this.props.targets),i=typeof document<"u",o=ms(n,a),s=this.selectorMap,l={};return this.refTargets.forEach(function c(u){if(Br(u)){var f=s[u];f?l[u]=s[u]:i&&(o=!0,l[u]=[].slice.call(document.querySelectorAll(u)))}else zt(u)&&u.forEach(c)}),this._tmpRefTargets=a,this._tmpSelectorMap=l,[a,l,!e&&o]},r.prototype._checkChangeTargets=function(){var e,n,a;this.refTargets=this._tmpRefTargets,this.selectorMap=this._tmpSelectorMap;var i=this._differ.update(this._elementTargets),o=i.added,s=i.removed,l=o.length||s.length;l&&((n=(e=this.props).onChangeTargets)===null||n===void 0||n.call(e,{moveable:this.moveable,targets:this._elementTargets}),(a=this._onChangeTargets)===null||a===void 0||a.call(this));var c=M(this._updateRefs(),3),u=c[0],f=c[1],d=c[2];this.refTargets=u,this.selectorMap=f,d&&this.forceUpdate()},r.defaultAbles=[],r.customStyledMap={},r.defaultStyled=null,gu([Ys(Iu)],r.prototype,"moveable",void 0),r}(A.PureComponent),xs=function(t){Ee(r,t);function r(){return t!==null&&t.apply(this,arguments)||this}return r.defaultAbles=Nd,r}(Fd);class _r{static drawBezierCurves(r,e){r.beginPath();for(let n=0;n<e.length;n++){const{startPoint:a,endPoint:i,firstCP:o,secondCP:s,color:l,lineWidth:c,lineDash:u}=e[n];r.strokeStyle=l,r.lineWidth=c,r.moveTo(a.x,a.y),r.setLineDash(u),r.lineDashOffset=0,r.bezierCurveTo(o.x,o.y,s.x,s.y,i.x,i.y)}r.stroke()}static calculateControlPoint(r,e){const n=e.x<r.x?"left":"right",a=Math.abs(e.x-r.x),i={x:0,y:0},o={x:0,y:0};return n==="right"?(i.x=r.x+a*.5,i.y=r.y,o.x=e.x-a*.5,o.y=e.y):(i.x=r.x+a*.8,i.y=r.y,o.x=e.x-a*.8,o.y=e.y),{firstCP:i,secondCP:o}}static sampleBezierCurve(r,e,n,a,i){const o=[];for(let s=0;s<=i;s++){const l=s/i,c=(1-l)**3*r.x+3*(1-l)**2*l*e.x+3*(1-l)*l**2*n.x+l**3*a.x,u=(1-l)**3*r.y+3*(1-l)**2*l*e.y+3*(1-l)*l**2*n.y+l**3*a.y;o.push({x:c,y:u})}return o}static drawPoint(r,e,n,a){r.fillStyle=a,r.fillRect(e.x-n/2,e.y-n/2,n,n)}static isMouseInRectangle(r,e,n){const a=Math.abs(n.x-e.x);let i,o;n.x<e.x?(i=Math.min(e.x+a*.2,n.x-a*.2),o=Math.max(e.x+a*.2,n.x-a*.2)):(i=Math.min(e.x,n.x),o=Math.max(e.x,n.x));const s=Math.min(e.y,n.y),l=Math.max(e.y,n.y);return r.x>=i&&r.x<=o&&r.y>=s&&r.y<=l}static distanceBetweenPointAndLine(r,e,n){const a=r.x-e.x,i=r.y-e.y,o=n.x-e.x,s=n.y-e.y,l=a*o+i*s,c=o*o+s*s;let u=-1;c!==0&&(u=l/c);let f,d;u<0?(f=e.x,d=e.y):u>1?(f=n.x,d=n.y):(f=e.x+u*o,d=e.y+u*s);const p=r.x-f,v=r.y-d;return Math.sqrt(p*p+v*v)}static isMouseOnLine(r,e,n){for(let a=0;a<e.length-1;a++)if(_r.distanceBetweenPointAndLine(r,e[a],e[a+1])<=n)return!0;return!1}static updSegmentSamplingPoint(){const{bpLines:r}=er;Object.values(r).forEach(e=>{const{startPoint:n,firstCP:a,secondCP:i,endPoint:o}=e;e.samplePoints=_r.sampleBezierCurve(n,a,i,o,20)})}}const tn=()=>{const{bpLines:t}=er;Wd(Object.values(t))},Wd=t=>{const{downCtx:r,canvasOffset:e,nodeContainerRef:n}=er,{width:a,height:i}=n==null?void 0:n.getBoundingClientRect();t.forEach(o=>{const{startAnchorId:s,endAnchorId:l}=o,c=document.getElementById(s),u=document.getElementById(l),{x:f,y:d,width:p,height:v}=c.getBoundingClientRect(),{x:g,y:h,width:m,height:x}=u.getBoundingClientRect();o.startPoint={x:f+p/2-e.x,y:d+v/2-e.y},o.endPoint={x:g+m/2-e.x,y:h+x/2-e.y};const y=_r.calculateControlPoint(o.startPoint,o.endPoint);o.firstCP=y.firstCP,o.secondCP=y.secondCP}),r.clearRect(0,0,a,i),_r.drawBezierCurves(r,t)},Ci=(t,r)=>{const{bpNodeControllerInsMap:e,bpAPLineMap:n,bpLines:a,updLinePos:i,updBpNodeLayout:o,canvasOffset:s}=er;o({id:t,position:{x:r.x,y:r.y}});const l=e[t],{input:c=[],output:u=[]}=l.getConfig(),f=[...c,...u];f&&f.forEach(d=>{const p=n[d.id];p&&p.forEach(v=>{const g=a[v];if(g){const{startAnchorId:h,endAnchorId:m}=g,x=document.getElementById(h),y=document.getElementById(m),{x:S,y:E,width:b,height:C}=x.getBoundingClientRect(),{x:w,y:T,width:O,height:P}=y.getBoundingClientRect();i({id:v,startPoint:{x:S+b/2-s.x,y:E+C/2-s.y},endPoint:{x:w+O/2-s.x,y:T+P/2-s.y}})}})})},Cv=Pt(t=>{const{children:r}=t,e=js.createRef();A.useEffect(()=>{const{setBpMovableRef:c}=er;c(e.current)});const n=c=>{const{target:u,beforeTranslate:f}=c;u.style.transform=`translate(${f[0]}px, ${f[1]}px)`,tn()},a=c=>{const{inputEvent:{target:u}}=c;if(u.classList.contains("ap-circle"))return!1},i=c=>{const{target:u,lastEvent:f}=c;if(!f)return;const{beforeTranslate:d}=f,p=u.id.split(":")[1];Ci(p,{x:d[0],y:d[1]}),_r.updSegmentSamplingPoint()},o=c=>{c.events.forEach(u=>u.target.style.transform=u.transform),tn()},s=c=>{c.events.forEach(u=>{const{target:f,lastEvent:d}=u;if(d){const p=f.id.split(":")[1],{beforeTranslate:v}=d;Ci(p,{x:v[0],y:v[1]})}}),_r.updSegmentSamplingPoint()},{selectedNodes:l}=er;return D.jsxs(D.Fragment,{children:[r,D.jsx(xs,{ref:e,target:l,draggable:!0,origin:!1,hideDefaultLines:!0,onDragStart:a,onDrag:n,onDragEnd:i,onDragGroup:o,onDragGroupEnd:s})]})});class qd{constructor(){at(this,"bluePrintVisible",!1);at(this,"setBluePrintVisible",r=>this.bluePrintVisible=r);an(this,{bluePrintVisible:hr,setBluePrintVisible:mr})}}const hn=new qd;class Yd extends cl{constructor(){super();at(this,"projectVisible",!1);at(this,"setProjectVisible",e=>this.projectVisible=e);at(this,"projectConfig",{name:"",des:"",state:He.DRAFT,createTime:"",updateTime:"",saveType:ul.LOCAL});at(this,"updateProjectConfig",e=>this.projectConfig={...this.projectConfig,...e});an(this,{projectVisible:hr,setProjectVisible:mr,projectConfig:hr,updateProjectConfig:mr})}destroy(){}getData(){return In(this.projectConfig)}init(e){}}const fe=new Yd,Xd=()=>{var a;const{layerConfigs:t}=Z,{setTargetIds:r,calculateGroupCoordinate:e}=it,n=Object.values(t).map(i=>{if(!i.lock&&!i.hide)return i.id});r(n),n.length>0&&e((a=n.map(i=>document.getElementById(i)))==null?void 0:a.filter(i=>!!i))},Ud=()=>{const{targetIds:t,setTargetIds:r}=it;if(!t||t.length===0)return;const{copyItem:e}=Z,n=e(t),a=setTimeout(()=>{r(n),clearTimeout(a)},10)},$d=()=>{const{targetIds:t,setTargetIds:r}=it;if(!t||t.length===0)return;const{layerConfigs:e}=Z,n=[];for(const a of t){const i=e[a];n.push({...i,lock:!0})}Bt.doLockUpd(n),r([])},Kd=()=>{const{setTargetIds:t,targetIds:r}=it;if(!r||r.length===0)return;const{layerConfigs:e}=Z,n=[];r.filter(a=>e[a].lock).forEach(a=>{n.push({id:a,lock:!1})}),Bt.doLockUpd(n),t([])},Zd=()=>{Bt.doLayerToTop()},Jd=()=>{Bt.doLayerToBottom()},Qd=()=>{Bt.doLayerMoveUp()},tp=()=>{Bt.doLayerMoveDown()},ys=()=>{const{targetIds:t}=it;if(t&&t.length>0){const{delNode:r,bpNodeLayoutMap:e}=er,n=[];t.forEach(a=>{e[a]&&n.push(a)}),n.length>0&&r(n)}Bt.doDelete()},bs=ye.throttle(()=>new Promise(()=>{const{saveType:t,id:r}=en.parseUrlParams(),e=_i.getData(),n={id:r,dataJson:JSON.stringify(e)};Di[t].updateProject(n)}),5e3),rp=()=>{const{targetIds:t,setTargetIds:r}=it;if(!t||t.length===0)return;const{layerConfigs:e}=Z,n=[];t.forEach(a=>{const i=e[a];n.push({...i,hide:!0})}),Bt.doHideUpd(n),r([])},ep=()=>{Bt.doGrouping()},np=()=>{let{targetIds:t}=it;const r=new Set;if(de.findTopGroupLayer(t,!1).forEach(e=>r.add(e)),t=Array.from(r),t&&t.length>0){const{delNode:e,bpNodeLayoutMap:n}=er,a=[];t.forEach(i=>{n[i]&&a.push(i)}),a.length>0&&e(a)}Bt.doUnGrouping()},ap=()=>{Bt.doRemoveFromGroup()},ip=()=>{const{targets:t,movableRef:r,groupCoordinate:e}=it;if(!t||t.length===0)return;const{layerConfigs:n}=Z,{canvasConfig:{dragStep:a=1}}=Dt;let i;if(t.length===1){const o=t[0].id;i=(n[o].y||0)-a}else i=((e==null?void 0:e.minY)||0)-a;r==null||r.request("draggable",{y:i},!0)},op=()=>{const{targets:t,movableRef:r,groupCoordinate:e}=it;if(!t||t.length===0)return;const{layerConfigs:n}=Z,{canvasConfig:{dragStep:a=1}}=Dt;if(t.length===1){const i=t[0].id,o=n[i].y+a;r==null||r.request("draggable",{y:o},!0)}else{const i=(e==null?void 0:e.minY)+a;r==null||r.request("draggable",{y:i},!0)}},sp=()=>{const{targets:t,movableRef:r,groupCoordinate:e}=it;if(!t||t.length===0)return;const{layerConfigs:n}=Z,{canvasConfig:{dragStep:a=1}}=Dt;if(t.length===1){const i=t[0].id,o=n[i].x;r==null||r.request("draggable",{x:o-a},!0)}else{const i=(e==null?void 0:e.minX)-a;r==null||r.request("draggable",{x:i},!0)}},lp=()=>{const{targets:t,movableRef:r,groupCoordinate:e}=it;if(!t||t.length===0)return;const{layerConfigs:n}=Z,{canvasConfig:{dragStep:a=1}}=Dt;if(t.length===1){const i=t[0].id,o=n[i].x;r==null||r.request("draggable",{x:o+a},!0)}else{const i=(e==null?void 0:e.minX)+a;r==null||r.request("draggable",{x:i},!0)}},cp=()=>{const{targets:t,movableRef:r,groupCoordinate:e}=it;if(!t||t.length===0)return;const{layerConfigs:n}=Z,{canvasConfig:{resizeStep:a=1}}=Dt;let i;if(t.length===1){const o=t[0].id;i=n[o].height+a}else i=e.groupHeight+a;r==null||r.request("resizable",{offsetHeight:i,direction:[1,-1]},!0)},up=()=>{const{targets:t,movableRef:r,groupCoordinate:e}=it;if(!t||t.length===0)return;const{layerConfigs:n}=Z,{canvasConfig:{resizeStep:a=1}}=Dt;let i;if(t.length===1){const o=t[0].id;i=n[o].height+a}else i=e.groupHeight+a;r==null||r.request("resizable",{offsetHeight:i,direction:[1,1]},!0)},fp=()=>{const{targets:t,movableRef:r,groupCoordinate:e}=it;if(!t||t.length===0)return;const{layerConfigs:n}=Z,{canvasConfig:{resizeStep:a=1}}=Dt;let i;if(t.length===1){const o=t[0].id;i=n[o].width+a}else i=e.groupWidth+a;r==null||r.request("resizable",{offsetWidth:i,direction:[-1,1]},!0)},dp=()=>{const{targets:t,movableRef:r,groupCoordinate:e}=it;if(!t||t.length===0)return;const{layerConfigs:n}=Z,{canvasConfig:{resizeStep:a=1}}=Dt;let i;if(t.length===1){const o=t[0].id;i=n[o].width+a}else i=e.groupWidth+a;r==null||r.request("resizable",{offsetWidth:i,direction:[1,1]},!0)},pp=()=>{const{targets:t,movableRef:r,groupCoordinate:e}=it;if(!t||t.length===0)return;const{layerConfigs:n}=Z,{canvasConfig:{resizeStep:a=1}}=Dt;let i;t.length===1?i=n[t[0].id].height-a:i=e.groupHeight-a,r==null||r.request("resizable",{offsetHeight:i,direction:[1,-1]},!0)},vp=()=>{const{targets:t,movableRef:r,groupCoordinate:e}=it;if(!t||t.length===0)return;const{layerConfigs:n}=Z,{canvasConfig:{resizeStep:a=1}}=Dt;let i;if(t.length===1){const o=t[0].id;i=n[o].height-a}else i=e.groupHeight-a;r==null||r.request("resizable",{offsetHeight:i,direction:[1,1]},!0)},gp=()=>{const{targets:t,movableRef:r,groupCoordinate:e}=it;if(!t||t.length===0)return;const{layerConfigs:n}=Z,{canvasConfig:{resizeStep:a=1}}=Dt;let i;if(t.length===1){const o=t[0].id;i=n[o].width-a}else i=e.groupWidth-a;r==null||r.request("resizable",{offsetWidth:i,direction:[-1,1]},!0)},hp=()=>{const{targets:t,movableRef:r,groupCoordinate:e}=it;if(!t||t.length===0)return;const{layerConfigs:n}=Z,{canvasConfig:{resizeStep:a=1}}=Dt;let i;if(t.length===1){const o=t[0].id;i=n[o].width-a}else i=e.groupWidth-a;r==null||r.request("resizable",{offsetWidth:i,direction:[1,1]},!0)},mp=()=>{const t=Bi.backoff();if(!t)return;const{actions:r}=t;r.forEach(e=>{var a;const{type:n}=e;(a=Zt.get(n))==null||a.undo(e)})},xp=()=>{const t=Bi.forward();if(!t)return;const{actions:r}=t;r.forEach(e=>{var a;const{type:n}=e;(a=Zt.get(n))==null||a.redo(e)})},yp=()=>{const{auxiliaryBorder:t,setAuxiliaryBorder:r}=Sl;if(!t){const n=document.getElementsByClassName("lc-comp-item");n&&Array.from(n).forEach(a=>{a.style.border="1px solid #65eafc"})}else{const n=document.getElementsByClassName("lc-comp-item");n&&Array.from(n).forEach(a=>{a.style.border="none"})}r(!t)},bp=()=>{const{projectVisible:t,setProjectVisible:r}=fe;console.log(t),r(!t)},Sp=()=>{const{canvasVisible:t,setCanvasVisible:r}=Dt;r(!t)},Cp=()=>{const{themeVisible:t,setThemeVisible:r}=nn;r(!t)},Dp=()=>{const{hotKeyVisible:t,setHotKeyVisible:r}=Ve;r(!t)},Ss=()=>{if(!hn.bluePrintVisible)return;const{selectedNodes:t,delNode:r}=er;if(t.length===0)return;const e=t.map(i=>i.id.split(":")[1]);r(e);const{setUsedLayerNodes:n,usedLayerNodes:a}=fl;e.forEach(i=>{i in a&&n(i,!1)}),tn()},Cs=()=>{if(!hn.bluePrintVisible)return;const{selectedLines:t,delLine:r}=er;if(t.length===0)return;const e=t.map(n=>n.id);r(e),tn()},Ep=()=>{const t=A.useRef({...Dt.canvasConfig}),[r,e]=A.useState(Dt.canvasConfig.rasterize||!1),{canvasVisible:n,setCanvasVisible:a}=Dt,{width:i,height:o,rasterize:s,dragStep:l,resizeStep:c}=t.current,u=()=>{a(!1)},f=d=>{Dt.updateCanvasConfig(t.current),d.preventDefault(),u()};return D.jsx(zr,{className:"lc-header-canvas",title:"画布设置",visible:n,onClose:u,children:D.jsxs("form",{onSubmit:f,children:[D.jsx("div",{style:{display:"flex",flexWrap:"wrap"},children:D.jsxs(ia,{gridGap:"15px",columns:3,children:[D.jsx(Ie,{label:"宽度",defaultValue:i,min:500,onChange:d=>t.current.width=d}),D.jsx(Ie,{label:"高度",defaultValue:o,min:300,onChange:d=>t.current.height=d}),D.jsx(_l,{label:"栅格化",defaultValue:s,containerStyle:{gridColumn:"1/2"},onChange:d=>{t.current.rasterize=d,e(d)}}),D.jsx(Ie,{label:"拖拽",disabled:!r,defaultValue:l,min:1,onChange:d=>t.current.dragStep=d}),D.jsx(Ie,{label:"缩放",disabled:!r,defaultValue:c,min:1,onChange:d=>t.current.resizeStep=d})]})}),D.jsx("p",{className:"canvas-config-desc",children:"说明：修改画布设置，会对整体效果产生较大影响，建议先调试好画布设置后再进行大屏设计"}),D.jsxs("div",{className:"lc-header-canvas-footer",children:[D.jsx(sr,{type:"submit",children:"保存"}),"  ",D.jsx(sr,{type:"button",onClick:u,children:"取消"})]})]})})},wp=Pt(Ep),Rp=()=>{const t=A.useRef({...fe.projectConfig}),{projectVisible:r,setProjectVisible:e}=fe,{name:n,des:a,state:i,saveType:o}=t.current,s=()=>e(!1),l=c=>{c.preventDefault();const{updateProjectConfig:u}=fe;u(t.current),s()};return D.jsx(zr,{title:"项目设置",className:"lc-header-project-set",visible:r,onClose:s,children:D.jsxs("form",{onSubmit:l,children:[D.jsx("div",{style:{display:"flex",flexWrap:"wrap"},children:D.jsxs(ia,{gridGap:"15px",columns:2,children:[D.jsx(qe,{label:"项目名称",maxLength:20,defaultValue:n,onChange:c=>t.current.name=c}),D.jsx(qe,{label:"项目描述",maxLength:60,defaultValue:a,onChange:c=>t.current.des=c}),D.jsx(Bl,{label:"项目状态",onChange:c=>t.current.state=c,containerStyle:{gridColumn:"1/3"},defaultValue:i,options:[{label:"草稿",value:He.DRAFT},{label:"发布",value:He.PUBLISH},{label:"封存",value:He.SEALED}]}),D.jsx(Gl,{label:"存储类型",options:[{value:"1",label:"本地存储"}],defaultValue:o})]})}),D.jsxs("div",{className:"lc-header-project-footer",children:[D.jsx(sr,{type:"submit",children:"保存"}),D.jsx(sr,{type:"button",onClick:s,children:"取消"})]})]})})},Mp=()=>{const t=A.useRef(),[r,e]=A.useState(!1),{themeVisible:n,setThemeVisible:a}=nn,i=()=>a(!1),o=()=>{const{flashGlobalTheme:s}=Z;t.current&&(s(t.current),i())};return D.jsxs(D.Fragment,{children:[D.jsxs(zr,{title:"主题设置(全局)",className:"lc-theme-config-global",visible:n,onClose:i,width:450,children:[D.jsx(sr,{style:{width:"100%",height:50,margin:"5px 0 10px 0"},onClick:()=>e(!0),children:"+ 自定义主题"}),D.jsx("div",{style:{maxHeight:360,overflowY:"scroll",padding:"3px 0 6px 0"},children:D.jsx(dl,{onSelected:s=>t.current=s})}),D.jsx("p",{style:{color:"#6e6e6e"},children:"警告：全局主题设置在更新后，会影响到当前项目的所有组件。请谨慎操作！"}),D.jsx(sr,{style:{width:"100%",margin:"10px 0 5px 0"},onClick:o,children:"更新全局主题"})]}),D.jsx(zr,{onClose:()=>e(!1),title:"编辑主题",visible:r,width:860,children:D.jsx(pl,{})})]})},Op=A.lazy(()=>lr(()=>import("./BluePrint-W3GvKWYy.js"),__vite__mapDeps([47,1,2])));function Tp(){return As.createPortal(D.jsx("div",{style:{position:"relative",top:-window.innerHeight,zIndex:2,width:"100%",height:"100%",backgroundColor:"#151515"},children:D.jsx(A.Suspense,{fallback:D.jsx(Zr,{}),children:D.jsx(Op,{})})}),document.body)}const Ip=[{icon:gc,name:"蓝图",key:"blue-print",onClick:()=>{const{setTargetIds:t}=it;t([]),hn.setBluePrintVisible(!0)}},{icon:Ql,name:"画布",key:"canvas",onClick:()=>Dt.setCanvasVisible(!0)},{icon:Xl,name:"主题",key:"theme",onClick:()=>nn.setThemeVisible(!0)}],zp=[{icon:xc,name:"保存",key:"save",onClick:()=>bs()},{icon:tc,name:"预览",key:"preview",onClick:()=>{const{saveType:t,id:r}=en.parseUrlParams();window.open(`/light-chaser-app/#/view?id=${r}&saveType=${t}&mode=${rn.VIEW}`,"_blank")}}],Pp=Pt(()=>{const t=r=>{const e=[];for(let n=0;n<r.length;n++){const{icon:a,name:i,key:o,onClick:s}=r[n];e.push(D.jsxs("div",{className:"header-item",onClick:s,children:[D.jsx(a,{}),D.jsx("span",{className:"item-span",children:i})]},o))}return e};return D.jsx(D.Fragment,{children:D.jsxs("div",{className:"designer-header",children:[D.jsx("div",{className:"header-left",children:D.jsx("div",{className:"header-title",children:"LIGHT CHASER"})}),D.jsx("div",{className:"header-center",children:t(Ip)}),D.jsx("div",{className:"header-right",children:t(zp)}),Dt.canvasVisible&&D.jsx(wp,{}),fe.projectVisible&&D.jsx(Rp,{}),nn.themeVisible&&D.jsx(Mp,{}),hn.bluePrintVisible&&D.jsx(Tp,{})]})})});var Lt=(t=>(t[t.SINGLE=0]="SINGLE",t[t.COILED=1]="COILED",t))(Lt||{});const _p=["control + s","alt","control + l","control + shift + l","control + h","control + k","control + 1","control + 2","control + 3","control + 4","control + 5","control + g","control + shift + g"];let Bp=class extends A.Component{constructor(e){super(e);at(this,"handlerMapping",{});at(this,"currHotKey",[]);at(this,"existHandlerKey","");at(this,"specialDomCache",{});at(this,"getSpecialDomCache",e=>{const n=this.specialDomCache[e];if(n)return n;{const a=document.querySelector(e);return a?(this.specialDomCache[e]=a,a):null}});at(this,"doHandler",(e,n)=>{const{handler:a,triggerType:i=0,range:o}=this.handlerMapping[n]||{};if(a&&(i===0&&this.existHandlerKey!==n||i===1)){const{pointerTarget:s}=it;if(o){const l=this.getSpecialDomCache(o);if(!l||!l.contains(s))return}Array.isArray(a)?a.forEach(l=>l(e)):a(e),this.existHandlerKey=n}});at(this,"keyDown",e=>{const n=e.key.toLowerCase();this.currHotKey.some(i=>i===n)||this.currHotKey.push(n);const a=this.currHotKey.join(" + ");_p.some(i=>i===a)&&e.preventDefault(),this.doHandler(e,a)});at(this,"keyUp",e=>{const n=e.key.toLowerCase();this.currHotKey.some(a=>a===n)&&(this.currHotKey=this.currHotKey.filter(a=>a!==n),this.existHandlerKey="")});at(this,"onBlur",()=>{this.currHotKey=[],this.existHandlerKey=""});this.handlerMapping=e.handlerMapping}componentDidMount(){document.addEventListener("keydown",this.keyDown),document.addEventListener("keyup",this.keyUp),window.onblur=this.onBlur}componentWillUnmount(){document.removeEventListener("keydown",this.keyDown),document.removeEventListener("keyup",this.keyUp),window.onblur=null}render(){return null}};const Gp=Object.freeze(Object.defineProperty({__proto__:null,HotKeyTriggerType:Lt,default:Bp},Symbol.toStringTag,{value:"Module"})),Ds={"control + a":{handler:Xd,range:".lc-ruler-content"},"control + v":{handler:Ud,range:".lc-ruler-content"},"control + l":{handler:$d},"control + shift + l":{handler:Kd},"control + h":{handler:rp},"control + arrowup":{handler:Zd},"control + arrowdown":{handler:Jd},"alt + arrowup":{handler:Qd},"alt + arrowdown":{handler:tp},"control + s":{handler:bs},"control + z":{handler:mp,range:".lc-ruler-content"},"control + shift + z":{handler:xp,range:".lc-ruler-content"},"control + k":{handler:yp},"control + 1":{handler:bp},"control + 2":{handler:Sp},"control + 3":{handler:Cp},"control + 4":{handler:Dp},arrowup:{handler:ip,triggerType:Lt.COILED,range:".lc-ruler-content"},arrowdown:{handler:op,triggerType:Lt.COILED,range:".lc-ruler-content"},arrowleft:{handler:sp,triggerType:Lt.COILED,range:".lc-ruler-content"},arrowright:{handler:lp,triggerType:Lt.COILED,range:".lc-ruler-content"},"control + shift + arrowup":{handler:cp,triggerType:Lt.COILED,range:".lc-ruler-content"},"control + shift + arrowdown":{handler:up,triggerType:Lt.COILED,range:".lc-ruler-content"},"control + shift + arrowleft":{handler:fp,triggerType:Lt.COILED,range:".lc-ruler-content"},"control + shift + arrowright":{handler:dp,triggerType:Lt.COILED,range:".lc-ruler-content"},"control + alt + arrowup":{handler:pp,triggerType:Lt.COILED,range:".lc-ruler-content"},"control + alt + arrowdown":{handler:vp,triggerType:Lt.COILED,range:".lc-ruler-content"},"control + alt + arrowleft":{handler:gp,triggerType:Lt.COILED,range:".lc-ruler-content"},"control + alt + arrowright":{handler:hp,triggerType:Lt.COILED,range:".lc-ruler-content"},"control + g":{handler:ep},"control + shift + g":{handler:np},"alt + shift + g":{handler:ap}},kp=/macintosh|mac os x/i.test(navigator.userAgent),jp={delete:{handler:[Cs,Ss,ys]},...Ds},Ap={"meta + backspace":{handler:[Cs,Ss,ys]},...Ds},Np=kp?Ap:jp;class Lp extends A.Component{constructor(e){super(e);at(this,"movableRef",A.createRef());at(this,"onDragStart",e=>{const{target:n,inputEvent:a}=e,{layerConfigs:i}=Z,{lock:o}=i[n.id];if(o)return!1;a&&a.shiftKey&&this.setState({throttleDragRotate:90})});at(this,"onDrag",e=>{const{target:n,beforeTranslate:a}=e;n.style.transform=`translate(${a[0]}px, ${a[1]}px)`});at(this,"onDragEnd",e=>{const{updateLayer:n}=Z,{backoff:a,setBackoff:i}=it,{lastEvent:o,target:s}=e;if(o){const{beforeTranslate:c}=o,u=[{id:s.id,width:s.offsetWidth,height:s.offsetHeight,type:s.dataset.type,x:c[0],y:c[1]}];a?(n(u,!1),i(!1)):Bt.doDrag(u);const{updateBaseConfig:f}=Te;f(u[0])}const{throttleDragRotate:l}=this.state;l!==0&&this.setState({throttleDragRotate:0})});at(this,"onDragGroupStart",e=>{const{inputEvent:n}=e;n&&n.shiftKey&&this.setState({throttleDragRotate:90})});at(this,"onDragGroup",e=>{const{targets:n}=e,{layerConfigs:a}=Z;if(a[n[0].id].lock)return!1;e.events.forEach(o=>o.target.style.transform=o.transform)});at(this,"onDragGroupEnd",e=>{var x;const{targets:n}=e,{updateLayer:a,layerConfigs:i}=Z;if(i[n[0].id].lock)return!1;const{backoff:s,setBackoff:l,setGroupCoordinate:c,groupCoordinate:u,targetIds:f}=it,d=[];e.events.forEach(y=>{const{target:S,lastEvent:E}=y;if(E){const{beforeTranslate:b}=E;d.push({id:S.id,width:S.offsetWidth,height:S.offsetHeight,type:S.dataset.type,x:b[0],y:b[1]})}});const p=((x=e==null?void 0:e.lastEvent)==null?void 0:x.beforeTranslate)||[0,0],v=u.minX+p[0],g=u.minY+p[1];c({minX:v,minY:g}),d.length>0&&(s?(a(d,!1),l(!1)):Bt.doDrag(d));const{throttleDragRotate:h}=this.state;h!==0&&this.setState({throttleDragRotate:0});const m=de.findTopGroupLayer(f,!0);if(m.length===1){const{updateBaseConfig:y}=Te;y({id:m[0],x:Math.round(v),y:Math.round(g)})}});at(this,"onResizeStart",e=>{const{target:n,inputEvent:a}=e,{layerConfigs:i}=Z,{lock:o}=i[n.id];if(o)return!1;a&&a.ctrlKey&&this.setState({keepRatio:!0})});at(this,"onResize",e=>{const{target:n,width:a,height:i,drag:o}=e;n.style.width=`${a}px`,n.style.height=`${i}px`,n.style.transform=`translate(${o.beforeTranslate[0]}px, ${o.beforeTranslate[1]}px)`});at(this,"onResizeEnd",e=>{const{updateLayer:n}=Z,{backoff:a,setBackoff:i}=it,{target:o,lastEvent:s}=e;if(s){const{width:c,height:u,drag:{translate:f},direction:d}=s,p=[{id:o.id,width:c,height:u,type:o.dataset.type,x:f[0],y:f[1]}];a?(n(p,!1),i(!1)):Bt.doResize(p,d);const{updateBaseConfig:v}=Te;v(p[0])}const{keepRatio:l}=this.state;l&&this.setState({keepRatio:!1})});at(this,"onResizeGroupStart",e=>{const{targets:n,inputEvent:a}=e,{layerConfigs:i}=Z;if(i[n[0].id].lock)return!1;a&&a.ctrlKey&&this.setState({keepRatio:!0})});at(this,"onResizeGroup",e=>{e.events.forEach(n=>{n.target.style.width=`${n.width}px`,n.target.style.height=`${n.height}px`,n.target.style.transform=n.drag.transform})});at(this,"onResizeGroupEnd",e=>{const{updateLayer:n}=Z,{backoff:a,setBackoff:i,targetIds:o}=it,s=[];if(e.events.forEach(f=>{const{target:d,lastEvent:p}=f;if(p){const{drag:{translate:v}}=p;s.push({id:d.id,width:d.offsetWidth,height:d.offsetHeight,type:d.dataset.type,x:v[0],y:v[1]})}}),!e.lastEvent)return;const{dist:l,direction:c}=e.lastEvent;if(s.length>0){a?(n(s,!1),i(!1)):Bt.doResize(s,c);const{setGroupCoordinate:f,groupCoordinate:d}=it;c[0]===-1||c[1]===-1?f({minX:d.minX-l[0],minY:d.minY-l[1],groupWidth:d.groupWidth+l[0],groupHeight:d.groupHeight+l[1]}):f({groupWidth:d.groupWidth+l[0],groupHeight:d.groupHeight+l[1]});const p=de.findTopGroupLayer(o,!0);if(p.length===1){const{updateBaseConfig:v}=Te;v({id:p[0],x:Math.round(d.minX),y:Math.round(d.minY),width:Math.round(d.groupWidth),height:Math.round(d.groupHeight)})}}const{keepRatio:u}=this.state;u&&this.setState({keepRatio:!1})});this.state={throttleDragRotate:0,keepRatio:!1}}componentDidMount(){const{setMovableRef:e}=it;e(this.movableRef.current)}render(){const{throttleDragRotate:e,keepRatio:n}=this.state,{selectorRef:a,targets:i}=it,{canvasConfig:{rasterize:o,dragStep:s,resizeStep:l}}=Dt,c=Array.from(document.getElementsByClassName("lc-comp-item")).filter(u=>!i.includes(u));return D.jsxs(D.Fragment,{children:[this.props.children,D.jsx(xs,{ref:this.movableRef,target:i,draggable:!0,resizable:!0,keepRatio:n,throttleDragRotate:e,hideChildMoveableDefaultLines:!0,maxSnapElementGuidelineDistance:200,isDisplaySnapDigit:!0,snappable:!0,snapGap:!1,snapThreshold:5,snapDirections:{top:!0,right:!0,bottom:!0,left:!0,center:!0,middle:!0},elementSnapDirections:{top:!0,right:!0,bottom:!0,left:!0,center:!0,middle:!0},verticalGuidelines:["0","100%"],horizontalGuidelines:["0","100%"],isDisplayInnerSnapDigit:!0,elementGuidelines:Array.from(c),ables:[Vp],dimensionViewable:!0,throttleDrag:o?s:1,throttleResize:o?l:1,onClickGroup:u=>a==null?void 0:a.clickTarget(u.inputEvent,u.inputTarget),onDrag:this.onDrag,onDragStart:this.onDragStart,onDragEnd:this.onDragEnd,onDragGroupStart:this.onDragGroupStart,onDragGroup:this.onDragGroup,onDragGroupEnd:this.onDragGroupEnd,onResizeStart:this.onResizeStart,onResize:this.onResize,onResizeEnd:this.onResizeEnd,onResizeGroupStart:this.onResizeGroupStart,onResizeGroup:this.onResizeGroup,onResizeGroupEnd:this.onResizeGroupEnd})]})}}const Hp=Pt(Lp),Vp={name:"dimensionViewable",props:{dimensionViewable:Boolean},events:{},render(t){const r=t.getRect();return D.jsx("div",{className:"moveable-dimension",style:{left:"-125px",top:"-60px",color:"#cacacaff",fontSize:"14px",position:"absolute",boxSizing:"content-box",borderRadius:"5px",padding:"5px",pointerEvents:"none"},children:D.jsxs("div",{children:[D.jsxs("p",{children:["位置: ",Math.round(r.left)," x ",Math.round(r.top)]}),D.jsxs("p",{children:["尺寸: ",Math.round(r.offsetWidth)," x ",Math.round(r.offsetHeight)]})]})},"dimension-viewer")}},Fp=A.lazy(()=>lr(()=>import("./DesignerContainer-qwvKe-ds.js"),__vite__mapDeps([48,1,2]))),Wp=A.lazy(()=>lr(()=>import("./DesignerRuler-G5NCc-Sm.js"),__vite__mapDeps([49,1,2,11,3,4,5,6,7,8,9,10,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]))),qp=A.lazy(()=>lr(()=>import("./LayerManager-GjyFNgYQ.js").then(t=>t.b3),__vite__mapDeps([11,3,1,2,4,5,6,7,8,9,10,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]))),Yp=A.lazy(()=>lr(()=>import("./ContextMenu-03_sBNxh.js"),__vite__mapDeps([50,1,2,3,4,5,6,7,8,9,10,33,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,34,37,38,39,35,36,40,41,42,43,51]))),Xp=A.lazy(()=>lr(()=>Promise.resolve().then(()=>Gp),void 0)),Up=A.lazy(()=>lr(()=>import("./DesignerDragScaleContainer-lRPKqHaG.js"),__vite__mapDeps([52,1,2,53,11,3,4,5,6,7,8,9,10,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31]))),$p=A.memo(Pt(()=>{const t=e=>{let{targetIds:n}=it;const{activeElem:a,activeConfig:i}=Jt;if(n.length===0){i(null,"");return}if(e.shiftKey||(n=de.findTopGroupLayer(n,!0)),n.length!==1)return;const o=n[0],{layerConfigs:s}=Z,l=s[o];o!==a.id&&i(o,l.type)},{layerConfigs:r}=Z;return D.jsxs(A.Suspense,{fallback:D.jsx(Zr,{}),children:[D.jsx(Fp,{children:D.jsx(qp,{children:D.jsx(Wp,{children:D.jsx(Up,{onDoubleClick:t,children:D.jsx(Hp,{children:zn.buildCanvasComponents(r)})})})})}),D.jsx(Yp,{}),D.jsx(Xp,{handlerMapping:Np})]})})),Es=t=>{const{header:r,footer:e,left:n,right:a,content:i}=t;return D.jsxs("div",{className:"frame-layout",children:[D.jsx("div",{className:"fl-header",children:r}),D.jsxs("div",{className:"fl-body",children:[D.jsx("div",{className:"fl-left",children:n}),D.jsxs("div",{className:"fl-crf-box",children:[D.jsxs("div",{className:"fl-cr-box",children:[D.jsx("div",{className:"fl-content",children:i}),D.jsx("div",{className:"fl-right",children:a})]}),D.jsx("div",{className:"fl-footer",children:e})]})]})]})},Ev=Object.freeze(Object.defineProperty({__proto__:null,default:Es},Symbol.toStringTag,{value:"Module"}));function Kp(){document.addEventListener("click",ws),document.addEventListener("contextmenu",Rs),document.addEventListener("pointerdown",Ms),document.addEventListener("pointerup",Os)}function Zp(){document.removeEventListener("click",ws),document.removeEventListener("contextmenu",Rs),document.removeEventListener("pointerdown",Ms),document.removeEventListener("pointerup",Os)}const ws=t=>{const{visible:r,updateVisible:e}=on;if(r&&t.button===0){const n=setTimeout(()=>{e(!1),clearTimeout(n)})}},Rs=t=>{t.preventDefault();const{mouseDownTime:r,mouseUpTime:e,setPosition:n,updateVisible:a}=on,{targetIds:i}=it,o=["lc-comp-item","moveable-area","layer-item","layer-name","group-header","group-left","group-icon","group-name"];i&&i.length>0&&o.some(s=>{var l;return(l=t.target)==null?void 0:l.classList.contains(s)})&&e-r<200?(a&&a(!0),n([t.clientX,t.clientY])):a&&a(!1)},Ms=()=>{const{setMouseDownTime:t}=on;t(Date.now())},Os=t=>{const{setMouseUpTime:r}=on;r(Date.now());const{setPointerTarget:e}=it;e(t.target)},Jp=t=>{const{id:r,type:e}=t;A.useEffect(()=>(Zn.getLoader(rn.EDIT).load(r,e),Kp(),()=>Zp()),[]);const{loaded:n}=_i;return n?D.jsx("div",{style:{backgroundColor:"#1f1f1f"},children:D.jsx(Es,{header:D.jsx(Pp,{}),left:D.jsx(Pc,{}),content:D.jsx($p,{}),right:D.jsx(jc,{}),footer:D.jsx(Fc,{})})}):D.jsx(Zr,{})},Qp=Pt(Jp);function tv(){const{saveType:t,id:r}=en.parseUrlParams();return D.jsx(Qp,{id:r,type:t})}const wv=Object.freeze(Object.defineProperty({__proto__:null,default:tv},Symbol.toStringTag,{value:"Module"}));export{Cv as B,_r as C,wv as D,Ev as F,la as M,Wl as P,$d as a,ep as b,np as c,Kd as d,Ud as e,tp as f,Zd as g,Jd as h,ys as i,rp as j,Qi as k,Qd as l,hn as m,tn as n,ap as r};
function __vite__mapDeps(indexes) {
  if (!__vite__mapDeps.viteFileDeps) {
    __vite__mapDeps.viteFileDeps = ["assets/CompList-ihkCQbjq.js","assets/index-Vy1Yw5o7.js","assets/index-IyM4ICh1.css","assets/Dialog-Zv92ba_c.js","assets/MainRouter-JVC0j7bk.js","assets/MainRouter-KAAIpN4X.css","assets/AntdIcon-H26mUnTY.js","assets/useZIndex-j0u8NYY7.js","assets/Overflow-kXLebS6p.js","assets/GlobalMessage-xEmdGiIb.js","assets/Dialog-IKScJss1.css","assets/LayerManager-GjyFNgYQ.js","assets/Accordion-3459iFJP.js","assets/Switch-JT6W9IDW.js","assets/UIContainer-Yl49M_pF.js","assets/QuestionCircleOutlined-QjJiUeOP.js","assets/UIContainer-2wM5o6qv.css","assets/Switch-sX9zyvHK.css","assets/Accordion-i35kZnIZ.css","assets/Radio-WoN3Ah2C.js","assets/Radio-scZDuxp-.css","assets/ColorPicker-EgERoCQ7.js","assets/ColorPicker-V9ASUd98.css","assets/CardPanel-WUJ30tpk.js","assets/CardPanel-8U9SL0-G.css","assets/Input-cgMnXtOp.js","assets/Input-ulYyAdl_.css","assets/Grid-0zq_maPI.js","assets/Grid-p4FjUlc6.css","assets/Button-TSqYfOPg.js","assets/Button-Vi-JaWc8.css","assets/LayerManager-E3Ybjmun.css","assets/DragAddProvider-_IIQLnDx.js","assets/LayerBuilder-rtyoD02E.js","assets/EyeFilled-88z3eWMW.js","assets/MonacoEditor-mflYtji2.js","assets/MonacoEditor-prUb3zzj.css","assets/PlusOutlined-waRpC5HH.js","assets/useForceUpdate-D171fb5-.js","assets/PlusOutlined-VdblB-UP.js","assets/NumberInput-HmxZMZSP.js","assets/NumberInput-A_zfvH9I.css","assets/Select-XD-y743g.js","assets/Select-fufuxCpP.css","assets/CompList-zkHso7eT.css","assets/ImageSource-JSPBJJzA.js","assets/ImageSource-rrjS9xjn.css","assets/BluePrint-W3GvKWYy.js","assets/DesignerContainer-qwvKe-ds.js","assets/DesignerRuler-G5NCc-Sm.js","assets/ContextMenu-03_sBNxh.js","assets/ContextMenu-CBU8e1pe.css","assets/DesignerDragScaleContainer-lRPKqHaG.js","assets/DragScaleProvider-Xr3oGa7d.js"]
  }
  return indexes.map((i) => __vite__mapDeps.viteFileDeps[i])
}